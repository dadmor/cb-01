import{r as A,j as d,u as zr,L as zc,a as Pr,O as Pc,R as fe,c as Ic,b as Ac,d as $c}from"./react-vendor-4ba9703c.js";import{c as Tc,u as Dc,s as ce,a as Gt,p as ps}from"./zustand-vendor-de806005.js";import{P as ut,U as Cn,D as xs,G as ys,S as oo,F as ft,C as Vc,a as Rc,b as bs,H as so,X as ws,c as Lc,d as Hc,e as Fc,f as Bc,L as Oc,g as Xc,I as Yc,R as Wc}from"./lucide-vendor-1b5114fb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function de(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=de(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Gc={value:()=>{}};function Dn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new bn(n)}function bn(e){this._=e}function Uc(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}bn.prototype=Dn.prototype={constructor:bn,on:function(e,t){var n=this._,r=Uc(e+"",n),o,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((o=(e=r[s]).type)&&(o=qc(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(o=(e=r[s]).type)n[o]=io(n[o],e.name,t);else if(t==null)for(o in n)n[o]=io(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new bn(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,s;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,o=s.length;r<o;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(t,n)}};function qc(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function io(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Gc,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var dr="http://www.w3.org/1999/xhtml";const ao={svg:"http://www.w3.org/2000/svg",xhtml:dr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Vn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),ao.hasOwnProperty(t)?{space:ao[t],local:e}:e}function Kc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===dr&&t.documentElement.namespaceURI===dr?t.createElement(e):t.createElementNS(n,e)}}function Zc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function vs(e){var t=Vn(e);return(t.local?Zc:Kc)(t)}function Qc(){}function Ir(e){return e==null?Qc:function(){return this.querySelector(e)}}function Jc(e){typeof e!="function"&&(e=Ir(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=new Array(i),c,l,f=0;f<i;++f)(c=s[f])&&(l=e.call(c,c.__data__,f,s))&&("__data__"in c&&(l.__data__=c.__data__),a[f]=l);return new xe(r,this._parents)}function el(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function tl(){return[]}function Ns(e){return e==null?tl:function(){return this.querySelectorAll(e)}}function nl(e){return function(){return el(e.apply(this,arguments))}}function rl(e){typeof e=="function"?e=nl(e):e=Ns(e);for(var t=this._groups,n=t.length,r=[],o=[],s=0;s<n;++s)for(var i=t[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),o.push(c));return new xe(r,o)}function Ss(e){return function(){return this.matches(e)}}function Cs(e){return function(t){return t.matches(e)}}var ol=Array.prototype.find;function sl(e){return function(){return ol.call(this.children,e)}}function il(){return this.firstElementChild}function al(e){return this.select(e==null?il:sl(typeof e=="function"?e:Cs(e)))}var cl=Array.prototype.filter;function ll(){return Array.from(this.children)}function dl(e){return function(){return cl.call(this.children,e)}}function ul(e){return this.selectAll(e==null?ll:dl(typeof e=="function"?e:Cs(e)))}function fl(e){typeof e!="function"&&(e=Ss(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new xe(r,this._parents)}function ks(e){return new Array(e.length)}function hl(){return new xe(this._enter||this._groups.map(ks),this._parents)}function kn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}kn.prototype={constructor:kn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function gl(e){return function(){return e}}function ml(e,t,n,r,o,s){for(var i=0,a,c=t.length,l=s.length;i<l;++i)(a=t[i])?(a.__data__=s[i],r[i]=a):n[i]=new kn(e,s[i]);for(;i<c;++i)(a=t[i])&&(o[i]=a)}function pl(e,t,n,r,o,s,i){var a,c,l=new Map,f=t.length,h=s.length,u=new Array(f),g;for(a=0;a<f;++a)(c=t[a])&&(u[a]=g=i.call(c,c.__data__,a,t)+"",l.has(g)?o[a]=c:l.set(g,c));for(a=0;a<h;++a)g=i.call(e,s[a],a,s)+"",(c=l.get(g))?(r[a]=c,c.__data__=s[a],l.delete(g)):n[a]=new kn(e,s[a]);for(a=0;a<f;++a)(c=t[a])&&l.get(u[a])===c&&(o[a]=c)}function xl(e){return e.__data__}function yl(e,t){if(!arguments.length)return Array.from(this,xl);var n=t?pl:ml,r=this._parents,o=this._groups;typeof e!="function"&&(e=gl(e));for(var s=o.length,i=new Array(s),a=new Array(s),c=new Array(s),l=0;l<s;++l){var f=r[l],h=o[l],u=h.length,g=bl(e.call(f,f&&f.__data__,l,r)),y=g.length,p=a[l]=new Array(y),x=i[l]=new Array(y),b=c[l]=new Array(u);n(f,h,p,x,b,g,t);for(var N=0,m=0,w,k;N<y;++N)if(w=p[N]){for(N>=m&&(m=N+1);!(k=x[m])&&++m<y;);w._next=k||null}}return i=new xe(i,r),i._enter=a,i._exit=c,i}function bl(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wl(){return new xe(this._exit||this._groups.map(ks),this._parents)}function vl(e,t,n){var r=this.enter(),o=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?s.remove():n(s),r&&o?r.merge(o).order():o}function Nl(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,s=r.length,i=Math.min(o,s),a=new Array(o),c=0;c<i;++c)for(var l=n[c],f=r[c],h=l.length,u=a[c]=new Array(h),g,y=0;y<h;++y)(g=l[y]||f[y])&&(u[y]=g);for(;c<o;++c)a[c]=n[c];return new xe(a,this._parents)}function Sl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,s=r[o],i;--o>=0;)(i=r[o])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Cl(e){e||(e=kl);function t(h,u){return h&&u?e(h.__data__,u.__data__):!h-!u}for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s){for(var i=n[s],a=i.length,c=o[s]=new Array(a),l,f=0;f<a;++f)(l=i[f])&&(c[f]=l);c.sort(t)}return new xe(o,this._parents).order()}function kl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function El(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function jl(){return Array.from(this)}function _l(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length;o<s;++o){var i=r[o];if(i)return i}return null}function Ml(){let e=0;for(const t of this)++e;return e}function zl(){return!this.node()}function Pl(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],s=0,i=o.length,a;s<i;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}function Il(e){return function(){this.removeAttribute(e)}}function Al(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $l(e,t){return function(){this.setAttribute(e,t)}}function Tl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Dl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Vl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Rl(e,t){var n=Vn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Al:Il:typeof t=="function"?n.local?Vl:Dl:n.local?Tl:$l)(n,t))}function Es(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ll(e){return function(){this.style.removeProperty(e)}}function Hl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Fl(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Bl(e,t,n){return arguments.length>1?this.each((t==null?Ll:typeof t=="function"?Fl:Hl)(e,t,n??"")):ht(this.node(),e)}function ht(e,t){return e.style.getPropertyValue(t)||Es(e).getComputedStyle(e,null).getPropertyValue(t)}function Ol(e){return function(){delete this[e]}}function Xl(e,t){return function(){this[e]=t}}function Yl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Wl(e,t){return arguments.length>1?this.each((t==null?Ol:typeof t=="function"?Yl:Xl)(e,t)):this.node()[e]}function js(e){return e.trim().split(/^|\s+/)}function Ar(e){return e.classList||new _s(e)}function _s(e){this._node=e,this._names=js(e.getAttribute("class")||"")}_s.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ms(e,t){for(var n=Ar(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function zs(e,t){for(var n=Ar(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Gl(e){return function(){Ms(this,e)}}function Ul(e){return function(){zs(this,e)}}function ql(e,t){return function(){(t.apply(this,arguments)?Ms:zs)(this,e)}}function Kl(e,t){var n=js(e+"");if(arguments.length<2){for(var r=Ar(this.node()),o=-1,s=n.length;++o<s;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?ql:t?Gl:Ul)(n,t))}function Zl(){this.textContent=""}function Ql(e){return function(){this.textContent=e}}function Jl(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ed(e){return arguments.length?this.each(e==null?Zl:(typeof e=="function"?Jl:Ql)(e)):this.node().textContent}function td(){this.innerHTML=""}function nd(e){return function(){this.innerHTML=e}}function rd(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function od(e){return arguments.length?this.each(e==null?td:(typeof e=="function"?rd:nd)(e)):this.node().innerHTML}function sd(){this.nextSibling&&this.parentNode.appendChild(this)}function id(){return this.each(sd)}function ad(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cd(){return this.each(ad)}function ld(e){var t=typeof e=="function"?e:vs(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function dd(){return null}function ud(e,t){var n=typeof e=="function"?e:vs(e),r=t==null?dd:typeof t=="function"?t:Ir(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function fd(){var e=this.parentNode;e&&e.removeChild(this)}function hd(){return this.each(fd)}function gd(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function md(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function pd(e){return this.select(e?md:gd)}function xd(e){return arguments.length?this.property("__data__",e):this.node().__data__}function yd(e){return function(t){e.call(this,t,this.__data__)}}function bd(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function wd(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,s;n<o;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function vd(e,t,n){return function(){var r=this.__on,o,s=yd(t);if(r){for(var i=0,a=r.length;i<a;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=t;return}}this.addEventListener(e.type,s,n),o={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(o):this.__on=[o]}}function Nd(e,t,n){var r=bd(e+""),o,s=r.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,f;c<l;++c)for(o=0,f=a[c];o<s;++o)if((i=r[o]).type===f.type&&i.name===f.name)return f.value}return}for(a=t?vd:wd,o=0;o<s;++o)this.each(a(r[o],t,n));return this}function Ps(e,t,n){var r=Es(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Sd(e,t){return function(){return Ps(this,e,t)}}function Cd(e,t){return function(){return Ps(this,e,t.apply(this,arguments))}}function kd(e,t){return this.each((typeof t=="function"?Cd:Sd)(e,t))}function*Ed(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length,i;o<s;++o)(i=r[o])&&(yield i)}var Is=[null];function xe(e,t){this._groups=e,this._parents=t}function Ut(){return new xe([[document.documentElement]],Is)}function jd(){return this}xe.prototype=Ut.prototype={constructor:xe,select:Jc,selectAll:rl,selectChild:al,selectChildren:ul,filter:fl,data:yl,enter:hl,exit:wl,join:vl,merge:Nl,selection:jd,order:Sl,sort:Cl,call:El,nodes:jl,node:_l,size:Ml,empty:zl,each:Pl,attr:Rl,style:Bl,property:Wl,classed:Kl,text:ed,html:od,raise:id,lower:cd,append:ld,insert:ud,remove:hd,clone:pd,datum:xd,on:Nd,dispatch:kd,[Symbol.iterator]:Ed};function me(e){return typeof e=="string"?new xe([[document.querySelector(e)]],[document.documentElement]):new xe([[e]],Is)}function _d(e){let t;for(;t=e.sourceEvent;)e=t;return e}function we(e,t){if(e=_d(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Md={passive:!1},Tt={capture:!0,passive:!1};function Jn(e){e.stopImmediatePropagation()}function lt(e){e.preventDefault(),e.stopImmediatePropagation()}function As(e){var t=e.document.documentElement,n=me(e).on("dragstart.drag",lt,Tt);"onselectstart"in t?n.on("selectstart.drag",lt,Tt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function $s(e,t){var n=e.document.documentElement,r=me(e).on("dragstart.drag",null);t&&(r.on("click.drag",lt,Tt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const sn=e=>()=>e;function ur(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:s,x:i,y:a,dx:c,dy:l,dispatch:f}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:f}})}ur.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function zd(e){return!e.ctrlKey&&!e.button}function Pd(){return this.parentNode}function Id(e,t){return t??{x:e.x,y:e.y}}function Ad(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ts(){var e=zd,t=Pd,n=Id,r=Ad,o={},s=Dn("start","drag","end"),i=0,a,c,l,f,h=0;function u(w){w.on("mousedown.drag",g).filter(r).on("touchstart.drag",x).on("touchmove.drag",b,Md).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(w,k){if(!(f||!e.call(this,w,k))){var S=m(this,t.call(this,w,k),w,k,"mouse");S&&(me(w.view).on("mousemove.drag",y,Tt).on("mouseup.drag",p,Tt),As(w.view),Jn(w),l=!1,a=w.clientX,c=w.clientY,S("start",w))}}function y(w){if(lt(w),!l){var k=w.clientX-a,S=w.clientY-c;l=k*k+S*S>h}o.mouse("drag",w)}function p(w){me(w.view).on("mousemove.drag mouseup.drag",null),$s(w.view,l),lt(w),o.mouse("end",w)}function x(w,k){if(e.call(this,w,k)){var S=w.changedTouches,I=t.call(this,w,k),j=S.length,E,L;for(E=0;E<j;++E)(L=m(this,I,w,k,S[E].identifier,S[E]))&&(Jn(w),L("start",w,S[E]))}}function b(w){var k=w.changedTouches,S=k.length,I,j;for(I=0;I<S;++I)(j=o[k[I].identifier])&&(lt(w),j("drag",w,k[I]))}function N(w){var k=w.changedTouches,S=k.length,I,j;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),I=0;I<S;++I)(j=o[k[I].identifier])&&(Jn(w),j("end",w,k[I]))}function m(w,k,S,I,j,E){var L=s.copy(),V=we(E||S,k),$,T,v;if((v=n.call(w,new ur("beforestart",{sourceEvent:S,target:u,identifier:j,active:i,x:V[0],y:V[1],dx:0,dy:0,dispatch:L}),I))!=null)return $=v.x-V[0]||0,T=v.y-V[1]||0,function P(C,_,M){var z=V,D;switch(C){case"start":o[j]=P,D=i++;break;case"end":delete o[j],--i;case"drag":V=we(M||_,k),D=i;break}L.call(C,w,new ur(C,{sourceEvent:_,subject:v,target:u,identifier:j,active:D,x:V[0]+$,y:V[1]+T,dx:V[0]-z[0],dy:V[1]-z[1],dispatch:L}),I)}}return u.filter=function(w){return arguments.length?(e=typeof w=="function"?w:sn(!!w),u):e},u.container=function(w){return arguments.length?(t=typeof w=="function"?w:sn(w),u):t},u.subject=function(w){return arguments.length?(n=typeof w=="function"?w:sn(w),u):n},u.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:sn(!!w),u):r},u.on=function(){var w=s.on.apply(s,arguments);return w===s?u:w},u.clickDistance=function(w){return arguments.length?(h=(w=+w)*w,u):Math.sqrt(h)},u}function $r(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ds(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function qt(){}var Dt=.7,En=1/Dt,dt="\\s*([+-]?\\d+)\\s*",Vt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",je="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$d=/^#([0-9a-f]{3,8})$/,Td=new RegExp(`^rgb\\(${dt},${dt},${dt}\\)$`),Dd=new RegExp(`^rgb\\(${je},${je},${je}\\)$`),Vd=new RegExp(`^rgba\\(${dt},${dt},${dt},${Vt}\\)$`),Rd=new RegExp(`^rgba\\(${je},${je},${je},${Vt}\\)$`),Ld=new RegExp(`^hsl\\(${Vt},${je},${je}\\)$`),Hd=new RegExp(`^hsla\\(${Vt},${je},${je},${Vt}\\)$`),co={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$r(qt,Qe,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lo,formatHex:lo,formatHex8:Fd,formatHsl:Bd,formatRgb:uo,toString:uo});function lo(){return this.rgb().formatHex()}function Fd(){return this.rgb().formatHex8()}function Bd(){return Vs(this).formatHsl()}function uo(){return this.rgb().formatRgb()}function Qe(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=$d.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?fo(t):n===3?new ge(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?an(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?an(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Td.exec(e))?new ge(t[1],t[2],t[3],1):(t=Dd.exec(e))?new ge(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Vd.exec(e))?an(t[1],t[2],t[3],t[4]):(t=Rd.exec(e))?an(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Ld.exec(e))?mo(t[1],t[2]/100,t[3]/100,1):(t=Hd.exec(e))?mo(t[1],t[2]/100,t[3]/100,t[4]):co.hasOwnProperty(e)?fo(co[e]):e==="transparent"?new ge(NaN,NaN,NaN,0):null}function fo(e){return new ge(e>>16&255,e>>8&255,e&255,1)}function an(e,t,n,r){return r<=0&&(e=t=n=NaN),new ge(e,t,n,r)}function Od(e){return e instanceof qt||(e=Qe(e)),e?(e=e.rgb(),new ge(e.r,e.g,e.b,e.opacity)):new ge}function fr(e,t,n,r){return arguments.length===1?Od(e):new ge(e,t,n,r??1)}function ge(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}$r(ge,fr,Ds(qt,{brighter(e){return e=e==null?En:Math.pow(En,e),new ge(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Dt:Math.pow(Dt,e),new ge(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ge(qe(this.r),qe(this.g),qe(this.b),jn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ho,formatHex:ho,formatHex8:Xd,formatRgb:go,toString:go}));function ho(){return`#${Ue(this.r)}${Ue(this.g)}${Ue(this.b)}`}function Xd(){return`#${Ue(this.r)}${Ue(this.g)}${Ue(this.b)}${Ue((isNaN(this.opacity)?1:this.opacity)*255)}`}function go(){const e=jn(this.opacity);return`${e===1?"rgb(":"rgba("}${qe(this.r)}, ${qe(this.g)}, ${qe(this.b)}${e===1?")":`, ${e})`}`}function jn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ue(e){return e=qe(e),(e<16?"0":"")+e.toString(16)}function mo(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ve(e,t,n,r)}function Vs(e){if(e instanceof ve)return new ve(e.h,e.s,e.l,e.opacity);if(e instanceof qt||(e=Qe(e)),!e)return new ve;if(e instanceof ve)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),s=Math.max(t,n,r),i=NaN,a=s-o,c=(s+o)/2;return a?(t===s?i=(n-r)/a+(n<r)*6:n===s?i=(r-t)/a+2:i=(t-n)/a+4,a/=c<.5?s+o:2-s-o,i*=60):a=c>0&&c<1?0:i,new ve(i,a,c,e.opacity)}function Yd(e,t,n,r){return arguments.length===1?Vs(e):new ve(e,t,n,r??1)}function ve(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}$r(ve,Yd,Ds(qt,{brighter(e){return e=e==null?En:Math.pow(En,e),new ve(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Dt:Math.pow(Dt,e),new ve(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new ge(er(e>=240?e-240:e+120,o,r),er(e,o,r),er(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new ve(po(this.h),cn(this.s),cn(this.l),jn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=jn(this.opacity);return`${e===1?"hsl(":"hsla("}${po(this.h)}, ${cn(this.s)*100}%, ${cn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function po(e){return e=(e||0)%360,e<0?e+360:e}function cn(e){return Math.max(0,Math.min(1,e||0))}function er(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Tr=e=>()=>e;function Wd(e,t){return function(n){return e+n*t}}function Gd(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Ud(e){return(e=+e)==1?Rs:function(t,n){return n-t?Gd(t,n,e):Tr(isNaN(t)?n:t)}}function Rs(e,t){var n=t-e;return n?Wd(e,n):Tr(isNaN(e)?t:e)}const _n=function e(t){var n=Ud(t);function r(o,s){var i=n((o=fr(o)).r,(s=fr(s)).r),a=n(o.g,s.g),c=n(o.b,s.b),l=Rs(o.opacity,s.opacity);return function(f){return o.r=i(f),o.g=a(f),o.b=c(f),o.opacity=l(f),o+""}}return r.gamma=e,r}(1);function qd(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),o;return function(s){for(o=0;o<n;++o)r[o]=e[o]*(1-s)+t[o]*s;return r}}function Kd(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Zd(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,o=new Array(r),s=new Array(n),i;for(i=0;i<r;++i)o[i]=At(e[i],t[i]);for(;i<n;++i)s[i]=t[i];return function(a){for(i=0;i<r;++i)s[i]=o[i](a);return s}}function Qd(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ce(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Jd(e,t){var n={},r={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?n[o]=At(e[o],t[o]):r[o]=t[o];return function(s){for(o in n)r[o]=n[o](s);return r}}var hr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tr=new RegExp(hr.source,"g");function eu(e){return function(){return e}}function tu(e){return function(t){return e(t)+""}}function Ls(e,t){var n=hr.lastIndex=tr.lastIndex=0,r,o,s,i=-1,a=[],c=[];for(e=e+"",t=t+"";(r=hr.exec(e))&&(o=tr.exec(t));)(s=o.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(r=r[0])===(o=o[0])?a[i]?a[i]+=o:a[++i]=o:(a[++i]=null,c.push({i,x:Ce(r,o)})),n=tr.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?c[0]?tu(c[0].x):eu(t):(t=c.length,function(l){for(var f=0,h;f<t;++f)a[(h=c[f]).i]=h.x(l);return a.join("")})}function At(e,t){var n=typeof t,r;return t==null||n==="boolean"?Tr(t):(n==="number"?Ce:n==="string"?(r=Qe(t))?(t=r,_n):Ls:t instanceof Qe?_n:t instanceof Date?Qd:Kd(t)?qd:Array.isArray(t)?Zd:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Jd:Ce)(e,t)}var xo=180/Math.PI,gr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hs(e,t,n,r,o,s){var i,a,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*xo,skewX:Math.atan(c)*xo,scaleX:i,scaleY:a}}var ln;function nu(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?gr:Hs(t.a,t.b,t.c,t.d,t.e,t.f)}function ru(e){return e==null||(ln||(ln=document.createElementNS("http://www.w3.org/2000/svg","g")),ln.setAttribute("transform",e),!(e=ln.transform.baseVal.consolidate()))?gr:(e=e.matrix,Hs(e.a,e.b,e.c,e.d,e.e,e.f))}function Fs(e,t,n,r){function o(l){return l.length?l.pop()+" ":""}function s(l,f,h,u,g,y){if(l!==h||f!==u){var p=g.push("translate(",null,t,null,n);y.push({i:p-4,x:Ce(l,h)},{i:p-2,x:Ce(f,u)})}else(h||u)&&g.push("translate("+h+t+u+n)}function i(l,f,h,u){l!==f?(l-f>180?f+=360:f-l>180&&(l+=360),u.push({i:h.push(o(h)+"rotate(",null,r)-2,x:Ce(l,f)})):f&&h.push(o(h)+"rotate("+f+r)}function a(l,f,h,u){l!==f?u.push({i:h.push(o(h)+"skewX(",null,r)-2,x:Ce(l,f)}):f&&h.push(o(h)+"skewX("+f+r)}function c(l,f,h,u,g,y){if(l!==h||f!==u){var p=g.push(o(g)+"scale(",null,",",null,")");y.push({i:p-4,x:Ce(l,h)},{i:p-2,x:Ce(f,u)})}else(h!==1||u!==1)&&g.push(o(g)+"scale("+h+","+u+")")}return function(l,f){var h=[],u=[];return l=e(l),f=e(f),s(l.translateX,l.translateY,f.translateX,f.translateY,h,u),i(l.rotate,f.rotate,h,u),a(l.skewX,f.skewX,h,u),c(l.scaleX,l.scaleY,f.scaleX,f.scaleY,h,u),l=f=null,function(g){for(var y=-1,p=u.length,x;++y<p;)h[(x=u[y]).i]=x.x(g);return h.join("")}}}var ou=Fs(nu,"px, ","px)","deg)"),su=Fs(ru,", ",")",")"),iu=1e-12;function yo(e){return((e=Math.exp(e))+1/e)/2}function au(e){return((e=Math.exp(e))-1/e)/2}function cu(e){return((e=Math.exp(2*e))-1)/(e+1)}const wn=function e(t,n,r){function o(s,i){var a=s[0],c=s[1],l=s[2],f=i[0],h=i[1],u=i[2],g=f-a,y=h-c,p=g*g+y*y,x,b;if(p<iu)b=Math.log(u/l)/t,x=function(I){return[a+I*g,c+I*y,l*Math.exp(t*I*b)]};else{var N=Math.sqrt(p),m=(u*u-l*l+r*p)/(2*l*n*N),w=(u*u-l*l-r*p)/(2*u*n*N),k=Math.log(Math.sqrt(m*m+1)-m),S=Math.log(Math.sqrt(w*w+1)-w);b=(S-k)/t,x=function(I){var j=I*b,E=yo(k),L=l/(n*N)*(E*cu(t*j+k)-au(k));return[a+L*g,c+L*y,l*E/yo(t*j+k)]}}return x.duration=b*1e3*t/Math.SQRT2,x}return o.rho=function(s){var i=Math.max(.001,+s),a=i*i,c=a*a;return e(i,a,c)},o}(Math.SQRT2,2,4);var gt=0,zt=0,jt=0,Bs=1e3,Mn,Pt,zn=0,Je=0,Rn=0,Rt=typeof performance=="object"&&performance.now?performance:Date,Os=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Dr(){return Je||(Os(lu),Je=Rt.now()+Rn)}function lu(){Je=0}function Pn(){this._call=this._time=this._next=null}Pn.prototype=Xs.prototype={constructor:Pn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Dr():+n)+(t==null?0:+t),!this._next&&Pt!==this&&(Pt?Pt._next=this:Mn=this,Pt=this),this._call=e,this._time=n,mr()},stop:function(){this._call&&(this._call=null,this._time=1/0,mr())}};function Xs(e,t,n){var r=new Pn;return r.restart(e,t,n),r}function du(){Dr(),++gt;for(var e=Mn,t;e;)(t=Je-e._time)>=0&&e._call.call(void 0,t),e=e._next;--gt}function bo(){Je=(zn=Rt.now())+Rn,gt=zt=0;try{du()}finally{gt=0,fu(),Je=0}}function uu(){var e=Rt.now(),t=e-zn;t>Bs&&(Rn-=t,zn=e)}function fu(){for(var e,t=Mn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Mn=n);Pt=e,mr(r)}function mr(e){if(!gt){zt&&(zt=clearTimeout(zt));var t=e-Je;t>24?(e<1/0&&(zt=setTimeout(bo,e-Rt.now()-Rn)),jt&&(jt=clearInterval(jt))):(jt||(zn=Rt.now(),jt=setInterval(uu,Bs)),gt=1,Os(bo))}}function wo(e,t,n){var r=new Pn;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var hu=Dn("start","end","cancel","interrupt"),gu=[],Ys=0,vo=1,pr=2,vn=3,No=4,xr=5,Nn=6;function Ln(e,t,n,r,o,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;mu(e,n,{name:t,index:r,group:o,on:hu,tween:gu,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Ys})}function Vr(e,t){var n=Se(e,t);if(n.state>Ys)throw new Error("too late; already scheduled");return n}function Me(e,t){var n=Se(e,t);if(n.state>vn)throw new Error("too late; already running");return n}function Se(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function mu(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=Xs(s,0,n.time);function s(l){n.state=vo,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var f,h,u,g;if(n.state!==vo)return c();for(f in r)if(g=r[f],g.name===n.name){if(g.state===vn)return wo(i);g.state===No?(g.state=Nn,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[f]):+f<t&&(g.state=Nn,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[f])}if(wo(function(){n.state===vn&&(n.state=No,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=pr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===pr){for(n.state=vn,o=new Array(u=n.tween.length),f=0,h=-1;f<u;++f)(g=n.tween[f].value.call(e,e.__data__,n.index,n.group))&&(o[++h]=g);o.length=h+1}}function a(l){for(var f=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=xr,1),h=-1,u=o.length;++h<u;)o[h].call(e,f);n.state===xr&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Nn,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function Sn(e,t){var n=e.__transition,r,o,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){s=!1;continue}o=r.state>pr&&r.state<xr,r.state=Nn,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}s&&delete e.__transition}}function pu(e){return this.each(function(){Sn(this,e)})}function xu(e,t){var n,r;return function(){var o=Me(this,e),s=o.tween;if(s!==n){r=n=s;for(var i=0,a=r.length;i<a;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function yu(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var s=Me(this,e),i=s.tween;if(i!==r){o=(r=i).slice();for(var a={name:t,value:n},c=0,l=o.length;c<l;++c)if(o[c].name===t){o[c]=a;break}c===l&&o.push(a)}s.tween=o}}function bu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Se(this.node(),n).tween,o=0,s=r.length,i;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?xu:yu)(n,e,t))}function Rr(e,t,n){var r=e._id;return e.each(function(){var o=Me(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Se(o,r).value[t]}}function Ws(e,t){var n;return(typeof t=="number"?Ce:t instanceof Qe?_n:(n=Qe(t))?(t=n,_n):Ls)(e,t)}function wu(e){return function(){this.removeAttribute(e)}}function vu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Nu(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttribute(e);return i===o?null:i===r?s:s=t(r=i,n)}}function Su(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?s:s=t(r=i,n)}}function Cu(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function ku(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function Eu(e,t){var n=Vn(e),r=n==="transform"?su:Ws;return this.attrTween(e,typeof t=="function"?(n.local?ku:Cu)(n,r,Rr(this,"attr."+e,t)):t==null?(n.local?vu:wu)(n):(n.local?Su:Nu)(n,r,t))}function ju(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function _u(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Mu(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&_u(e,s)),n}return o._value=t,o}function zu(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&ju(e,s)),n}return o._value=t,o}function Pu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Vn(e);return this.tween(n,(r.local?Mu:zu)(r,t))}function Iu(e,t){return function(){Vr(this,e).delay=+t.apply(this,arguments)}}function Au(e,t){return t=+t,function(){Vr(this,e).delay=t}}function $u(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Iu:Au)(t,e)):Se(this.node(),t).delay}function Tu(e,t){return function(){Me(this,e).duration=+t.apply(this,arguments)}}function Du(e,t){return t=+t,function(){Me(this,e).duration=t}}function Vu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Tu:Du)(t,e)):Se(this.node(),t).duration}function Ru(e,t){if(typeof t!="function")throw new Error;return function(){Me(this,e).ease=t}}function Lu(e){var t=this._id;return arguments.length?this.each(Ru(t,e)):Se(this.node(),t).ease}function Hu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Me(this,e).ease=n}}function Fu(e){if(typeof e!="function")throw new Error;return this.each(Hu(this._id,e))}function Bu(e){typeof e!="function"&&(e=Ss(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new Te(r,this._parents,this._name,this._id)}function Ou(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,s=Math.min(r,o),i=new Array(r),a=0;a<s;++a)for(var c=t[a],l=n[a],f=c.length,h=i[a]=new Array(f),u,g=0;g<f;++g)(u=c[g]||l[g])&&(h[g]=u);for(;a<r;++a)i[a]=t[a];return new Te(i,this._parents,this._name,this._id)}function Xu(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Yu(e,t,n){var r,o,s=Xu(t)?Vr:Me;return function(){var i=s(this,e),a=i.on;a!==r&&(o=(r=a).copy()).on(t,n),i.on=o}}function Wu(e,t){var n=this._id;return arguments.length<2?Se(this.node(),n).on.on(e):this.each(Yu(n,e,t))}function Gu(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Uu(){return this.on("end.remove",Gu(this._id))}function qu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ir(e));for(var r=this._groups,o=r.length,s=new Array(o),i=0;i<o;++i)for(var a=r[i],c=a.length,l=s[i]=new Array(c),f,h,u=0;u<c;++u)(f=a[u])&&(h=e.call(f,f.__data__,u,a))&&("__data__"in f&&(h.__data__=f.__data__),l[u]=h,Ln(l[u],t,n,u,l,Se(f,n)));return new Te(s,this._parents,t,n)}function Ku(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ns(e));for(var r=this._groups,o=r.length,s=[],i=[],a=0;a<o;++a)for(var c=r[a],l=c.length,f,h=0;h<l;++h)if(f=c[h]){for(var u=e.call(f,f.__data__,h,c),g,y=Se(f,n),p=0,x=u.length;p<x;++p)(g=u[p])&&Ln(g,t,n,p,u,y);s.push(u),i.push(f)}return new Te(s,i,t,n)}var Zu=Ut.prototype.constructor;function Qu(){return new Zu(this._groups,this._parents)}function Ju(e,t){var n,r,o;return function(){var s=ht(this,e),i=(this.style.removeProperty(e),ht(this,e));return s===i?null:s===n&&i===r?o:o=t(n=s,r=i)}}function Gs(e){return function(){this.style.removeProperty(e)}}function ef(e,t,n){var r,o=n+"",s;return function(){var i=ht(this,e);return i===o?null:i===r?s:s=t(r=i,n)}}function tf(e,t,n){var r,o,s;return function(){var i=ht(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),ht(this,e))),i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a))}}function nf(e,t){var n,r,o,s="style."+t,i="end."+s,a;return function(){var c=Me(this,e),l=c.on,f=c.value[s]==null?a||(a=Gs(t)):void 0;(l!==n||o!==f)&&(r=(n=l).copy()).on(i,o=f),c.on=r}}function rf(e,t,n){var r=(e+="")=="transform"?ou:Ws;return t==null?this.styleTween(e,Ju(e,r)).on("end.style."+e,Gs(e)):typeof t=="function"?this.styleTween(e,tf(e,r,Rr(this,"style."+e,t))).each(nf(this._id,e)):this.styleTween(e,ef(e,r,t),n).on("end.style."+e,null)}function of(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function sf(e,t,n){var r,o;function s(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&of(e,i,n)),r}return s._value=t,s}function af(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,sf(e,t,n??""))}function cf(e){return function(){this.textContent=e}}function lf(e){return function(){var t=e(this);this.textContent=t??""}}function df(e){return this.tween("text",typeof e=="function"?lf(Rr(this,"text",e)):cf(e==null?"":e+""))}function uf(e){return function(t){this.textContent=e.call(this,t)}}function ff(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&uf(o)),t}return r._value=e,r}function hf(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,ff(e))}function gf(){for(var e=this._name,t=this._id,n=Us(),r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,l=0;l<a;++l)if(c=i[l]){var f=Se(c,t);Ln(c,e,n,l,i,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Te(r,this._parents,e,n)}function mf(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(s,i){var a={value:i},c={value:function(){--o===0&&s()}};n.each(function(){var l=Me(this,r),f=l.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),o===0&&s()})}var pf=0;function Te(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Us(){return++pf}var ze=Ut.prototype;Te.prototype={constructor:Te,select:qu,selectAll:Ku,selectChild:ze.selectChild,selectChildren:ze.selectChildren,filter:Bu,merge:Ou,selection:Qu,transition:gf,call:ze.call,nodes:ze.nodes,node:ze.node,size:ze.size,empty:ze.empty,each:ze.each,on:Wu,attr:Eu,attrTween:Pu,style:rf,styleTween:af,text:df,textTween:hf,remove:Uu,tween:bu,delay:$u,duration:Vu,ease:Lu,easeVarying:Fu,end:mf,[Symbol.iterator]:ze[Symbol.iterator]};function xf(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var yf={time:null,delay:0,duration:250,ease:xf};function bf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function wf(e){var t,n;e instanceof Te?(t=e._id,e=e._name):(t=Us(),(n=yf).time=Dr(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&Ln(c,e,t,l,i,n||bf(c,t));return new Te(r,this._parents,e,t)}Ut.prototype.interrupt=pu;Ut.prototype.transition=wf;const dn=e=>()=>e;function vf(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ie(e,t,n){this.k=e,this.x=t,this.y=n}Ie.prototype={constructor:Ie,scale:function(e){return e===1?this:new Ie(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ie(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Hn=new Ie(1,0,0);qs.prototype=Ie.prototype;function qs(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Hn;return e.__zoom}function nr(e){e.stopImmediatePropagation()}function _t(e){e.preventDefault(),e.stopImmediatePropagation()}function Nf(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Sf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function So(){return this.__zoom||Hn}function Cf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function kf(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ef(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function Ks(){var e=Nf,t=Sf,n=Ef,r=Cf,o=kf,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=wn,l=Dn("start","zoom","end"),f,h,u,g=500,y=150,p=0,x=10;function b(v){v.property("__zoom",So).on("wheel.zoom",j,{passive:!1}).on("mousedown.zoom",E).on("dblclick.zoom",L).filter(o).on("touchstart.zoom",V).on("touchmove.zoom",$).on("touchend.zoom touchcancel.zoom",T).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(v,P,C,_){var M=v.selection?v.selection():v;M.property("__zoom",So),v!==M?k(v,P,C,_):M.interrupt().each(function(){S(this,arguments).event(_).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},b.scaleBy=function(v,P,C,_){b.scaleTo(v,function(){var M=this.__zoom.k,z=typeof P=="function"?P.apply(this,arguments):P;return M*z},C,_)},b.scaleTo=function(v,P,C,_){b.transform(v,function(){var M=t.apply(this,arguments),z=this.__zoom,D=C==null?w(M):typeof C=="function"?C.apply(this,arguments):C,R=z.invert(D),H=typeof P=="function"?P.apply(this,arguments):P;return n(m(N(z,H),D,R),M,i)},C,_)},b.translateBy=function(v,P,C,_){b.transform(v,function(){return n(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof C=="function"?C.apply(this,arguments):C),t.apply(this,arguments),i)},null,_)},b.translateTo=function(v,P,C,_,M){b.transform(v,function(){var z=t.apply(this,arguments),D=this.__zoom,R=_==null?w(z):typeof _=="function"?_.apply(this,arguments):_;return n(Hn.translate(R[0],R[1]).scale(D.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof C=="function"?-C.apply(this,arguments):-C),z,i)},_,M)};function N(v,P){return P=Math.max(s[0],Math.min(s[1],P)),P===v.k?v:new Ie(P,v.x,v.y)}function m(v,P,C){var _=P[0]-C[0]*v.k,M=P[1]-C[1]*v.k;return _===v.x&&M===v.y?v:new Ie(v.k,_,M)}function w(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function k(v,P,C,_){v.on("start.zoom",function(){S(this,arguments).event(_).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(_).end()}).tween("zoom",function(){var M=this,z=arguments,D=S(M,z).event(_),R=t.apply(M,z),H=C==null?w(R):typeof C=="function"?C.apply(M,z):C,O=Math.max(R[1][0]-R[0][0],R[1][1]-R[0][1]),B=M.__zoom,q=typeof P=="function"?P.apply(M,z):P,Z=c(B.invert(H).concat(O/B.k),q.invert(H).concat(O/q.k));return function(X){if(X===1)X=q;else{var F=Z(X),U=O/F[2];X=new Ie(U,H[0]-F[0]*U,H[1]-F[1]*U)}D.zoom(null,X)}})}function S(v,P,C){return!C&&v.__zooming||new I(v,P)}function I(v,P){this.that=v,this.args=P,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,P),this.taps=0}I.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,P){return this.mouse&&v!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var P=me(this.that).datum();l.call(v,this.that,new vf(v,{sourceEvent:this.sourceEvent,target:b,type:v,transform:this.that.__zoom,dispatch:l}),P)}};function j(v,...P){if(!e.apply(this,arguments))return;var C=S(this,P).event(v),_=this.__zoom,M=Math.max(s[0],Math.min(s[1],_.k*Math.pow(2,r.apply(this,arguments)))),z=we(v);if(C.wheel)(C.mouse[0][0]!==z[0]||C.mouse[0][1]!==z[1])&&(C.mouse[1]=_.invert(C.mouse[0]=z)),clearTimeout(C.wheel);else{if(_.k===M)return;C.mouse=[z,_.invert(z)],Sn(this),C.start()}_t(v),C.wheel=setTimeout(D,y),C.zoom("mouse",n(m(N(_,M),C.mouse[0],C.mouse[1]),C.extent,i));function D(){C.wheel=null,C.end()}}function E(v,...P){if(u||!e.apply(this,arguments))return;var C=v.currentTarget,_=S(this,P,!0).event(v),M=me(v.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",O,!0),z=we(v,C),D=v.clientX,R=v.clientY;As(v.view),nr(v),_.mouse=[z,this.__zoom.invert(z)],Sn(this),_.start();function H(B){if(_t(B),!_.moved){var q=B.clientX-D,Z=B.clientY-R;_.moved=q*q+Z*Z>p}_.event(B).zoom("mouse",n(m(_.that.__zoom,_.mouse[0]=we(B,C),_.mouse[1]),_.extent,i))}function O(B){M.on("mousemove.zoom mouseup.zoom",null),$s(B.view,_.moved),_t(B),_.event(B).end()}}function L(v,...P){if(e.apply(this,arguments)){var C=this.__zoom,_=we(v.changedTouches?v.changedTouches[0]:v,this),M=C.invert(_),z=C.k*(v.shiftKey?.5:2),D=n(m(N(C,z),_,M),t.apply(this,P),i);_t(v),a>0?me(this).transition().duration(a).call(k,D,_,v):me(this).call(b.transform,D,_,v)}}function V(v,...P){if(e.apply(this,arguments)){var C=v.touches,_=C.length,M=S(this,P,v.changedTouches.length===_).event(v),z,D,R,H;for(nr(v),D=0;D<_;++D)R=C[D],H=we(R,this),H=[H,this.__zoom.invert(H),R.identifier],M.touch0?!M.touch1&&M.touch0[2]!==H[2]&&(M.touch1=H,M.taps=0):(M.touch0=H,z=!0,M.taps=1+!!f);f&&(f=clearTimeout(f)),z&&(M.taps<2&&(h=H[0],f=setTimeout(function(){f=null},g)),Sn(this),M.start())}}function $(v,...P){if(this.__zooming){var C=S(this,P).event(v),_=v.changedTouches,M=_.length,z,D,R,H;for(_t(v),z=0;z<M;++z)D=_[z],R=we(D,this),C.touch0&&C.touch0[2]===D.identifier?C.touch0[0]=R:C.touch1&&C.touch1[2]===D.identifier&&(C.touch1[0]=R);if(D=C.that.__zoom,C.touch1){var O=C.touch0[0],B=C.touch0[1],q=C.touch1[0],Z=C.touch1[1],X=(X=q[0]-O[0])*X+(X=q[1]-O[1])*X,F=(F=Z[0]-B[0])*F+(F=Z[1]-B[1])*F;D=N(D,Math.sqrt(X/F)),R=[(O[0]+q[0])/2,(O[1]+q[1])/2],H=[(B[0]+Z[0])/2,(B[1]+Z[1])/2]}else if(C.touch0)R=C.touch0[0],H=C.touch0[1];else return;C.zoom("touch",n(m(D,R,H),C.extent,i))}}function T(v,...P){if(this.__zooming){var C=S(this,P).event(v),_=v.changedTouches,M=_.length,z,D;for(nr(v),u&&clearTimeout(u),u=setTimeout(function(){u=null},g),z=0;z<M;++z)D=_[z],C.touch0&&C.touch0[2]===D.identifier?delete C.touch0:C.touch1&&C.touch1[2]===D.identifier&&delete C.touch1;if(C.touch1&&!C.touch0&&(C.touch0=C.touch1,delete C.touch1),C.touch0)C.touch0[1]=this.__zoom.invert(C.touch0[0]);else if(C.end(),C.taps===2&&(D=we(D,this),Math.hypot(h[0]-D[0],h[1]-D[1])<x)){var R=me(this).on("dblclick.zoom");R&&R.apply(this,arguments)}}}return b.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:dn(+v),b):r},b.filter=function(v){return arguments.length?(e=typeof v=="function"?v:dn(!!v),b):e},b.touchable=function(v){return arguments.length?(o=typeof v=="function"?v:dn(!!v),b):o},b.extent=function(v){return arguments.length?(t=typeof v=="function"?v:dn([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),b):t},b.scaleExtent=function(v){return arguments.length?(s[0]=+v[0],s[1]=+v[1],b):[s[0],s[1]]},b.translateExtent=function(v){return arguments.length?(i[0][0]=+v[0][0],i[1][0]=+v[1][0],i[0][1]=+v[0][1],i[1][1]=+v[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(v){return arguments.length?(n=v,b):n},b.duration=function(v){return arguments.length?(a=+v,b):a},b.interpolate=function(v){return arguments.length?(c=v,b):c},b.on=function(){var v=l.on.apply(l,arguments);return v===l?b:v},b.clickDistance=function(v){return arguments.length?(p=(v=+v)*v,b):Math.sqrt(p)},b.tapDistance=function(v){return arguments.length?(x=+v,b):x},b}const _e={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Lt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Zs=["Enter"," ","Escape"],Qs={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var mt;(function(e){e.Strict="strict",e.Loose="loose"})(mt||(mt={}));var Ke;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ke||(Ke={}));var Ht;(function(e){e.Partial="partial",e.Full="full"})(Ht||(Ht={}));const Js={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ke;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ke||(ke={}));var pt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(pt||(pt={}));var G;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(G||(G={}));const Co={[G.Left]:G.Right,[G.Right]:G.Left,[G.Top]:G.Bottom,[G.Bottom]:G.Top};function ei(e){return e===null?null:e?"valid":"invalid"}const ti=e=>"id"in e&&"source"in e&&"target"in e,jf=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Lr=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Kt=(e,t=[0,0])=>{const{width:n,height:r}=De(e),o=e.origin??t,s=n*o[0],i=r*o[1];return{x:e.position.x-s,y:e.position.y-i}},_f=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const s=typeof o=="string";let i=!t.nodeLookup&&!s?o:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(o):Lr(o)?o:t.nodeLookup.get(o.id));const a=i?In(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Fn(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Bn(n)},Zt=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=In(r);n=Fn(n,o)}}),Bn(n)},Hr=(e,t,[n,r,o]=[0,0,1],s=!1,i=!1)=>{const a={...Jt(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:f,selectable:h=!0,hidden:u=!1}=l;if(i&&!h||u)continue;const g=f.width??l.width??l.initialWidth??null,y=f.height??l.height??l.initialHeight??null,p=Ft(a,yt(l)),x=(g??0)*(y??0),b=s&&p>0;(!l.internals.handleBounds||b||p>=x||l.dragging)&&c.push(l)}return c},Mf=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function zf(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function Pf({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=zf(e,i),c=Zt(a),l=Fr(c,t,n,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await r.setViewport(l,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function ni({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},f=i.origin??r;let h=i.extent||o;if(i.extent==="parent"&&!i.expandParent)if(!a)s==null||s("005",_e.error005());else{const g=a.measured.width,y=a.measured.height;g&&y&&(h=[[c,l],[c+g,l+y]])}else a&&bt(i.extent)&&(h=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const u=bt(h)?et(t,h,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",_e.error015())),{position:{x:u.x-c+(i.measured.width??0)*f[0],y:u.y-l+(i.measured.height??0)*f[1]},positionAbsolute:u}}async function If({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const s=new Set(e.map(u=>u.id)),i=[];for(const u of n){if(u.deletable===!1)continue;const g=s.has(u.id),y=!g&&u.parentId&&i.find(p=>p.id===u.parentId);(g||y)&&i.push(u)}const a=new Set(t.map(u=>u.id)),c=r.filter(u=>u.deletable!==!1),f=Mf(i,c);for(const u of c)a.has(u.id)&&!f.find(y=>y.id===u.id)&&f.push(u);if(!o)return{edges:f,nodes:i};const h=await o({nodes:i,edges:f});return typeof h=="boolean"?h?{edges:f,nodes:i}:{edges:[],nodes:[]}:h}const xt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),et=(e={x:0,y:0},t,n)=>({x:xt(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:xt(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function ri(e,t,n){const{width:r,height:o}=De(n),{x:s,y:i}=n.internals.positionAbsolute;return et(e,[[s,i],[s+r,i+o]],t)}const ko=(e,t,n)=>e<t?xt(Math.abs(e-t),1,t)/t:e>n?-xt(Math.abs(e-n),1,t)/t:0,oi=(e,t,n=15,r=40)=>{const o=ko(e.x,r,t.width-r)*n,s=ko(e.y,r,t.height-r)*n;return[o,s]},Fn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),yr=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Bn=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),yt=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Lr(e)?e.internals.positionAbsolute:Kt(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},In=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Lr(e)?e.internals.positionAbsolute:Kt(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},si=(e,t)=>Bn(Fn(yr(e),yr(t))),Ft=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Eo=e=>Ne(e.width)&&Ne(e.height)&&Ne(e.x)&&Ne(e.y),Ne=e=>!isNaN(e)&&isFinite(e),Af=(e,t)=>{},Qt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Jt=({x:e,y:t},[n,r,o],s=!1,i=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return s?Qt(a,i):a},An=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function rt(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function $f(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=rt(e,n),o=rt(e,t);return{top:r,right:o,bottom:r,left:o,x:o*2,y:r*2}}if(typeof e=="object"){const r=rt(e.top??e.y??0,n),o=rt(e.bottom??e.y??0,n),s=rt(e.left??e.x??0,t),i=rt(e.right??e.x??0,t);return{top:r,right:i,bottom:o,left:s,x:s+i,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Tf(e,t,n,r,o,s){const{x:i,y:a}=An(e,[t,n,r]),{x:c,y:l}=An({x:e.x+e.width,y:e.y+e.height},[t,n,r]),f=o-c,h=s-l;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(f),bottom:Math.floor(h)}}const Fr=(e,t,n,r,o,s)=>{const i=$f(s,t,n),a=(t-i.x)/e.width,c=(n-i.y)/e.height,l=Math.min(a,c),f=xt(l,r,o),h=e.x+e.width/2,u=e.y+e.height/2,g=t/2-h*f,y=n/2-u*f,p=Tf(e,g,y,f,t,n),x={left:Math.min(p.left-i.left,0),top:Math.min(p.top-i.top,0),right:Math.min(p.right-i.right,0),bottom:Math.min(p.bottom-i.bottom,0)};return{x:g-x.left+x.right,y:y-x.top+x.bottom,zoom:f}},Bt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function bt(e){return e!=null&&e!=="parent"}function De(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function ii(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function ai(e,t={width:0,height:0},n,r,o){const s={...e},i=r.get(n);if(i){const a=i.origin||o;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function jo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Df(){let e,t;return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}}function Vf(e){return{...Qs,...e||{}}}function $t(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:s,y:i}=Ee(e),a=Jt({x:s-((o==null?void 0:o.left)??0),y:i-((o==null?void 0:o.top)??0)},r),{x:c,y:l}=n?Qt(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const Br=e=>({width:e.offsetWidth,height:e.offsetHeight}),ci=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Rf=["INPUT","SELECT","TEXTAREA"];function li(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Rf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const di=e=>"clientX"in e,Ee=(e,t)=>{var s,i;const n=di(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,o=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},_o=(e,t,n,r,o)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:o,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...Br(i)}})};function ui({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:a}){const c=e*.125+o*.375+i*.375+n*.125,l=t*.125+s*.375+a*.375+r*.125,f=Math.abs(c-e),h=Math.abs(l-t);return[c,l,f,h]}function un(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Mo({pos:e,x1:t,y1:n,x2:r,y2:o,c:s}){switch(e){case G.Left:return[t-un(t-r,s),n];case G.Right:return[t+un(r-t,s),n];case G.Top:return[t,n-un(n-o,s)];case G.Bottom:return[t,n+un(o-n,s)]}}function fi({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top,curvature:i=.25}){const[a,c]=Mo({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[l,f]=Mo({pos:s,x1:r,y1:o,x2:e,y2:t,c:i}),[h,u,g,y]=ui({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:f});return[`M${e},${t} C${a},${c} ${l},${f} ${r},${o}`,h,u,g,y]}function hi({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,s=n<e?n+o:n-o,i=Math.abs(r-t)/2,a=r<t?r+i:r-i;return[s,a,o,i]}function Lf({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r,elevateOnSelect:o=!1}){if(r!==void 0)return r;const s=o&&n?1e3:0,i=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return s+i}function Hf({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const s=Fn(In(e),In(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return Ft(i,Bn(s))>0}const Ff=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Bf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),gi=(e,t)=>{if(!e.source||!e.target)return t;let n;return ti(e)?n={...e}:n={...e,id:Ff(e)},Bf(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function mi({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,s,i,a]=hi({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,s,i,a]}const zo={[G.Left]:{x:-1,y:0},[G.Right]:{x:1,y:0},[G.Top]:{x:0,y:-1},[G.Bottom]:{x:0,y:1}},Of=({source:e,sourcePosition:t=G.Bottom,target:n})=>t===G.Left||t===G.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Po=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Xf({source:e,sourcePosition:t=G.Bottom,target:n,targetPosition:r=G.Top,center:o,offset:s,stepPosition:i}){const a=zo[t],c=zo[r],l={x:e.x+a.x*s,y:e.y+a.y*s},f={x:n.x+c.x*s,y:n.y+c.y*s},h=Of({source:l,sourcePosition:t,target:f}),u=h.x!==0?"x":"y",g=h[u];let y=[],p,x;const b={x:0,y:0},N={x:0,y:0},[,,m,w]=hi({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[u]*c[u]===-1){u==="x"?(p=o.x??l.x+(f.x-l.x)*i,x=o.y??(l.y+f.y)/2):(p=o.x??(l.x+f.x)/2,x=o.y??l.y+(f.y-l.y)*i);const S=[{x:p,y:l.y},{x:p,y:f.y}],I=[{x:l.x,y:x},{x:f.x,y:x}];a[u]===g?y=u==="x"?S:I:y=u==="x"?I:S}else{const S=[{x:l.x,y:f.y}],I=[{x:f.x,y:l.y}];if(u==="x"?y=a.x===g?I:S:y=a.y===g?S:I,t===r){const $=Math.abs(e[u]-n[u]);if($<=s){const T=Math.min(s-1,s-$);a[u]===g?b[u]=(l[u]>e[u]?-1:1)*T:N[u]=(f[u]>n[u]?-1:1)*T}}if(t!==r){const $=u==="x"?"y":"x",T=a[u]===c[$],v=l[$]>f[$],P=l[$]<f[$];(a[u]===1&&(!T&&v||T&&P)||a[u]!==1&&(!T&&P||T&&v))&&(y=u==="x"?S:I)}const j={x:l.x+b.x,y:l.y+b.y},E={x:f.x+N.x,y:f.y+N.y},L=Math.max(Math.abs(j.x-y[0].x),Math.abs(E.x-y[0].x)),V=Math.max(Math.abs(j.y-y[0].y),Math.abs(E.y-y[0].y));L>=V?(p=(j.x+E.x)/2,x=y[0].y):(p=y[0].x,x=(j.y+E.y)/2)}return[[e,{x:l.x+b.x,y:l.y+b.y},...y,{x:f.x+N.x,y:f.y+N.y},n],p,x,m,w]}function Yf(e,t,n,r){const o=Math.min(Po(e,t)/2,Po(t,n)/2,r),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,f=e.y<n.y?1:-1;return`L ${s+o*l},${i}Q ${s},${i} ${s},${i+o*f}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${i+o*c}Q ${s},${i} ${s+o*a},${i}`}function br({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top,borderRadius:i=5,centerX:a,centerY:c,offset:l=20,stepPosition:f=.5}){const[h,u,g,y,p]=Xf({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:s,center:{x:a,y:c},offset:l,stepPosition:f});return[h.reduce((b,N,m)=>{let w="";return m>0&&m<h.length-1?w=Yf(h[m-1],N,h[m+1],i):w=`${m===0?"M":"L"}${N.x} ${N.y}`,b+=w,b},""),u,g,y,p]}function Io(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Wf(e){var h;const{sourceNode:t,targetNode:n}=e;if(!Io(t)||!Io(n))return null;const r=t.internals.handleBounds||Ao(t.handles),o=n.internals.handleBounds||Ao(n.handles),s=$o((r==null?void 0:r.source)??[],e.sourceHandle),i=$o(e.connectionMode===mt.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!s||!i)return(h=e.onError)==null||h.call(e,"008",_e.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||G.Bottom,c=(i==null?void 0:i.position)||G.Top,l=Ot(t,s,a),f=Ot(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:f.x,targetY:f.y,sourcePosition:a,targetPosition:c}}function Ao(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Ot(e,t,n=G.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??De(e);if(r)return{x:o+i/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case G.Top:return{x:o+i/2,y:s};case G.Right:return{x:o+i,y:s+a/2};case G.Bottom:return{x:o+i/2,y:s+a};case G.Left:return{x:o,y:s+a/2}}}function $o(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function wr(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function Gf(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||r,a.markerEnd||o].forEach(c=>{if(c&&typeof c=="object"){const l=wr(c,t);s.has(l)||(i.push({id:l,color:c.color||n,...c}),s.add(l))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const Or={nodeOrigin:[0,0],nodeExtent:Lt,elevateNodesOnSelect:!0,defaults:{}},Uf={...Or,checkEquality:!0};function Xr(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function qf(e,t,n){const r=Xr(Or,n);for(const o of e.values())if(o.parentId)Yr(o,e,t,r);else{const s=Kt(o,r.nodeOrigin),i=bt(o.extent)?o.extent:r.nodeExtent,a=et(s,i,De(o));o.internals.positionAbsolute=a}}function vr(e,t,n,r){var c,l;const o=Xr(Uf,r);let s=e.length>0;const i=new Map(t),a=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const f of e){let h=i.get(f.id);if(o.checkEquality&&f===(h==null?void 0:h.internals.userNode))t.set(f.id,h);else{const u=Kt(f,o.nodeOrigin),g=bt(f.extent)?f.extent:o.nodeExtent,y=et(u,g,De(f));h={...o.defaults,...f,measured:{width:(c=f.measured)==null?void 0:c.width,height:(l=f.measured)==null?void 0:l.height},internals:{positionAbsolute:y,handleBounds:f.measured?h==null?void 0:h.internals.handleBounds:void 0,z:pi(f,a),userNode:f}},t.set(f.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(s=!1),f.parentId&&Yr(h,t,n,r)}return s}function Kf(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Yr(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:i}=Xr(Or,r),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Kf(e,n);const l=o?1e3:0,{x:f,y:h,z:u}=Zf(e,c,s,i,l),{positionAbsolute:g}=e.internals,y=f!==g.x||h!==g.y;(y||u!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:f,y:h}:g,z:u}})}function pi(e,t){return(Ne(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Zf(e,t,n,r,o){const{x:s,y:i}=t.internals.positionAbsolute,a=De(e),c=Kt(e,n),l=bt(e.extent)?et(c,e.extent,a):c;let f=et({x:s+l.x,y:i+l.y},r,a);e.extent==="parent"&&(f=ri(f,a,t));const h=pi(e,o),u=t.internals.z??0;return{x:f.x,y:f.y,z:u>=h?u+1:h}}function Wr(e,t,n,r=[0,0]){var i;const o=[],s=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const l=((i=s.get(a.parentId))==null?void 0:i.expandedRect)??yt(c),f=si(l,a.rect);s.set(a.parentId,{expandedRect:f,parent:c})}return s.size>0&&s.forEach(({expandedRect:a,parent:c},l)=>{var m;const f=c.internals.positionAbsolute,h=De(c),u=c.origin??r,g=a.x<f.x?Math.round(Math.abs(f.x-a.x)):0,y=a.y<f.y?Math.round(Math.abs(f.y-a.y)):0,p=Math.max(h.width,Math.round(a.width)),x=Math.max(h.height,Math.round(a.height)),b=(p-h.width)*u[0],N=(x-h.height)*u[1];(g>0||y>0||b||N)&&(o.push({id:l,type:"position",position:{x:c.position.x-g+b,y:c.position.y-y+N}}),(m=n.get(l))==null||m.forEach(w=>{e.some(k=>k.id===w.id)||o.push({id:w.id,type:"position",position:{x:w.position.x+g,y:w.position.y+y}})})),(h.width<a.width||h.height<a.height||g||y)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(g?u[0]*g-b:0),height:x+(y?u[1]*y-N:0)}})}),o}function Qf(e,t,n,r,o,s){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const c=[],l=window.getComputedStyle(i),{m22:f}=new window.DOMMatrixReadOnly(l.transform),h=[];for(const u of e.values()){const g=t.get(u.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),a=!0;continue}const y=Br(u.nodeElement),p=g.measured.width!==y.width||g.measured.height!==y.height;if(!!(y.width&&y.height&&(p||!g.internals.handleBounds||u.force))){const b=u.nodeElement.getBoundingClientRect(),N=bt(g.extent)?g.extent:s;let{positionAbsolute:m}=g.internals;g.parentId&&g.extent==="parent"?m=ri(m,y,t.get(g.parentId)):N&&(m=et(m,N,y));const w={...g,measured:y,internals:{...g.internals,positionAbsolute:m,handleBounds:{source:_o("source",u.nodeElement,b,f,g.id),target:_o("target",u.nodeElement,b,f,g.id)}}};t.set(g.id,w),g.parentId&&Yr(w,t,n,{nodeOrigin:o}),a=!0,p&&(c.push({id:g.id,type:"dimensions",dimensions:y}),g.expandParent&&g.parentId&&h.push({id:g.id,parentId:g.parentId,rect:yt(w,o)}))}}if(h.length>0){const u=Wr(h,t,n,o);c.push(...u)}return{changes:c,updatedInternals:a}}async function Jf({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,s]],r),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function To(e,t,n,r,o,s){let i=o;const a=r.get(i)||new Map;r.set(i,a.set(n,t)),i=`${o}-${e}`;const c=r.get(i)||new Map;if(r.set(i,c.set(n,t)),s){i=`${o}-${e}-${s}`;const l=r.get(i)||new Map;r.set(i,l.set(n,t))}}function xi(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:s,sourceHandle:i=null,targetHandle:a=null}=r,c={edgeId:r.id,source:o,target:s,sourceHandle:i,targetHandle:a},l=`${o}-${i}--${s}-${a}`,f=`${s}-${a}--${o}-${i}`;To("source",c,f,e,o,i),To("target",c,l,e,s,a),t.set(r.id,r)}}function yi(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:yi(n,t):!1}function Do(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function eh(e,t,n,r){const o=new Map;for(const[s,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!yi(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&o.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function rr({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,a,c;const o=[];for(const[l,f]of t){const h=(i=n.get(l))==null?void 0:i.internals.userNode;h&&o.push({...h,position:f.position,dragging:r})}if(!e)return[o[0],o];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((c=t.get(e))==null?void 0:c.position)||s.position,dragging:r}:o[0],o]}function th({dragItems:e,snapGrid:t,x:n,y:r}){const o=e.values().next().value;if(!o)return null;const s={x:n-o.distance.x,y:r-o.distance.y},i=Qt(s,t);return{x:i.x-s.x,y:i.y-s.y}}function nh({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let s={x:null,y:null},i=0,a=new Map,c=!1,l={x:0,y:0},f=null,h=!1,u=null,g=!1,y=!1,p=null;function x({noDragClassName:N,handleSelector:m,domNode:w,isSelectable:k,nodeId:S,nodeClickDistance:I=0}){u=me(w);function j({x:$,y:T}){const{nodeLookup:v,nodeExtent:P,snapGrid:C,snapToGrid:_,nodeOrigin:M,onNodeDrag:z,onSelectionDrag:D,onError:R,updateNodePositions:H}=t();s={x:$,y:T};let O=!1;const B=a.size>1,q=B&&P?yr(Zt(a)):null,Z=B&&_?th({dragItems:a,snapGrid:C,x:$,y:T}):null;for(const[X,F]of a){if(!v.has(X))continue;let U={x:$-F.distance.x,y:T-F.distance.y};_&&(U=Z?{x:Math.round(U.x+Z.x),y:Math.round(U.y+Z.y)}:Qt(U,C));let ee=null;if(B&&P&&!F.extent&&q){const{positionAbsolute:Q}=F.internals,J=Q.x-q.x+P[0][0],se=Q.x+F.measured.width-q.x2+P[1][0],ae=Q.y-q.y+P[0][1],be=Q.y+F.measured.height-q.y2+P[1][1];ee=[[J,ae],[se,be]]}const{position:te,positionAbsolute:K}=ni({nodeId:X,nextPosition:U,nodeLookup:v,nodeExtent:ee||P,nodeOrigin:M,onError:R});O=O||F.position.x!==te.x||F.position.y!==te.y,F.position=te,F.internals.positionAbsolute=K}if(y=y||O,!!O&&(H(a,!0),p&&(r||z||!S&&D))){const[X,F]=rr({nodeId:S,dragItems:a,nodeLookup:v});r==null||r(p,a,X,F),z==null||z(p,X,F),S||D==null||D(p,F)}}async function E(){if(!f)return;const{transform:$,panBy:T,autoPanSpeed:v,autoPanOnNodeDrag:P}=t();if(!P){c=!1,cancelAnimationFrame(i);return}const[C,_]=oi(l,f,v);(C!==0||_!==0)&&(s.x=(s.x??0)-C/$[2],s.y=(s.y??0)-_/$[2],await T({x:C,y:_})&&j(s)),i=requestAnimationFrame(E)}function L($){var B;const{nodeLookup:T,multiSelectionActive:v,nodesDraggable:P,transform:C,snapGrid:_,snapToGrid:M,selectNodesOnDrag:z,onNodeDragStart:D,onSelectionDragStart:R,unselectNodesAndEdges:H}=t();h=!0,(!z||!k)&&!v&&S&&((B=T.get(S))!=null&&B.selected||H()),k&&z&&S&&(e==null||e(S));const O=$t($.sourceEvent,{transform:C,snapGrid:_,snapToGrid:M,containerBounds:f});if(s=O,a=eh(T,P,O,S),a.size>0&&(n||D||!S&&R)){const[q,Z]=rr({nodeId:S,dragItems:a,nodeLookup:T});n==null||n($.sourceEvent,a,q,Z),D==null||D($.sourceEvent,q,Z),S||R==null||R($.sourceEvent,Z)}}const V=Ts().clickDistance(I).on("start",$=>{const{domNode:T,nodeDragThreshold:v,transform:P,snapGrid:C,snapToGrid:_}=t();f=(T==null?void 0:T.getBoundingClientRect())||null,g=!1,y=!1,p=$.sourceEvent,v===0&&L($),s=$t($.sourceEvent,{transform:P,snapGrid:C,snapToGrid:_,containerBounds:f}),l=Ee($.sourceEvent,f)}).on("drag",$=>{const{autoPanOnNodeDrag:T,transform:v,snapGrid:P,snapToGrid:C,nodeDragThreshold:_,nodeLookup:M}=t(),z=$t($.sourceEvent,{transform:v,snapGrid:P,snapToGrid:C,containerBounds:f});if(p=$.sourceEvent,($.sourceEvent.type==="touchmove"&&$.sourceEvent.touches.length>1||S&&!M.has(S))&&(g=!0),!g){if(!c&&T&&h&&(c=!0,E()),!h){const D=z.xSnapped-(s.x??0),R=z.ySnapped-(s.y??0);Math.sqrt(D*D+R*R)>_&&L($)}(s.x!==z.xSnapped||s.y!==z.ySnapped)&&a&&h&&(l=Ee($.sourceEvent,f),j(z))}}).on("end",$=>{if(!(!h||g)&&(c=!1,h=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:T,updateNodePositions:v,onNodeDragStop:P,onSelectionDragStop:C}=t();if(y&&(v(a,!1),y=!1),o||P||!S&&C){const[_,M]=rr({nodeId:S,dragItems:a,nodeLookup:T,dragging:!1});o==null||o($.sourceEvent,a,_,M),P==null||P($.sourceEvent,_,M),S||C==null||C($.sourceEvent,M)}}}).filter($=>{const T=$.target;return!$.button&&(!N||!Do(T,`.${N}`,w))&&(!m||Do(T,m,w))});u.call(V)}function b(){u==null||u.on(".drag",null)}return{update:x,destroy:b}}function rh(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())Ft(o,yt(s))>0&&r.push(s);return r}const oh=250;function sh(e,t,n,r){var a,c;let o=[],s=1/0;const i=rh(e,n,t+oh);for(const l of i){const f=[...((a=l.internals.handleBounds)==null?void 0:a.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const h of f){if(r.nodeId===h.nodeId&&r.type===h.type&&r.id===h.id)continue;const{x:u,y:g}=Ot(l,h,h.position,!0),y=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(g-e.y,2));y>t||(y<s?(o=[{...h,x:u,y:g}],s=y):y===s&&o.push({...h,x:u,y:g}))}}if(!o.length)return null;if(o.length>1){const l=r.type==="source"?"target":"source";return o.find(f=>f.type===l)??o[0]}return o[0]}function bi(e,t,n,r,o,s=!1){var l,f,h;const i=r.get(e);if(!i)return null;const a=o==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((f=i.internals.handleBounds)==null?void 0:f.source)??[],...((h=i.internals.handleBounds)==null?void 0:h.target)??[]],c=(n?a==null?void 0:a.find(u=>u.id===n):a==null?void 0:a[0])??null;return c&&s?{...c,...Ot(i,c,c.position,!0)}:c}function wi(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function ih(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const vi=()=>!0;function ah(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:f,flowId:h,panBy:u,cancelConnection:g,onConnectStart:y,onConnect:p,onConnectEnd:x,isValidConnection:b=vi,onReconnectEnd:N,updateConnection:m,getTransform:w,getFromHandle:k,autoPanSpeed:S,dragThreshold:I=1,handleDomNode:j}){const E=ci(e.target);let L=0,V;const{x:$,y:T}=Ee(e),v=wi(s,j),P=a==null?void 0:a.getBoundingClientRect();let C=!1;if(!P||!v)return;const _=bi(o,v,r,c,t);if(!_)return;let M=Ee(e,P),z=!1,D=null,R=!1,H=null;function O(){if(!f||!P)return;const[te,K]=oi(M,P,S);u({x:te,y:K}),L=requestAnimationFrame(O)}const B={..._,nodeId:o,type:v,position:_.position},q=c.get(o);let X={inProgress:!0,isValid:null,from:Ot(q,B,G.Left,!0),fromHandle:B,fromPosition:B.position,fromNode:q,to:M,toHandle:null,toPosition:Co[B.position],toNode:null};function F(){C=!0,m(X),y==null||y(e,{nodeId:o,handleId:r,handleType:v})}I===0&&F();function U(te){if(!C){const{x:se,y:ae}=Ee(te),be=se-$,tt=ae-T;if(!(be*be+tt*tt>I*I))return;F()}if(!k()||!B){ee(te);return}const K=w();M=Ee(te,P),V=sh(Jt(M,K,!1,[1,1]),n,c,B),z||(O(),z=!0);const Q=Ni(te,{handle:V,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:E,lib:l,flowId:h,nodeLookup:c});H=Q.handleDomNode,D=Q.connection,R=ih(!!V,Q.isValid);const J={...X,isValid:R,to:Q.toHandle&&R?An({x:Q.toHandle.x,y:Q.toHandle.y},K):M,toHandle:Q.toHandle,toPosition:R&&Q.toHandle?Q.toHandle.position:Co[B.position],toNode:Q.toHandle?c.get(Q.toHandle.nodeId):null};R&&V&&X.toHandle&&J.toHandle&&X.toHandle.type===J.toHandle.type&&X.toHandle.nodeId===J.toHandle.nodeId&&X.toHandle.id===J.toHandle.id&&X.to.x===J.to.x&&X.to.y===J.to.y||(m(J),X=J)}function ee(te){if(C){(V||H)&&D&&R&&(p==null||p(D));const{inProgress:K,...Q}=X,J={...Q,toPosition:X.toHandle?X.toPosition:null};x==null||x(te,J),s&&(N==null||N(te,J))}g(),cancelAnimationFrame(L),z=!1,R=!1,D=null,H=null,E.removeEventListener("mousemove",U),E.removeEventListener("mouseup",ee),E.removeEventListener("touchmove",U),E.removeEventListener("touchend",ee)}E.addEventListener("mousemove",U),E.addEventListener("mouseup",ee),E.addEventListener("touchmove",U),E.addEventListener("touchend",ee)}function Ni(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:s,doc:i,lib:a,flowId:c,isValidConnection:l=vi,nodeLookup:f}){const h=s==="target",u=t?i.querySelector(`.${a}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:g,y}=Ee(e),p=i.elementFromPoint(g,y),x=p!=null&&p.classList.contains(`${a}-flow__handle`)?p:u,b={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const N=wi(void 0,x),m=x.getAttribute("data-nodeid"),w=x.getAttribute("data-handleid"),k=x.classList.contains("connectable"),S=x.classList.contains("connectableend");if(!m||!N)return b;const I={source:h?m:r,sourceHandle:h?w:o,target:h?r:m,targetHandle:h?o:w};b.connection=I;const E=k&&S&&(n===mt.Strict?h&&N==="source"||!h&&N==="target":m!==r||w!==o);b.isValid=E&&l(I),b.toHandle=bi(m,N,w,f,n,!0)}return b}const Nr={onPointerDown:ah,isValid:Ni};function ch({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=me(e);function s({translateExtent:a,width:c,height:l,zoomStep:f=1,pannable:h=!0,zoomable:u=!0,inversePan:g=!1}){const y=m=>{if(m.sourceEvent.type!=="wheel"||!t)return;const w=n(),k=m.sourceEvent.ctrlKey&&Bt()?10:1,S=-m.sourceEvent.deltaY*(m.sourceEvent.deltaMode===1?.05:m.sourceEvent.deltaMode?1:.002)*f,I=w[2]*Math.pow(2,S*k);t.scaleTo(I)};let p=[0,0];const x=m=>{(m.sourceEvent.type==="mousedown"||m.sourceEvent.type==="touchstart")&&(p=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY])},b=m=>{const w=n();if(m.sourceEvent.type!=="mousemove"&&m.sourceEvent.type!=="touchmove"||!t)return;const k=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY],S=[k[0]-p[0],k[1]-p[1]];p=k;const I=r()*Math.max(w[2],Math.log(w[2]))*(g?-1:1),j={x:w[0]-S[0]*I,y:w[1]-S[1]*I},E=[[0,0],[c,l]];t.setViewportConstrained({x:j.x,y:j.y,zoom:w[2]},E,a)},N=Ks().on("start",x).on("zoom",h?b:null).on("zoom.wheel",u?y:null);o.call(N,{})}function i(){o.on("zoom",null)}return{update:s,destroy:i,pointer:we}}const lh=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,On=e=>({x:e.x,y:e.y,zoom:e.k}),or=({x:e,y:t,zoom:n})=>Hn.translate(e,t).scale(n),it=(e,t)=>e.target.closest(`.${t}`),Si=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),dh=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,sr=(e,t=0,n=dh,r=()=>{})=>{const o=typeof t=="number"&&t>0;return o||r(),o?e.transition().duration(t).ease(n).on("end",r):e},Ci=e=>{const t=e.ctrlKey&&Bt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function uh({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return f=>{if(it(f,t))return!1;f.preventDefault(),f.stopImmediatePropagation();const h=n.property("__zoom").k||1;if(f.ctrlKey&&i){const x=we(f),b=Ci(f),N=h*Math.pow(2,b);r.scaleTo(n,N,x,f);return}const u=f.deltaMode===1?20:1;let g=o===Ke.Vertical?0:f.deltaX*u,y=o===Ke.Horizontal?0:f.deltaY*u;!Bt()&&f.shiftKey&&o!==Ke.Vertical&&(g=f.deltaY*u,y=0),r.translateBy(n,-(g/h)*s,-(y/h)*s,{internal:!0});const p=On(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(f,p)),e.isPanScrolling&&(c==null||c(f,p),e.panScrollTimeout=setTimeout(()=>{l==null||l(f,p),e.isPanScrolling=!1},150))}}function fh({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){const s=r.type==="wheel",i=!t&&s&&!r.ctrlKey,a=it(r,e);if(r.ctrlKey&&s&&a&&r.preventDefault(),i||a)return null;r.preventDefault(),n.call(this,r,o)}}function hh({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,i,a;if((s=r.sourceEvent)!=null&&s.internal)return;const o=On(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function gh({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return s=>{var i,a;e.usedRightMouseButton=!!(n&&Si(t,e.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||r([s.transform.x,s.transform.y,s.transform.k]),o&&!((a=s.sourceEvent)!=null&&a.internal)&&(o==null||o(s.sourceEvent,On(s.transform)))}}function mh({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:s}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&Si(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&lh(e.prevViewport,i.transform))){const c=On(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,c)},n?150:0)}}}function ph({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:c,lib:l}){return f=>{var y;const h=e||t,u=n&&f.ctrlKey;if(f.button===1&&f.type==="mousedown"&&(it(f,`${l}-flow__node`)||it(f,`${l}-flow__edge`)))return!0;if(!r&&!h&&!o&&!s&&!n||i||it(f,a)&&f.type==="wheel"||it(f,c)&&(f.type!=="wheel"||o&&f.type==="wheel"&&!e)||!n&&f.ctrlKey&&f.type==="wheel")return!1;if(!n&&f.type==="touchstart"&&((y=f.touches)==null?void 0:y.length)>1)return f.preventDefault(),!1;if(!h&&!o&&!u&&f.type==="wheel"||!r&&(f.type==="mousedown"||f.type==="touchstart")||Array.isArray(r)&&!r.includes(f.button)&&f.type==="mousedown")return!1;const g=Array.isArray(r)&&r.includes(f.button)||!f.button||f.button<=1;return(!f.ctrlKey||f.type==="wheel")&&g}}function xh({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:s,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:l}){const f={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),u=Ks().clickDistance(!Ne(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),g=me(e).call(u);m({x:s.x,y:s.y,zoom:xt(s.zoom,t,n)},[[0,0],[h.width,h.height]],o);const y=g.on("wheel.zoom"),p=g.on("dblclick.zoom");u.wheelDelta(Ci);function x($,T){return g?new Promise(v=>{u==null||u.interpolate((T==null?void 0:T.interpolate)==="linear"?At:wn).transform(sr(g,T==null?void 0:T.duration,T==null?void 0:T.ease,()=>v(!0)),$)}):Promise.resolve(!1)}function b({noWheelClassName:$,noPanClassName:T,onPaneContextMenu:v,userSelectionActive:P,panOnScroll:C,panOnDrag:_,panOnScrollMode:M,panOnScrollSpeed:z,preventScrolling:D,zoomOnPinch:R,zoomOnScroll:H,zoomOnDoubleClick:O,zoomActivationKeyPressed:B,lib:q,onTransformChange:Z}){P&&!f.isZoomingOrPanning&&N();const F=C&&!B&&!P?uh({zoomPanValues:f,noWheelClassName:$,d3Selection:g,d3Zoom:u,panOnScrollMode:M,panOnScrollSpeed:z,zoomOnPinch:R,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:c}):fh({noWheelClassName:$,preventScrolling:D,d3ZoomHandler:y});if(g.on("wheel.zoom",F,{passive:!1}),!P){const ee=hh({zoomPanValues:f,onDraggingChange:l,onPanZoomStart:a});u.on("start",ee);const te=gh({zoomPanValues:f,panOnDrag:_,onPaneContextMenu:!!v,onPanZoom:i,onTransformChange:Z});u.on("zoom",te);const K=mh({zoomPanValues:f,panOnDrag:_,panOnScroll:C,onPaneContextMenu:v,onPanZoomEnd:c,onDraggingChange:l});u.on("end",K)}const U=ph({zoomActivationKeyPressed:B,panOnDrag:_,zoomOnScroll:H,panOnScroll:C,zoomOnDoubleClick:O,zoomOnPinch:R,userSelectionActive:P,noPanClassName:T,noWheelClassName:$,lib:q});u.filter(U),O?g.on("dblclick.zoom",p):g.on("dblclick.zoom",null)}function N(){u.on("zoom",null)}async function m($,T,v){const P=or($),C=u==null?void 0:u.constrain()(P,T,v);return C&&await x(C),new Promise(_=>_(C))}async function w($,T){const v=or($);return await x(v,T),new Promise(P=>P(v))}function k($){if(g){const T=or($),v=g.property("__zoom");(v.k!==$.zoom||v.x!==$.x||v.y!==$.y)&&(u==null||u.transform(g,T,null,{sync:!0}))}}function S(){const $=g?qs(g.node()):{x:0,y:0,k:1};return{x:$.x,y:$.y,zoom:$.k}}function I($,T){return g?new Promise(v=>{u==null||u.interpolate((T==null?void 0:T.interpolate)==="linear"?At:wn).scaleTo(sr(g,T==null?void 0:T.duration,T==null?void 0:T.ease,()=>v(!0)),$)}):Promise.resolve(!1)}function j($,T){return g?new Promise(v=>{u==null||u.interpolate((T==null?void 0:T.interpolate)==="linear"?At:wn).scaleBy(sr(g,T==null?void 0:T.duration,T==null?void 0:T.ease,()=>v(!0)),$)}):Promise.resolve(!1)}function E($){u==null||u.scaleExtent($)}function L($){u==null||u.translateExtent($)}function V($){const T=!Ne($)||$<0?0:$;u==null||u.clickDistance(T)}return{update:b,destroy:N,setViewport:w,setViewportConstrained:m,getViewport:S,scaleTo:I,scaleBy:j,setScaleExtent:E,setTranslateExtent:L,syncViewport:k,setClickDistance:V}}var wt;(function(e){e.Line="line",e.Handle="handle"})(wt||(wt={}));function yh({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:s}){const i=e-t,a=n-r,c=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&o&&(c[0]=c[0]*-1),a&&s&&(c[1]=c[1]*-1),c}function bh(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function Ve(e,t){return Math.max(0,t-e)}function Re(e,t){return Math.max(0,e-t)}function fn(e,t,n){return Math.max(0,t-e,e-n)}function Vo(e,t){return e?!t:t}function wh(e,t,n,r,o,s,i,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:f,isVertical:h}=t,u=f&&h,{xSnapped:g,ySnapped:y}=n,{minWidth:p,maxWidth:x,minHeight:b,maxHeight:N}=r,{x:m,y:w,width:k,height:S,aspectRatio:I}=e;let j=Math.floor(f?g-e.pointerX:0),E=Math.floor(h?y-e.pointerY:0);const L=k+(c?-j:j),V=S+(l?-E:E),$=-s[0]*k,T=-s[1]*S;let v=fn(L,p,x),P=fn(V,b,N);if(i){let M=0,z=0;c&&j<0?M=Ve(m+j+$,i[0][0]):!c&&j>0&&(M=Re(m+L+$,i[1][0])),l&&E<0?z=Ve(w+E+T,i[0][1]):!l&&E>0&&(z=Re(w+V+T,i[1][1])),v=Math.max(v,M),P=Math.max(P,z)}if(a){let M=0,z=0;c&&j>0?M=Re(m+j,a[0][0]):!c&&j<0&&(M=Ve(m+L,a[1][0])),l&&E>0?z=Re(w+E,a[0][1]):!l&&E<0&&(z=Ve(w+V,a[1][1])),v=Math.max(v,M),P=Math.max(P,z)}if(o){if(f){const M=fn(L/I,b,N)*I;if(v=Math.max(v,M),i){let z=0;!c&&!l||c&&!l&&u?z=Re(w+T+L/I,i[1][1])*I:z=Ve(w+T+(c?j:-j)/I,i[0][1])*I,v=Math.max(v,z)}if(a){let z=0;!c&&!l||c&&!l&&u?z=Ve(w+L/I,a[1][1])*I:z=Re(w+(c?j:-j)/I,a[0][1])*I,v=Math.max(v,z)}}if(h){const M=fn(V*I,p,x)/I;if(P=Math.max(P,M),i){let z=0;!c&&!l||l&&!c&&u?z=Re(m+V*I+$,i[1][0])/I:z=Ve(m+(l?E:-E)*I+$,i[0][0])/I,P=Math.max(P,z)}if(a){let z=0;!c&&!l||l&&!c&&u?z=Ve(m+V*I,a[1][0])/I:z=Re(m+(l?E:-E)*I,a[0][0])/I,P=Math.max(P,z)}}}E=E+(E<0?P:-P),j=j+(j<0?v:-v),o&&(u?L>V*I?E=(Vo(c,l)?-j:j)/I:j=(Vo(c,l)?-E:E)*I:f?(E=j/I,l=c):(j=E*I,c=l));const C=c?m+j:m,_=l?w+E:w;return{width:k+(c?-j:j),height:S+(l?-E:E),x:s[0]*j*(c?-1:1)+C,y:s[1]*E*(l?-1:1)+_}}const ki={width:0,height:0,x:0,y:0},vh={...ki,pointerX:0,pointerY:0,aspectRatio:1};function Nh(e){return[[0,0],[e.measured.width,e.measured.height]]}function Sh(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,c=n[1]*i;return[[r-a,o-c],[r+s-a,o+i-c]]}function Ch({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const s=me(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:f,resizeDirection:h,onResizeStart:u,onResize:g,onResizeEnd:y,shouldResize:p}){let x={...ki},b={...vh};const N=bh(c);let m,w=null,k=[],S,I,j;const E=Ts().on("start",L=>{const{nodeLookup:V,transform:$,snapGrid:T,snapToGrid:v,nodeOrigin:P,paneDomNode:C}=n();if(m=V.get(t),!m)return;w=(C==null?void 0:C.getBoundingClientRect())??null;const{xSnapped:_,ySnapped:M}=$t(L.sourceEvent,{transform:$,snapGrid:T,snapToGrid:v,containerBounds:w});x={width:m.measured.width??0,height:m.measured.height??0,x:m.position.x??0,y:m.position.y??0},b={...x,pointerX:_,pointerY:M,aspectRatio:x.width/x.height},S=void 0,m.parentId&&(m.extent==="parent"||m.expandParent)&&(S=V.get(m.parentId),I=S&&m.extent==="parent"?Nh(S):void 0),k=[],j=void 0;for(const[z,D]of V)if(D.parentId===t&&(k.push({id:z,position:{...D.position},extent:D.extent}),D.extent==="parent"||D.expandParent)){const R=Sh(D,m,D.origin??P);j?j=[[Math.min(R[0][0],j[0][0]),Math.min(R[0][1],j[0][1])],[Math.max(R[1][0],j[1][0]),Math.max(R[1][1],j[1][1])]]:j=R}u==null||u(L,{...x})}).on("drag",L=>{const{transform:V,snapGrid:$,snapToGrid:T,nodeOrigin:v}=n(),P=$t(L.sourceEvent,{transform:V,snapGrid:$,snapToGrid:T,containerBounds:w}),C=[];if(!m)return;const{x:_,y:M,width:z,height:D}=x,R={},H=m.origin??v,{width:O,height:B,x:q,y:Z}=wh(b,N,P,l,f,H,I,j),X=O!==z,F=B!==D,U=q!==_&&X,ee=Z!==M&&F;if(!U&&!ee&&!X&&!F)return;if((U||ee||H[0]===1||H[1]===1)&&(R.x=U?q:x.x,R.y=ee?Z:x.y,x.x=R.x,x.y=R.y,k.length>0)){const J=q-_,se=Z-M;for(const ae of k)ae.position={x:ae.position.x-J+H[0]*(O-z),y:ae.position.y-se+H[1]*(B-D)},C.push(ae)}if((X||F)&&(R.width=X&&(!h||h==="horizontal")?O:x.width,R.height=F&&(!h||h==="vertical")?B:x.height,x.width=R.width,x.height=R.height),S&&m.expandParent){const J=H[0]*(R.width??0);R.x&&R.x<J&&(x.x=J,b.x=b.x-(R.x-J));const se=H[1]*(R.height??0);R.y&&R.y<se&&(x.y=se,b.y=b.y-(R.y-se))}const te=yh({width:x.width,prevWidth:z,height:x.height,prevHeight:D,affectsX:N.affectsX,affectsY:N.affectsY}),K={...x,direction:te};(p==null?void 0:p(L,K))!==!1&&(g==null||g(L,K),r(R,C))}).on("end",L=>{y==null||y(L,{...x}),o==null||o({...x})});s.call(E)}function a(){s.on(".drag",null)}return{update:i,destroy:a}}const Xn=A.createContext(null),kh=Xn.Provider,Ei=_e.error001();function re(e,t){const n=A.useContext(Xn);if(n===null)throw new Error(Ei);return Dc(n,e,t)}function ie(){const e=A.useContext(Xn);if(e===null)throw new Error(Ei);return A.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Ro={display:"none"},Eh={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ji="react-flow__node-desc",_i="react-flow__edge-desc",jh="react-flow__aria-live",_h=e=>e.ariaLiveMessage,Mh=e=>e.ariaLabelConfig;function zh({rfId:e}){const t=re(_h);return d.jsx("div",{id:`${jh}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Eh,children:t})}function Ph({rfId:e,disableKeyboardA11y:t}){const n=re(Mh);return d.jsxs(d.Fragment,{children:[d.jsx("div",{id:`${ji}-${e}`,style:Ro,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),d.jsx("div",{id:`${_i}-${e}`,style:Ro,children:n["edge.a11yDescription.default"]}),!t&&d.jsx(zh,{rfId:e})]})}const Yn=A.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},s)=>{const i=`${e}`.split("-");return d.jsx("div",{className:de(["react-flow__panel",n,...i]),style:r,ref:s,...o,children:t})});Yn.displayName="Panel";function Ih({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:d.jsx(Yn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:d.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Ah=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},hn=e=>e.id;function $h(e,t){return ce(e.selectedNodes.map(hn),t.selectedNodes.map(hn))&&ce(e.selectedEdges.map(hn),t.selectedEdges.map(hn))}function Th({onSelectionChange:e}){const t=ie(),{selectedNodes:n,selectedEdges:r}=re(Ah,$h);return A.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(s=>s(o))},[n,r,e]),null}const Dh=e=>!!e.onSelectionChangeHandlers;function Vh({onSelectionChange:e}){const t=re(Dh);return e||t?d.jsx(Th,{onSelectionChange:e}):null}const Mi=[0,0],Rh={x:0,y:0,zoom:1},Lh=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],Lo=[...Lh,"rfId"],Hh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Ho={translateExtent:Lt,nodeOrigin:Mi,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Fh(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=re(Hh,ce),f=ie();A.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{h.current=Ho,a()}),[]);const h=A.useRef(Ho);return A.useEffect(()=>{for(const u of Lo){const g=e[u],y=h.current[u];g!==y&&(typeof e[u]>"u"||(u==="nodes"?t(g):u==="edges"?n(g):u==="minZoom"?r(g):u==="maxZoom"?o(g):u==="translateExtent"?s(g):u==="nodeExtent"?i(g):u==="paneClickDistance"?l(g):u==="ariaLabelConfig"?f.setState({ariaLabelConfig:Vf(g)}):u==="fitView"?f.setState({fitViewQueued:g}):u==="fitViewOptions"?f.setState({fitViewOptions:g}):f.setState({[u]:g})))}h.current=e},Lo.map(u=>e[u])),null}function Fo(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Bh(e){var r;const[t,n]=A.useState(e==="system"?null:e);return A.useEffect(()=>{if(e!=="system"){n(e);return}const o=Fo(),s=()=>n(o!=null&&o.matches?"dark":"light");return s(),o==null||o.addEventListener("change",s),()=>{o==null||o.removeEventListener("change",s)}},[e]),t!==null?t:(r=Fo())!=null&&r.matches?"dark":"light"}const Bo=typeof document<"u"?document:null;function Xt(e=null,t={target:Bo,actInsideInputWithModifier:!0}){const[n,r]=A.useState(!1),o=A.useRef(!1),s=A.useRef(new Set([])),[i,a]=A.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(h=>typeof h=="string").map(h=>h.replace("+",`
`).replace(`

`,`
+`).split(`
`)),f=l.reduce((h,u)=>h.concat(...u),[]);return[l,f]}return[[],[]]},[e]);return A.useEffect(()=>{const c=(t==null?void 0:t.target)??Bo,l=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const f=g=>{var x,b;if(o.current=g.ctrlKey||g.metaKey||g.shiftKey||g.altKey,(!o.current||o.current&&!l)&&li(g))return!1;const p=Xo(g.code,a);if(s.current.add(g[p]),Oo(i,s.current,!1)){const N=((b=(x=g.composedPath)==null?void 0:x.call(g))==null?void 0:b[0])||g.target,m=(N==null?void 0:N.nodeName)==="BUTTON"||(N==null?void 0:N.nodeName)==="A";t.preventDefault!==!1&&(o.current||!m)&&g.preventDefault(),r(!0)}},h=g=>{const y=Xo(g.code,a);Oo(i,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(g[y]),g.key==="Meta"&&s.current.clear(),o.current=!1},u=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",f),c==null||c.addEventListener("keyup",h),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{c==null||c.removeEventListener("keydown",f),c==null||c.removeEventListener("keyup",h),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,r]),n}function Oo(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Xo(e,t){return t.includes(e)?"code":"key"}const Oh=()=>{const e=ie();return A.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??s},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),c=Fr(t,r,o,s,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(c,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:c}=i.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},f=n.snapGrid??o,h=n.snapToGrid??s;return Jt(l,r,h,f)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:s}=r.getBoundingClientRect(),i=An(t,n);return{x:i.x+o,y:i.y+s}}}),[])};function zi(e,t){const n=[],r=new Map,o=[];for(const s of e)if(s.type==="add"){o.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const i=r.get(s.id);i?i.push(s):r.set(s.id,[s])}for(const s of t){const i=r.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const c of i)Xh(c,a);n.push(a)}return o.length&&o.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function Xh(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Pi(e,t){return zi(e,t)}function Ii(e,t){return zi(e,t)}function Ge(e,t){return{id:e,type:"select",selected:t}}function at(e,t=new Set,n=!1){const r=[];for(const[o,s]of e){const i=t.has(o);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),r.push(Ge(s.id,i)))}return r}function Yo({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,i]of e.entries()){const a=t.get(i.id),c=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function Wo(e){return{id:e.id,type:"remove"}}const Go=e=>jf(e),Yh=e=>ti(e);function Ai(e){return A.forwardRef(e)}const Wh=typeof window<"u"?A.useLayoutEffect:A.useEffect;function Uo(e){const[t,n]=A.useState(BigInt(0)),[r]=A.useState(()=>Gh(()=>n(o=>o+BigInt(1))));return Wh(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function Gh(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const $i=A.createContext(null);function Uh({children:e}){const t=ie(),n=A.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:f,onNodesChange:h,nodeLookup:u,fitViewQueued:g}=t.getState();let y=c;for(const x of a)y=typeof x=="function"?x(y):x;const p=Yo({items:y,lookup:u});f&&l(y),p.length>0?h==null||h(p):g&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:b,setNodes:N}=t.getState();x&&N(b)})},[]),r=Uo(n),o=A.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:f,onEdgesChange:h,edgeLookup:u}=t.getState();let g=c;for(const y of a)g=typeof y=="function"?y(g):y;f?l(g):h&&h(Yo({items:g,lookup:u}))},[]),s=Uo(o),i=A.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return d.jsx($i.Provider,{value:i,children:e})}function qh(){const e=A.useContext($i);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Kh=e=>!!e.panZoom;function Wn(){const e=Oh(),t=ie(),n=qh(),r=re(Kh),o=A.useMemo(()=>{const s=h=>t.getState().nodeLookup.get(h),i=h=>{n.nodeQueue.push(h)},a=h=>{n.edgeQueue.push(h)},c=h=>{var b,N;const{nodeLookup:u,nodeOrigin:g}=t.getState(),y=Go(h)?h:u.get(h.id),p=y.parentId?ai(y.position,y.measured,y.parentId,u,g):y.position,x={...y,position:p,width:((b=y.measured)==null?void 0:b.width)??y.width,height:((N=y.measured)==null?void 0:N.height)??y.height};return yt(x)},l=(h,u,g={replace:!1})=>{i(y=>y.map(p=>{if(p.id===h){const x=typeof u=="function"?u(p):u;return g.replace&&Go(x)?x:{...p,...x}}return p}))},f=(h,u,g={replace:!1})=>{a(y=>y.map(p=>{if(p.id===h){const x=typeof u=="function"?u(p):u;return g.replace&&Yh(x)?x:{...p,...x}}return p}))};return{getNodes:()=>t.getState().nodes.map(h=>({...h})),getNode:h=>{var u;return(u=s(h))==null?void 0:u.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:h=[]}=t.getState();return h.map(u=>({...u}))},getEdge:h=>t.getState().edgeLookup.get(h),setNodes:i,setEdges:a,addNodes:h=>{const u=Array.isArray(h)?h:[h];n.nodeQueue.push(g=>[...g,...u])},addEdges:h=>{const u=Array.isArray(h)?h:[h];n.edgeQueue.push(g=>[...g,...u])},toObject:()=>{const{nodes:h=[],edges:u=[],transform:g}=t.getState(),[y,p,x]=g;return{nodes:h.map(b=>({...b})),edges:u.map(b=>({...b})),viewport:{x:y,y:p,zoom:x}}},deleteElements:async({nodes:h=[],edges:u=[]})=>{const{nodes:g,edges:y,onNodesDelete:p,onEdgesDelete:x,triggerNodeChanges:b,triggerEdgeChanges:N,onDelete:m,onBeforeDelete:w}=t.getState(),{nodes:k,edges:S}=await If({nodesToRemove:h,edgesToRemove:u,nodes:g,edges:y,onBeforeDelete:w}),I=S.length>0,j=k.length>0;if(I){const E=S.map(Wo);x==null||x(S),N(E)}if(j){const E=k.map(Wo);p==null||p(k),b(E)}return(j||I)&&(m==null||m({nodes:k,edges:S})),{deletedNodes:k,deletedEdges:S}},getIntersectingNodes:(h,u=!0,g)=>{const y=Eo(h),p=y?h:c(h),x=g!==void 0;return p?(g||t.getState().nodes).filter(b=>{const N=t.getState().nodeLookup.get(b.id);if(N&&!y&&(b.id===h.id||!N.internals.positionAbsolute))return!1;const m=yt(x?b:N),w=Ft(m,p);return u&&w>0||w>=m.width*m.height||w>=p.width*p.height}):[]},isNodeIntersecting:(h,u,g=!0)=>{const p=Eo(h)?h:c(h);if(!p)return!1;const x=Ft(p,u);return g&&x>0||x>=p.width*p.height},updateNode:l,updateNodeData:(h,u,g={replace:!1})=>{l(h,y=>{const p=typeof u=="function"?u(y):u;return g.replace?{...y,data:p}:{...y,data:{...y.data,...p}}},g)},updateEdge:f,updateEdgeData:(h,u,g={replace:!1})=>{f(h,y=>{const p=typeof u=="function"?u(y):u;return g.replace?{...y,data:p}:{...y,data:{...y.data,...p}}},g)},getNodesBounds:h=>{const{nodeLookup:u,nodeOrigin:g}=t.getState();return _f(h,{nodeLookup:u,nodeOrigin:g})},getHandleConnections:({type:h,id:u,nodeId:g})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${g}-${h}${u?`-${u}`:""}`))==null?void 0:y.values())??[])},getNodeConnections:({type:h,handleId:u,nodeId:g})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${g}${h?u?`-${h}-${u}`:`-${h}`:""}`))==null?void 0:y.values())??[])},fitView:async h=>{const u=t.getState().fitViewResolver??Df();return t.setState({fitViewQueued:!0,fitViewOptions:h,fitViewResolver:u}),n.nodeQueue.push(g=>[...g]),u.promise}}},[]);return A.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const qo=e=>e.selected,Zh=typeof window<"u"?window:void 0;function Qh({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ie(),{deleteElements:r}=Wn(),o=Xt(e,{actInsideInputWithModifier:!1}),s=Xt(t,{target:Zh});A.useEffect(()=>{if(o){const{edges:i,nodes:a}=n.getState();r({nodes:a.filter(qo),edges:i.filter(qo)}),n.setState({nodesSelectionActive:!1})}},[o]),A.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function Jh(e){const t=ie();A.useEffect(()=>{const n=()=>{var o,s;if(!e.current)return!1;const r=Br(e.current);(r.height===0||r.width===0)&&((s=(o=t.getState()).onError)==null||s.call(o,"004",_e.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Gn={position:"absolute",width:"100%",height:"100%",top:0,left:0},eg=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function tg({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:s=Ke.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:f,maxZoom:h,zoomActivationKeyCode:u,preventScrolling:g=!0,children:y,noWheelClassName:p,noPanClassName:x,onViewportChange:b,isControlledViewport:N,paneClickDistance:m}){const w=ie(),k=A.useRef(null),{userSelectionActive:S,lib:I}=re(eg,ce),j=Xt(u),E=A.useRef();Jh(k);const L=A.useCallback(V=>{b==null||b({x:V[0],y:V[1],zoom:V[2]}),N||w.setState({transform:V})},[b,N]);return A.useEffect(()=>{if(k.current){E.current=xh({domNode:k.current,minZoom:f,maxZoom:h,translateExtent:l,viewport:c,paneClickDistance:m,onDraggingChange:v=>w.setState({paneDragging:v}),onPanZoomStart:(v,P)=>{const{onViewportChangeStart:C,onMoveStart:_}=w.getState();_==null||_(v,P),C==null||C(P)},onPanZoom:(v,P)=>{const{onViewportChange:C,onMove:_}=w.getState();_==null||_(v,P),C==null||C(P)},onPanZoomEnd:(v,P)=>{const{onViewportChangeEnd:C,onMoveEnd:_}=w.getState();_==null||_(v,P),C==null||C(P)}});const{x:V,y:$,zoom:T}=E.current.getViewport();return w.setState({panZoom:E.current,transform:[V,$,T],domNode:k.current.closest(".react-flow")}),()=>{var v;(v=E.current)==null||v.destroy()}}},[]),A.useEffect(()=>{var V;(V=E.current)==null||V.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:j,preventScrolling:g,noPanClassName:x,userSelectionActive:S,noWheelClassName:p,lib:I,onTransformChange:L})},[e,t,n,r,o,s,i,a,j,g,x,S,p,I,L]),d.jsx("div",{className:"react-flow__renderer",ref:k,style:Gn,children:y})}const ng=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function rg(){const{userSelectionActive:e,userSelectionRect:t}=re(ng,ce);return e&&t?d.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const ir=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},og=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function sg({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Ht.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:s,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:f,onPaneMouseMove:h,onPaneMouseLeave:u,children:g}){const y=ie(),{userSelectionActive:p,elementsSelectable:x,dragging:b,connectionInProgress:N}=re(og,ce),m=x&&(e||p),w=A.useRef(null),k=A.useRef(),S=A.useRef(new Set),I=A.useRef(new Set),j=A.useRef(!1),E=A.useRef(!1),L=_=>{if(j.current||N){j.current=!1;return}a==null||a(_),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},V=_=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){_.preventDefault();return}c==null||c(_)},$=l?_=>l(_):void 0,T=_=>{var H,O;const{resetSelectedElements:M,domNode:z}=y.getState();if(k.current=z==null?void 0:z.getBoundingClientRect(),!x||!e||_.button!==0||_.target!==w.current||!k.current)return;(O=(H=_.target)==null?void 0:H.setPointerCapture)==null||O.call(H,_.pointerId),E.current=!0,j.current=!1;const{x:D,y:R}=Ee(_.nativeEvent,k.current);M(),y.setState({userSelectionRect:{width:0,height:0,startX:D,startY:R,x:D,y:R}}),s==null||s(_)},v=_=>{const{userSelectionRect:M,transform:z,nodeLookup:D,edgeLookup:R,connectionLookup:H,triggerNodeChanges:O,triggerEdgeChanges:B,defaultEdgeOptions:q}=y.getState();if(!k.current||!M)return;j.current=!0;const{x:Z,y:X}=Ee(_.nativeEvent,k.current),{startX:F,startY:U}=M,ee={startX:F,startY:U,x:Z<F?Z:F,y:X<U?X:U,width:Math.abs(Z-F),height:Math.abs(X-U)},te=S.current,K=I.current;S.current=new Set(Hr(D,ee,z,n===Ht.Partial,!0).map(J=>J.id)),I.current=new Set;const Q=(q==null?void 0:q.selectable)??!0;for(const J of S.current){const se=H.get(J);if(se)for(const{edgeId:ae}of se.values()){const be=R.get(ae);be&&(be.selectable??Q)&&I.current.add(ae)}}if(!jo(te,S.current)){const J=at(D,S.current,!0);O(J)}if(!jo(K,I.current)){const J=at(R,I.current);B(J)}y.setState({userSelectionRect:ee,userSelectionActive:!0,nodesSelectionActive:!1})},P=_=>{var z,D;if(_.button!==0||!E.current)return;(D=(z=_.target)==null?void 0:z.releasePointerCapture)==null||D.call(z,_.pointerId);const{userSelectionRect:M}=y.getState();!p&&M&&_.target===w.current&&(L==null||L(_)),y.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:S.current.size>0}),i==null||i(_),(t||o)&&(j.current=!1),E.current=!1},C=r===!0||Array.isArray(r)&&r.includes(0);return d.jsxs("div",{className:de(["react-flow__pane",{draggable:C,dragging:b,selection:e}]),onClick:m?void 0:ir(L,w),onContextMenu:ir(V,w),onWheel:ir($,w),onPointerEnter:m?void 0:f,onPointerDown:m?T:h,onPointerMove:m?v:h,onPointerUp:m?P:void 0,onPointerLeave:u,ref:w,style:Gn,children:[g,d.jsx(rg,{})]})}function Sr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",_e.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(s({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var f;return(f=r==null?void 0:r.current)==null?void 0:f.blur()})):o([e])}function Ti({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:s,nodeClickDistance:i}){const a=ie(),[c,l]=A.useState(!1),f=A.useRef();return A.useEffect(()=>{f.current=nh({getStoreItems:()=>a.getState(),onNodeMouseDown:h=>{Sr({id:h,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),A.useEffect(()=>{var h,u;if(t)(h=f.current)==null||h.destroy();else if(e.current)return(u=f.current)==null||u.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:o,nodeClickDistance:i}),()=>{var g;(g=f.current)==null||g.destroy()}},[n,r,t,s,e,o]),c}const ig=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Di(){const e=ie();return A.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:f}=e.getState(),h=new Map,u=ig(i),g=o?s[0]:5,y=o?s[1]:5,p=n.direction.x*g*n.factor,x=n.direction.y*y*n.factor;for(const[,b]of l){if(!u(b))continue;let N={x:b.internals.positionAbsolute.x+p,y:b.internals.positionAbsolute.y+x};o&&(N=Qt(N,s));const{position:m,positionAbsolute:w}=ni({nodeId:b.id,nextPosition:N,nodeLookup:l,nodeExtent:r,nodeOrigin:f,onError:a});b.position=m,b.internals.positionAbsolute=w,h.set(b.id,b)}c(h)},[])}const Gr=A.createContext(null),ag=Gr.Provider;Gr.Consumer;const Vi=()=>A.useContext(Gr),cg=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),lg=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:s,connection:i}=r,{fromHandle:a,toHandle:c,isValid:l}=i,f=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:f,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:s===mt.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:f&&l}};function dg({type:e="source",position:t=G.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:c,className:l,onMouseDown:f,onTouchStart:h,...u},g){var P,C;const y=i||null,p=e==="target",x=ie(),b=Vi(),{connectOnClick:N,noPanClassName:m,rfId:w}=re(cg,ce),{connectingFrom:k,connectingTo:S,clickConnecting:I,isPossibleEndHandle:j,connectionInProcess:E,clickConnectionInProcess:L,valid:V}=re(lg(b,y,e),ce);b||(C=(P=x.getState()).onError)==null||C.call(P,"010",_e.error010());const $=_=>{const{defaultEdgeOptions:M,onConnect:z,hasDefaultEdges:D}=x.getState(),R={...M,..._};if(D){const{edges:H,setEdges:O}=x.getState();O(gi(R,H))}z==null||z(R),a==null||a(R)},T=_=>{if(!b)return;const M=di(_.nativeEvent);if(o&&(M&&_.button===0||!M)){const z=x.getState();Nr.onPointerDown(_.nativeEvent,{handleDomNode:_.currentTarget,autoPanOnConnect:z.autoPanOnConnect,connectionMode:z.connectionMode,connectionRadius:z.connectionRadius,domNode:z.domNode,nodeLookup:z.nodeLookup,lib:z.lib,isTarget:p,handleId:y,nodeId:b,flowId:z.rfId,panBy:z.panBy,cancelConnection:z.cancelConnection,onConnectStart:z.onConnectStart,onConnectEnd:z.onConnectEnd,updateConnection:z.updateConnection,onConnect:$,isValidConnection:n||z.isValidConnection,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,autoPanSpeed:z.autoPanSpeed,dragThreshold:z.connectionDragThreshold})}M?f==null||f(_):h==null||h(_)},v=_=>{const{onClickConnectStart:M,onClickConnectEnd:z,connectionClickStartHandle:D,connectionMode:R,isValidConnection:H,lib:O,rfId:B,nodeLookup:q,connection:Z}=x.getState();if(!b||!D&&!o)return;if(!D){M==null||M(_.nativeEvent,{nodeId:b,handleId:y,handleType:e}),x.setState({connectionClickStartHandle:{nodeId:b,type:e,id:y}});return}const X=ci(_.target),F=n||H,{connection:U,isValid:ee}=Nr.isValid(_.nativeEvent,{handle:{nodeId:b,id:y,type:e},connectionMode:R,fromNodeId:D.nodeId,fromHandleId:D.id||null,fromType:D.type,isValidConnection:F,flowId:B,doc:X,lib:O,nodeLookup:q});ee&&U&&$(U);const te=structuredClone(Z);delete te.inProgress,te.toPosition=te.toHandle?te.toHandle.position:null,z==null||z(_,te),x.setState({connectionClickStartHandle:null})};return d.jsx("div",{"data-handleid":y,"data-nodeid":b,"data-handlepos":t,"data-id":`${w}-${b}-${y}-${e}`,className:de(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",m,l,{source:!p,target:p,connectable:r,connectablestart:o,connectableend:s,clickconnecting:I,connectingfrom:k,connectingto:S,valid:V,connectionindicator:r&&(!E||j)&&(E||L?s:o)}]),onMouseDown:T,onTouchStart:T,onClick:N?v:void 0,ref:g,...u,children:c})}const Oe=A.memo(Ai(dg));function ug({data:e,isConnectable:t,sourcePosition:n=G.Bottom}){return d.jsxs(d.Fragment,{children:[e==null?void 0:e.label,d.jsx(Oe,{type:"source",position:n,isConnectable:t})]})}function fg({data:e,isConnectable:t,targetPosition:n=G.Top,sourcePosition:r=G.Bottom}){return d.jsxs(d.Fragment,{children:[d.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,d.jsx(Oe,{type:"source",position:r,isConnectable:t})]})}function hg(){return null}function gg({data:e,isConnectable:t,targetPosition:n=G.Top}){return d.jsxs(d.Fragment,{children:[d.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const $n={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Ko={input:ug,default:fg,output:gg,group:hg};function mg(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const pg=e=>{const{width:t,height:n,x:r,y:o}=Zt(e.nodeLookup,{filter:s=>!!s.selected});return{width:Ne(t)?t:null,height:Ne(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function xg({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ie(),{width:o,height:s,transformString:i,userSelectionActive:a}=re(pg,ce),c=Di(),l=A.useRef(null);if(A.useEffect(()=>{var u;n||(u=l.current)==null||u.focus({preventScroll:!0})},[n]),Ti({nodeRef:l}),a||!o||!s)return null;const f=e?u=>{const g=r.getState().nodes.filter(y=>y.selected);e(u,g)}:void 0,h=u=>{Object.prototype.hasOwnProperty.call($n,u.key)&&(u.preventDefault(),c({direction:$n[u.key],factor:u.shiftKey?4:1}))};return d.jsx("div",{className:de(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:d.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:o,height:s}})})}const Zo=typeof window<"u"?window:void 0,yg=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ri({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:f,selectionMode:h,onSelectionStart:u,onSelectionEnd:g,multiSelectionKeyCode:y,panActivationKeyCode:p,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:N,zoomOnPinch:m,panOnScroll:w,panOnScrollSpeed:k,panOnScrollMode:S,zoomOnDoubleClick:I,panOnDrag:j,defaultViewport:E,translateExtent:L,minZoom:V,maxZoom:$,preventScrolling:T,onSelectionContextMenu:v,noWheelClassName:P,noPanClassName:C,disableKeyboardA11y:_,onViewportChange:M,isControlledViewport:z}){const{nodesSelectionActive:D,userSelectionActive:R}=re(yg),H=Xt(l,{target:Zo}),O=Xt(p,{target:Zo}),B=O||j,q=O||w,Z=f&&B!==!0,X=H||R||Z;return Qh({deleteKeyCode:c,multiSelectionKeyCode:y}),d.jsx(tg,{onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:N,zoomOnPinch:m,panOnScroll:q,panOnScrollSpeed:k,panOnScrollMode:S,zoomOnDoubleClick:I,panOnDrag:!H&&B,defaultViewport:E,translateExtent:L,minZoom:V,maxZoom:$,zoomActivationKeyCode:x,preventScrolling:T,noWheelClassName:P,noPanClassName:C,onViewportChange:M,isControlledViewport:z,paneClickDistance:a,children:d.jsxs(sg,{onSelectionStart:u,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:B,isSelecting:!!X,selectionMode:h,selectionKeyPressed:H,selectionOnDrag:Z,children:[e,D&&d.jsx(xg,{onSelectionContextMenu:v,noPanClassName:C,disableKeyboardA11y:_})]})})}Ri.displayName="FlowRenderer";const bg=A.memo(Ri),wg=e=>t=>e?Hr(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function vg(e){return re(A.useCallback(wg(e),[e]),ce)}const Ng=e=>e.updateNodeInternals;function Sg(){const e=re(Ng),[t]=A.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const s=o.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:o.target,force:!0})}),e(r)}));return A.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Cg({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=ie(),s=A.useRef(null),i=A.useRef(null),a=A.useRef(e.sourcePosition),c=A.useRef(e.targetPosition),l=A.useRef(t),f=n&&!!e.internals.handleBounds;return A.useEffect(()=>{s.current&&!e.hidden&&(!f||i.current!==s.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(s.current),i.current=s.current)},[f,e.hidden]),A.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),A.useEffect(()=>{if(s.current){const h=l.current!==t,u=a.current!==e.sourcePosition,g=c.current!==e.targetPosition;(h||u||g)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function kg({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:f,resizeObserver:h,noDragClassName:u,noPanClassName:g,disableKeyboardA11y:y,rfId:p,nodeTypes:x,nodeClickDistance:b,onError:N}){const{node:m,internals:w,isParent:k}=re(F=>{const U=F.nodeLookup.get(e),ee=F.parentLookup.has(e);return{node:U,internals:U.internals,isParent:ee}},ce);let S=m.type||"default",I=(x==null?void 0:x[S])||Ko[S];I===void 0&&(N==null||N("003",_e.error003(S)),S="default",I=(x==null?void 0:x.default)||Ko.default);const j=!!(m.draggable||a&&typeof m.draggable>"u"),E=!!(m.selectable||c&&typeof m.selectable>"u"),L=!!(m.connectable||l&&typeof m.connectable>"u"),V=!!(m.focusable||f&&typeof m.focusable>"u"),$=ie(),T=ii(m),v=Cg({node:m,nodeType:S,hasDimensions:T,resizeObserver:h}),P=Ti({nodeRef:v,disabled:m.hidden||!j,noDragClassName:u,handleSelector:m.dragHandle,nodeId:e,isSelectable:E,nodeClickDistance:b}),C=Di();if(m.hidden)return null;const _=De(m),M=mg(m),z=E||j||t||n||r||o,D=n?F=>n(F,{...w.userNode}):void 0,R=r?F=>r(F,{...w.userNode}):void 0,H=o?F=>o(F,{...w.userNode}):void 0,O=s?F=>s(F,{...w.userNode}):void 0,B=i?F=>i(F,{...w.userNode}):void 0,q=F=>{const{selectNodesOnDrag:U,nodeDragThreshold:ee}=$.getState();E&&(!U||!j||ee>0)&&Sr({id:e,store:$,nodeRef:v}),t&&t(F,{...w.userNode})},Z=F=>{if(!(li(F.nativeEvent)||y)){if(Zs.includes(F.key)&&E){const U=F.key==="Escape";Sr({id:e,store:$,unselect:U,nodeRef:v})}else if(j&&m.selected&&Object.prototype.hasOwnProperty.call($n,F.key)){F.preventDefault();const{ariaLabelConfig:U}=$.getState();$.setState({ariaLiveMessage:U["node.a11yDescription.ariaLiveMessage"]({direction:F.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),C({direction:$n[F.key],factor:F.shiftKey?4:1})}}},X=()=>{var J;if(y||!((J=v.current)!=null&&J.matches(":focus-visible")))return;const{transform:F,width:U,height:ee,autoPanOnNodeFocus:te,setCenter:K}=$.getState();if(!te)return;Hr(new Map([[e,m]]),{x:0,y:0,width:U,height:ee},F,!0).length>0||K(m.position.x+_.width/2,m.position.y+_.height/2,{zoom:F[2]})};return d.jsx("div",{className:de(["react-flow__node",`react-flow__node-${S}`,{[g]:j},m.className,{selected:m.selected,selectable:E,parent:k,draggable:j,dragging:P}]),ref:v,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:z?"all":"none",visibility:T?"visible":"hidden",...m.style,...M},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:D,onMouseMove:R,onMouseLeave:H,onContextMenu:O,onClick:q,onDoubleClick:B,onKeyDown:V?Z:void 0,tabIndex:V?0:void 0,onFocus:V?X:void 0,role:m.ariaRole??(V?"group":void 0),"aria-roledescription":"node","aria-describedby":y?void 0:`${ji}-${p}`,"aria-label":m.ariaLabel,...m.domAttributes,children:d.jsx(ag,{value:e,children:d.jsx(I,{id:e,data:m.data,type:S,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:m.selected??!1,selectable:E,draggable:j,deletable:m.deletable??!0,isConnectable:L,sourcePosition:m.sourcePosition,targetPosition:m.targetPosition,dragging:P,dragHandle:m.dragHandle,zIndex:w.z,parentId:m.parentId,..._})})})}const Eg=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Li(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:s}=re(Eg,ce),i=vg(e.onlyRenderVisibleElements),a=Sg();return d.jsx("div",{className:"react-flow__nodes",style:Gn,children:i.map(c=>d.jsx(kg,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:s},c))})}Li.displayName="NodeRenderer";const jg=A.memo(Li);function _g(e){return re(A.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const s=n.nodeLookup.get(o.source),i=n.nodeLookup.get(o.target);s&&i&&Hf({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),ce)}const Mg=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return d.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},zg=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return d.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Qo={[pt.Arrow]:Mg,[pt.ArrowClosed]:zg};function Pg(e){const t=ie();return A.useMemo(()=>{var o,s;return Object.prototype.hasOwnProperty.call(Qo,e)?Qo[e]:((s=(o=t.getState()).onError)==null||s.call(o,"009",_e.error009(e)),null)},[e])}const Ig=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=Pg(t);return c?d.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:d.jsx(c,{color:n,strokeWidth:i})}):null},Hi=({defaultColor:e,rfId:t})=>{const n=re(s=>s.edges),r=re(s=>s.defaultEdgeOptions),o=A.useMemo(()=>Gf(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?d.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:d.jsx("defs",{children:o.map(s=>d.jsx(Ig,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Hi.displayName="MarkerDefinitions";var Ag=A.memo(Hi);function Fi({x:e,y:t,label:n,labelStyle:r,labelShowBg:o=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...f}){const[h,u]=A.useState({x:1,y:0,width:0,height:0}),g=de(["react-flow__edge-textwrapper",l]),y=A.useRef(null);return A.useEffect(()=>{if(y.current){const p=y.current.getBBox();u({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),n?d.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:g,visibility:h.width?"visible":"hidden",...f,children:[o&&d.jsx("rect",{width:h.width+2*i[0],x:-i[0],y:-i[1],height:h.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),d.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:y,style:r,children:n}),c]}):null}Fi.displayName="EdgeText";const $g=A.memo(Fi);function Un({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...f}){return d.jsxs(d.Fragment,{children:[d.jsx("path",{...f,d:e,fill:"none",className:de(["react-flow__edge-path",f.className])}),l?d.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}):null,r&&Ne(t)&&Ne(n)?d.jsx($g,{x:t,y:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function Jo({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===G.Left||e===G.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Bi({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top}){const[i,a]=Jo({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,l]=Jo({pos:s,x1:r,y1:o,x2:e,y2:t}),[f,h,u,g]=ui({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${a} ${c},${l} ${r},${o}`,f,h,u,g]}function Oi(e){return A.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i,targetPosition:a,label:c,labelStyle:l,labelShowBg:f,labelBgStyle:h,labelBgPadding:u,labelBgBorderRadius:g,style:y,markerEnd:p,markerStart:x,interactionWidth:b})=>{const[N,m,w]=Bi({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a}),k=e.isInternal?void 0:t;return d.jsx(Un,{id:k,path:N,labelX:m,labelY:w,label:c,labelStyle:l,labelShowBg:f,labelBgStyle:h,labelBgPadding:u,labelBgBorderRadius:g,style:y,markerEnd:p,markerStart:x,interactionWidth:b})})}const Tg=Oi({isInternal:!1}),Xi=Oi({isInternal:!0});Tg.displayName="SimpleBezierEdge";Xi.displayName="SimpleBezierEdgeInternal";function Yi(e){return A.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:u,sourcePosition:g=G.Bottom,targetPosition:y=G.Top,markerEnd:p,markerStart:x,pathOptions:b,interactionWidth:N})=>{const[m,w,k]=br({sourceX:n,sourceY:r,sourcePosition:g,targetX:o,targetY:s,targetPosition:y,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset,stepPosition:b==null?void 0:b.stepPosition}),S=e.isInternal?void 0:t;return d.jsx(Un,{id:S,path:m,labelX:w,labelY:k,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:u,markerEnd:p,markerStart:x,interactionWidth:N})})}const Wi=Yi({isInternal:!1}),Gi=Yi({isInternal:!0});Wi.displayName="SmoothStepEdge";Gi.displayName="SmoothStepEdgeInternal";function Ui(e){return A.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return d.jsx(Wi,{...n,id:r,pathOptions:A.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const Dg=Ui({isInternal:!1}),qi=Ui({isInternal:!0});Dg.displayName="StepEdge";qi.displayName="StepEdgeInternal";function Ki(e){return A.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:u,markerEnd:g,markerStart:y,interactionWidth:p})=>{const[x,b,N]=mi({sourceX:n,sourceY:r,targetX:o,targetY:s}),m=e.isInternal?void 0:t;return d.jsx(Un,{id:m,path:x,labelX:b,labelY:N,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:u,markerEnd:g,markerStart:y,interactionWidth:p})})}const Vg=Ki({isInternal:!1}),Zi=Ki({isInternal:!0});Vg.displayName="StraightEdge";Zi.displayName="StraightEdgeInternal";function Qi(e){return A.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i=G.Bottom,targetPosition:a=G.Top,label:c,labelStyle:l,labelShowBg:f,labelBgStyle:h,labelBgPadding:u,labelBgBorderRadius:g,style:y,markerEnd:p,markerStart:x,pathOptions:b,interactionWidth:N})=>{const[m,w,k]=fi({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a,curvature:b==null?void 0:b.curvature}),S=e.isInternal?void 0:t;return d.jsx(Un,{id:S,path:m,labelX:w,labelY:k,label:c,labelStyle:l,labelShowBg:f,labelBgStyle:h,labelBgPadding:u,labelBgBorderRadius:g,style:y,markerEnd:p,markerStart:x,interactionWidth:N})})}const Rg=Qi({isInternal:!1}),Ji=Qi({isInternal:!0});Rg.displayName="BezierEdge";Ji.displayName="BezierEdgeInternal";const es={default:Ji,straight:Zi,step:qi,smoothstep:Gi,simplebezier:Xi},ts={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Lg=(e,t,n)=>n===G.Left?e-t:n===G.Right?e+t:e,Hg=(e,t,n)=>n===G.Top?e-t:n===G.Bottom?e+t:e,ns="react-flow__edgeupdater";function rs({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:s,onMouseOut:i,type:a}){return d.jsx("circle",{onMouseDown:o,onMouseEnter:s,onMouseOut:i,className:de([ns,`${ns}-${a}`]),cx:Lg(t,r,e),cy:Hg(n,r,e),r,stroke:"transparent",fill:"transparent"})}function Fg({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:s,targetY:i,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:f,onReconnectEnd:h,setReconnecting:u,setUpdateHover:g}){const y=ie(),p=(w,k)=>{if(w.button!==0)return;const{autoPanOnConnect:S,domNode:I,isValidConnection:j,connectionMode:E,connectionRadius:L,lib:V,onConnectStart:$,onConnectEnd:T,cancelConnection:v,nodeLookup:P,rfId:C,panBy:_,updateConnection:M}=y.getState(),z=k.type==="target",D=(O,B)=>{u(!1),h==null||h(O,n,k.type,B)},R=O=>l==null?void 0:l(n,O),H=(O,B)=>{u(!0),f==null||f(w,n,k.type),$==null||$(O,B)};Nr.onPointerDown(w.nativeEvent,{autoPanOnConnect:S,connectionMode:E,connectionRadius:L,domNode:I,handleId:k.id,nodeId:k.nodeId,nodeLookup:P,isTarget:z,edgeUpdaterType:k.type,lib:V,flowId:C,cancelConnection:v,panBy:_,isValidConnection:j,onConnect:R,onConnectStart:H,onConnectEnd:T,onReconnectEnd:D,updateConnection:M,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,dragThreshold:y.getState().connectionDragThreshold,handleDomNode:w.currentTarget})},x=w=>p(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=w=>p(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),N=()=>g(!0),m=()=>g(!1);return d.jsxs(d.Fragment,{children:[(e===!0||e==="source")&&d.jsx(rs,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:x,onMouseEnter:N,onMouseOut:m,type:"source"}),(e===!0||e==="target")&&d.jsx(rs,{position:c,centerX:s,centerY:i,radius:t,onMouseDown:b,onMouseEnter:N,onMouseOut:m,type:"target"})]})}function Bg({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:f,onReconnect:h,onReconnectStart:u,onReconnectEnd:g,rfId:y,edgeTypes:p,noPanClassName:x,onError:b,disableKeyboardA11y:N}){let m=re(K=>K.edgeLookup.get(e));const w=re(K=>K.defaultEdgeOptions);m=w?{...w,...m}:m;let k=m.type||"default",S=(p==null?void 0:p[k])||es[k];S===void 0&&(b==null||b("011",_e.error011(k)),k="default",S=(p==null?void 0:p.default)||es.default);const I=!!(m.focusable||t&&typeof m.focusable>"u"),j=typeof h<"u"&&(m.reconnectable||n&&typeof m.reconnectable>"u"),E=!!(m.selectable||r&&typeof m.selectable>"u"),L=A.useRef(null),[V,$]=A.useState(!1),[T,v]=A.useState(!1),P=ie(),{zIndex:C,sourceX:_,sourceY:M,targetX:z,targetY:D,sourcePosition:R,targetPosition:H}=re(A.useCallback(K=>{const Q=K.nodeLookup.get(m.source),J=K.nodeLookup.get(m.target);if(!Q||!J)return{zIndex:m.zIndex,...ts};const se=Wf({id:e,sourceNode:Q,targetNode:J,sourceHandle:m.sourceHandle||null,targetHandle:m.targetHandle||null,connectionMode:K.connectionMode,onError:b});return{zIndex:Lf({selected:m.selected,zIndex:m.zIndex,sourceNode:Q,targetNode:J,elevateOnSelect:K.elevateEdgesOnSelect}),...se||ts}},[m.source,m.target,m.sourceHandle,m.targetHandle,m.selected,m.zIndex]),ce),O=A.useMemo(()=>m.markerStart?`url('#${wr(m.markerStart,y)}')`:void 0,[m.markerStart,y]),B=A.useMemo(()=>m.markerEnd?`url('#${wr(m.markerEnd,y)}')`:void 0,[m.markerEnd,y]);if(m.hidden||_===null||M===null||z===null||D===null)return null;const q=K=>{var ae;const{addSelectedEdges:Q,unselectNodesAndEdges:J,multiSelectionActive:se}=P.getState();E&&(P.setState({nodesSelectionActive:!1}),m.selected&&se?(J({nodes:[],edges:[m]}),(ae=L.current)==null||ae.blur()):Q([e])),o&&o(K,m)},Z=s?K=>{s(K,{...m})}:void 0,X=i?K=>{i(K,{...m})}:void 0,F=a?K=>{a(K,{...m})}:void 0,U=c?K=>{c(K,{...m})}:void 0,ee=l?K=>{l(K,{...m})}:void 0,te=K=>{var Q;if(!N&&Zs.includes(K.key)&&E){const{unselectNodesAndEdges:J,addSelectedEdges:se}=P.getState();K.key==="Escape"?((Q=L.current)==null||Q.blur(),J({edges:[m]})):se([e])}};return d.jsx("svg",{style:{zIndex:C},children:d.jsxs("g",{className:de(["react-flow__edge",`react-flow__edge-${k}`,m.className,x,{selected:m.selected,animated:m.animated,inactive:!E&&!o,updating:V,selectable:E}]),onClick:q,onDoubleClick:Z,onContextMenu:X,onMouseEnter:F,onMouseMove:U,onMouseLeave:ee,onKeyDown:I?te:void 0,tabIndex:I?0:void 0,role:m.ariaRole??(I?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":m.ariaLabel===null?void 0:m.ariaLabel||`Edge from ${m.source} to ${m.target}`,"aria-describedby":I?`${_i}-${y}`:void 0,ref:L,...m.domAttributes,children:[!T&&d.jsx(S,{id:e,source:m.source,target:m.target,type:m.type,selected:m.selected,animated:m.animated,selectable:E,deletable:m.deletable??!0,label:m.label,labelStyle:m.labelStyle,labelShowBg:m.labelShowBg,labelBgStyle:m.labelBgStyle,labelBgPadding:m.labelBgPadding,labelBgBorderRadius:m.labelBgBorderRadius,sourceX:_,sourceY:M,targetX:z,targetY:D,sourcePosition:R,targetPosition:H,data:m.data,style:m.style,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle,markerStart:O,markerEnd:B,pathOptions:"pathOptions"in m?m.pathOptions:void 0,interactionWidth:m.interactionWidth}),j&&d.jsx(Fg,{edge:m,isReconnectable:j,reconnectRadius:f,onReconnect:h,onReconnectStart:u,onReconnectEnd:g,sourceX:_,sourceY:M,targetX:z,targetY:D,sourcePosition:R,targetPosition:H,setUpdateHover:$,setReconnecting:v})]})})}const Og=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function ea({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:f,reconnectRadius:h,onEdgeDoubleClick:u,onReconnectStart:g,onReconnectEnd:y,disableKeyboardA11y:p}){const{edgesFocusable:x,edgesReconnectable:b,elementsSelectable:N,onError:m}=re(Og,ce),w=_g(t);return d.jsxs("div",{className:"react-flow__edges",children:[d.jsx(Ag,{defaultColor:e,rfId:n}),w.map(k=>d.jsx(Bg,{id:k,edgesFocusable:x,edgesReconnectable:b,elementsSelectable:N,noPanClassName:o,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:f,reconnectRadius:h,onDoubleClick:u,onReconnectStart:g,onReconnectEnd:y,rfId:n,onError:m,edgeTypes:r,disableKeyboardA11y:p},k))]})}ea.displayName="EdgeRenderer";const Xg=A.memo(ea),Yg=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Wg({children:e}){const t=re(Yg);return d.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Gg(e){const t=Wn(),n=A.useRef(!1);A.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Ug=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function qg(e){const t=re(Ug),n=ie();return A.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function os(e){return e.connection.inProgress?{...e.connection,to:Jt(e.connection.to,e.transform)}:{...e.connection}}function Kg(e){return e?n=>{const r=os(n);return e(r)}:os}function Zg(e){const t=Kg(e);return re(t,ce)}const Qg=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Jg({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:s,height:i,isValid:a,inProgress:c}=re(Qg,ce);return!(s&&o&&c)?null:d.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:d.jsx("g",{className:de(["react-flow__connection",ei(a)]),children:d.jsx(ta,{style:t,type:n,CustomComponent:r,isValid:a})})})}const ta=({style:e,type:t=ke.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:s,fromNode:i,fromHandle:a,fromPosition:c,to:l,toNode:f,toHandle:h,toPosition:u}=Zg();if(!o)return;if(n)return d.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:u,connectionStatus:ei(r),toNode:f,toHandle:h});let g="";const y={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:u};switch(t){case ke.Bezier:[g]=fi(y);break;case ke.SimpleBezier:[g]=Bi(y);break;case ke.Step:[g]=br({...y,borderRadius:0});break;case ke.SmoothStep:[g]=br(y);break;default:[g]=mi(y)}return d.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};ta.displayName="ConnectionLine";const em={};function ss(e=em){A.useRef(e),ie(),A.useEffect(()=>{},[e])}function tm(){ie(),A.useRef(!1),A.useEffect(()=>{},[])}function na({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:f,onSelectionContextMenu:h,onSelectionStart:u,onSelectionEnd:g,connectionLineType:y,connectionLineStyle:p,connectionLineComponent:x,connectionLineContainerStyle:b,selectionKeyCode:N,selectionOnDrag:m,selectionMode:w,multiSelectionKeyCode:k,panActivationKeyCode:S,zoomActivationKeyCode:I,deleteKeyCode:j,onlyRenderVisibleElements:E,elementsSelectable:L,defaultViewport:V,translateExtent:$,minZoom:T,maxZoom:v,preventScrolling:P,defaultMarkerColor:C,zoomOnScroll:_,zoomOnPinch:M,panOnScroll:z,panOnScrollSpeed:D,panOnScrollMode:R,zoomOnDoubleClick:H,panOnDrag:O,onPaneClick:B,onPaneMouseEnter:q,onPaneMouseMove:Z,onPaneMouseLeave:X,onPaneScroll:F,onPaneContextMenu:U,paneClickDistance:ee,nodeClickDistance:te,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:se,reconnectRadius:ae,onReconnect:be,onReconnectStart:tt,onReconnectEnd:en,noDragClassName:tn,noWheelClassName:nn,noPanClassName:Ct,disableKeyboardA11y:kt,nodeExtent:Kn,rfId:rn,viewport:nt,onViewportChange:Et}){return ss(e),ss(t),tm(),Gg(n),qg(nt),d.jsx(bg,{onPaneClick:B,onPaneMouseEnter:q,onPaneMouseMove:Z,onPaneMouseLeave:X,onPaneContextMenu:U,onPaneScroll:F,paneClickDistance:ee,deleteKeyCode:j,selectionKeyCode:N,selectionOnDrag:m,selectionMode:w,onSelectionStart:u,onSelectionEnd:g,multiSelectionKeyCode:k,panActivationKeyCode:S,zoomActivationKeyCode:I,elementsSelectable:L,zoomOnScroll:_,zoomOnPinch:M,zoomOnDoubleClick:H,panOnScroll:z,panOnScrollSpeed:D,panOnScrollMode:R,panOnDrag:O,defaultViewport:V,translateExtent:$,minZoom:T,maxZoom:v,onSelectionContextMenu:h,preventScrolling:P,noDragClassName:tn,noWheelClassName:nn,noPanClassName:Ct,disableKeyboardA11y:kt,onViewportChange:Et,isControlledViewport:!!nt,children:d.jsxs(Wg,{children:[d.jsx(Xg,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:i,onReconnect:be,onReconnectStart:tt,onReconnectEnd:en,onlyRenderVisibleElements:E,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:se,reconnectRadius:ae,defaultMarkerColor:C,noPanClassName:Ct,disableKeyboardA11y:kt,rfId:rn}),d.jsx(Jg,{style:p,type:y,component:x,containerStyle:b}),d.jsx("div",{className:"react-flow__edgelabel-renderer"}),d.jsx(jg,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:f,nodeClickDistance:te,onlyRenderVisibleElements:E,noPanClassName:Ct,noDragClassName:tn,disableKeyboardA11y:kt,nodeExtent:Kn,rfId:rn}),d.jsx("div",{className:"react-flow__viewport-portal"})]})})}na.displayName="GraphView";const nm=A.memo(na),is=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c=.5,maxZoom:l=2,nodeOrigin:f,nodeExtent:h}={})=>{const u=new Map,g=new Map,y=new Map,p=new Map,x=r??t??[],b=n??e??[],N=f??[0,0],m=h??Lt;xi(y,p,x);const w=vr(b,u,g,{nodeOrigin:N,nodeExtent:m,elevateNodesOnSelect:!1});let k=[0,0,1];if(i&&o&&s){const S=Zt(u,{filter:L=>!!((L.width||L.initialWidth)&&(L.height||L.initialHeight))}),{x:I,y:j,zoom:E}=Fr(S,o,s,c,l,(a==null?void 0:a.padding)??.1);k=[I,j,E]}return{rfId:"1",width:0,height:0,transform:k,nodes:b,nodesInitialized:w,nodeLookup:u,parentLookup:g,edges:x,edgeLookup:p,connectionLookup:y,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:c,maxZoom:l,translateExtent:Lt,nodeExtent:m,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:mt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:N,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Js},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Af,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Qs}},rm=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:f,nodeExtent:h})=>Tc((u,g)=>{async function y(){const{nodeLookup:p,panZoom:x,fitViewOptions:b,fitViewResolver:N,width:m,height:w,minZoom:k,maxZoom:S}=g();x&&(await Pf({nodes:p,width:m,height:w,panZoom:x,minZoom:k,maxZoom:S},b),N==null||N.resolve(!0),u({fitViewResolver:null}))}return{...is({nodes:e,edges:t,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:f,nodeExtent:h,defaultNodes:n,defaultEdges:r}),setNodes:p=>{const{nodeLookup:x,parentLookup:b,nodeOrigin:N,elevateNodesOnSelect:m,fitViewQueued:w}=g(),k=vr(p,x,b,{nodeOrigin:N,nodeExtent:h,elevateNodesOnSelect:m,checkEquality:!0});w&&k?(y(),u({nodes:p,nodesInitialized:k,fitViewQueued:!1,fitViewOptions:void 0})):u({nodes:p,nodesInitialized:k})},setEdges:p=>{const{connectionLookup:x,edgeLookup:b}=g();xi(x,b,p),u({edges:p})},setDefaultNodesAndEdges:(p,x)=>{if(p){const{setNodes:b}=g();b(p),u({hasDefaultNodes:!0})}if(x){const{setEdges:b}=g();b(x),u({hasDefaultEdges:!0})}},updateNodeInternals:p=>{const{triggerNodeChanges:x,nodeLookup:b,parentLookup:N,domNode:m,nodeOrigin:w,nodeExtent:k,debug:S,fitViewQueued:I}=g(),{changes:j,updatedInternals:E}=Qf(p,b,N,m,w,k);E&&(qf(b,N,{nodeOrigin:w,nodeExtent:k}),I?(y(),u({fitViewQueued:!1,fitViewOptions:void 0})):u({}),(j==null?void 0:j.length)>0&&(S&&console.log("React Flow: trigger node changes",j),x==null||x(j)))},updateNodePositions:(p,x=!1)=>{const b=[],N=[],{nodeLookup:m,triggerNodeChanges:w}=g();for(const[k,S]of p){const I=m.get(k),j=!!(I!=null&&I.expandParent&&(I!=null&&I.parentId)&&(S!=null&&S.position)),E={id:k,type:"position",position:j?{x:Math.max(0,S.position.x),y:Math.max(0,S.position.y)}:S.position,dragging:x};j&&I.parentId&&b.push({id:k,parentId:I.parentId,rect:{...S.internals.positionAbsolute,width:S.measured.width??0,height:S.measured.height??0}}),N.push(E)}if(b.length>0){const{parentLookup:k,nodeOrigin:S}=g(),I=Wr(b,m,k,S);N.push(...I)}w(N)},triggerNodeChanges:p=>{const{onNodesChange:x,setNodes:b,nodes:N,hasDefaultNodes:m,debug:w}=g();if(p!=null&&p.length){if(m){const k=Pi(p,N);b(k)}w&&console.log("React Flow: trigger node changes",p),x==null||x(p)}},triggerEdgeChanges:p=>{const{onEdgesChange:x,setEdges:b,edges:N,hasDefaultEdges:m,debug:w}=g();if(p!=null&&p.length){if(m){const k=Ii(p,N);b(k)}w&&console.log("React Flow: trigger edge changes",p),x==null||x(p)}},addSelectedNodes:p=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:N,triggerNodeChanges:m,triggerEdgeChanges:w}=g();if(x){const k=p.map(S=>Ge(S,!0));m(k);return}m(at(N,new Set([...p]),!0)),w(at(b))},addSelectedEdges:p=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:N,triggerNodeChanges:m,triggerEdgeChanges:w}=g();if(x){const k=p.map(S=>Ge(S,!0));w(k);return}w(at(b,new Set([...p]))),m(at(N,new Set,!0))},unselectNodesAndEdges:({nodes:p,edges:x}={})=>{const{edges:b,nodes:N,nodeLookup:m,triggerNodeChanges:w,triggerEdgeChanges:k}=g(),S=p||N,I=x||b,j=S.map(L=>{const V=m.get(L.id);return V&&(V.selected=!1),Ge(L.id,!1)}),E=I.map(L=>Ge(L.id,!1));w(j),k(E)},setMinZoom:p=>{const{panZoom:x,maxZoom:b}=g();x==null||x.setScaleExtent([p,b]),u({minZoom:p})},setMaxZoom:p=>{const{panZoom:x,minZoom:b}=g();x==null||x.setScaleExtent([b,p]),u({maxZoom:p})},setTranslateExtent:p=>{var x;(x=g().panZoom)==null||x.setTranslateExtent(p),u({translateExtent:p})},setPaneClickDistance:p=>{var x;(x=g().panZoom)==null||x.setClickDistance(p)},resetSelectedElements:()=>{const{edges:p,nodes:x,triggerNodeChanges:b,triggerEdgeChanges:N,elementsSelectable:m}=g();if(!m)return;const w=x.reduce((S,I)=>I.selected?[...S,Ge(I.id,!1)]:S,[]),k=p.reduce((S,I)=>I.selected?[...S,Ge(I.id,!1)]:S,[]);b(w),N(k)},setNodeExtent:p=>{const{nodes:x,nodeLookup:b,parentLookup:N,nodeOrigin:m,elevateNodesOnSelect:w,nodeExtent:k}=g();p[0][0]===k[0][0]&&p[0][1]===k[0][1]&&p[1][0]===k[1][0]&&p[1][1]===k[1][1]||(vr(x,b,N,{nodeOrigin:m,nodeExtent:p,elevateNodesOnSelect:w,checkEquality:!1}),u({nodeExtent:p}))},panBy:p=>{const{transform:x,width:b,height:N,panZoom:m,translateExtent:w}=g();return Jf({delta:p,panZoom:m,transform:x,translateExtent:w,width:b,height:N})},setCenter:async(p,x,b)=>{const{width:N,height:m,maxZoom:w,panZoom:k}=g();if(!k)return Promise.resolve(!1);const S=typeof(b==null?void 0:b.zoom)<"u"?b.zoom:w;return await k.setViewport({x:N/2-p*S,y:m/2-x*S,zoom:S},{duration:b==null?void 0:b.duration,ease:b==null?void 0:b.ease,interpolate:b==null?void 0:b.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{u({connection:{...Js}})},updateConnection:p=>{u({connection:p})},reset:()=>u({...is()})}},Object.is);function Ur({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:s,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:c,fitView:l,nodeOrigin:f,nodeExtent:h,children:u}){const[g]=A.useState(()=>rm({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:l,minZoom:i,maxZoom:a,fitViewOptions:c,nodeOrigin:f,nodeExtent:h}));return d.jsx(kh,{value:g,children:d.jsx(Uh,{children:u})})}function om({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:s,height:i,fitView:a,fitViewOptions:c,minZoom:l,maxZoom:f,nodeOrigin:h,nodeExtent:u}){return A.useContext(Xn)?d.jsx(d.Fragment,{children:e}):d.jsx(Ur,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:s,initialHeight:i,fitView:a,initialFitViewOptions:c,initialMinZoom:l,initialMaxZoom:f,nodeOrigin:h,nodeExtent:u,children:e})}const sm={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function im({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:f,onMoveStart:h,onMoveEnd:u,onConnect:g,onConnectStart:y,onConnectEnd:p,onClickConnectStart:x,onClickConnectEnd:b,onNodeMouseEnter:N,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:k,onNodeDoubleClick:S,onNodeDragStart:I,onNodeDrag:j,onNodeDragStop:E,onNodesDelete:L,onEdgesDelete:V,onDelete:$,onSelectionChange:T,onSelectionDragStart:v,onSelectionDrag:P,onSelectionDragStop:C,onSelectionContextMenu:_,onSelectionStart:M,onSelectionEnd:z,onBeforeDelete:D,connectionMode:R,connectionLineType:H=ke.Bezier,connectionLineStyle:O,connectionLineComponent:B,connectionLineContainerStyle:q,deleteKeyCode:Z="Backspace",selectionKeyCode:X="Shift",selectionOnDrag:F=!1,selectionMode:U=Ht.Full,panActivationKeyCode:ee="Space",multiSelectionKeyCode:te=Bt()?"Meta":"Control",zoomActivationKeyCode:K=Bt()?"Meta":"Control",snapToGrid:Q,snapGrid:J,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:ae,nodesDraggable:be,autoPanOnNodeFocus:tt,nodesConnectable:en,nodesFocusable:tn,nodeOrigin:nn=Mi,edgesFocusable:Ct,edgesReconnectable:kt,elementsSelectable:Kn=!0,defaultViewport:rn=Rh,minZoom:nt=.5,maxZoom:Et=2,translateExtent:Kr=Lt,preventScrolling:_a=!0,nodeExtent:Zn,defaultMarkerColor:Ma="#b1b1b7",zoomOnScroll:za=!0,zoomOnPinch:Pa=!0,panOnScroll:Ia=!1,panOnScrollSpeed:Aa=.5,panOnScrollMode:$a=Ke.Free,zoomOnDoubleClick:Ta=!0,panOnDrag:Da=!0,onPaneClick:Va,onPaneMouseEnter:Ra,onPaneMouseMove:La,onPaneMouseLeave:Ha,onPaneScroll:Fa,onPaneContextMenu:Ba,paneClickDistance:Zr=0,nodeClickDistance:Oa=0,children:Xa,onReconnect:Ya,onReconnectStart:Wa,onReconnectEnd:Ga,onEdgeContextMenu:Ua,onEdgeDoubleClick:qa,onEdgeMouseEnter:Ka,onEdgeMouseMove:Za,onEdgeMouseLeave:Qa,reconnectRadius:Ja=10,onNodesChange:ec,onEdgesChange:tc,noDragClassName:nc="nodrag",noWheelClassName:rc="nowheel",noPanClassName:Qr="nopan",fitView:Jr,fitViewOptions:eo,connectOnClick:oc,attributionPosition:sc,proOptions:ic,defaultEdgeOptions:ac,elevateNodesOnSelect:cc,elevateEdgesOnSelect:lc,disableKeyboardA11y:to=!1,autoPanOnConnect:dc,autoPanOnNodeDrag:uc,autoPanSpeed:fc,connectionRadius:hc,isValidConnection:gc,onError:mc,style:pc,id:no,nodeDragThreshold:xc,connectionDragThreshold:yc,viewport:bc,onViewportChange:wc,width:vc,height:Nc,colorMode:Sc="light",debug:Cc,onScroll:on,ariaLabelConfig:kc,...Ec},jc){const Qn=no||"1",_c=Bh(Sc),Mc=A.useCallback(ro=>{ro.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),on==null||on(ro)},[on]);return d.jsx("div",{"data-testid":"rf__wrapper",...Ec,onScroll:Mc,style:{...pc,...sm},ref:jc,className:de(["react-flow",o,_c]),id:no,role:"application",children:d.jsxs(om,{nodes:e,edges:t,width:vc,height:Nc,fitView:Jr,fitViewOptions:eo,minZoom:nt,maxZoom:Et,nodeOrigin:nn,nodeExtent:Zn,children:[d.jsx(nm,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:N,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:k,onNodeDoubleClick:S,nodeTypes:s,edgeTypes:i,connectionLineType:H,connectionLineStyle:O,connectionLineComponent:B,connectionLineContainerStyle:q,selectionKeyCode:X,selectionOnDrag:F,selectionMode:U,deleteKeyCode:Z,multiSelectionKeyCode:te,panActivationKeyCode:ee,zoomActivationKeyCode:K,onlyRenderVisibleElements:se,defaultViewport:rn,translateExtent:Kr,minZoom:nt,maxZoom:Et,preventScrolling:_a,zoomOnScroll:za,zoomOnPinch:Pa,zoomOnDoubleClick:Ta,panOnScroll:Ia,panOnScrollSpeed:Aa,panOnScrollMode:$a,panOnDrag:Da,onPaneClick:Va,onPaneMouseEnter:Ra,onPaneMouseMove:La,onPaneMouseLeave:Ha,onPaneScroll:Fa,onPaneContextMenu:Ba,paneClickDistance:Zr,nodeClickDistance:Oa,onSelectionContextMenu:_,onSelectionStart:M,onSelectionEnd:z,onReconnect:Ya,onReconnectStart:Wa,onReconnectEnd:Ga,onEdgeContextMenu:Ua,onEdgeDoubleClick:qa,onEdgeMouseEnter:Ka,onEdgeMouseMove:Za,onEdgeMouseLeave:Qa,reconnectRadius:Ja,defaultMarkerColor:Ma,noDragClassName:nc,noWheelClassName:rc,noPanClassName:Qr,rfId:Qn,disableKeyboardA11y:to,nodeExtent:Zn,viewport:bc,onViewportChange:wc}),d.jsx(Fh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:g,onConnectStart:y,onConnectEnd:p,onClickConnectStart:x,onClickConnectEnd:b,nodesDraggable:be,autoPanOnNodeFocus:tt,nodesConnectable:en,nodesFocusable:tn,edgesFocusable:Ct,edgesReconnectable:kt,elementsSelectable:Kn,elevateNodesOnSelect:cc,elevateEdgesOnSelect:lc,minZoom:nt,maxZoom:Et,nodeExtent:Zn,onNodesChange:ec,onEdgesChange:tc,snapToGrid:Q,snapGrid:J,connectionMode:R,translateExtent:Kr,connectOnClick:oc,defaultEdgeOptions:ac,fitView:Jr,fitViewOptions:eo,onNodesDelete:L,onEdgesDelete:V,onDelete:$,onNodeDragStart:I,onNodeDrag:j,onNodeDragStop:E,onSelectionDrag:P,onSelectionDragStart:v,onSelectionDragStop:C,onMove:f,onMoveStart:h,onMoveEnd:u,noPanClassName:Qr,nodeOrigin:nn,rfId:Qn,autoPanOnConnect:dc,autoPanOnNodeDrag:uc,autoPanSpeed:fc,onError:mc,connectionRadius:hc,isValidConnection:gc,selectNodesOnDrag:ae,nodeDragThreshold:xc,connectionDragThreshold:yc,onBeforeDelete:D,paneClickDistance:Zr,debug:Cc,ariaLabelConfig:kc}),d.jsx(Vh,{onSelectionChange:T}),Xa,d.jsx(Ih,{proOptions:ic,position:sc}),d.jsx(Ph,{rfId:Qn,disableKeyboardA11y:to})]})})}var ra=Ai(im);function am({onChange:e}){const t=ie();A.useEffect(()=>{const n=[...t.getState().onSelectionChangeHandlers,e];return t.setState({onSelectionChangeHandlers:n}),()=>{const r=t.getState().onSelectionChangeHandlers.filter(o=>o!==e);t.setState({onSelectionChangeHandlers:r})}},[e])}function cm({dimensions:e,lineWidth:t,variant:n,className:r}){return d.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:de(["react-flow__background-pattern",n,r])})}function lm({radius:e,className:t}){return d.jsx("circle",{cx:e,cy:e,r:e,className:de(["react-flow__background-pattern","dots",t])})}var Fe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Fe||(Fe={}));const dm={[Fe.Dots]:1,[Fe.Lines]:1,[Fe.Cross]:6},um=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function oa({id:e,variant:t=Fe.Dots,gap:n=20,size:r,lineWidth:o=1,offset:s=0,color:i,bgColor:a,style:c,className:l,patternClassName:f}){const h=A.useRef(null),{transform:u,patternId:g}=re(um,ce),y=r||dm[t],p=t===Fe.Dots,x=t===Fe.Cross,b=Array.isArray(n)?n:[n,n],N=[b[0]*u[2]||1,b[1]*u[2]||1],m=y*u[2],w=Array.isArray(s)?s:[s,s],k=x?[m,m]:N,S=[w[0]*u[2]||1+k[0]/2,w[1]*u[2]||1+k[1]/2],I=`${g}${e||""}`;return d.jsxs("svg",{className:de(["react-flow__background",l]),style:{...c,...Gn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:h,"data-testid":"rf__background",children:[d.jsx("pattern",{id:I,x:u[0]%N[0],y:u[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:p?d.jsx(lm,{radius:m/2,className:f}):d.jsx(cm,{dimensions:k,lineWidth:o,variant:t,className:f})}),d.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${I})`})]})}oa.displayName="Background";const sa=A.memo(oa);function fm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:d.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function hm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:d.jsx("path",{d:"M0 0h32v4.2H0z"})})}function gm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:d.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function mm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:d.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function pm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:d.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function gn({children:e,className:t,...n}){return d.jsx("button",{type:"button",className:de(["react-flow__controls-button",t]),...n,children:e})}const xm=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ia({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:c,className:l,children:f,position:h="bottom-left",orientation:u="vertical","aria-label":g}){const y=ie(),{isInteractive:p,minZoomReached:x,maxZoomReached:b,ariaLabelConfig:N}=re(xm,ce),{zoomIn:m,zoomOut:w,fitView:k}=Wn(),S=()=>{m(),s==null||s()},I=()=>{w(),i==null||i()},j=()=>{k(o),a==null||a()},E=()=>{y.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),c==null||c(!p)},L=u==="horizontal"?"horizontal":"vertical";return d.jsxs(Yn,{className:de(["react-flow__controls",L,l]),position:h,style:e,"data-testid":"rf__controls","aria-label":g??N["controls.ariaLabel"],children:[t&&d.jsxs(d.Fragment,{children:[d.jsx(gn,{onClick:S,className:"react-flow__controls-zoomin",title:N["controls.zoomIn.ariaLabel"],"aria-label":N["controls.zoomIn.ariaLabel"],disabled:b,children:d.jsx(fm,{})}),d.jsx(gn,{onClick:I,className:"react-flow__controls-zoomout",title:N["controls.zoomOut.ariaLabel"],"aria-label":N["controls.zoomOut.ariaLabel"],disabled:x,children:d.jsx(hm,{})})]}),n&&d.jsx(gn,{className:"react-flow__controls-fitview",onClick:j,title:N["controls.fitView.ariaLabel"],"aria-label":N["controls.fitView.ariaLabel"],children:d.jsx(gm,{})}),r&&d.jsx(gn,{className:"react-flow__controls-interactive",onClick:E,title:N["controls.interactive.ariaLabel"],"aria-label":N["controls.interactive.ariaLabel"],children:p?d.jsx(pm,{}):d.jsx(mm,{})}),f]})}ia.displayName="Controls";const aa=A.memo(ia);function ym({id:e,x:t,y:n,width:r,height:o,style:s,color:i,strokeColor:a,strokeWidth:c,className:l,borderRadius:f,shapeRendering:h,selected:u,onClick:g}){const{background:y,backgroundColor:p}=s||{},x=i||y||p;return d.jsx("rect",{className:de(["react-flow__minimap-node",{selected:u},l]),x:t,y:n,rx:f,ry:f,width:r,height:o,style:{fill:x,stroke:a,strokeWidth:c},shapeRendering:h,onClick:g?b=>g(b,e):void 0})}const bm=A.memo(ym),wm=e=>e.nodes.map(t=>t.id),ar=e=>e instanceof Function?e:()=>e;function vm({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:s=bm,onClick:i}){const a=re(wm,ce),c=ar(t),l=ar(e),f=ar(n),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return d.jsx(d.Fragment,{children:a.map(u=>d.jsx(Sm,{id:u,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:f,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:s,onClick:i,shapeRendering:h},u))})}function Nm({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:c}){const{node:l,x:f,y:h,width:u,height:g}=re(y=>{const{internals:p}=y.nodeLookup.get(e),x=p.userNode,{x:b,y:N}=p.positionAbsolute,{width:m,height:w}=De(x);return{node:x,x:b,y:N,width:m,height:w}},ce);return!l||l.hidden||!ii(l)?null:d.jsx(a,{x:f,y:h,width:u,height:g,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:o,strokeColor:n(l),strokeWidth:s,shapeRendering:i,onClick:c,id:l.id})}const Sm=A.memo(Nm);var Cm=A.memo(vm);const km=200,Em=150,jm=e=>!e.hidden,_m=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?si(Zt(e.nodeLookup,{filter:jm}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Mm="react-flow__minimap-desc";function ca({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:f,maskStrokeWidth:h,position:u="bottom-right",onClick:g,onNodeClick:y,pannable:p=!1,zoomable:x=!1,ariaLabel:b,inversePan:N,zoomStep:m=1,offsetScale:w=5}){const k=ie(),S=A.useRef(null),{boundingRect:I,viewBB:j,rfId:E,panZoom:L,translateExtent:V,flowWidth:$,flowHeight:T,ariaLabelConfig:v}=re(_m,ce),P=(e==null?void 0:e.width)??km,C=(e==null?void 0:e.height)??Em,_=I.width/P,M=I.height/C,z=Math.max(_,M),D=z*P,R=z*C,H=w*z,O=I.x-(D-I.width)/2-H,B=I.y-(R-I.height)/2-H,q=D+H*2,Z=R+H*2,X=`${Mm}-${E}`,F=A.useRef(0),U=A.useRef();F.current=z,A.useEffect(()=>{if(S.current&&L)return U.current=ch({domNode:S.current,panZoom:L,getTransform:()=>k.getState().transform,getViewScale:()=>F.current}),()=>{var Q;(Q=U.current)==null||Q.destroy()}},[L]),A.useEffect(()=>{var Q;(Q=U.current)==null||Q.update({translateExtent:V,width:$,height:T,inversePan:N,pannable:p,zoomStep:m,zoomable:x})},[p,x,N,m,V,$,T]);const ee=g?Q=>{var ae;const[J,se]=((ae=U.current)==null?void 0:ae.pointer(Q))||[0,0];g(Q,{x:J,y:se})}:void 0,te=y?A.useCallback((Q,J)=>{const se=k.getState().nodeLookup.get(J).internals.userNode;y(Q,se)},[]):void 0,K=b??v["minimap.ariaLabel"];return d.jsx(Yn,{position:u,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-stroke-width-props":typeof h=="number"?h*z:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:de(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:d.jsxs("svg",{width:P,height:C,viewBox:`${O} ${B} ${q} ${Z}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":X,ref:S,onClick:ee,children:[K&&d.jsx("title",{id:X,children:K}),d.jsx(Cm,{onClick:te,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:a}),d.jsx("path",{className:"react-flow__minimap-mask",d:`M${O-H},${B-H}h${q+H*2}v${Z+H*2}h${-q-H*2}z
        M${j.x},${j.y}h${j.width}v${j.height}h${-j.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}ca.displayName="MiniMap";const la=A.memo(ca),zm=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Pm={[wt.Line]:"right",[wt.Handle]:"bottom-right"};function Im({nodeId:e,position:t,variant:n=wt.Handle,className:r,style:o=void 0,children:s,color:i,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:f=Number.MAX_VALUE,keepAspectRatio:h=!1,resizeDirection:u,autoScale:g=!0,shouldResize:y,onResizeStart:p,onResize:x,onResizeEnd:b}){const N=Vi(),m=typeof e=="string"?e:N,w=ie(),k=A.useRef(null),S=n===wt.Handle,I=re(A.useCallback(zm(S&&g),[S,g]),ce),j=A.useRef(null),E=t??Pm[n];A.useEffect(()=>{if(!(!k.current||!m))return j.current||(j.current=Ch({domNode:k.current,nodeId:m,getStoreItems:()=>{const{nodeLookup:V,transform:$,snapGrid:T,snapToGrid:v,nodeOrigin:P,domNode:C}=w.getState();return{nodeLookup:V,transform:$,snapGrid:T,snapToGrid:v,nodeOrigin:P,paneDomNode:C}},onChange:(V,$)=>{const{triggerNodeChanges:T,nodeLookup:v,parentLookup:P,nodeOrigin:C}=w.getState(),_=[],M={x:V.x,y:V.y},z=v.get(m);if(z&&z.expandParent&&z.parentId){const D=z.origin??C,R=V.width??z.measured.width??0,H=V.height??z.measured.height??0,O={id:z.id,parentId:z.parentId,rect:{width:R,height:H,...ai({x:V.x??z.position.x,y:V.y??z.position.y},{width:R,height:H},z.parentId,v,D)}},B=Wr([O],v,P,C);_.push(...B),M.x=V.x?Math.max(D[0]*R,V.x):void 0,M.y=V.y?Math.max(D[1]*H,V.y):void 0}if(M.x!==void 0&&M.y!==void 0){const D={id:m,type:"position",position:{...M}};_.push(D)}if(V.width!==void 0&&V.height!==void 0){const R={id:m,type:"dimensions",resizing:!0,setAttributes:u?u==="horizontal"?"width":"height":!0,dimensions:{width:V.width,height:V.height}};_.push(R)}for(const D of $){const R={...D,type:"position"};_.push(R)}T(_)},onEnd:({width:V,height:$})=>{const T={id:m,type:"dimensions",resizing:!1,dimensions:{width:V,height:$}};w.getState().triggerNodeChanges([T])}})),j.current.update({controlPosition:E,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:f},keepAspectRatio:h,resizeDirection:u,onResizeStart:p,onResize:x,onResizeEnd:b,shouldResize:y}),()=>{var V;(V=j.current)==null||V.destroy()}},[E,a,c,l,f,h,p,x,b,y]);const L=E.split("-");return d.jsx("div",{className:de(["react-flow__resize-control","nodrag",...L,n,r]),ref:k,style:{...o,scale:I,...i&&{[S?"backgroundColor":"borderColor"]:i}},children:s})}A.memo(Im);const He=e=>e.type==="scene",Yt=e=>e.type==="choice",Tn=24,as=(e,t=Tn)=>Math.round(e/t)*t,Cr=e=>({x:as(e.x),y:as(e.y)}),Wt="scene_start",cs=e=>`${e}_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,9)}`,ls=()=>[{id:Wt,type:"scene",position:Cr({x:250,y:250}),data:{label:"Start",durationSec:5},deletable:!1}],oe=Gt()(ps((e,t)=>({nodes:ls(),edges:[],selectedNodeId:null,onNodesChange:n=>e(r=>({nodes:Pi(n,r.nodes)})),onEdgesChange:n=>e(r=>({edges:Ii(n,r.edges)})),addConnection:n=>e(r=>({edges:gi(n,r.edges)})),addChoiceNode:()=>e(n=>{const o={id:cs("choice"),type:"choice",position:Cr({x:0,y:0}),data:{label:`Choice ${n.nodes.filter(s=>s.type==="choice").length+1}`,effects:{}}};return{nodes:[...n.nodes,o],edges:n.edges,selectedNodeId:o.id}}),selectNode:n=>e(r=>r.selectedNodeId===n?r:{selectedNodeId:n}),updateNode:(n,r)=>e(o=>({nodes:o.nodes.map(s=>s.id===n?{...s,data:{...s.data,...r}}:s)})),deleteNode:n=>{n!==Wt&&e(r=>{const o=r.nodes.find(a=>a.id===n);if(!o)return r;const s=[n],i=new Set;return r.edges.forEach(a=>{(a.source===n||a.target===n)&&i.add(a.id)}),He(o)&&r.nodes.forEach(a=>{Yt(a)&&(r.edges.filter(l=>(l.source===a.id||l.target===a.id)&&!i.has(l.id)).length>=2||(s.push(a.id),r.edges.forEach(l=>{(l.source===a.id||l.target===a.id)&&i.add(l.id)})))}),{nodes:r.nodes.filter(a=>!s.includes(a.id)),edges:r.edges.filter(a=>!i.has(a.id)),selectedNodeId:s.includes(r.selectedNodeId||"")?null:r.selectedNodeId}})},addSceneNode:()=>e(n=>{const r=n.nodes.reduce((s,i)=>Math.max(s,i.position.y),250),o={id:cs("scene"),type:"scene",position:Cr({x:400,y:r+100}),data:{label:`Scene ${n.nodes.filter(s=>s.type==="scene").length}`,durationSec:5}};return{nodes:[...n.nodes,o],selectedNodeId:o.id}}),getNode:n=>t().nodes.find(r=>r.id===n),getChoicesForScene:n=>{const r=t();return r.edges.filter(s=>s.source===n).map(s=>r.nodes.find(i=>i.id===s.target)).filter(s=>!!s&&Yt(s))},loadNodes:n=>e({nodes:n,selectedNodeId:null}),loadEdges:n=>e({edges:n}),reset:()=>e({nodes:ls(),edges:[],selectedNodeId:null})}),{name:"flow-storage",partialize:e=>({nodes:e.nodes,edges:e.edges})})),Am=(e,t)=>{var n;return(n=e.find(r=>r.name===t))==null?void 0:n.value},da=(e,t)=>{let n=t;return typeof e.min=="number"&&(n=Math.max(n,e.min)),typeof e.max=="number"&&(n=Math.min(n,e.max)),n},$m=(e,t)=>{const n=Am(t,e.varName);if(typeof n!="number")return!1;switch(e.op){case"lt":return n<e.value;case"lte":return n<=e.value;case"eq":return n===e.value;case"neq":return n!==e.value;case"gte":return n>=e.value;case"gt":return n>e.value;default:return!0}},kr=(e,t)=>!e||e.length===0?!0:e.every(n=>$m(n,t)),Tm=e=>{const t={lt:"<",lte:"≤",eq:"=",neq:"≠",gte:"≥",gt:">"}[e.op];return`${e.varName} ${t} ${e.value}`},Dm=(e,t)=>t.map(n=>{const r=e[n.name]??0;if(r===0)return n;const o=da(n,n.value+r);return{...n,value:o}}),ds=[{name:"health",value:10,initialValue:10},{name:"energy",value:5,initialValue:5}],ye=Gt()(ps(e=>({variables:ds,updateVariable:(t,n)=>e(r=>({variables:r.variables.map(o=>o.name===t?{...o,value:da(o,n)}:o)})),addVariable:t=>e(n=>({variables:[...n.variables,{name:t,value:0,initialValue:0}]})),removeVariable:t=>e(n=>({variables:n.variables.filter(r=>r.name!==t)})),reset:()=>e({variables:ds}),loadVariables:t=>e({variables:t})}),{name:"variables-storage"})),Be=Gt((e,t)=>({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,isPlaying:!1,currentTime:0,duration:0,volume:50,isLoading:!1,setCurrentVideo:(n,r)=>{const o=t();if(o.currentVideoUrl&&URL.revokeObjectURL(o.currentVideoUrl),!r){e({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,currentTime:0,duration:0,isPlaying:!1});return}const s=URL.createObjectURL(r);e({currentVideoId:n,currentVideoFile:r,currentVideoUrl:s,currentTime:0,isPlaying:!1})},setIsPlaying:n=>e({isPlaying:n}),setCurrentTime:n=>e({currentTime:n}),setDuration:n=>e({duration:n}),setVolume:n=>e({volume:n}),setIsLoading:n=>e({isLoading:n}),clearCurrentVideo:()=>{const n=t();n.currentVideoUrl&&URL.revokeObjectURL(n.currentVideoUrl),e({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,currentTime:0,duration:0,isPlaying:!1})}})),$e=Gt((e,t)=>({projectTitle:"Untitled Project",createdAt:new Date().toISOString(),lastSaved:null,isDirty:!1,setProjectTitle:n=>e({projectTitle:n,isDirty:!0}),markAsSaved:()=>e({lastSaved:new Date,isDirty:!1}),markAsDirty:()=>e({isDirty:!0}),exportProject:()=>{const n=oe.getState(),r=ye.getState(),{projectTitle:o,createdAt:s}=t();return{title:o,nodes:n.nodes,edges:n.edges,variables:r.variables,version:"1.0.0",createdAt:s,updatedAt:new Date().toISOString()}},importProject:n=>{oe.getState().loadNodes(n.nodes),oe.getState().loadEdges(n.edges),ye.getState().loadVariables(n.variables),e({projectTitle:n.title,createdAt:n.createdAt??new Date().toISOString(),lastSaved:null,isDirty:!1})},newProject:()=>{oe.getState().reset(),ye.getState().reset(),Be.getState().clearCurrentVideo(),e({projectTitle:"Untitled Project",createdAt:new Date().toISOString(),lastSaved:null,isDirty:!1})}}));class st{static exportProject(){return $e.getState().exportProject()}static downloadProject(t){var a,c;const n=JSON.stringify(t,null,2),r=new Blob([n],{type:"application/json"}),o=URL.createObjectURL(r),s=(c=(a=t.title)==null?void 0:a.trim())!=null&&c.length?t.title.replace(/\s+/g,"_"):"project",i=document.createElement("a");i.href=o,i.download=`${s}_${Date.now()}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)}static async importProject(t){this.validateProjectData(t),$e.getState().importProject(t)}static async loadProjectFromFile(t){return new Promise((n,r)=>{const o=new FileReader;o.onload=s=>{var i;try{const a=(i=s.target)==null?void 0:i.result,c=JSON.parse(a);n(c)}catch{r(new Error("Nieprawidłowy format pliku projektu"))}},o.onerror=()=>r(new Error("Błąd odczytu pliku")),o.readAsText(t)})}static createNewProject(){$e.getState().newProject()}static async getProjectMetadata(t){const n=await this.loadProjectFromFile(t);return{title:n.title,version:n.version,createdAt:n.createdAt||"Nieznana",updatedAt:n.updatedAt||"Nieznana",nodeCount:n.nodes.length,edgeCount:n.edges.length}}static validateProjectData(t){if(!t.title||typeof t.title!="string")throw new Error("Nieprawidłowy projekt: brak tytułu");if(!Array.isArray(t.nodes))throw new Error("Nieprawidłowy projekt: nodes musi być tablicą");if(!Array.isArray(t.edges))throw new Error("Nieprawidłowy projekt: edges musi być tablicą");if(!Array.isArray(t.variables))throw new Error("Nieprawidłowy projekt: variables musi być tablicą");if(t.version&&!this.isVersionCompatible(t.version))throw new Error(`Niezgodna wersja projektu: ${t.version}`)}static isVersionCompatible(t){const[n]=t.split("."),[r]=this.CURRENT_VERSION.split(".");return n===r}}st.CURRENT_VERSION="1.0.0";const ua=(e={})=>{const[t,n]=A.useState(!1),[r,o]=A.useState(!1),s=A.useRef(null),i=$e(u=>u.projectTitle),a=A.useCallback(async()=>{var u;try{o(!0);const g=st.exportProject();st.downloadProject(g),(u=e.onExportSuccess)==null||u.call(e)}catch(g){console.error("Błąd eksportu:",g)}finally{o(!1)}},[e]),c=A.useCallback(async u=>{var g,y;try{n(!0);const p=await st.loadProjectFromFile(u);await st.importProject(p),(g=e.onImportSuccess)==null||g.call(e,p)}catch(p){console.error("Błąd importu:",p),(y=e.onImportError)==null||y.call(e,p)}finally{n(!1)}},[e]),l=A.useCallback(u=>{var y;const g=(y=u.target.files)==null?void 0:y[0];g&&c(g),s.current&&(s.current.value="")},[c]),f=A.useCallback(()=>{var u;(u=s.current)==null||u.click()},[]),h=A.useCallback(()=>e.confirmNewProject&&!confirm("Utworzyć nowy projekt? Niezapisane zmiany zostaną utracone.")?!1:(st.createNewProject(),!0),[e.confirmNewProject]);return{fileInputRef:s,isImporting:t,isExporting:r,projectTitle:i,handleExport:a,handleImport:c,handleFileSelect:l,triggerImport:f,createNewProject:h}},Vm=()=>d.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",className:"group-hover:scale-105 transition-transform",children:[d.jsx("rect",{x:"4",y:"8",width:"24",height:"16",fill:"#E84E36",rx:"1"}),d.jsx("rect",{x:"7",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"11",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"15",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"19",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"23",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"7",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"11",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"15",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"19",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"23",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"8",y:"14.5",width:"4",height:"3",fill:"white",opacity:"0.9"}),d.jsx("rect",{x:"14",y:"14.5",width:"4",height:"3",fill:"white",opacity:"0.9"}),d.jsx("rect",{x:"20",y:"14.5",width:"4",height:"3",fill:"white",opacity:"0.9"})]}),Rm=({tabs:e})=>{const t=zr(),n=e.find(r=>r.path===t.pathname)||e[0];return d.jsx("div",{className:"flex h-full",children:e.map(r=>d.jsxs(zc,{to:r.path,className:`h-full px-8 flex items-center gap-3 transition-all border-r border-[#0a0a0a] ${n.id===r.id?"bg-[#1a1a1a] text-[#E84E36] border-b-2 border-b-[#E84E36]":"bg-transparent text-[#666] border-b-2 border-b-transparent"}`,children:[d.jsx(r.icon,{className:"w-5 h-5"}),d.jsx("span",{className:"font-medium text-sm",children:r.label})]},r.id))})},Lm=()=>{const e=zr(),t=Pr(),n=$e(p=>p.projectTitle),r=$e(p=>p.setProjectTitle),{fileInputRef:o,isImporting:s,isExporting:i,handleExport:a,handleFileSelect:c,triggerImport:l,createNewProject:f}=ua({confirmNewProject:!0,onImportSuccess:p=>{alert(`Projekt "${p.title}" został wczytany pomyślnie!`)},onImportError:p=>{alert(`Błąd wczytywania projektu: ${p.message}`)},onExportSuccess:()=>{console.log("Projekt wyeksportowany pomyślnie")}}),h=()=>{f()},u=()=>{a()},g=[{id:"storymap",path:"/storymap",label:"Story Map",icon:ys},{id:"story",path:"/story",label:"Screen Play",icon:oo},{id:"variables",path:"/variables",label:"Variables",icon:oo},{id:"video",path:"/video",label:"Video",icon:ft},{id:"play",path:"/play",label:"Play",icon:Vc}],y=g.find(p=>p.path===e.pathname)||g[0];return d.jsx(Ur,{children:d.jsxs("div",{className:"h-screen flex flex-col bg-zinc-900 select-none",children:[d.jsx("header",{className:"flex-shrink-0 h-10 bg-gradient-to-b from-zinc-950 to-zinc-900 border-b border-zinc-900",children:d.jsxs("div",{className:"h-full flex items-center",children:[d.jsx("button",{onClick:()=>t("/"),className:"px-3 h-full flex items-center border-r border-zinc-900 hover:bg-zinc-800 transition-colors group",title:"Go to Projects",children:d.jsx(Vm,{})}),d.jsx("div",{className:"flex items-center h-full",children:["File","Edit","Timeline","Workspace","Help"].map(p=>d.jsx("button",{className:"px-4 h-full hover:bg-zinc-800 text-sm text-zinc-400",children:p},p))}),d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsx("input",{type:"text",value:n,onChange:p=>r(p.target.value),className:"bg-transparent text-center font-medium text-zinc-200 text-[13px] outline-none border-none"})}),d.jsx("div",{className:"flex items-center gap-2 px-3",children:d.jsx("button",{onClick:h,className:"p-1.5 hover:bg-zinc-800 rounded",title:"New project",children:d.jsx(ut,{className:"w-4 h-4 text-zinc-400"})})})]})}),d.jsxs("div",{className:"h-12 bg-zinc-800 border-b border-zinc-900 flex items-center",children:[d.jsx(Rm,{tabs:g}),d.jsx("div",{className:"flex-1 flex items-center justify-end px-4 gap-2",children:y.id!=="projects"&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:l,disabled:s,className:"px-3 py-1.5 text-xs font-medium bg-zinc-800 text-zinc-400 border border-zinc-700 transition-colors hover:bg-zinc-700 hover:text-white disabled:opacity-50 flex items-center gap-2",children:[d.jsx(Cn,{className:"w-3 h-3"}),s?"Importing...":"Import"]}),d.jsx("input",{ref:o,type:"file",accept:".json",onChange:c,className:"hidden"}),d.jsxs("button",{onClick:u,disabled:i,className:"px-3 py-1.5 text-xs font-medium bg-zinc-800 text-zinc-400 border border-zinc-700 transition-colors hover:bg-zinc-700 hover:text-white disabled:opacity-50 flex items-center gap-2",children:[d.jsx(xs,{className:"w-3 h-3"}),i?"Exporting...":"Export"]})]})})]}),d.jsx("div",{className:"flex-1 overflow-hidden",children:d.jsx(Pc,{})})]})})};class Ae{constructor(){this.root=null,this.videosDir=null,this.metadataCache=new Map,this.subscribers=new Set}static getInstance(){return Ae.instance||(Ae.instance=new Ae),Ae.instance}subscribe(t){return this.subscribers.add(t),()=>this.subscribers.delete(t)}notify(){this.subscribers.forEach(t=>{try{t()}catch{}})}async initialize(){try{return!("storage"in navigator)||!("getDirectory"in navigator.storage)?(console.warn("OPFS not supported"),!1):(this.root=await navigator.storage.getDirectory(),this.videosDir=await this.root.getDirectoryHandle("videos",{create:!0}),await this.loadMetadata(),!0)}catch(t){return console.error("Failed to initialize OPFS:",t),!1}}async storeVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");const n=`video-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=t.name.includes(".")?t.name.split(".").pop().toLowerCase():"bin",o=`${n}.${r}`;try{const i=await(await this.videosDir.getFileHandle(o,{create:!0})).createWritable();await i.write(t),await i.close();const a={id:n,fileName:t.name,fileSize:t.size,lastModified:t.lastModified,mimeType:t.type,storedFileName:o};return await this.saveMetadata(n,a),this.metadataCache.set(n,a),this.generateThumbnails(n,t).catch(console.error),this.notify(),n}catch(s){throw console.error("Failed to store video:",s),s}}async retrieveVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");try{const n=this.metadataCache.get(t);if(!n)return console.warn("No metadata found for video:",t),null;const o=await(await this.videosDir.getFileHandle(n.storedFileName)).getFile();return new File([o],n.fileName,{type:n.mimeType})}catch(n){return console.error("Failed to retrieve video:",n),null}}async deleteVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");try{const n=this.metadataCache.get(t),r=(n==null?void 0:n.storedFileName)??`${t}.mp4`;await this.videosDir.removeEntry(r).catch(()=>{}),await this.videosDir.removeEntry(`${t}.json`).catch(()=>{});const o=await this.videosDir.getDirectoryHandle("thumbnails",{create:!1}).catch(()=>null);if(o)for await(const[s]of o.entries())typeof s=="string"&&s.startsWith(t)&&await o.removeEntry(s).catch(()=>{});this.metadataCache.delete(t),this.notify()}catch(n){console.error("Failed to delete video:",n)}}async listVideos(){return Array.from(this.metadataCache.values())}async getStorageEstimate(){if("estimate"in navigator.storage){const t=await navigator.storage.estimate();return{usage:t.usage||0,quota:t.quota||0}}return{usage:0,quota:0}}async generateThumbnails(t,n){const r=document.createElement("video"),o=document.createElement("canvas"),s=o.getContext("2d");if(!s)return;r.src=URL.createObjectURL(n),r.muted=!0,r.playsInline=!0,await new Promise(f=>{r.onloadedmetadata=()=>f()});const i=Math.max(0,r.duration||0),a=i>0?[0,i*.25,i*.5,i*.75]:[0],c=[];o.width=320,o.height=180;for(const f of a)await new Promise(h=>{r.currentTime=f,r.onseeked=()=>h()}),s.drawImage(r,0,0,o.width,o.height),c.push(o.toDataURL("image/jpeg",.7));URL.revokeObjectURL(r.src);const l=this.metadataCache.get(t);l&&(l.thumbnails=c,await this.saveMetadata(t,l),this.metadataCache.set(t,l),this.notify())}async saveMetadata(t,n){if(!this.videosDir)return;const o=await(await this.videosDir.getFileHandle(`${t}.json`,{create:!0})).createWritable();await o.write(JSON.stringify(n)),await o.close()}async loadMetadata(){if(this.videosDir)try{for await(const[t,n]of this.videosDir.entries()){const r=n;if(r.kind==="file"&&typeof t=="string"&&t.endsWith(".json")){const s=await(await r.getFile()).text(),i=JSON.parse(s),a=i.storedFileName??`${i.id}.mp4`,c={id:i.id,fileName:i.fileName,fileSize:i.fileSize,lastModified:i.lastModified,mimeType:i.mimeType,storedFileName:a,thumbnails:i.thumbnails??[]};this.metadataCache.set(c.id,c)}}}catch(t){console.error("Failed to load metadata:",t)}}}function fa(){const[e,t]=A.useState(!1),[n,r]=A.useState([]),o=Ae.getInstance();return A.useEffect(()=>{let c=null;return o.initialize().then(async l=>{t(l),l&&(r(await o.listVideos()),c=o.subscribe(async()=>{r(await o.listVideos())}))}),()=>{c&&c()}},[]),{isInitialized:e,videos:n,storeVideo:async c=>{const l=await o.storeVideo(c);return r(await o.listVideos()),l},retrieveVideo:c=>o.retrieveVideo(c),deleteVideo:async c=>{await o.deleteVideo(c),r(await o.listVideos())},getStorageEstimate:()=>o.getStorageEstimate()}}const le=({variant:e="default",size:t="sm",icon:n,children:r,className:o="",...s})=>{const i={default:"bg-neutral-800 border border-neutral-700 text-neutral-300 hover:bg-neutral-700",primary:"bg-red-600 text-white hover:bg-red-500 border border-red-700",ghost:"bg-transparent text-neutral-400 hover:bg-neutral-800 hover:text-neutral-200",tool:"bg-neutral-900 text-neutral-400 hover:text-white hover:bg-neutral-800 border border-neutral-800"},a={xs:"px-2 py-0.5 text-xs",sm:"px-3 py-1 text-xs"};return d.jsx("button",{className:`
        transition-all duration-150 disabled:opacity-30
        ${i[e]}
        ${a[t]}
        ${o}
      `,...s,children:d.jsxs("span",{className:"flex items-center gap-1.5",children:[n&&d.jsx(n,{className:"w-3 h-3"}),r]})})},pe=({title:e,children:t,selected:n,compact:r=!1,className:o="",onClose:s})=>d.jsxs("div",{className:`
      bg-neutral-900 border rounded-sm
      ${n?"border-red-600 shadow-lg shadow-red-900/20":"border-neutral-800"}
      ${r?"p-1":"p-2"}
      ${o}
    `,children:[e&&d.jsxs("div",{className:"h-5 bg-gradient-to-r from-neutral-800 to-neutral-900 border border-neutral-700 px-1 mb-1 flex items-center justify-between",children:[d.jsx("span",{className:"text-xs text-neutral-400 font-medium tracking-wide",children:e}),s&&d.jsx("button",{onClick:s,className:"text-neutral-500 hover:text-neutral-200 text-xs leading-none transition-colors","aria-label":"Close",children:"×"})]}),d.jsx("div",{children:t})]}),Xe=({children:e,className:t=""})=>d.jsx("div",{className:`bg-zinc-950 flex flex-col ${t}`,children:e}),vt=({title:e,actions:t})=>d.jsxs("div",{className:"h-8 bg-zinc-800 border-b border-zinc-700 px-3 flex items-center justify-between",children:[d.jsx("span",{className:"text-xs text-zinc-400 uppercase tracking-wider",children:e}),t&&d.jsx("div",{className:"flex items-center gap-1",children:t})]}),Ye=({children:e,className:t=""})=>d.jsx("div",{className:`flex-1 overflow-y-auto p-2 ${t}`,children:e}),qn=({children:e})=>d.jsx("div",{className:"h-6 bg-zinc-900 border-t border-zinc-800 px-3 flex items-center text-zinc-600 text-xs",children:e}),Er=({label:e,className:t="",...n})=>d.jsxs("div",{className:"w-full",children:[e&&d.jsx("label",{className:"block text-neutral-500 mb-1 text-[10px] uppercase font-medium",children:e}),d.jsx("input",{className:`
        w-full bg-black border border-neutral-800 px-2 py-0.5
        text-neutral-200 text-xs focus:border-red-700 focus:outline-none
        placeholder-neutral-600
        ${t}
      `,...n})]}),us=({label:e,options:t,className:n="",...r})=>d.jsxs("div",{className:"w-full",children:[e&&d.jsx("label",{className:"block text-neutral-500 mb-1 text-[10px] uppercase font-medium",children:e}),d.jsx("select",{className:`
        w-full bg-black border border-neutral-800 px-2 py-0.5
        text-neutral-200 text-xs focus:border-red-700 focus:outline-none
        ${n}
      `,...r,children:t.map(o=>d.jsx("option",{value:o.value,children:o.label},o.value))})]}),mn=({label:e,value:t,onChange:n,min:r,max:o,placeholder:s,disabled:i=!1})=>{const a=typeof t=="number"?t:parseFloat(t)||0;return d.jsxs("div",{className:"w-full",children:[e&&d.jsx("label",{className:"block text-zinc-500 mb-1 text-[10px] uppercase",children:e}),d.jsxs("div",{className:"relative",children:[d.jsx("button",{type:"button",onClick:()=>n(a-1),disabled:i||r!==void 0&&a<=r,className:"absolute left-0 inset-y-0 px-1.5 text-zinc-500 hover:bg-zinc-800 disabled:opacity-50",children:"−"}),d.jsx("input",{type:"number",value:t,onChange:c=>n(parseFloat(c.target.value)||0),disabled:i,placeholder:s,min:r,max:o,className:"w-full bg-zinc-950 border border-zinc-800 px-6 py-0.5 text-xs text-center text-zinc-200 focus:border-zinc-600 focus:outline-none disabled:opacity-50"}),d.jsx("button",{type:"button",onClick:()=>n(a+1),disabled:i||o!==void 0&&a>=o,className:"absolute right-0 inset-y-0 px-1.5 text-zinc-500 hover:bg-zinc-800 disabled:opacity-50",children:"+"})]})]})},he=({children:e,className:t="",direction:n="row",flex:r=!1,fullHeight:o=!1})=>d.jsx("div",{className:["flex",n==="col"?"flex-col":"flex-row",r?"flex-1":"",o?"h-full":"",t].join(" "),children:e}),Ze=({children:e,className:t="",variant:n="default",size:r="sm"})=>{const o={default:"text-zinc-300",muted:"text-zinc-500",warning:"text-amber-400",error:"text-red-400"},s={xs:"text-xs",sm:"text-sm"};return d.jsx("span",{className:[o[n],s[r],t].join(" "),children:e})},Hm=({icon:e,title:t,description:n,action:r,className:o=""})=>d.jsxs("div",{className:`text-center py-8 ${o}`,children:[e&&d.jsx("div",{className:"mb-3 flex justify-center text-neutral-600",children:e}),d.jsx("h3",{className:"text-sm text-neutral-300 font-medium",children:t}),n&&d.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:n}),r&&d.jsx("div",{className:"mt-4",children:r})]}),Fm=({message:e})=>d.jsx(pe,{className:"mb-6 bg-red-900 bg-opacity-20 border-red-500 border-opacity-50",children:d.jsxs(he,{className:"gap-3",children:[d.jsx(Rc,{className:"w-5 h-5 flex-shrink-0 text-red-400"}),d.jsx(Ze,{variant:"error",size:"sm",children:e})]})}),Bm=({title:e,lastSaved:t,isDirty:n,onContinue:r,onExport:o,isExporting:s})=>{const i=a=>{const c=Math.floor((Date.now()-a.getTime())/1e3);return c<3600?`${Math.floor(c/60)} min ago`:c<86400?`${Math.floor(c/3600)} hours ago`:`${Math.floor(c/86400)} days ago`};return d.jsx(pe,{className:"mb-8",children:d.jsxs(he,{className:"justify-between items-start",children:[d.jsxs(he,{direction:"col",children:[d.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:e}),d.jsxs(he,{className:"gap-4",children:[d.jsxs(he,{className:"gap-1",children:[d.jsx(bs,{className:"w-4 h-4 text-zinc-500"}),d.jsx(Ze,{variant:"muted",size:"sm",children:t?i(t):"Not saved"})]}),n&&d.jsx(Ze,{variant:"warning",size:"sm",children:"• Unsaved changes"})]})]}),d.jsxs(he,{className:"gap-2",children:[d.jsx(le,{variant:"primary",onClick:r,children:"Continue Project"}),d.jsx(le,{variant:"default",icon:xs,onClick:o,disabled:s,children:"Export"})]})]})})},Om=({onNewProject:e,onImportClick:t,isImporting:n})=>d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsx(pe,{className:"p-8 border-2 border-dashed hover:border-orange-600 cursor-pointer transition-colors group",children:d.jsx("button",{onClick:e,className:"w-full",children:d.jsxs(he,{direction:"col",className:"items-center",children:[d.jsx(ut,{className:"w-12 h-12 mb-3 text-zinc-600 group-hover:text-orange-600"}),d.jsx("h3",{className:"text-lg font-medium text-white",children:"New Project"})]})})}),d.jsx(pe,{className:"p-8 border-2 border-dashed hover:border-orange-600 cursor-pointer transition-colors group",children:d.jsx("button",{onClick:t,disabled:n,className:"w-full",children:d.jsxs(he,{direction:"col",className:"items-center",children:[d.jsx(Cn,{className:"w-12 h-12 mb-3 text-zinc-600 group-hover:text-orange-600"}),d.jsx("h3",{className:"text-lg font-medium text-white",children:n?"Importing...":"Open Project"})]})})})]}),Xm=()=>{const e=Pr(),t=A.useRef(null),[n,r]=A.useState(null),o=$e(g=>g.projectTitle),s=$e(g=>g.isDirty),i=$e(g=>g.lastSaved),{isImporting:a,isExporting:c,handleExport:l,handleFileSelect:f,createNewProject:h}=ua({onImportSuccess:()=>e("/storymap"),onImportError:g=>{r(g.message),setTimeout(()=>r(null),5e3)},confirmNewProject:!0}),u=async()=>{if(h()){try{const g=Ae.getInstance();await g.initialize();const y=await g.listVideos();for(const p of y)await g.deleteVideo(p.id)}catch(g){console.error("Failed to clear video storage:",g)}e("/storymap")}};return d.jsx(Xe,{className:"h-full overflow-auto",children:d.jsx(Ye,{children:d.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-white mb-8",children:"Projects"}),n&&d.jsx(Fm,{message:n}),d.jsx(Bm,{title:o,lastSaved:i,isDirty:s,onContinue:()=>e("/storymap"),onExport:l,isExporting:c}),d.jsx(Om,{onNewProject:u,onImportClick:()=>{var g;return(g=t.current)==null?void 0:g.click()},isImporting:a}),d.jsx("input",{ref:t,type:"file",accept:".json",onChange:f,className:"hidden"})]})})})},Ym=()=>{const e=A.useRef(null),{isInitialized:t,videos:n,storeVideo:r,retrieveVideo:o,deleteVideo:s,getStorageEstimate:i}=fa(),{currentVideoId:a,setCurrentVideo:c,setIsLoading:l,clearCurrentVideo:f}=Be(),[h,u]=fe.useState({usage:0,quota:0}),[g,y]=fe.useState(0);fe.useEffect(()=>{t&&i().then(u)},[t,n,i]);const p=async m=>{const k=Array.from(m.target.files||[]).filter(S=>S.type.startsWith("video/"));y(k.length);for(const S of k)try{const I=await r(S);n.length===0&&!a&&x(I)}catch(I){console.error("Failed to store video:",I),alert(`Failed to store ${S.name}. Storage might be full.`)}y(0),e.current&&(e.current.value="")},x=async m=>{if(a!==m){l(!0);try{const w=await o(m);w&&c(m,w)}catch(w){console.error("Failed to load video:",w)}finally{l(!1)}}},b=async m=>{if(confirm("Delete this video from storage?")&&(await s(m),a===m)){f();const w=n.filter(k=>k.id!==m);w.length>0&&x(w[0].id)}},N=m=>{if(m===0)return"0 Bytes";const w=1024,k=["Bytes","KB","MB","GB"],S=Math.floor(Math.log(m)/Math.log(w));return parseFloat((m/Math.pow(w,S)).toFixed(2))+" "+k[S]};return d.jsxs(Xe,{className:"w-80 border-r border-zinc-800 flex flex-col",children:[d.jsx(vt,{title:"Media Pool",actions:d.jsx(le,{variant:"ghost",size:"xs",icon:Cn,onClick:()=>{var m;return(m=e.current)==null?void 0:m.click()},disabled:!t||g>0,children:g>0?`Uploading ${g}...`:"Import"})}),d.jsx("input",{ref:e,type:"file",accept:"video/*",multiple:!0,onChange:p,className:"hidden"}),t&&d.jsxs("div",{className:"px-3 py-2 bg-zinc-950 border-b border-zinc-800",children:[d.jsxs("div",{className:"flex items-center justify-between mb-1 text-[10px]",children:[d.jsxs("span",{className:"flex items-center gap-1 text-zinc-600",children:[d.jsx(so,{className:"w-3 h-3"}),"Browser Storage"]}),d.jsxs("span",{className:"text-zinc-600",children:[N(h.usage)," / ",N(h.quota)]})]}),d.jsx("div",{className:"h-1 bg-zinc-950 rounded overflow-hidden",children:d.jsx("div",{className:"h-full bg-orange-600 transition-all",style:{width:`${h.usage/h.quota*100}%`}})})]}),d.jsx(Ye,{className:"flex-1 overflow-y-auto",children:t?n.length===0?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ft,{className:"w-12 h-12 mx-auto mb-4 text-zinc-600"}),d.jsx("p",{className:"text-zinc-600 text-xs mb-4",children:"No videos in storage"}),d.jsx(le,{variant:"default",icon:Cn,onClick:()=>{var m;return(m=e.current)==null?void 0:m.click()},disabled:g>0,children:"Import Videos"})]}):d.jsx("div",{className:"p-2 space-y-1",children:n.map(m=>d.jsxs(pe,{selected:a===m.id,compact:!0,className:"relative cursor-pointer",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),b(m.id)},className:"absolute top-1 right-1 p-1 rounded hover:bg-red-500/20 text-zinc-500 hover:text-red-400",title:"Delete video",children:d.jsx(ws,{className:"w-4 h-4"})}),d.jsxs("div",{onClick:()=>x(m.id),children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx(ft,{className:"w-4 h-4 text-zinc-600 flex-shrink-0"}),d.jsx("p",{className:"text-xs text-zinc-300 truncate",children:m.fileName})]}),d.jsx("div",{className:"flex items-center gap-3 text-zinc-600 text-[10px]",children:d.jsx("span",{children:N(m.fileSize)})}),m.thumbnails&&m.thumbnails.length>0&&d.jsx("div",{className:"flex gap-1 mt-2",children:m.thumbnails.slice(0,4).map((w,k)=>d.jsx("div",{className:"w-1/4 aspect-video bg-zinc-900 overflow-hidden rounded",children:d.jsx("img",{src:w,alt:"",className:"w-full h-full object-cover opacity-70",draggable:!1})},k))})]})]},m.id))}):d.jsx("div",{className:"text-center py-12",children:d.jsxs("div",{className:"animate-pulse",children:[d.jsx(so,{className:"w-12 h-12 mx-auto mb-4 text-zinc-600"}),d.jsx("p",{className:"text-zinc-600 text-xs",children:"Initializing storage..."})]})})}),d.jsx(qn,{children:d.jsxs("span",{className:"text-[10px]",children:[n.length," video",n.length!==1?"s":""," stored"]})})]})};let pn=null;const It=Gt((e,t)=>{const n=()=>{pn&&(window.clearTimeout(pn),pn=null)},r=async i=>{var g;const{nodes:a}=oe.getState(),c=a.find(y=>y.id===i&&y.type==="scene"),l=(g=c==null?void 0:c.data)==null?void 0:g.videoId,f=Be.getState();if(!l){f.clearCurrentVideo();return}const h=Ae.getInstance();await h.initialize();const u=await h.retrieveVideo(l);u?f.setCurrentVideo(l,u):f.clearCurrentVideo()},o=i=>{n();const c=oe.getState().nodes.find(h=>h.id===i&&h.type==="scene"),l=(c==null?void 0:c.data)||{};if(l.videoId)return;const f=l.durationSec??0;!f||f<=0||(pn=window.setTimeout(()=>{const{nodes:h,edges:u}=oe.getState(),y=u.filter(x=>x.source===i).map(x=>h.find(b=>b.id===x.target)).filter(Boolean);if(y.some(x=>x.type==="choice"))return;const p=y.find(x=>x.type==="scene");p&&t().goTo(p.id)},Math.max(0,f*1e3)))};return{currentSceneId:null,start:()=>{const i=Wt;e({currentSceneId:i}),r(i),o(i)},goTo:i=>{e({currentSceneId:i}),r(i),o(i)},reset:()=>{n();const i=Wt;e({currentSceneId:i}),r(i),o(i)},onVideoEnded:()=>{const i=t().currentSceneId;if(!i)return;const{nodes:a,edges:c}=oe.getState(),f=c.filter(u=>u.source===i).map(u=>a.find(g=>g.id===u.target)).filter(Boolean);if(f.some(u=>u.type==="choice"))return;const h=f.find(u=>u.type==="scene");h&&t().goTo(h.id)}}}),ha=()=>{const e=A.useRef(null),{currentVideoUrl:t,isPlaying:n,currentTime:r,duration:o,volume:s,setIsPlaying:i,setCurrentTime:a,setDuration:c,setVolume:l}=Be(),f=It(p=>p.onVideoEnded);A.useEffect(()=>{const p=e.current;if(!p)return;const x=()=>c(p.duration||0),b=()=>a(p.currentTime||0),N=()=>i(!0),m=()=>i(!1),w=()=>{i(!1),f()};return p.addEventListener("loadedmetadata",x),p.addEventListener("timeupdate",b),p.addEventListener("play",N),p.addEventListener("pause",m),p.addEventListener("ended",w),p.volume=s/100,()=>{p.removeEventListener("loadedmetadata",x),p.removeEventListener("timeupdate",b),p.removeEventListener("play",N),p.removeEventListener("pause",m),p.removeEventListener("ended",w)}},[t,s,c,a,i,f]);const h=()=>{const p=e.current;p&&(p.paused?p.play():p.pause())},u=p=>{const x=e.current;if(!x)return;const b=Number.isFinite(o)?o:x.duration||0;x.currentTime=Math.max(0,Math.min(p,b))},g=p=>{if(!Number.isFinite(p))return"0:00";const x=Math.max(0,Math.floor(p)),b=Math.floor(x/60),N=x%60;return`${b}:${N.toString().padStart(2,"0")}`};if(!t)return d.jsx("div",{className:"flex-1 flex items-center justify-center bg-black",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 text-[#444]",children:d.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:d.jsx("path",{d:"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"})})}),d.jsx("p",{className:"text-[#666] text-sm",children:"Select a video to preview"})]})});const y="object-contain";return d.jsxs("div",{className:"flex-1 flex flex-col bg-black min-h-0",children:[d.jsx("div",{className:"flex-1 min-h-0 flex items-center justify-center overflow-hidden",children:d.jsx("video",{ref:e,src:t,className:`w-full h-full max-w-full max-h-full ${y}`,playsInline:!0,autoPlay:!0,controls:!1,preload:"metadata"})}),d.jsxs("div",{className:"h-24 shrink-0 bg-[#252525] border-t border-[#0a0a0a] p-3",children:[d.jsx("div",{className:"mb-3",children:d.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-[#666] mb-1",children:[d.jsx("span",{children:g(r)}),d.jsxs("div",{className:"flex-1 h-1 bg-[#1a1a1a] relative",children:[d.jsx("div",{className:"absolute h-full bg-[#E84E36]",style:{width:`${o>0?Math.min(100,r/o*100):0}%`}}),d.jsx("input",{type:"range",min:0,max:Math.max(0,o||0),value:Math.min(r,o||0),onChange:p=>u(parseFloat(p.target.value)),className:"absolute inset-0 w-full opacity-0 cursor-pointer","aria-label":"Seek"})]}),d.jsx("span",{children:g(o)})]})}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>u(0),className:"p-2 bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] hover:bg-[#333] hover:text-white transition-colors","aria-label":"Restart",children:d.jsx(Lc,{className:"w-4 h-4"})}),d.jsx("button",{onClick:h,className:"p-2 bg-[#E84E36] text-white hover:bg-[#d63d2a] transition-colors","aria-label":n?"Pause":"Play",children:n?d.jsx(Hc,{className:"w-4 h-4"}):d.jsx(Fc,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>u(o||0),className:"p-2 bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] hover:bg-[#333] hover:text-white transition-colors","aria-label":"End",children:d.jsx(Bc,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-[10px] text-[#666]",children:"Vol"}),d.jsx("input",{type:"range",min:0,max:100,value:s,onChange:p=>{const x=parseInt(p.target.value,10);l(x),e.current&&(e.current.volume=x/100)},className:"w-24",style:{height:"4px",backgroundColor:"#1a1a1a",outline:"none"},"aria-label":"Volume"}),d.jsxs("span",{className:"text-[10px] text-[#666] w-8 text-right",children:[s,"%"]})]})]})]})]})},Wm=()=>{const e=oe(x=>x.nodes),t=oe(x=>x.updateNode),{videos:n,retrieveVideo:r}=fa(),{setCurrentVideo:o,currentVideoId:s}=Be(),i=zr(),[a,c]=A.useState(""),[l,f]=A.useState(null);A.useEffect(()=>{const x=i.state;x!=null&&x.sceneId&&(f(x.sceneId),x.videoId&&r(x.videoId).then(b=>{b&&o(x.videoId,b)}))},[i.state]);const h=A.useMemo(()=>e.filter(He).filter(x=>!a||x.data.label.toLowerCase().includes(a.toLowerCase())||x.id.toLowerCase().includes(a.toLowerCase())),[e,a]),u=async(x,b)=>{if(f(x),b){const N=await r(b);N&&o(b,N)}},g=x=>{if(!s){alert("Select a video first");return}t(x,{videoId:s})},y=n.find(x=>x.id===s),p=x=>n.find(b=>b.id===x);return d.jsxs(Xe,{className:"w-96 border-l border-zinc-800 flex flex-col",children:[d.jsx(vt,{title:"Scene Linker"}),y&&d.jsx("div",{className:"px-3 py-2 bg-zinc-800 border-b border-zinc-700",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(ft,{className:"w-3 h-3 text-green-500"}),d.jsxs("span",{className:"text-zinc-400 truncate",style:{fontSize:"10px"},children:["Selected: ",y.fileName]})]})}),d.jsx("div",{className:"p-3 border-b border-zinc-800",children:d.jsx(Er,{value:a,onChange:x=>c(x.target.value),placeholder:"Search scenes..."})}),d.jsx(Ye,{className:"flex-1 overflow-y-auto",children:d.jsxs("div",{className:"space-y-2",children:[h.map(x=>{const b=p(x.data.videoId),N=l===x.id;return d.jsx(pe,{selected:N,compact:!0,className:"cursor-pointer",children:d.jsx("div",{onClick:()=>u(x.id,x.data.videoId),children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-xs font-medium text-zinc-200",children:x.data.label}),b?d.jsxs("p",{className:"text-zinc-500 mt-1",style:{fontSize:"10px"},children:[d.jsx(ft,{className:"w-3 h-3 inline mr-1"}),b.fileName]}):d.jsxs("p",{className:"text-zinc-600 mt-1",style:{fontSize:"10px"},children:["No video • ",x.data.durationSec,"s"]})]}),d.jsx("div",{className:"flex gap-2",children:b?s&&s!==x.data.videoId?d.jsx(le,{variant:"ghost",size:"xs",onClick:m=>{m.stopPropagation(),g(x.id)},children:"change"}):d.jsx(le,{variant:"ghost",size:"xs",onClick:m=>{m.stopPropagation(),t(x.id,{videoId:void 0})},children:"remove"}):s&&d.jsx(le,{variant:"ghost",size:"xs",onClick:m=>{m.stopPropagation(),g(x.id)},children:"link"})})]})})},x.id)}),h.length===0&&d.jsx("div",{className:"text-center py-8 text-xs text-zinc-500",children:a?"No scenes found":"No scenes in project"})]})})]})},Gm=()=>d.jsxs("div",{className:"flex h-full bg-zinc-900",children:[d.jsx(Ym,{}),d.jsx("div",{className:"flex-1 flex flex-col",children:d.jsx(ha,{})}),d.jsx(Wm,{})]});function ga(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=ga(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Um(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=ga(e))&&(r&&(r+=" "),r+=t);return r}const qr="-",qm=e=>{const t=Zm(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:i=>{const a=i.split(qr);return a[0]===""&&a.length!==1&&a.shift(),ma(a,t)||Km(i)},getConflictingClassGroupIds:(i,a)=>{const c=n[i]||[];return a&&r[i]?[...c,...r[i]]:c}}},ma=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?ma(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const s=e.join(qr);return(i=t.validators.find(({validator:a})=>a(s)))==null?void 0:i.classGroupId},fs=/^\[(.+)\]$/,Km=e=>{if(fs.test(e)){const t=fs.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Zm=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const o in n)jr(n[o],r,o,t);return r},jr=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const s=o===""?t:hs(t,o);s.classGroupId=n;return}if(typeof o=="function"){if(Qm(o)){jr(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([s,i])=>{jr(i,hs(t,s),n,r)})})},hs=(e,t)=>{let n=e;return t.split(qr).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Qm=e=>e.isThemeGetter,Jm=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(s,i)=>{n.set(s,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(s){let i=n.get(s);if(i!==void 0)return i;if((i=r.get(s))!==void 0)return o(s,i),i},set(s,i){n.has(s)?n.set(s,i):o(s,i)}}},_r="!",Mr=":",ep=Mr.length,tp=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=o=>{const s=[];let i=0,a=0,c=0,l;for(let y=0;y<o.length;y++){let p=o[y];if(i===0&&a===0){if(p===Mr){s.push(o.slice(c,y)),c=y+ep;continue}if(p==="/"){l=y;continue}}p==="["?i++:p==="]"?i--:p==="("?a++:p===")"&&a--}const f=s.length===0?o:o.substring(c),h=np(f),u=h!==f,g=l&&l>c?l-c:void 0;return{modifiers:s,hasImportantModifier:u,baseClassName:h,maybePostfixModifierPosition:g}};if(t){const o=t+Mr,s=r;r=i=>i.startsWith(o)?s(i.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:i,maybePostfixModifierPosition:void 0}}if(n){const o=r;r=s=>n({className:s,parseClassName:o})}return r},np=e=>e.endsWith(_r)?e.substring(0,e.length-1):e.startsWith(_r)?e.substring(1):e,rp=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let s=[];return r.forEach(i=>{i[0]==="["||t[i]?(o.push(...s.sort(),i),s=[]):s.push(i)}),o.push(...s.sort()),o}},op=e=>({cache:Jm(e.cacheSize),parseClassName:tp(e),sortModifiers:rp(e),...qm(e)}),sp=/\s+/,ip=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:s}=t,i=[],a=e.trim().split(sp);let c="";for(let l=a.length-1;l>=0;l-=1){const f=a[l],{isExternal:h,modifiers:u,hasImportantModifier:g,baseClassName:y,maybePostfixModifierPosition:p}=n(f);if(h){c=f+(c.length>0?" "+c:c);continue}let x=!!p,b=r(x?y.substring(0,p):y);if(!b){if(!x){c=f+(c.length>0?" "+c:c);continue}if(b=r(y),!b){c=f+(c.length>0?" "+c:c);continue}x=!1}const N=s(u).join(":"),m=g?N+_r:N,w=m+b;if(i.includes(w))continue;i.push(w);const k=o(b,x);for(let S=0;S<k.length;++S){const I=k[S];i.push(m+I)}c=f+(c.length>0?" "+c:c)}return c};function ap(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=pa(t))&&(r&&(r+=" "),r+=n);return r}const pa=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=pa(e[r]))&&(n&&(n+=" "),n+=t);return n};function cp(e,...t){let n,r,o,s=i;function i(c){const l=t.reduce((f,h)=>h(f),e());return n=op(l),r=n.cache.get,o=n.cache.set,s=a,a(c)}function a(c){const l=r(c);if(l)return l;const f=ip(c,n);return o(c,f),f}return function(){return s(ap.apply(null,arguments))}}const ue=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},xa=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ya=/^\((?:(\w[\w-]*):)?(.+)\)$/i,lp=/^\d+\/\d+$/,dp=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,up=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fp=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,hp=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gp=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ot=e=>lp.test(e),ne=e=>!!e&&!Number.isNaN(Number(e)),Le=e=>!!e&&Number.isInteger(Number(e)),cr=e=>e.endsWith("%")&&ne(e.slice(0,-1)),Pe=e=>dp.test(e),mp=()=>!0,pp=e=>up.test(e)&&!fp.test(e),ba=()=>!1,xp=e=>hp.test(e),yp=e=>gp.test(e),bp=e=>!Y(e)&&!W(e),wp=e=>Nt(e,Na,ba),Y=e=>xa.test(e),We=e=>Nt(e,Sa,pp),lr=e=>Nt(e,kp,ne),gs=e=>Nt(e,wa,ba),vp=e=>Nt(e,va,yp),xn=e=>Nt(e,Ca,xp),W=e=>ya.test(e),Mt=e=>St(e,Sa),Np=e=>St(e,Ep),ms=e=>St(e,wa),Sp=e=>St(e,Na),Cp=e=>St(e,va),yn=e=>St(e,Ca,!0),Nt=(e,t,n)=>{const r=xa.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},St=(e,t,n=!1)=>{const r=ya.exec(e);return r?r[1]?t(r[1]):n:!1},wa=e=>e==="position"||e==="percentage",va=e=>e==="image"||e==="url",Na=e=>e==="length"||e==="size"||e==="bg-size",Sa=e=>e==="length",kp=e=>e==="number",Ep=e=>e==="family-name",Ca=e=>e==="shadow",jp=()=>{const e=ue("color"),t=ue("font"),n=ue("text"),r=ue("font-weight"),o=ue("tracking"),s=ue("leading"),i=ue("breakpoint"),a=ue("container"),c=ue("spacing"),l=ue("radius"),f=ue("shadow"),h=ue("inset-shadow"),u=ue("text-shadow"),g=ue("drop-shadow"),y=ue("blur"),p=ue("perspective"),x=ue("aspect"),b=ue("ease"),N=ue("animate"),m=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...w(),W,Y],S=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto","contain","none"],j=()=>[W,Y,c],E=()=>[ot,"full","auto",...j()],L=()=>[Le,"none","subgrid",W,Y],V=()=>["auto",{span:["full",Le,W,Y]},Le,W,Y],$=()=>[Le,"auto",W,Y],T=()=>["auto","min","max","fr",W,Y],v=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],P=()=>["start","end","center","stretch","center-safe","end-safe"],C=()=>["auto",...j()],_=()=>[ot,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...j()],M=()=>[e,W,Y],z=()=>[...w(),ms,gs,{position:[W,Y]}],D=()=>["no-repeat",{repeat:["","x","y","space","round"]}],R=()=>["auto","cover","contain",Sp,wp,{size:[W,Y]}],H=()=>[cr,Mt,We],O=()=>["","none","full",l,W,Y],B=()=>["",ne,Mt,We],q=()=>["solid","dashed","dotted","double"],Z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],X=()=>[ne,cr,ms,gs],F=()=>["","none",y,W,Y],U=()=>["none",ne,W,Y],ee=()=>["none",ne,W,Y],te=()=>[ne,W,Y],K=()=>[ot,"full",...j()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Pe],breakpoint:[Pe],color:[mp],container:[Pe],"drop-shadow":[Pe],ease:["in","out","in-out"],font:[bp],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Pe],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Pe],shadow:[Pe],spacing:["px",ne],text:[Pe],"text-shadow":[Pe],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ot,Y,W,x]}],container:["container"],columns:[{columns:[ne,Y,W,a]}],"break-after":[{"break-after":m()}],"break-before":[{"break-before":m()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:S()}],"overflow-x":[{"overflow-x":S()}],"overflow-y":[{"overflow-y":S()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:E()}],"inset-x":[{"inset-x":E()}],"inset-y":[{"inset-y":E()}],start:[{start:E()}],end:[{end:E()}],top:[{top:E()}],right:[{right:E()}],bottom:[{bottom:E()}],left:[{left:E()}],visibility:["visible","invisible","collapse"],z:[{z:[Le,"auto",W,Y]}],basis:[{basis:[ot,"full","auto",a,...j()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ne,ot,"auto","initial","none",Y]}],grow:[{grow:["",ne,W,Y]}],shrink:[{shrink:["",ne,W,Y]}],order:[{order:[Le,"first","last","none",W,Y]}],"grid-cols":[{"grid-cols":L()}],"col-start-end":[{col:V()}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":L()}],"row-start-end":[{row:V()}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":T()}],"auto-rows":[{"auto-rows":T()}],gap:[{gap:j()}],"gap-x":[{"gap-x":j()}],"gap-y":[{"gap-y":j()}],"justify-content":[{justify:[...v(),"normal"]}],"justify-items":[{"justify-items":[...P(),"normal"]}],"justify-self":[{"justify-self":["auto",...P()]}],"align-content":[{content:["normal",...v()]}],"align-items":[{items:[...P(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...P(),{baseline:["","last"]}]}],"place-content":[{"place-content":v()}],"place-items":[{"place-items":[...P(),"baseline"]}],"place-self":[{"place-self":["auto",...P()]}],p:[{p:j()}],px:[{px:j()}],py:[{py:j()}],ps:[{ps:j()}],pe:[{pe:j()}],pt:[{pt:j()}],pr:[{pr:j()}],pb:[{pb:j()}],pl:[{pl:j()}],m:[{m:C()}],mx:[{mx:C()}],my:[{my:C()}],ms:[{ms:C()}],me:[{me:C()}],mt:[{mt:C()}],mr:[{mr:C()}],mb:[{mb:C()}],ml:[{ml:C()}],"space-x":[{"space-x":j()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":j()}],"space-y-reverse":["space-y-reverse"],size:[{size:_()}],w:[{w:[a,"screen",..._()]}],"min-w":[{"min-w":[a,"screen","none",..._()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[i]},..._()]}],h:[{h:["screen","lh",..._()]}],"min-h":[{"min-h":["screen","lh","none",..._()]}],"max-h":[{"max-h":["screen","lh",..._()]}],"font-size":[{text:["base",n,Mt,We]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,W,lr]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",cr,Y]}],"font-family":[{font:[Np,Y,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,W,Y]}],"line-clamp":[{"line-clamp":[ne,"none",W,lr]}],leading:[{leading:[s,...j()]}],"list-image":[{"list-image":["none",W,Y]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",W,Y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:M()}],"text-color":[{text:M()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:[ne,"from-font","auto",W,We]}],"text-decoration-color":[{decoration:M()}],"underline-offset":[{"underline-offset":[ne,"auto",W,Y]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",W,Y]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",W,Y]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:z()}],"bg-repeat":[{bg:D()}],"bg-size":[{bg:R()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Le,W,Y],radial:["",W,Y],conic:[Le,W,Y]},Cp,vp]}],"bg-color":[{bg:M()}],"gradient-from-pos":[{from:H()}],"gradient-via-pos":[{via:H()}],"gradient-to-pos":[{to:H()}],"gradient-from":[{from:M()}],"gradient-via":[{via:M()}],"gradient-to":[{to:M()}],rounded:[{rounded:O()}],"rounded-s":[{"rounded-s":O()}],"rounded-e":[{"rounded-e":O()}],"rounded-t":[{"rounded-t":O()}],"rounded-r":[{"rounded-r":O()}],"rounded-b":[{"rounded-b":O()}],"rounded-l":[{"rounded-l":O()}],"rounded-ss":[{"rounded-ss":O()}],"rounded-se":[{"rounded-se":O()}],"rounded-ee":[{"rounded-ee":O()}],"rounded-es":[{"rounded-es":O()}],"rounded-tl":[{"rounded-tl":O()}],"rounded-tr":[{"rounded-tr":O()}],"rounded-br":[{"rounded-br":O()}],"rounded-bl":[{"rounded-bl":O()}],"border-w":[{border:B()}],"border-w-x":[{"border-x":B()}],"border-w-y":[{"border-y":B()}],"border-w-s":[{"border-s":B()}],"border-w-e":[{"border-e":B()}],"border-w-t":[{"border-t":B()}],"border-w-r":[{"border-r":B()}],"border-w-b":[{"border-b":B()}],"border-w-l":[{"border-l":B()}],"divide-x":[{"divide-x":B()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":B()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...q(),"hidden","none"]}],"divide-style":[{divide:[...q(),"hidden","none"]}],"border-color":[{border:M()}],"border-color-x":[{"border-x":M()}],"border-color-y":[{"border-y":M()}],"border-color-s":[{"border-s":M()}],"border-color-e":[{"border-e":M()}],"border-color-t":[{"border-t":M()}],"border-color-r":[{"border-r":M()}],"border-color-b":[{"border-b":M()}],"border-color-l":[{"border-l":M()}],"divide-color":[{divide:M()}],"outline-style":[{outline:[...q(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ne,W,Y]}],"outline-w":[{outline:["",ne,Mt,We]}],"outline-color":[{outline:M()}],shadow:[{shadow:["","none",f,yn,xn]}],"shadow-color":[{shadow:M()}],"inset-shadow":[{"inset-shadow":["none",h,yn,xn]}],"inset-shadow-color":[{"inset-shadow":M()}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:M()}],"ring-offset-w":[{"ring-offset":[ne,We]}],"ring-offset-color":[{"ring-offset":M()}],"inset-ring-w":[{"inset-ring":B()}],"inset-ring-color":[{"inset-ring":M()}],"text-shadow":[{"text-shadow":["none",u,yn,xn]}],"text-shadow-color":[{"text-shadow":M()}],opacity:[{opacity:[ne,W,Y]}],"mix-blend":[{"mix-blend":[...Z(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Z()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ne]}],"mask-image-linear-from-pos":[{"mask-linear-from":X()}],"mask-image-linear-to-pos":[{"mask-linear-to":X()}],"mask-image-linear-from-color":[{"mask-linear-from":M()}],"mask-image-linear-to-color":[{"mask-linear-to":M()}],"mask-image-t-from-pos":[{"mask-t-from":X()}],"mask-image-t-to-pos":[{"mask-t-to":X()}],"mask-image-t-from-color":[{"mask-t-from":M()}],"mask-image-t-to-color":[{"mask-t-to":M()}],"mask-image-r-from-pos":[{"mask-r-from":X()}],"mask-image-r-to-pos":[{"mask-r-to":X()}],"mask-image-r-from-color":[{"mask-r-from":M()}],"mask-image-r-to-color":[{"mask-r-to":M()}],"mask-image-b-from-pos":[{"mask-b-from":X()}],"mask-image-b-to-pos":[{"mask-b-to":X()}],"mask-image-b-from-color":[{"mask-b-from":M()}],"mask-image-b-to-color":[{"mask-b-to":M()}],"mask-image-l-from-pos":[{"mask-l-from":X()}],"mask-image-l-to-pos":[{"mask-l-to":X()}],"mask-image-l-from-color":[{"mask-l-from":M()}],"mask-image-l-to-color":[{"mask-l-to":M()}],"mask-image-x-from-pos":[{"mask-x-from":X()}],"mask-image-x-to-pos":[{"mask-x-to":X()}],"mask-image-x-from-color":[{"mask-x-from":M()}],"mask-image-x-to-color":[{"mask-x-to":M()}],"mask-image-y-from-pos":[{"mask-y-from":X()}],"mask-image-y-to-pos":[{"mask-y-to":X()}],"mask-image-y-from-color":[{"mask-y-from":M()}],"mask-image-y-to-color":[{"mask-y-to":M()}],"mask-image-radial":[{"mask-radial":[W,Y]}],"mask-image-radial-from-pos":[{"mask-radial-from":X()}],"mask-image-radial-to-pos":[{"mask-radial-to":X()}],"mask-image-radial-from-color":[{"mask-radial-from":M()}],"mask-image-radial-to-color":[{"mask-radial-to":M()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[ne]}],"mask-image-conic-from-pos":[{"mask-conic-from":X()}],"mask-image-conic-to-pos":[{"mask-conic-to":X()}],"mask-image-conic-from-color":[{"mask-conic-from":M()}],"mask-image-conic-to-color":[{"mask-conic-to":M()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:z()}],"mask-repeat":[{mask:D()}],"mask-size":[{mask:R()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",W,Y]}],filter:[{filter:["","none",W,Y]}],blur:[{blur:F()}],brightness:[{brightness:[ne,W,Y]}],contrast:[{contrast:[ne,W,Y]}],"drop-shadow":[{"drop-shadow":["","none",g,yn,xn]}],"drop-shadow-color":[{"drop-shadow":M()}],grayscale:[{grayscale:["",ne,W,Y]}],"hue-rotate":[{"hue-rotate":[ne,W,Y]}],invert:[{invert:["",ne,W,Y]}],saturate:[{saturate:[ne,W,Y]}],sepia:[{sepia:["",ne,W,Y]}],"backdrop-filter":[{"backdrop-filter":["","none",W,Y]}],"backdrop-blur":[{"backdrop-blur":F()}],"backdrop-brightness":[{"backdrop-brightness":[ne,W,Y]}],"backdrop-contrast":[{"backdrop-contrast":[ne,W,Y]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ne,W,Y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ne,W,Y]}],"backdrop-invert":[{"backdrop-invert":["",ne,W,Y]}],"backdrop-opacity":[{"backdrop-opacity":[ne,W,Y]}],"backdrop-saturate":[{"backdrop-saturate":[ne,W,Y]}],"backdrop-sepia":[{"backdrop-sepia":["",ne,W,Y]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":j()}],"border-spacing-x":[{"border-spacing-x":j()}],"border-spacing-y":[{"border-spacing-y":j()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",W,Y]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ne,"initial",W,Y]}],ease:[{ease:["linear","initial",b,W,Y]}],delay:[{delay:[ne,W,Y]}],animate:[{animate:["none",N,W,Y]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,W,Y]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:U()}],"rotate-x":[{"rotate-x":U()}],"rotate-y":[{"rotate-y":U()}],"rotate-z":[{"rotate-z":U()}],scale:[{scale:ee()}],"scale-x":[{"scale-x":ee()}],"scale-y":[{"scale-y":ee()}],"scale-z":[{"scale-z":ee()}],"scale-3d":["scale-3d"],skew:[{skew:te()}],"skew-x":[{"skew-x":te()}],"skew-y":[{"skew-y":te()}],transform:[{transform:[W,Y,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:K()}],"translate-x":[{"translate-x":K()}],"translate-y":[{"translate-y":K()}],"translate-z":[{"translate-z":K()}],"translate-none":["translate-none"],accent:[{accent:M()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:M()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",W,Y]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",W,Y]}],fill:[{fill:["none",...M()]}],"stroke-w":[{stroke:[ne,Mt,We,lr]}],stroke:[{stroke:["none",...M()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},_p=cp(jp);function ct(...e){return _p(Um(e))}const ka=({id:e,data:t,selected:n})=>{const{label:r,description:o,durationSec:s,conditions:i,videoId:a}=t,c=ye(b=>b.variables),l=oe(b=>b.updateNode),f=Pr(),[h,u]=A.useState(!1),g=A.useRef(null),y=A.useMemo(()=>kr(i,c),[i,c]),p=async b=>{u(!0);try{const N=Ae.getInstance();await N.initialize();const m=await N.storeVideo(b);l(e,{videoId:m})}finally{u(!1)}},x=()=>{f("/video",{state:{sceneId:e,videoId:a}})};return d.jsxs("div",{className:ct("relative w-60 h-60 transition-all duration-150 ease-in-out","border-2 bg-zinc-800",n?"border-red-500":"border-zinc-700",!y&&"opacity-60"),children:[!y&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60",children:d.jsxs("div",{className:"flex flex-col items-center gap-1 text-xs text-zinc-300",children:[d.jsx(Oc,{className:"w-5 h-5 text-zinc-400"}),i==null?void 0:i.map((b,N)=>d.jsx("span",{className:"font-mono",children:Tm(b)},N))]})}),d.jsxs("div",{className:"p-4 h-full flex flex-col",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsx("h3",{className:"text-sm font-semibold text-zinc-200",children:r}),d.jsx("div",{className:"flex items-center gap-1",children:a?d.jsxs("span",{onClick:x,className:"inline-flex items-center gap-1 text-[10px] px-1.5 py-0.5 rounded bg-zinc-700 text-zinc-200 cursor-pointer hover:bg-zinc-600",children:[d.jsx(ft,{className:"w-3 h-3"}),d.jsx("span",{children:h?"...":"attached"}),d.jsx("button",{type:"button",title:"Unlink video",className:"ml-1 opacity-70 hover:opacity-100",onClick:b=>{b.stopPropagation(),l(e,{videoId:void 0})},children:d.jsx(ws,{className:"w-3 h-3"})})]}):d.jsxs(d.Fragment,{children:[d.jsx("input",{ref:g,type:"file",accept:"video/*",className:"hidden",onChange:b=>{var m;const N=(m=b.target.files)==null?void 0:m[0];N&&p(N),g.current&&(g.current.value="")}}),d.jsx("button",{type:"button",title:"Attach video or go to video view",className:ct("p-1 rounded border border-zinc-700 hover:bg-zinc-700/50","text-zinc-300"),onClick:x,disabled:h,children:d.jsx(Xc,{className:"w-4 h-4"})})]})})]}),d.jsx("div",{className:"flex-1 mb-3",children:o&&d.jsx("p",{className:"text-xs leading-relaxed text-zinc-500 overflow-hidden text-ellipsis line-clamp-6",children:o})}),d.jsxs("div",{className:"mt-auto",children:[d.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[d.jsx("span",{className:"text-xs text-zinc-500",children:a?"Video":"Duration"}),d.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:a?"auto":`${s}s`})]}),d.jsx("div",{className:"h-1 bg-zinc-900 relative overflow-hidden rounded-sm"})]})]}),d.jsx(Oe,{type:"target",position:G.Left,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !left-[-5px]"}),d.jsx(Oe,{type:"source",position:G.Right,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !right-[-5px]"})]})},Ea=({data:e,selected:t})=>{const{label:n,effects:r}=e,o=ye(c=>c.variables),s=A.useMemo(()=>Object.entries(r).filter(([c,l])=>l!==0),[r]),i=s.length>0,a=A.useMemo(()=>{const c=new Map;for(const l of o)c.set(l.name,l);return c},[o]);return d.jsxs("div",{className:"relative group",children:[d.jsxs("div",{className:ct("relative px-5 py-2.5 border-2 text-xs font-medium","inline-flex items-center gap-2 h-12","bg-zinc-700 border-zinc-600 text-zinc-200",t&&"border-red-500"),children:[d.jsx("span",{children:n}),i&&d.jsx("div",{className:"flex items-center gap-1 ml-1",children:s.map(([c,l])=>d.jsx("div",{className:ct("w-4 h-4 bg-zinc-800 border border-zinc-700","flex items-center justify-center text-[9px] font-bold",l>0?"text-green-400":"text-red-400"),children:l>0?"↑":"↓"},c))}),d.jsx(Oe,{type:"target",position:G.Left,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !left-[-5px]"}),d.jsx(Oe,{type:"source",position:G.Right,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !right-[-5px]"})]}),i&&d.jsx("div",{className:ct("absolute left-1/2 -translate-x-1/2 -bottom-[60px] z-10","opacity-0 pointer-events-none transition-opacity duration-200","group-hover:opacity-100"),children:d.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 px-2.5 py-1.5 text-[10px] whitespace-nowrap relative",children:[d.jsx("div",{className:"flex flex-col gap-0.5",children:s.map(([c,l])=>a.get(c)?d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("span",{className:"text-zinc-500",children:[c,":"]}),d.jsxs("span",{className:ct("font-mono font-medium",l>0?"text-green-400":"text-red-400"),children:[l>0?"+":"",l]})]},c):null)}),d.jsx("div",{className:"absolute -top-[3px] left-1/2 -translate-x-1/2 w-0 h-0 border-l-[4px] border-r-[4px] border-b-[4px] border-l-transparent border-r-transparent border-b-zinc-700"})]})})]})},Mp={scene:ka,choice:Ea},zp={type:"step",markerEnd:{type:pt.Arrow},style:{strokeWidth:2,stroke:"#52525b"}},Pp=[Tn,Tn],Ip=["Backspace","Delete"],Ap=()=>{const e=oe(n=>n.selectNode),t=A.useCallback(({nodes:n})=>{const r=n.length>0?n[0].id:null;e(r)},[e]);return am({onChange:t}),null},ja=fe.memo(()=>{const e=oe(l=>l.nodes),t=oe(l=>l.edges),n=oe(l=>l.selectedNodeId),r=oe(l=>l.onNodesChange),o=oe(l=>l.onEdgesChange),s=oe(l=>l.addConnection),i=A.useMemo(()=>new Map(e.map(l=>[l.id,l])),[e]),a=A.useMemo(()=>{if(!n)return t;const l=i.get(n);if(!l||!Yt(l))return t;let f=!1;const h=t.map(u=>u.source===n||u.target===n?(f=!0,{...u,style:{...u.style??{},strokeWidth:3,stroke:"#dc2626"},markerEnd:{type:pt.Arrow,color:"#dc2626"}}):u);return f?h:t},[t,i,n]),c=A.useCallback(l=>{s(l)},[s]);return d.jsxs(Ur,{children:[d.jsxs(ra,{nodes:e,edges:a,nodeTypes:Mp,onNodesChange:r,onEdgesChange:o,onConnect:c,defaultEdgeOptions:zp,connectionLineType:ke.Step,deleteKeyCode:Ip,snapToGrid:!0,snapGrid:Pp,fitView:!0,children:[d.jsx(aa,{}),d.jsx(la,{}),d.jsx(sa,{gap:Tn,size:1})]}),d.jsx(Ap,{})]})}),$p=()=>d.jsxs(he,{direction:"col",className:"space-y-2 mt-4",children:[d.jsxs(he,{className:"items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-zinc-800 border border-zinc-700"}),d.jsx(Ze,{variant:"muted",size:"xs",children:"Scene nodes"})]}),d.jsxs(he,{className:"items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-zinc-700 border border-zinc-600"}),d.jsx(Ze,{variant:"muted",size:"xs",children:"Choice nodes"})]}),d.jsxs(he,{className:"items-center gap-2",children:[d.jsx("div",{className:"w-8 h-0.5 bg-orange-500"}),d.jsx(Ze,{variant:"muted",size:"xs",children:"Conditional paths"})]})]}),Tp=()=>d.jsxs(he,{direction:"row",fullHeight:!0,children:[d.jsx(he,{flex:!0,direction:"col",className:"bg-zinc-950",children:d.jsx(Xe,{className:"flex-1",children:d.jsx(ja,{})})}),d.jsxs(Xe,{className:"w-[350px] border-l border-zinc-800",children:[d.jsx(vt,{title:"Story Overview"}),d.jsx(Ye,{children:d.jsx(Hm,{icon:d.jsx(ys,{className:"w-12 h-12 text-zinc-600"}),title:"Story flow visualization",action:d.jsxs(pe,{compact:!0,children:[d.jsxs(he,{className:"items-start gap-2 mb-3",children:[d.jsx(Yc,{className:"w-4 h-4 text-zinc-500 mt-0.5"}),d.jsx(Ze,{variant:"muted",size:"xs",className:"leading-relaxed",children:"This view shows your complete story structure. Add scenes and choices to build branching narratives."})]}),d.jsx($p,{})]})})})]})]}),Dp=()=>{const e=oe(l=>l.nodes),t=oe(l=>l.edges),n=oe(l=>l.selectedNodeId),r=oe(l=>l.updateNode),o=oe(l=>l.deleteNode),s=oe(l=>l.addSceneNode),i=oe(l=>l.addChoiceNode),a=ye(l=>l.variables),c=A.useMemo(()=>e.find(l=>l.id===n),[e,n]);return c?d.jsxs(d.Fragment,{children:[d.jsxs(Ye,{children:[d.jsx(pe,{title:He(c)?"Scene":"Choice",children:d.jsxs("div",{className:"space-y-3",children:[d.jsx(Er,{label:"Name",value:c.data.label,onChange:l=>r(c.id,{label:l.target.value})}),He(c)&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-zinc-500 mb-1 text-[10px] uppercase",children:"Description"}),d.jsx("textarea",{value:c.data.description||"",onChange:l=>r(c.id,{description:l.target.value}),className:"w-full bg-zinc-950 border border-zinc-800 px-2 py-1 text-xs text-zinc-200 focus:border-zinc-600 focus:outline-none resize-none rounded",rows:3})]}),d.jsx(Er,{label:"Duration (sec)",type:"number",value:c.data.durationSec,min:0,onChange:l=>{const f=parseInt(l.target.value);!isNaN(f)&&f>=0&&r(c.id,{durationSec:f})}})]}),d.jsxs("div",{className:"flex justify-between",children:[He(c)&&d.jsx(le,{size:"xs",onClick:()=>i({connectFromId:c.id}),children:"+ Choice"}),c.id!==Wt&&d.jsx(le,{size:"xs",variant:"ghost",onClick:()=>o(c.id),children:"Delete"})]})]})}),He(c)&&d.jsx(pe,{title:"Conditions",className:"mt-3",children:d.jsxs("div",{className:"space-y-2",children:[(c.data.conditions??[]).map((l,f)=>d.jsxs("div",{className:"flex gap-1",children:[d.jsx(us,{value:l.varName,options:[{value:"",label:"(none)"},...a.map(h=>({value:h.name,label:h.name}))],onChange:h=>{const u=[...c.data.conditions??[]];u[f]={...l,varName:h.target.value},r(c.id,{conditions:u})},className:"flex-1"}),d.jsx(us,{value:l.op,options:[{value:"lt",label:"<"},{value:"lte",label:"≤"},{value:"eq",label:"="},{value:"neq",label:"≠"},{value:"gte",label:"≥"},{value:"gt",label:">"}],onChange:h=>{const u=[...c.data.conditions??[]];u[f]={...l,op:h.target.value},r(c.id,{conditions:u})},className:"w-16"}),d.jsx("input",{type:"number",value:l.value,onChange:h=>{const u=parseFloat(h.target.value),g=[...c.data.conditions??[]];g[f]={...l,value:isNaN(u)?0:u},r(c.id,{conditions:g})},className:"w-16 bg-zinc-950 border border-zinc-800 px-1 py-0.5 text-xs text-zinc-200 text-center focus:border-zinc-600 focus:outline-none rounded"}),d.jsx(le,{size:"xs",variant:"ghost",onClick:()=>{const h=(c.data.conditions??[]).filter((u,g)=>g!==f);r(c.id,{conditions:h})},children:"×"})]},f)),d.jsx(le,{size:"xs",onClick:()=>{var f;const l=[...c.data.conditions??[],{varName:((f=a[0])==null?void 0:f.name)??"",op:"gte",value:0}];r(c.id,{conditions:l})},children:"+ Add Condition"})]})}),Yt(c)&&d.jsx(pe,{title:"Variable Effects",className:"mt-3",children:d.jsx("div",{className:"space-y-2",children:a.map(l=>{const f=c.data.effects[l.name]??0;return d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"w-20 text-xs text-zinc-400 font-mono",children:l.name}),d.jsx(le,{size:"xs",onClick:()=>r(c.id,{effects:{...c.data.effects,[l.name]:f-1}}),children:"−"}),d.jsxs("span",{className:`w-10 text-center text-xs font-mono ${f>0?"text-green-400":f<0?"text-red-400":"text-zinc-600"}`,children:[f>0?"+":"",f]}),d.jsx(le,{size:"xs",onClick:()=>r(c.id,{effects:{...c.data.effects,[l.name]:f+1}}),children:"+"})]},l.name)})})})]}),d.jsxs(qn,{children:[e.length," nodes • ",t.length," edges",d.jsx("span",{className:"ml-auto",children:n?`ID: ${n}`:"Ready"})]})]}):d.jsx(Ye,{children:d.jsxs("div",{className:"text-center py-8",children:[d.jsx("p",{className:"text-zinc-600 text-xs mb-4",children:"No node selected"}),d.jsxs("div",{className:"flex gap-2 justify-center",children:[d.jsx(le,{icon:ut,onClick:s,children:"Add Scene"}),d.jsx(le,{icon:ut,onClick:()=>i(),children:"Add Choice"})]})]})})},Vp=()=>d.jsxs("div",{className:"flex h-full",children:[d.jsx("div",{className:"flex-1 bg-zinc-900",children:d.jsx(ja,{})}),d.jsxs(Xe,{className:"w-96 border-l border-zinc-800",children:[d.jsx(vt,{title:"Inspector"}),d.jsx(Dp,{})]})]}),Rp={scene:ka,choice:Ea},Lp={type:"smoothstep",markerEnd:{type:"arrow"},style:{strokeWidth:2,stroke:"#52525b"}},Hp=()=>{const e=oe(E=>E.nodes),t=oe(E=>E.edges),n=oe(E=>E.getChoicesForScene),r=It(E=>E.currentSceneId),o=It(E=>E.start),s=It(E=>E.goTo),i=It(E=>E.reset),a=ye(E=>E.variables),c=ye(E=>E.loadVariables),{setCenter:l,fitView:f,getZoom:h}=Wn(),u=fe.useRef(null),g=fe.useRef(!0),y=Be(E=>E.currentVideoUrl),p=Be(E=>E.duration),x=Be(E=>E.currentTime),b=fe.useMemo(()=>y&&Number.isFinite(p)&&Number.isFinite(x)?Math.ceil(Math.max(0,(p||0)-(x||0))):null,[y,p,x]);fe.useEffect(()=>{r||o()},[r,o]);const N=fe.useMemo(()=>e.find(E=>E.id===r&&He(E)),[e,r]);fe.useEffect(()=>{g.current&&e.length>0&&(g.current=!1,requestAnimationFrame(()=>{f({padding:.2,duration:800,maxZoom:1,minZoom:.5})}))},[e.length,f]),fe.useEffect(()=>{if(!N||u.current===N.id)return;const E=N.position.x+120,L=N.position.y+120,V=h(),$=V<.5?.8:V;l(E,L,{zoom:$,duration:600}).then(()=>{u.current=N.id})},[N,l,h]);const m=fe.useMemo(()=>N?n(N.id):[],[N,n]),w=fe.useCallback(E=>{const L=t.find($=>$.source===E);if(!L)return;const V=e.find($=>$.id===L.target);return V&&He(V)?V:void 0},[t,e]),k=fe.useCallback(E=>{const L=e.find(v=>v.id===E);if(!L||!Yt(L))return;const V=w(E);if(!V||!kr(V.data.conditions,a))return;const T=Dm(L.data.effects||{},a);c(T),u.current=null,s(V.id)},[e,w,a,c,s]),S=()=>{u.current=null,g.current=!0,i()},I=fe.useMemo(()=>e.map(E=>({...E,selected:E.id===r,draggable:!1,data:{...E.data,isCurrent:E.id===r}})),[e,r]),j=fe.useMemo(()=>t.map(E=>({...E,selected:!1})),[t]);return d.jsxs("div",{className:"flex h-full min-h-0",children:[d.jsx("div",{className:"flex-1 bg-zinc-950 min-h-0",children:d.jsxs(ra,{nodes:I,edges:j,nodeTypes:Rp,defaultEdgeOptions:Lp,connectionLineType:ke.SmoothStep,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,selectNodesOnDrag:!1,selectionOnDrag:!1,selectionKeyCode:null,panOnDrag:!0,zoomOnScroll:!0,zoomOnPinch:!0,children:[d.jsx(aa,{}),d.jsx(la,{}),d.jsx(sa,{gap:24,size:1})]})}),d.jsxs(Xe,{className:"w-[420px] border-l border-zinc-800 flex flex-col min-h-0",children:[d.jsx(vt,{title:"Play",actions:d.jsxs("div",{className:"flex items-center gap-2",children:[b!==null&&d.jsxs("div",{className:"flex items-center gap-1 text-zinc-300 text-xs",children:[d.jsx(bs,{className:"w-3 h-3"}),d.jsxs("span",{children:[b,"s"]})]}),d.jsx(le,{size:"xs",onClick:S,children:"Restart"})]})}),d.jsxs(Ye,{className:"space-y-3",children:[d.jsx(pe,{title:"Video",className:"p-0 overflow-hidden",children:d.jsx("div",{className:"h-[360px] md:h-[420px] lg:h-[480px] flex flex-col min-h-0",children:d.jsx(ha,{})})}),d.jsx(pe,{title:"Title",children:d.jsx("span",{className:`text-xs ${N?"text-zinc-300":"text-zinc-600"}`,children:N?N.data.label:"—"})}),d.jsx(pe,{title:"Choices",children:m.length>0?d.jsx("div",{className:"space-y-2",children:m.map(E=>{const L=w(E.id),V=!!L&&kr(L.data.conditions,a);return d.jsx(le,{variant:V?"primary":"default",onClick:()=>k(E.id),disabled:!V,className:"w-full justify-start",children:E.data.label},E.id)})}):d.jsx("p",{className:"text-xs text-zinc-600 text-center py-4",children:"No choices available"})})]}),d.jsxs(qn,{children:[d.jsxs("span",{children:[e.length," nodes • ",t.length," edges"]}),d.jsx("span",{className:"ml-auto",children:N?`Scene: ${N.id}`:"Ready"})]})]})]})},Fp=()=>{const e=ye(a=>a.variables),t=ye(a=>a.removeVariable),n=ye(a=>a.reset),r=ye(a=>a.loadVariables),o=A.useMemo(()=>new Map(e.map(a=>[a.name,a])),[e]),s=(a,c)=>{r(e.map(l=>l.name===a?{...l,...c}:l))},i=()=>{const a=prompt("Variable name:");if(!a)return;if(o.has(a)){alert("Variable with this name already exists.");return}const c={name:a,value:10,initialValue:10,min:void 0,max:void 0};r([...e,c])};return d.jsxs(Xe,{className:"h-full bg-zinc-900",children:[d.jsx(vt,{title:"Variables",actions:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("span",{className:"text-xs text-zinc-500",children:[e.length," items"]}),d.jsx(le,{variant:"default",size:"xs",icon:ut,onClick:i,children:"Add"}),d.jsx(le,{variant:"default",size:"xs",icon:Wc,onClick:n,children:"Reset"})]})}),d.jsx(Ye,{className:"p-2",children:e.length>0?d.jsx(d.Fragment,{children:e.map(a=>d.jsxs("div",{className:"mb-2",children:[d.jsxs("div",{className:"bg-zinc-800 border border-zinc-700 px-2 py-1 flex items-center justify-between",children:[d.jsx("span",{className:"text-xs font-mono text-zinc-300",children:a.name}),d.jsx("button",{onClick:()=>t(a.name),className:"text-zinc-600 hover:text-zinc-400 transition-colors text-lg leading-none",children:"×"})]}),d.jsx("div",{className:"bg-zinc-950 border-x border-b border-zinc-700 p-2",children:d.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[d.jsx(mn,{label:"Current",value:a.value,onChange:()=>{},disabled:!0}),d.jsx(mn,{label:"Initial",value:a.initialValue,onChange:c=>s(a.name,{initialValue:c,value:c})}),d.jsx(mn,{label:"Min",value:typeof a.min=="number"?a.min:"",placeholder:"—",onChange:c=>s(a.name,{min:c})}),d.jsx(mn,{label:"Max",value:typeof a.max=="number"?a.max:"",placeholder:"—",onChange:c=>s(a.name,{max:c})})]})})]},a.name))}):d.jsxs("div",{className:"text-center py-8",children:[d.jsx("div",{className:"text-zinc-600 italic text-xs mb-4",children:"No variables defined"}),d.jsx(le,{variant:"default",icon:ut,onClick:i,children:"Add Variable"})]})}),d.jsx(qn,{children:"Variable System"})]})},Bp=Ic([{element:d.jsx(Lm,{}),children:[{path:"/",element:d.jsx(Xm,{})},{path:"/video",element:d.jsx(Gm,{})},{path:"/story",element:d.jsx(Tp,{})},{path:"/storymap",element:d.jsx(Vp,{})},{path:"/variables",element:d.jsx(Fp,{})},{path:"/play",element:d.jsx(Hp,{})}]}]);Ac.createRoot(document.getElementById("root")).render(d.jsx(fe.StrictMode,{children:d.jsx($c,{router:Bp})}));
