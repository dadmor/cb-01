import{r as I,j as d,u as es,L as uc,O as dc,R as ye,c as fc,a as hc,b as gc}from"./react-vendor-fe022307.js";import{u as mc,s as ae,c as pc,a as Dt,p as ts}from"./zustand-vendor-bebbdc9e.js";import{F as ns,a as Et,G as rs,S as Or,C as xc,P as mr,U as yc,H as Fr,X as os,b as bc,c as wc,d as vc,e as Nc,L as Sc,I as Ec,R as Cc}from"./lucide-vendor-2824ad90.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function le(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=le(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var kc={value:()=>{}};function Sn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new an(n)}function an(e){this._=e}function _c(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}an.prototype=Sn.prototype={constructor:an,on:function(e,t){var n=this._,r=_c(e+"",n),o,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((o=(e=r[s]).type)&&(o=jc(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(o=(e=r[s]).type)n[o]=Yr(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Yr(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new an(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,s;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,o=s.length;r<o;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(t,n)}};function jc(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function Yr(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=kc,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Kn="http://www.w3.org/1999/xhtml";const Xr={svg:"http://www.w3.org/2000/svg",xhtml:Kn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function En(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Xr.hasOwnProperty(t)?{space:Xr[t],local:e}:e}function Mc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Kn&&t.documentElement.namespaceURI===Kn?t.createElement(e):t.createElementNS(n,e)}}function Pc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ss(e){var t=En(e);return(t.local?Pc:Mc)(t)}function Ac(){}function pr(e){return e==null?Ac:function(){return this.querySelector(e)}}function Ic(e){typeof e!="function"&&(e=pr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=new Array(i),c,l,u=0;u<i;++u)(c=s[u])&&(l=e.call(c,c.__data__,u,s))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new ge(r,this._parents)}function Tc(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function zc(){return[]}function is(e){return e==null?zc:function(){return this.querySelectorAll(e)}}function $c(e){return function(){return Tc(e.apply(this,arguments))}}function Dc(e){typeof e=="function"?e=$c(e):e=is(e);for(var t=this._groups,n=t.length,r=[],o=[],s=0;s<n;++s)for(var i=t[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),o.push(c));return new ge(r,o)}function as(e){return function(){return this.matches(e)}}function cs(e){return function(t){return t.matches(e)}}var Rc=Array.prototype.find;function Lc(e){return function(){return Rc.call(this.children,e)}}function Vc(){return this.firstElementChild}function Hc(e){return this.select(e==null?Vc:Lc(typeof e=="function"?e:cs(e)))}var Bc=Array.prototype.filter;function Oc(){return Array.from(this.children)}function Fc(e){return function(){return Bc.call(this.children,e)}}function Yc(e){return this.selectAll(e==null?Oc:Fc(typeof e=="function"?e:cs(e)))}function Xc(e){typeof e!="function"&&(e=as(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new ge(r,this._parents)}function ls(e){return new Array(e.length)}function Wc(){return new ge(this._enter||this._groups.map(ls),this._parents)}function fn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}fn.prototype={constructor:fn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Gc(e){return function(){return e}}function Uc(e,t,n,r,o,s){for(var i=0,a,c=t.length,l=s.length;i<l;++i)(a=t[i])?(a.__data__=s[i],r[i]=a):n[i]=new fn(e,s[i]);for(;i<c;++i)(a=t[i])&&(o[i]=a)}function qc(e,t,n,r,o,s,i){var a,c,l=new Map,u=t.length,h=s.length,f=new Array(u),g;for(a=0;a<u;++a)(c=t[a])&&(f[a]=g=i.call(c,c.__data__,a,t)+"",l.has(g)?o[a]=c:l.set(g,c));for(a=0;a<h;++a)g=i.call(e,s[a],a,s)+"",(c=l.get(g))?(r[a]=c,c.__data__=s[a],l.delete(g)):n[a]=new fn(e,s[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(f[a])===c&&(o[a]=c)}function Kc(e){return e.__data__}function Zc(e,t){if(!arguments.length)return Array.from(this,Kc);var n=t?qc:Uc,r=this._parents,o=this._groups;typeof e!="function"&&(e=Gc(e));for(var s=o.length,i=new Array(s),a=new Array(s),c=new Array(s),l=0;l<s;++l){var u=r[l],h=o[l],f=h.length,g=Qc(e.call(u,u&&u.__data__,l,r)),m=g.length,x=a[l]=new Array(m),y=i[l]=new Array(m),b=c[l]=new Array(f);n(u,h,x,y,b,g,t);for(var N=0,p=0,w,C;N<m;++N)if(w=x[N]){for(N>=p&&(p=N+1);!(C=y[p])&&++p<m;);w._next=C||null}}return i=new ge(i,r),i._enter=a,i._exit=c,i}function Qc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Jc(){return new ge(this._exit||this._groups.map(ls),this._parents)}function el(e,t,n){var r=this.enter(),o=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?s.remove():n(s),r&&o?r.merge(o).order():o}function tl(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,s=r.length,i=Math.min(o,s),a=new Array(o),c=0;c<i;++c)for(var l=n[c],u=r[c],h=l.length,f=a[c]=new Array(h),g,m=0;m<h;++m)(g=l[m]||u[m])&&(f[m]=g);for(;c<o;++c)a[c]=n[c];return new ge(a,this._parents)}function nl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,s=r[o],i;--o>=0;)(i=r[o])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function rl(e){e||(e=ol);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s){for(var i=n[s],a=i.length,c=o[s]=new Array(a),l,u=0;u<a;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new ge(o,this._parents).order()}function ol(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function sl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function il(){return Array.from(this)}function al(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length;o<s;++o){var i=r[o];if(i)return i}return null}function cl(){let e=0;for(const t of this)++e;return e}function ll(){return!this.node()}function ul(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],s=0,i=o.length,a;s<i;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}function dl(e){return function(){this.removeAttribute(e)}}function fl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function hl(e,t){return function(){this.setAttribute(e,t)}}function gl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ml(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function pl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function xl(e,t){var n=En(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?fl:dl:typeof t=="function"?n.local?pl:ml:n.local?gl:hl)(n,t))}function us(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function yl(e){return function(){this.style.removeProperty(e)}}function bl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function wl(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function vl(e,t,n){return arguments.length>1?this.each((t==null?yl:typeof t=="function"?wl:bl)(e,t,n??"")):ot(this.node(),e)}function ot(e,t){return e.style.getPropertyValue(t)||us(e).getComputedStyle(e,null).getPropertyValue(t)}function Nl(e){return function(){delete this[e]}}function Sl(e,t){return function(){this[e]=t}}function El(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Cl(e,t){return arguments.length>1?this.each((t==null?Nl:typeof t=="function"?El:Sl)(e,t)):this.node()[e]}function ds(e){return e.trim().split(/^|\s+/)}function xr(e){return e.classList||new fs(e)}function fs(e){this._node=e,this._names=ds(e.getAttribute("class")||"")}fs.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function hs(e,t){for(var n=xr(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function gs(e,t){for(var n=xr(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function kl(e){return function(){hs(this,e)}}function _l(e){return function(){gs(this,e)}}function jl(e,t){return function(){(t.apply(this,arguments)?hs:gs)(this,e)}}function Ml(e,t){var n=ds(e+"");if(arguments.length<2){for(var r=xr(this.node()),o=-1,s=n.length;++o<s;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?jl:t?kl:_l)(n,t))}function Pl(){this.textContent=""}function Al(e){return function(){this.textContent=e}}function Il(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Tl(e){return arguments.length?this.each(e==null?Pl:(typeof e=="function"?Il:Al)(e)):this.node().textContent}function zl(){this.innerHTML=""}function $l(e){return function(){this.innerHTML=e}}function Dl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Rl(e){return arguments.length?this.each(e==null?zl:(typeof e=="function"?Dl:$l)(e)):this.node().innerHTML}function Ll(){this.nextSibling&&this.parentNode.appendChild(this)}function Vl(){return this.each(Ll)}function Hl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Bl(){return this.each(Hl)}function Ol(e){var t=typeof e=="function"?e:ss(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Fl(){return null}function Yl(e,t){var n=typeof e=="function"?e:ss(e),r=t==null?Fl:typeof t=="function"?t:pr(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Xl(){var e=this.parentNode;e&&e.removeChild(this)}function Wl(){return this.each(Xl)}function Gl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ul(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ql(e){return this.select(e?Ul:Gl)}function Kl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Zl(e){return function(t){e.call(this,t,this.__data__)}}function Ql(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Jl(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,s;n<o;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function eu(e,t,n){return function(){var r=this.__on,o,s=Zl(t);if(r){for(var i=0,a=r.length;i<a;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=t;return}}this.addEventListener(e.type,s,n),o={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(o):this.__on=[o]}}function tu(e,t,n){var r=Ql(e+""),o,s=r.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(o=0,u=a[c];o<s;++o)if((i=r[o]).type===u.type&&i.name===u.name)return u.value}return}for(a=t?eu:Jl,o=0;o<s;++o)this.each(a(r[o],t,n));return this}function ms(e,t,n){var r=us(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function nu(e,t){return function(){return ms(this,e,t)}}function ru(e,t){return function(){return ms(this,e,t.apply(this,arguments))}}function ou(e,t){return this.each((typeof t=="function"?ru:nu)(e,t))}function*su(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length,i;o<s;++o)(i=r[o])&&(yield i)}var ps=[null];function ge(e,t){this._groups=e,this._parents=t}function Rt(){return new ge([[document.documentElement]],ps)}function iu(){return this}ge.prototype=Rt.prototype={constructor:ge,select:Ic,selectAll:Dc,selectChild:Hc,selectChildren:Yc,filter:Xc,data:Zc,enter:Wc,exit:Jc,join:el,merge:tl,selection:iu,order:nl,sort:rl,call:sl,nodes:il,node:al,size:cl,empty:ll,each:ul,attr:xl,style:vl,property:Cl,classed:Ml,text:Tl,html:Rl,raise:Vl,lower:Bl,append:Ol,insert:Yl,remove:Wl,clone:ql,datum:Kl,on:tu,dispatch:ou,[Symbol.iterator]:su};function fe(e){return typeof e=="string"?new ge([[document.querySelector(e)]],[document.documentElement]):new ge([[e]],ps)}function au(e){let t;for(;t=e.sourceEvent;)e=t;return e}function xe(e,t){if(e=au(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const cu={passive:!1},Ct={capture:!0,passive:!1};function Vn(e){e.stopImmediatePropagation()}function nt(e){e.preventDefault(),e.stopImmediatePropagation()}function xs(e){var t=e.document.documentElement,n=fe(e).on("dragstart.drag",nt,Ct);"onselectstart"in t?n.on("selectstart.drag",nt,Ct):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ys(e,t){var n=e.document.documentElement,r=fe(e).on("dragstart.drag",null);t&&(r.on("click.drag",nt,Ct),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ut=e=>()=>e;function Zn(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:s,x:i,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}Zn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function lu(e){return!e.ctrlKey&&!e.button}function uu(){return this.parentNode}function du(e,t){return t??{x:e.x,y:e.y}}function fu(){return navigator.maxTouchPoints||"ontouchstart"in this}function bs(){var e=lu,t=uu,n=du,r=fu,o={},s=Sn("start","drag","end"),i=0,a,c,l,u,h=0;function f(w){w.on("mousedown.drag",g).filter(r).on("touchstart.drag",y).on("touchmove.drag",b,cu).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(w,C){if(!(u||!e.call(this,w,C))){var E=p(this,t.call(this,w,C),w,C,"mouse");E&&(fe(w.view).on("mousemove.drag",m,Ct).on("mouseup.drag",x,Ct),xs(w.view),Vn(w),l=!1,a=w.clientX,c=w.clientY,E("start",w))}}function m(w){if(nt(w),!l){var C=w.clientX-a,E=w.clientY-c;l=C*C+E*E>h}o.mouse("drag",w)}function x(w){fe(w.view).on("mousemove.drag mouseup.drag",null),ys(w.view,l),nt(w),o.mouse("end",w)}function y(w,C){if(e.call(this,w,C)){var E=w.changedTouches,A=t.call(this,w,C),k=E.length,T,H;for(T=0;T<k;++T)(H=p(this,A,w,C,E[T].identifier,E[T]))&&(Vn(w),H("start",w,E[T]))}}function b(w){var C=w.changedTouches,E=C.length,A,k;for(A=0;A<E;++A)(k=o[C[A].identifier])&&(nt(w),k("drag",w,C[A]))}function N(w){var C=w.changedTouches,E=C.length,A,k;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),A=0;A<E;++A)(k=o[C[A].identifier])&&(Vn(w),k("end",w,C[A]))}function p(w,C,E,A,k,T){var H=s.copy(),L=xe(T||E,C),z,D,v;if((v=n.call(w,new Zn("beforestart",{sourceEvent:E,target:f,identifier:k,active:i,x:L[0],y:L[1],dx:0,dy:0,dispatch:H}),A))!=null)return z=v.x-L[0]||0,D=v.y-L[1]||0,function P(S,_,j){var M=L,$;switch(S){case"start":o[k]=P,$=i++;break;case"end":delete o[k],--i;case"drag":L=xe(j||_,C),$=i;break}H.call(S,w,new Zn(S,{sourceEvent:_,subject:v,target:f,identifier:k,active:$,x:L[0]+z,y:L[1]+D,dx:L[0]-M[0],dy:L[1]-M[1],dispatch:H}),A)}}return f.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Ut(!!w),f):e},f.container=function(w){return arguments.length?(t=typeof w=="function"?w:Ut(w),f):t},f.subject=function(w){return arguments.length?(n=typeof w=="function"?w:Ut(w),f):n},f.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:Ut(!!w),f):r},f.on=function(){var w=s.on.apply(s,arguments);return w===s?f:w},f.clickDistance=function(w){return arguments.length?(h=(w=+w)*w,f):Math.sqrt(h)},f}function yr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ws(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Lt(){}var kt=.7,hn=1/kt,rt="\\s*([+-]?\\d+)\\s*",_t="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ce="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hu=/^#([0-9a-f]{3,8})$/,gu=new RegExp(`^rgb\\(${rt},${rt},${rt}\\)$`),mu=new RegExp(`^rgb\\(${Ce},${Ce},${Ce}\\)$`),pu=new RegExp(`^rgba\\(${rt},${rt},${rt},${_t}\\)$`),xu=new RegExp(`^rgba\\(${Ce},${Ce},${Ce},${_t}\\)$`),yu=new RegExp(`^hsl\\(${_t},${Ce},${Ce}\\)$`),bu=new RegExp(`^hsla\\(${_t},${Ce},${Ce},${_t}\\)$`),Wr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yr(Lt,We,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Gr,formatHex:Gr,formatHex8:wu,formatHsl:vu,formatRgb:Ur,toString:Ur});function Gr(){return this.rgb().formatHex()}function wu(){return this.rgb().formatHex8()}function vu(){return vs(this).formatHsl()}function Ur(){return this.rgb().formatRgb()}function We(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=hu.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?qr(t):n===3?new de(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?qt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?qt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=gu.exec(e))?new de(t[1],t[2],t[3],1):(t=mu.exec(e))?new de(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=pu.exec(e))?qt(t[1],t[2],t[3],t[4]):(t=xu.exec(e))?qt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=yu.exec(e))?Qr(t[1],t[2]/100,t[3]/100,1):(t=bu.exec(e))?Qr(t[1],t[2]/100,t[3]/100,t[4]):Wr.hasOwnProperty(e)?qr(Wr[e]):e==="transparent"?new de(NaN,NaN,NaN,0):null}function qr(e){return new de(e>>16&255,e>>8&255,e&255,1)}function qt(e,t,n,r){return r<=0&&(e=t=n=NaN),new de(e,t,n,r)}function Nu(e){return e instanceof Lt||(e=We(e)),e?(e=e.rgb(),new de(e.r,e.g,e.b,e.opacity)):new de}function Qn(e,t,n,r){return arguments.length===1?Nu(e):new de(e,t,n,r??1)}function de(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}yr(de,Qn,ws(Lt,{brighter(e){return e=e==null?hn:Math.pow(hn,e),new de(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?kt:Math.pow(kt,e),new de(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new de(Oe(this.r),Oe(this.g),Oe(this.b),gn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kr,formatHex:Kr,formatHex8:Su,formatRgb:Zr,toString:Zr}));function Kr(){return`#${Be(this.r)}${Be(this.g)}${Be(this.b)}`}function Su(){return`#${Be(this.r)}${Be(this.g)}${Be(this.b)}${Be((isNaN(this.opacity)?1:this.opacity)*255)}`}function Zr(){const e=gn(this.opacity);return`${e===1?"rgb(":"rgba("}${Oe(this.r)}, ${Oe(this.g)}, ${Oe(this.b)}${e===1?")":`, ${e})`}`}function gn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Oe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Be(e){return e=Oe(e),(e<16?"0":"")+e.toString(16)}function Qr(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new be(e,t,n,r)}function vs(e){if(e instanceof be)return new be(e.h,e.s,e.l,e.opacity);if(e instanceof Lt||(e=We(e)),!e)return new be;if(e instanceof be)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),s=Math.max(t,n,r),i=NaN,a=s-o,c=(s+o)/2;return a?(t===s?i=(n-r)/a+(n<r)*6:n===s?i=(r-t)/a+2:i=(t-n)/a+4,a/=c<.5?s+o:2-s-o,i*=60):a=c>0&&c<1?0:i,new be(i,a,c,e.opacity)}function Eu(e,t,n,r){return arguments.length===1?vs(e):new be(e,t,n,r??1)}function be(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}yr(be,Eu,ws(Lt,{brighter(e){return e=e==null?hn:Math.pow(hn,e),new be(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?kt:Math.pow(kt,e),new be(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new de(Hn(e>=240?e-240:e+120,o,r),Hn(e,o,r),Hn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new be(Jr(this.h),Kt(this.s),Kt(this.l),gn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=gn(this.opacity);return`${e===1?"hsl(":"hsla("}${Jr(this.h)}, ${Kt(this.s)*100}%, ${Kt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Jr(e){return e=(e||0)%360,e<0?e+360:e}function Kt(e){return Math.max(0,Math.min(1,e||0))}function Hn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const br=e=>()=>e;function Cu(e,t){return function(n){return e+n*t}}function ku(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function _u(e){return(e=+e)==1?Ns:function(t,n){return n-t?ku(t,n,e):br(isNaN(t)?n:t)}}function Ns(e,t){var n=t-e;return n?Cu(e,n):br(isNaN(e)?t:e)}const mn=function e(t){var n=_u(t);function r(o,s){var i=n((o=Qn(o)).r,(s=Qn(s)).r),a=n(o.g,s.g),c=n(o.b,s.b),l=Ns(o.opacity,s.opacity);return function(u){return o.r=i(u),o.g=a(u),o.b=c(u),o.opacity=l(u),o+""}}return r.gamma=e,r}(1);function ju(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),o;return function(s){for(o=0;o<n;++o)r[o]=e[o]*(1-s)+t[o]*s;return r}}function Mu(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Pu(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,o=new Array(r),s=new Array(n),i;for(i=0;i<r;++i)o[i]=Nt(e[i],t[i]);for(;i<n;++i)s[i]=t[i];return function(a){for(i=0;i<r;++i)s[i]=o[i](a);return s}}function Au(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ne(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Iu(e,t){var n={},r={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?n[o]=Nt(e[o],t[o]):r[o]=t[o];return function(s){for(o in n)r[o]=n[o](s);return r}}var Jn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bn=new RegExp(Jn.source,"g");function Tu(e){return function(){return e}}function zu(e){return function(t){return e(t)+""}}function Ss(e,t){var n=Jn.lastIndex=Bn.lastIndex=0,r,o,s,i=-1,a=[],c=[];for(e=e+"",t=t+"";(r=Jn.exec(e))&&(o=Bn.exec(t));)(s=o.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(r=r[0])===(o=o[0])?a[i]?a[i]+=o:a[++i]=o:(a[++i]=null,c.push({i,x:Ne(r,o)})),n=Bn.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?c[0]?zu(c[0].x):Tu(t):(t=c.length,function(l){for(var u=0,h;u<t;++u)a[(h=c[u]).i]=h.x(l);return a.join("")})}function Nt(e,t){var n=typeof t,r;return t==null||n==="boolean"?br(t):(n==="number"?Ne:n==="string"?(r=We(t))?(t=r,mn):Ss:t instanceof We?mn:t instanceof Date?Au:Mu(t)?ju:Array.isArray(t)?Pu:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Iu:Ne)(e,t)}var eo=180/Math.PI,er={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Es(e,t,n,r,o,s){var i,a,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*eo,skewX:Math.atan(c)*eo,scaleX:i,scaleY:a}}var Zt;function $u(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?er:Es(t.a,t.b,t.c,t.d,t.e,t.f)}function Du(e){return e==null||(Zt||(Zt=document.createElementNS("http://www.w3.org/2000/svg","g")),Zt.setAttribute("transform",e),!(e=Zt.transform.baseVal.consolidate()))?er:(e=e.matrix,Es(e.a,e.b,e.c,e.d,e.e,e.f))}function Cs(e,t,n,r){function o(l){return l.length?l.pop()+" ":""}function s(l,u,h,f,g,m){if(l!==h||u!==f){var x=g.push("translate(",null,t,null,n);m.push({i:x-4,x:Ne(l,h)},{i:x-2,x:Ne(u,f)})}else(h||f)&&g.push("translate("+h+t+f+n)}function i(l,u,h,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:h.push(o(h)+"rotate(",null,r)-2,x:Ne(l,u)})):u&&h.push(o(h)+"rotate("+u+r)}function a(l,u,h,f){l!==u?f.push({i:h.push(o(h)+"skewX(",null,r)-2,x:Ne(l,u)}):u&&h.push(o(h)+"skewX("+u+r)}function c(l,u,h,f,g,m){if(l!==h||u!==f){var x=g.push(o(g)+"scale(",null,",",null,")");m.push({i:x-4,x:Ne(l,h)},{i:x-2,x:Ne(u,f)})}else(h!==1||f!==1)&&g.push(o(g)+"scale("+h+","+f+")")}return function(l,u){var h=[],f=[];return l=e(l),u=e(u),s(l.translateX,l.translateY,u.translateX,u.translateY,h,f),i(l.rotate,u.rotate,h,f),a(l.skewX,u.skewX,h,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,h,f),l=u=null,function(g){for(var m=-1,x=f.length,y;++m<x;)h[(y=f[m]).i]=y.x(g);return h.join("")}}}var Ru=Cs($u,"px, ","px)","deg)"),Lu=Cs(Du,", ",")",")"),Vu=1e-12;function to(e){return((e=Math.exp(e))+1/e)/2}function Hu(e){return((e=Math.exp(e))-1/e)/2}function Bu(e){return((e=Math.exp(2*e))-1)/(e+1)}const cn=function e(t,n,r){function o(s,i){var a=s[0],c=s[1],l=s[2],u=i[0],h=i[1],f=i[2],g=u-a,m=h-c,x=g*g+m*m,y,b;if(x<Vu)b=Math.log(f/l)/t,y=function(A){return[a+A*g,c+A*m,l*Math.exp(t*A*b)]};else{var N=Math.sqrt(x),p=(f*f-l*l+r*x)/(2*l*n*N),w=(f*f-l*l-r*x)/(2*f*n*N),C=Math.log(Math.sqrt(p*p+1)-p),E=Math.log(Math.sqrt(w*w+1)-w);b=(E-C)/t,y=function(A){var k=A*b,T=to(C),H=l/(n*N)*(T*Bu(t*k+C)-Hu(C));return[a+H*g,c+H*m,l*T/to(t*k+C)]}}return y.duration=b*1e3*t/Math.SQRT2,y}return o.rho=function(s){var i=Math.max(.001,+s),a=i*i,c=a*a;return e(i,a,c)},o}(Math.SQRT2,2,4);var st=0,bt=0,pt=0,ks=1e3,pn,wt,xn=0,Ge=0,Cn=0,jt=typeof performance=="object"&&performance.now?performance:Date,_s=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function wr(){return Ge||(_s(Ou),Ge=jt.now()+Cn)}function Ou(){Ge=0}function yn(){this._call=this._time=this._next=null}yn.prototype=js.prototype={constructor:yn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?wr():+n)+(t==null?0:+t),!this._next&&wt!==this&&(wt?wt._next=this:pn=this,wt=this),this._call=e,this._time=n,tr()},stop:function(){this._call&&(this._call=null,this._time=1/0,tr())}};function js(e,t,n){var r=new yn;return r.restart(e,t,n),r}function Fu(){wr(),++st;for(var e=pn,t;e;)(t=Ge-e._time)>=0&&e._call.call(void 0,t),e=e._next;--st}function no(){Ge=(xn=jt.now())+Cn,st=bt=0;try{Fu()}finally{st=0,Xu(),Ge=0}}function Yu(){var e=jt.now(),t=e-xn;t>ks&&(Cn-=t,xn=e)}function Xu(){for(var e,t=pn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:pn=n);wt=e,tr(r)}function tr(e){if(!st){bt&&(bt=clearTimeout(bt));var t=e-Ge;t>24?(e<1/0&&(bt=setTimeout(no,e-jt.now()-Cn)),pt&&(pt=clearInterval(pt))):(pt||(xn=jt.now(),pt=setInterval(Yu,ks)),st=1,_s(no))}}function ro(e,t,n){var r=new yn;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Wu=Sn("start","end","cancel","interrupt"),Gu=[],Ms=0,oo=1,nr=2,ln=3,so=4,rr=5,un=6;function kn(e,t,n,r,o,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;Uu(e,n,{name:t,index:r,group:o,on:Wu,tween:Gu,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Ms})}function vr(e,t){var n=ve(e,t);if(n.state>Ms)throw new Error("too late; already scheduled");return n}function _e(e,t){var n=ve(e,t);if(n.state>ln)throw new Error("too late; already running");return n}function ve(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Uu(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=js(s,0,n.time);function s(l){n.state=oo,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,h,f,g;if(n.state!==oo)return c();for(u in r)if(g=r[u],g.name===n.name){if(g.state===ln)return ro(i);g.state===so?(g.state=un,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[u]):+u<t&&(g.state=un,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[u])}if(ro(function(){n.state===ln&&(n.state=so,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=nr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===nr){for(n.state=ln,o=new Array(f=n.tween.length),u=0,h=-1;u<f;++u)(g=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(o[++h]=g);o.length=h+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=rr,1),h=-1,f=o.length;++h<f;)o[h].call(e,u);n.state===rr&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=un,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function dn(e,t){var n=e.__transition,r,o,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){s=!1;continue}o=r.state>nr&&r.state<rr,r.state=un,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}s&&delete e.__transition}}function qu(e){return this.each(function(){dn(this,e)})}function Ku(e,t){var n,r;return function(){var o=_e(this,e),s=o.tween;if(s!==n){r=n=s;for(var i=0,a=r.length;i<a;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function Zu(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var s=_e(this,e),i=s.tween;if(i!==r){o=(r=i).slice();for(var a={name:t,value:n},c=0,l=o.length;c<l;++c)if(o[c].name===t){o[c]=a;break}c===l&&o.push(a)}s.tween=o}}function Qu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ve(this.node(),n).tween,o=0,s=r.length,i;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?Ku:Zu)(n,e,t))}function Nr(e,t,n){var r=e._id;return e.each(function(){var o=_e(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return ve(o,r).value[t]}}function Ps(e,t){var n;return(typeof t=="number"?Ne:t instanceof We?mn:(n=We(t))?(t=n,mn):Ss)(e,t)}function Ju(e){return function(){this.removeAttribute(e)}}function ed(e){return function(){this.removeAttributeNS(e.space,e.local)}}function td(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttribute(e);return i===o?null:i===r?s:s=t(r=i,n)}}function nd(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?s:s=t(r=i,n)}}function rd(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function od(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function sd(e,t){var n=En(e),r=n==="transform"?Lu:Ps;return this.attrTween(e,typeof t=="function"?(n.local?od:rd)(n,r,Nr(this,"attr."+e,t)):t==null?(n.local?ed:Ju)(n):(n.local?nd:td)(n,r,t))}function id(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function ad(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function cd(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&ad(e,s)),n}return o._value=t,o}function ld(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&id(e,s)),n}return o._value=t,o}function ud(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=En(e);return this.tween(n,(r.local?cd:ld)(r,t))}function dd(e,t){return function(){vr(this,e).delay=+t.apply(this,arguments)}}function fd(e,t){return t=+t,function(){vr(this,e).delay=t}}function hd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dd:fd)(t,e)):ve(this.node(),t).delay}function gd(e,t){return function(){_e(this,e).duration=+t.apply(this,arguments)}}function md(e,t){return t=+t,function(){_e(this,e).duration=t}}function pd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?gd:md)(t,e)):ve(this.node(),t).duration}function xd(e,t){if(typeof t!="function")throw new Error;return function(){_e(this,e).ease=t}}function yd(e){var t=this._id;return arguments.length?this.each(xd(t,e)):ve(this.node(),t).ease}function bd(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;_e(this,e).ease=n}}function wd(e){if(typeof e!="function")throw new Error;return this.each(bd(this._id,e))}function vd(e){typeof e!="function"&&(e=as(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new Ae(r,this._parents,this._name,this._id)}function Nd(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,s=Math.min(r,o),i=new Array(r),a=0;a<s;++a)for(var c=t[a],l=n[a],u=c.length,h=i[a]=new Array(u),f,g=0;g<u;++g)(f=c[g]||l[g])&&(h[g]=f);for(;a<r;++a)i[a]=t[a];return new Ae(i,this._parents,this._name,this._id)}function Sd(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Ed(e,t,n){var r,o,s=Sd(t)?vr:_e;return function(){var i=s(this,e),a=i.on;a!==r&&(o=(r=a).copy()).on(t,n),i.on=o}}function Cd(e,t){var n=this._id;return arguments.length<2?ve(this.node(),n).on.on(e):this.each(Ed(n,e,t))}function kd(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function _d(){return this.on("end.remove",kd(this._id))}function jd(e){var t=this._name,n=this._id;typeof e!="function"&&(e=pr(e));for(var r=this._groups,o=r.length,s=new Array(o),i=0;i<o;++i)for(var a=r[i],c=a.length,l=s[i]=new Array(c),u,h,f=0;f<c;++f)(u=a[f])&&(h=e.call(u,u.__data__,f,a))&&("__data__"in u&&(h.__data__=u.__data__),l[f]=h,kn(l[f],t,n,f,l,ve(u,n)));return new Ae(s,this._parents,t,n)}function Md(e){var t=this._name,n=this._id;typeof e!="function"&&(e=is(e));for(var r=this._groups,o=r.length,s=[],i=[],a=0;a<o;++a)for(var c=r[a],l=c.length,u,h=0;h<l;++h)if(u=c[h]){for(var f=e.call(u,u.__data__,h,c),g,m=ve(u,n),x=0,y=f.length;x<y;++x)(g=f[x])&&kn(g,t,n,x,f,m);s.push(f),i.push(u)}return new Ae(s,i,t,n)}var Pd=Rt.prototype.constructor;function Ad(){return new Pd(this._groups,this._parents)}function Id(e,t){var n,r,o;return function(){var s=ot(this,e),i=(this.style.removeProperty(e),ot(this,e));return s===i?null:s===n&&i===r?o:o=t(n=s,r=i)}}function As(e){return function(){this.style.removeProperty(e)}}function Td(e,t,n){var r,o=n+"",s;return function(){var i=ot(this,e);return i===o?null:i===r?s:s=t(r=i,n)}}function zd(e,t,n){var r,o,s;return function(){var i=ot(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),ot(this,e))),i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a))}}function $d(e,t){var n,r,o,s="style."+t,i="end."+s,a;return function(){var c=_e(this,e),l=c.on,u=c.value[s]==null?a||(a=As(t)):void 0;(l!==n||o!==u)&&(r=(n=l).copy()).on(i,o=u),c.on=r}}function Dd(e,t,n){var r=(e+="")=="transform"?Ru:Ps;return t==null?this.styleTween(e,Id(e,r)).on("end.style."+e,As(e)):typeof t=="function"?this.styleTween(e,zd(e,r,Nr(this,"style."+e,t))).each($d(this._id,e)):this.styleTween(e,Td(e,r,t),n).on("end.style."+e,null)}function Rd(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Ld(e,t,n){var r,o;function s(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&Rd(e,i,n)),r}return s._value=t,s}function Vd(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Ld(e,t,n??""))}function Hd(e){return function(){this.textContent=e}}function Bd(e){return function(){var t=e(this);this.textContent=t??""}}function Od(e){return this.tween("text",typeof e=="function"?Bd(Nr(this,"text",e)):Hd(e==null?"":e+""))}function Fd(e){return function(t){this.textContent=e.call(this,t)}}function Yd(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Fd(o)),t}return r._value=e,r}function Xd(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Yd(e))}function Wd(){for(var e=this._name,t=this._id,n=Is(),r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,l=0;l<a;++l)if(c=i[l]){var u=ve(c,t);kn(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ae(r,this._parents,e,n)}function Gd(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(s,i){var a={value:i},c={value:function(){--o===0&&s()}};n.each(function(){var l=_e(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),o===0&&s()})}var Ud=0;function Ae(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Is(){return++Ud}var je=Rt.prototype;Ae.prototype={constructor:Ae,select:jd,selectAll:Md,selectChild:je.selectChild,selectChildren:je.selectChildren,filter:vd,merge:Nd,selection:Ad,transition:Wd,call:je.call,nodes:je.nodes,node:je.node,size:je.size,empty:je.empty,each:je.each,on:Cd,attr:sd,attrTween:ud,style:Dd,styleTween:Vd,text:Od,textTween:Xd,remove:_d,tween:Qu,delay:hd,duration:pd,ease:yd,easeVarying:wd,end:Gd,[Symbol.iterator]:je[Symbol.iterator]};function qd(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Kd={time:null,delay:0,duration:250,ease:qd};function Zd(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Qd(e){var t,n;e instanceof Ae?(t=e._id,e=e._name):(t=Is(),(n=Kd).time=wr(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&kn(c,e,t,l,i,n||Zd(c,t));return new Ae(r,this._parents,e,t)}Rt.prototype.interrupt=qu;Rt.prototype.transition=Qd;const Qt=e=>()=>e;function Jd(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Pe(e,t,n){this.k=e,this.x=t,this.y=n}Pe.prototype={constructor:Pe,scale:function(e){return e===1?this:new Pe(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Pe(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var _n=new Pe(1,0,0);Ts.prototype=Pe.prototype;function Ts(e){for(;!e.__zoom;)if(!(e=e.parentNode))return _n;return e.__zoom}function On(e){e.stopImmediatePropagation()}function xt(e){e.preventDefault(),e.stopImmediatePropagation()}function ef(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function tf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function io(){return this.__zoom||_n}function nf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function rf(){return navigator.maxTouchPoints||"ontouchstart"in this}function of(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function zs(){var e=ef,t=tf,n=of,r=nf,o=rf,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=cn,l=Sn("start","zoom","end"),u,h,f,g=500,m=150,x=0,y=10;function b(v){v.property("__zoom",io).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",H).filter(o).on("touchstart.zoom",L).on("touchmove.zoom",z).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(v,P,S,_){var j=v.selection?v.selection():v;j.property("__zoom",io),v!==j?C(v,P,S,_):j.interrupt().each(function(){E(this,arguments).event(_).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},b.scaleBy=function(v,P,S,_){b.scaleTo(v,function(){var j=this.__zoom.k,M=typeof P=="function"?P.apply(this,arguments):P;return j*M},S,_)},b.scaleTo=function(v,P,S,_){b.transform(v,function(){var j=t.apply(this,arguments),M=this.__zoom,$=S==null?w(j):typeof S=="function"?S.apply(this,arguments):S,R=M.invert($),V=typeof P=="function"?P.apply(this,arguments):P;return n(p(N(M,V),$,R),j,i)},S,_)},b.translateBy=function(v,P,S,_){b.transform(v,function(){return n(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),i)},null,_)},b.translateTo=function(v,P,S,_,j){b.transform(v,function(){var M=t.apply(this,arguments),$=this.__zoom,R=_==null?w(M):typeof _=="function"?_.apply(this,arguments):_;return n(_n.translate(R[0],R[1]).scale($.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof S=="function"?-S.apply(this,arguments):-S),M,i)},_,j)};function N(v,P){return P=Math.max(s[0],Math.min(s[1],P)),P===v.k?v:new Pe(P,v.x,v.y)}function p(v,P,S){var _=P[0]-S[0]*v.k,j=P[1]-S[1]*v.k;return _===v.x&&j===v.y?v:new Pe(v.k,_,j)}function w(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function C(v,P,S,_){v.on("start.zoom",function(){E(this,arguments).event(_).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(_).end()}).tween("zoom",function(){var j=this,M=arguments,$=E(j,M).event(_),R=t.apply(j,M),V=S==null?w(R):typeof S=="function"?S.apply(j,M):S,F=Math.max(R[1][0]-R[0][0],R[1][1]-R[0][1]),O=j.__zoom,q=typeof P=="function"?P.apply(j,M):P,Z=c(O.invert(V).concat(F/O.k),q.invert(V).concat(F/q.k));return function(Y){if(Y===1)Y=q;else{var B=Z(Y),U=F/B[2];Y=new Pe(U,V[0]-B[0]*U,V[1]-B[1]*U)}$.zoom(null,Y)}})}function E(v,P,S){return!S&&v.__zooming||new A(v,P)}function A(v,P){this.that=v,this.args=P,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,P),this.taps=0}A.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,P){return this.mouse&&v!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var P=fe(this.that).datum();l.call(v,this.that,new Jd(v,{sourceEvent:this.sourceEvent,target:b,type:v,transform:this.that.__zoom,dispatch:l}),P)}};function k(v,...P){if(!e.apply(this,arguments))return;var S=E(this,P).event(v),_=this.__zoom,j=Math.max(s[0],Math.min(s[1],_.k*Math.pow(2,r.apply(this,arguments)))),M=xe(v);if(S.wheel)(S.mouse[0][0]!==M[0]||S.mouse[0][1]!==M[1])&&(S.mouse[1]=_.invert(S.mouse[0]=M)),clearTimeout(S.wheel);else{if(_.k===j)return;S.mouse=[M,_.invert(M)],dn(this),S.start()}xt(v),S.wheel=setTimeout($,m),S.zoom("mouse",n(p(N(_,j),S.mouse[0],S.mouse[1]),S.extent,i));function $(){S.wheel=null,S.end()}}function T(v,...P){if(f||!e.apply(this,arguments))return;var S=v.currentTarget,_=E(this,P,!0).event(v),j=fe(v.view).on("mousemove.zoom",V,!0).on("mouseup.zoom",F,!0),M=xe(v,S),$=v.clientX,R=v.clientY;xs(v.view),On(v),_.mouse=[M,this.__zoom.invert(M)],dn(this),_.start();function V(O){if(xt(O),!_.moved){var q=O.clientX-$,Z=O.clientY-R;_.moved=q*q+Z*Z>x}_.event(O).zoom("mouse",n(p(_.that.__zoom,_.mouse[0]=xe(O,S),_.mouse[1]),_.extent,i))}function F(O){j.on("mousemove.zoom mouseup.zoom",null),ys(O.view,_.moved),xt(O),_.event(O).end()}}function H(v,...P){if(e.apply(this,arguments)){var S=this.__zoom,_=xe(v.changedTouches?v.changedTouches[0]:v,this),j=S.invert(_),M=S.k*(v.shiftKey?.5:2),$=n(p(N(S,M),_,j),t.apply(this,P),i);xt(v),a>0?fe(this).transition().duration(a).call(C,$,_,v):fe(this).call(b.transform,$,_,v)}}function L(v,...P){if(e.apply(this,arguments)){var S=v.touches,_=S.length,j=E(this,P,v.changedTouches.length===_).event(v),M,$,R,V;for(On(v),$=0;$<_;++$)R=S[$],V=xe(R,this),V=[V,this.__zoom.invert(V),R.identifier],j.touch0?!j.touch1&&j.touch0[2]!==V[2]&&(j.touch1=V,j.taps=0):(j.touch0=V,M=!0,j.taps=1+!!u);u&&(u=clearTimeout(u)),M&&(j.taps<2&&(h=V[0],u=setTimeout(function(){u=null},g)),dn(this),j.start())}}function z(v,...P){if(this.__zooming){var S=E(this,P).event(v),_=v.changedTouches,j=_.length,M,$,R,V;for(xt(v),M=0;M<j;++M)$=_[M],R=xe($,this),S.touch0&&S.touch0[2]===$.identifier?S.touch0[0]=R:S.touch1&&S.touch1[2]===$.identifier&&(S.touch1[0]=R);if($=S.that.__zoom,S.touch1){var F=S.touch0[0],O=S.touch0[1],q=S.touch1[0],Z=S.touch1[1],Y=(Y=q[0]-F[0])*Y+(Y=q[1]-F[1])*Y,B=(B=Z[0]-O[0])*B+(B=Z[1]-O[1])*B;$=N($,Math.sqrt(Y/B)),R=[(F[0]+q[0])/2,(F[1]+q[1])/2],V=[(O[0]+Z[0])/2,(O[1]+Z[1])/2]}else if(S.touch0)R=S.touch0[0],V=S.touch0[1];else return;S.zoom("touch",n(p($,R,V),S.extent,i))}}function D(v,...P){if(this.__zooming){var S=E(this,P).event(v),_=v.changedTouches,j=_.length,M,$;for(On(v),f&&clearTimeout(f),f=setTimeout(function(){f=null},g),M=0;M<j;++M)$=_[M],S.touch0&&S.touch0[2]===$.identifier?delete S.touch0:S.touch1&&S.touch1[2]===$.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&($=xe($,this),Math.hypot(h[0]-$[0],h[1]-$[1])<y)){var R=fe(this).on("dblclick.zoom");R&&R.apply(this,arguments)}}}return b.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:Qt(+v),b):r},b.filter=function(v){return arguments.length?(e=typeof v=="function"?v:Qt(!!v),b):e},b.touchable=function(v){return arguments.length?(o=typeof v=="function"?v:Qt(!!v),b):o},b.extent=function(v){return arguments.length?(t=typeof v=="function"?v:Qt([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),b):t},b.scaleExtent=function(v){return arguments.length?(s[0]=+v[0],s[1]=+v[1],b):[s[0],s[1]]},b.translateExtent=function(v){return arguments.length?(i[0][0]=+v[0][0],i[1][0]=+v[1][0],i[0][1]=+v[0][1],i[1][1]=+v[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(v){return arguments.length?(n=v,b):n},b.duration=function(v){return arguments.length?(a=+v,b):a},b.interpolate=function(v){return arguments.length?(c=v,b):c},b.on=function(){var v=l.on.apply(l,arguments);return v===l?b:v},b.clickDistance=function(v){return arguments.length?(x=(v=+v)*v,b):Math.sqrt(x)},b.tapDistance=function(v){return arguments.length?(y=+v,b):y},b}const ke={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Mt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],$s=["Enter"," ","Escape"],Ds={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var it;(function(e){e.Strict="strict",e.Loose="loose"})(it||(it={}));var Fe;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Fe||(Fe={}));var Pt;(function(e){e.Partial="partial",e.Full="full"})(Pt||(Pt={}));const Rs={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Se;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Se||(Se={}));var bn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(bn||(bn={}));var G;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(G||(G={}));const ao={[G.Left]:G.Right,[G.Right]:G.Left,[G.Top]:G.Bottom,[G.Bottom]:G.Top};function Ls(e){return e===null?null:e?"valid":"invalid"}const Vs=e=>"id"in e&&"source"in e&&"target"in e,sf=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Sr=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Vt=(e,t=[0,0])=>{const{width:n,height:r}=Ie(e),o=e.origin??t,s=n*o[0],i=r*o[1];return{x:e.position.x-s,y:e.position.y-i}},af=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const s=typeof o=="string";let i=!t.nodeLookup&&!s?o:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(o):Sr(o)?o:t.nodeLookup.get(o.id));const a=i?wn(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return jn(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Mn(n)},Ht=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=wn(r);n=jn(n,o)}}),Mn(n)},Er=(e,t,[n,r,o]=[0,0,1],s=!1,i=!1)=>{const a={...Ot(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:u,selectable:h=!0,hidden:f=!1}=l;if(i&&!h||f)continue;const g=u.width??l.width??l.initialWidth??null,m=u.height??l.height??l.initialHeight??null,x=At(a,ct(l)),y=(g??0)*(m??0),b=s&&x>0;(!l.internals.handleBounds||b||x>=y||l.dragging)&&c.push(l)}return c},cf=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function lf(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function uf({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=lf(e,i),c=Ht(a),l=Cr(c,t,n,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await r.setViewport(l,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function Hs({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let h=i.extent||o;if(i.extent==="parent"&&!i.expandParent)if(!a)s==null||s("005",ke.error005());else{const g=a.measured.width,m=a.measured.height;g&&m&&(h=[[c,l],[c+g,l+m]])}else a&&lt(i.extent)&&(h=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const f=lt(h)?Ue(t,h,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",ke.error015())),{position:{x:f.x-c+(i.measured.width??0)*u[0],y:f.y-l+(i.measured.height??0)*u[1]},positionAbsolute:f}}async function df({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const s=new Set(e.map(f=>f.id)),i=[];for(const f of n){if(f.deletable===!1)continue;const g=s.has(f.id),m=!g&&f.parentId&&i.find(x=>x.id===f.parentId);(g||m)&&i.push(f)}const a=new Set(t.map(f=>f.id)),c=r.filter(f=>f.deletable!==!1),u=cf(i,c);for(const f of c)a.has(f.id)&&!u.find(m=>m.id===f.id)&&u.push(f);if(!o)return{edges:u,nodes:i};const h=await o({nodes:i,edges:u});return typeof h=="boolean"?h?{edges:u,nodes:i}:{edges:[],nodes:[]}:h}const at=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Ue=(e={x:0,y:0},t,n)=>({x:at(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:at(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Bs(e,t,n){const{width:r,height:o}=Ie(n),{x:s,y:i}=n.internals.positionAbsolute;return Ue(e,[[s,i],[s+r,i+o]],t)}const co=(e,t,n)=>e<t?at(Math.abs(e-t),1,t)/t:e>n?-at(Math.abs(e-n),1,t)/t:0,Os=(e,t,n=15,r=40)=>{const o=co(e.x,r,t.width-r)*n,s=co(e.y,r,t.height-r)*n;return[o,s]},jn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),or=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Mn=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),ct=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Sr(e)?e.internals.positionAbsolute:Vt(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},wn=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Sr(e)?e.internals.positionAbsolute:Vt(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},Fs=(e,t)=>Mn(jn(or(e),or(t))),At=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},lo=e=>we(e.width)&&we(e.height)&&we(e.x)&&we(e.y),we=e=>!isNaN(e)&&isFinite(e),ff=(e,t)=>{},Bt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ot=({x:e,y:t},[n,r,o],s=!1,i=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return s?Bt(a,i):a},vn=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function Ze(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function hf(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=Ze(e,n),o=Ze(e,t);return{top:r,right:o,bottom:r,left:o,x:o*2,y:r*2}}if(typeof e=="object"){const r=Ze(e.top??e.y??0,n),o=Ze(e.bottom??e.y??0,n),s=Ze(e.left??e.x??0,t),i=Ze(e.right??e.x??0,t);return{top:r,right:i,bottom:o,left:s,x:s+i,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function gf(e,t,n,r,o,s){const{x:i,y:a}=vn(e,[t,n,r]),{x:c,y:l}=vn({x:e.x+e.width,y:e.y+e.height},[t,n,r]),u=o-c,h=s-l;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(h)}}const Cr=(e,t,n,r,o,s)=>{const i=hf(s,t,n),a=(t-i.x)/e.width,c=(n-i.y)/e.height,l=Math.min(a,c),u=at(l,r,o),h=e.x+e.width/2,f=e.y+e.height/2,g=t/2-h*u,m=n/2-f*u,x=gf(e,g,m,u,t,n),y={left:Math.min(x.left-i.left,0),top:Math.min(x.top-i.top,0),right:Math.min(x.right-i.right,0),bottom:Math.min(x.bottom-i.bottom,0)};return{x:g-y.left+y.right,y:m-y.top+y.bottom,zoom:u}},It=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function lt(e){return e!=null&&e!=="parent"}function Ie(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Ys(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Xs(e,t={width:0,height:0},n,r,o){const s={...e},i=r.get(n);if(i){const a=i.origin||o;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function uo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function mf(){let e,t;return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}}function pf(e){return{...Ds,...e||{}}}function St(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:s,y:i}=Ee(e),a=Ot({x:s-((o==null?void 0:o.left)??0),y:i-((o==null?void 0:o.top)??0)},r),{x:c,y:l}=n?Bt(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const kr=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ws=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},xf=["INPUT","SELECT","TEXTAREA"];function Gs(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:xf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Us=e=>"clientX"in e,Ee=(e,t)=>{var s,i;const n=Us(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,o=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},fo=(e,t,n,r,o)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:o,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...kr(i)}})};function qs({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:a}){const c=e*.125+o*.375+i*.375+n*.125,l=t*.125+s*.375+a*.375+r*.125,u=Math.abs(c-e),h=Math.abs(l-t);return[c,l,u,h]}function Jt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ho({pos:e,x1:t,y1:n,x2:r,y2:o,c:s}){switch(e){case G.Left:return[t-Jt(t-r,s),n];case G.Right:return[t+Jt(r-t,s),n];case G.Top:return[t,n-Jt(n-o,s)];case G.Bottom:return[t,n+Jt(o-n,s)]}}function Ks({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top,curvature:i=.25}){const[a,c]=ho({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[l,u]=ho({pos:s,x1:r,y1:o,x2:e,y2:t,c:i}),[h,f,g,m]=qs({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${r},${o}`,h,f,g,m]}function Zs({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,s=n<e?n+o:n-o,i=Math.abs(r-t)/2,a=r<t?r+i:r-i;return[s,a,o,i]}function yf({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r,elevateOnSelect:o=!1}){if(r!==void 0)return r;const s=o&&n?1e3:0,i=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return s+i}function bf({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const s=jn(wn(e),wn(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return At(i,Mn(s))>0}const wf=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,vf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Nf=(e,t)=>{if(!e.source||!e.target)return t;let n;return Vs(e)?n={...e}:n={...e,id:wf(e)},vf(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Qs({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,s,i,a]=Zs({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,s,i,a]}const go={[G.Left]:{x:-1,y:0},[G.Right]:{x:1,y:0},[G.Top]:{x:0,y:-1},[G.Bottom]:{x:0,y:1}},Sf=({source:e,sourcePosition:t=G.Bottom,target:n})=>t===G.Left||t===G.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},mo=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Ef({source:e,sourcePosition:t=G.Bottom,target:n,targetPosition:r=G.Top,center:o,offset:s,stepPosition:i}){const a=go[t],c=go[r],l={x:e.x+a.x*s,y:e.y+a.y*s},u={x:n.x+c.x*s,y:n.y+c.y*s},h=Sf({source:l,sourcePosition:t,target:u}),f=h.x!==0?"x":"y",g=h[f];let m=[],x,y;const b={x:0,y:0},N={x:0,y:0},[,,p,w]=Zs({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[f]*c[f]===-1){f==="x"?(x=o.x??l.x+(u.x-l.x)*i,y=o.y??(l.y+u.y)/2):(x=o.x??(l.x+u.x)/2,y=o.y??l.y+(u.y-l.y)*i);const E=[{x,y:l.y},{x,y:u.y}],A=[{x:l.x,y},{x:u.x,y}];a[f]===g?m=f==="x"?E:A:m=f==="x"?A:E}else{const E=[{x:l.x,y:u.y}],A=[{x:u.x,y:l.y}];if(f==="x"?m=a.x===g?A:E:m=a.y===g?E:A,t===r){const z=Math.abs(e[f]-n[f]);if(z<=s){const D=Math.min(s-1,s-z);a[f]===g?b[f]=(l[f]>e[f]?-1:1)*D:N[f]=(u[f]>n[f]?-1:1)*D}}if(t!==r){const z=f==="x"?"y":"x",D=a[f]===c[z],v=l[z]>u[z],P=l[z]<u[z];(a[f]===1&&(!D&&v||D&&P)||a[f]!==1&&(!D&&P||D&&v))&&(m=f==="x"?E:A)}const k={x:l.x+b.x,y:l.y+b.y},T={x:u.x+N.x,y:u.y+N.y},H=Math.max(Math.abs(k.x-m[0].x),Math.abs(T.x-m[0].x)),L=Math.max(Math.abs(k.y-m[0].y),Math.abs(T.y-m[0].y));H>=L?(x=(k.x+T.x)/2,y=m[0].y):(x=m[0].x,y=(k.y+T.y)/2)}return[[e,{x:l.x+b.x,y:l.y+b.y},...m,{x:u.x+N.x,y:u.y+N.y},n],x,y,p,w]}function Cf(e,t,n,r){const o=Math.min(mo(e,t)/2,mo(t,n)/2,r),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${s+o*l},${i}Q ${s},${i} ${s},${i+o*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${i+o*c}Q ${s},${i} ${s+o*a},${i}`}function sr({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top,borderRadius:i=5,centerX:a,centerY:c,offset:l=20,stepPosition:u=.5}){const[h,f,g,m,x]=Ef({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:s,center:{x:a,y:c},offset:l,stepPosition:u});return[h.reduce((b,N,p)=>{let w="";return p>0&&p<h.length-1?w=Cf(h[p-1],N,h[p+1],i):w=`${p===0?"M":"L"}${N.x} ${N.y}`,b+=w,b},""),f,g,m,x]}function po(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function kf(e){var h;const{sourceNode:t,targetNode:n}=e;if(!po(t)||!po(n))return null;const r=t.internals.handleBounds||xo(t.handles),o=n.internals.handleBounds||xo(n.handles),s=yo((r==null?void 0:r.source)??[],e.sourceHandle),i=yo(e.connectionMode===it.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!s||!i)return(h=e.onError)==null||h.call(e,"008",ke.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||G.Bottom,c=(i==null?void 0:i.position)||G.Top,l=Tt(t,s,a),u=Tt(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:c}}function xo(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Tt(e,t,n=G.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??Ie(e);if(r)return{x:o+i/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case G.Top:return{x:o+i/2,y:s};case G.Right:return{x:o+i,y:s+a/2};case G.Bottom:return{x:o+i/2,y:s+a};case G.Left:return{x:o,y:s+a/2}}}function yo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function ir(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function _f(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||r,a.markerEnd||o].forEach(c=>{if(c&&typeof c=="object"){const l=ir(c,t);s.has(l)||(i.push({id:l,color:c.color||n,...c}),s.add(l))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const _r={nodeOrigin:[0,0],nodeExtent:Mt,elevateNodesOnSelect:!0,defaults:{}},jf={..._r,checkEquality:!0};function jr(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Mf(e,t,n){const r=jr(_r,n);for(const o of e.values())if(o.parentId)Mr(o,e,t,r);else{const s=Vt(o,r.nodeOrigin),i=lt(o.extent)?o.extent:r.nodeExtent,a=Ue(s,i,Ie(o));o.internals.positionAbsolute=a}}function ar(e,t,n,r){var c,l;const o=jr(jf,r);let s=e.length>0;const i=new Map(t),a=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const u of e){let h=i.get(u.id);if(o.checkEquality&&u===(h==null?void 0:h.internals.userNode))t.set(u.id,h);else{const f=Vt(u,o.nodeOrigin),g=lt(u.extent)?u.extent:o.nodeExtent,m=Ue(f,g,Ie(u));h={...o.defaults,...u,measured:{width:(c=u.measured)==null?void 0:c.width,height:(l=u.measured)==null?void 0:l.height},internals:{positionAbsolute:m,handleBounds:u.measured?h==null?void 0:h.internals.handleBounds:void 0,z:Js(u,a),userNode:u}},t.set(u.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(s=!1),u.parentId&&Mr(h,t,n,r)}return s}function Pf(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Mr(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:i}=jr(_r,r),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Pf(e,n);const l=o?1e3:0,{x:u,y:h,z:f}=Af(e,c,s,i,l),{positionAbsolute:g}=e.internals,m=u!==g.x||h!==g.y;(m||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:m?{x:u,y:h}:g,z:f}})}function Js(e,t){return(we(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Af(e,t,n,r,o){const{x:s,y:i}=t.internals.positionAbsolute,a=Ie(e),c=Vt(e,n),l=lt(e.extent)?Ue(c,e.extent,a):c;let u=Ue({x:s+l.x,y:i+l.y},r,a);e.extent==="parent"&&(u=Bs(u,a,t));const h=Js(e,o),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>=h?f+1:h}}function Pr(e,t,n,r=[0,0]){var i;const o=[],s=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const l=((i=s.get(a.parentId))==null?void 0:i.expandedRect)??ct(c),u=Fs(l,a.rect);s.set(a.parentId,{expandedRect:u,parent:c})}return s.size>0&&s.forEach(({expandedRect:a,parent:c},l)=>{var p;const u=c.internals.positionAbsolute,h=Ie(c),f=c.origin??r,g=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,m=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,x=Math.max(h.width,Math.round(a.width)),y=Math.max(h.height,Math.round(a.height)),b=(x-h.width)*f[0],N=(y-h.height)*f[1];(g>0||m>0||b||N)&&(o.push({id:l,type:"position",position:{x:c.position.x-g+b,y:c.position.y-m+N}}),(p=n.get(l))==null||p.forEach(w=>{e.some(C=>C.id===w.id)||o.push({id:w.id,type:"position",position:{x:w.position.x+g,y:w.position.y+m}})})),(h.width<a.width||h.height<a.height||g||m)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:x+(g?f[0]*g-b:0),height:y+(m?f[1]*m-N:0)}})}),o}function If(e,t,n,r,o,s){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),h=[];for(const f of e.values()){const g=t.get(f.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),a=!0;continue}const m=kr(f.nodeElement),x=g.measured.width!==m.width||g.measured.height!==m.height;if(!!(m.width&&m.height&&(x||!g.internals.handleBounds||f.force))){const b=f.nodeElement.getBoundingClientRect(),N=lt(g.extent)?g.extent:s;let{positionAbsolute:p}=g.internals;g.parentId&&g.extent==="parent"?p=Bs(p,m,t.get(g.parentId)):N&&(p=Ue(p,N,m));const w={...g,measured:m,internals:{...g.internals,positionAbsolute:p,handleBounds:{source:fo("source",f.nodeElement,b,u,g.id),target:fo("target",f.nodeElement,b,u,g.id)}}};t.set(g.id,w),g.parentId&&Mr(w,t,n,{nodeOrigin:o}),a=!0,x&&(c.push({id:g.id,type:"dimensions",dimensions:m}),g.expandParent&&g.parentId&&h.push({id:g.id,parentId:g.parentId,rect:ct(w,o)}))}}if(h.length>0){const f=Pr(h,t,n,o);c.push(...f)}return{changes:c,updatedInternals:a}}async function Tf({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,s]],r),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function bo(e,t,n,r,o,s){let i=o;const a=r.get(i)||new Map;r.set(i,a.set(n,t)),i=`${o}-${e}`;const c=r.get(i)||new Map;if(r.set(i,c.set(n,t)),s){i=`${o}-${e}-${s}`;const l=r.get(i)||new Map;r.set(i,l.set(n,t))}}function ei(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:s,sourceHandle:i=null,targetHandle:a=null}=r,c={edgeId:r.id,source:o,target:s,sourceHandle:i,targetHandle:a},l=`${o}-${i}--${s}-${a}`,u=`${s}-${a}--${o}-${i}`;bo("source",c,u,e,o,i),bo("target",c,l,e,s,a),t.set(r.id,r)}}function ti(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:ti(n,t):!1}function wo(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function zf(e,t,n,r){const o=new Map;for(const[s,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!ti(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&o.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function Fn({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,a,c;const o=[];for(const[l,u]of t){const h=(i=n.get(l))==null?void 0:i.internals.userNode;h&&o.push({...h,position:u.position,dragging:r})}if(!e)return[o[0],o];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((c=t.get(e))==null?void 0:c.position)||s.position,dragging:r}:o[0],o]}function $f({dragItems:e,snapGrid:t,x:n,y:r}){const o=e.values().next().value;if(!o)return null;const s={x:n-o.distance.x,y:r-o.distance.y},i=Bt(s,t);return{x:i.x-s.x,y:i.y-s.y}}function Df({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let s={x:null,y:null},i=0,a=new Map,c=!1,l={x:0,y:0},u=null,h=!1,f=null,g=!1,m=!1,x=null;function y({noDragClassName:N,handleSelector:p,domNode:w,isSelectable:C,nodeId:E,nodeClickDistance:A=0}){f=fe(w);function k({x:z,y:D}){const{nodeLookup:v,nodeExtent:P,snapGrid:S,snapToGrid:_,nodeOrigin:j,onNodeDrag:M,onSelectionDrag:$,onError:R,updateNodePositions:V}=t();s={x:z,y:D};let F=!1;const O=a.size>1,q=O&&P?or(Ht(a)):null,Z=O&&_?$f({dragItems:a,snapGrid:S,x:z,y:D}):null;for(const[Y,B]of a){if(!v.has(Y))continue;let U={x:z-B.distance.x,y:D-B.distance.y};_&&(U=Z?{x:Math.round(U.x+Z.x),y:Math.round(U.y+Z.y)}:Bt(U,S));let ee=null;if(O&&P&&!B.extent&&q){const{positionAbsolute:Q}=B.internals,J=Q.x-q.x+P[0][0],oe=Q.x+B.measured.width-q.x2+P[1][0],ie=Q.y-q.y+P[0][1],pe=Q.y+B.measured.height-q.y2+P[1][1];ee=[[J,ie],[oe,pe]]}const{position:te,positionAbsolute:K}=Hs({nodeId:Y,nextPosition:U,nodeLookup:v,nodeExtent:ee||P,nodeOrigin:j,onError:R});F=F||B.position.x!==te.x||B.position.y!==te.y,B.position=te,B.internals.positionAbsolute=K}if(m=m||F,!!F&&(V(a,!0),x&&(r||M||!E&&$))){const[Y,B]=Fn({nodeId:E,dragItems:a,nodeLookup:v});r==null||r(x,a,Y,B),M==null||M(x,Y,B),E||$==null||$(x,B)}}async function T(){if(!u)return;const{transform:z,panBy:D,autoPanSpeed:v,autoPanOnNodeDrag:P}=t();if(!P){c=!1,cancelAnimationFrame(i);return}const[S,_]=Os(l,u,v);(S!==0||_!==0)&&(s.x=(s.x??0)-S/z[2],s.y=(s.y??0)-_/z[2],await D({x:S,y:_})&&k(s)),i=requestAnimationFrame(T)}function H(z){var O;const{nodeLookup:D,multiSelectionActive:v,nodesDraggable:P,transform:S,snapGrid:_,snapToGrid:j,selectNodesOnDrag:M,onNodeDragStart:$,onSelectionDragStart:R,unselectNodesAndEdges:V}=t();h=!0,(!M||!C)&&!v&&E&&((O=D.get(E))!=null&&O.selected||V()),C&&M&&E&&(e==null||e(E));const F=St(z.sourceEvent,{transform:S,snapGrid:_,snapToGrid:j,containerBounds:u});if(s=F,a=zf(D,P,F,E),a.size>0&&(n||$||!E&&R)){const[q,Z]=Fn({nodeId:E,dragItems:a,nodeLookup:D});n==null||n(z.sourceEvent,a,q,Z),$==null||$(z.sourceEvent,q,Z),E||R==null||R(z.sourceEvent,Z)}}const L=bs().clickDistance(A).on("start",z=>{const{domNode:D,nodeDragThreshold:v,transform:P,snapGrid:S,snapToGrid:_}=t();u=(D==null?void 0:D.getBoundingClientRect())||null,g=!1,m=!1,x=z.sourceEvent,v===0&&H(z),s=St(z.sourceEvent,{transform:P,snapGrid:S,snapToGrid:_,containerBounds:u}),l=Ee(z.sourceEvent,u)}).on("drag",z=>{const{autoPanOnNodeDrag:D,transform:v,snapGrid:P,snapToGrid:S,nodeDragThreshold:_,nodeLookup:j}=t(),M=St(z.sourceEvent,{transform:v,snapGrid:P,snapToGrid:S,containerBounds:u});if(x=z.sourceEvent,(z.sourceEvent.type==="touchmove"&&z.sourceEvent.touches.length>1||E&&!j.has(E))&&(g=!0),!g){if(!c&&D&&h&&(c=!0,T()),!h){const $=M.xSnapped-(s.x??0),R=M.ySnapped-(s.y??0);Math.sqrt($*$+R*R)>_&&H(z)}(s.x!==M.xSnapped||s.y!==M.ySnapped)&&a&&h&&(l=Ee(z.sourceEvent,u),k(M))}}).on("end",z=>{if(!(!h||g)&&(c=!1,h=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:D,updateNodePositions:v,onNodeDragStop:P,onSelectionDragStop:S}=t();if(m&&(v(a,!1),m=!1),o||P||!E&&S){const[_,j]=Fn({nodeId:E,dragItems:a,nodeLookup:D,dragging:!1});o==null||o(z.sourceEvent,a,_,j),P==null||P(z.sourceEvent,_,j),E||S==null||S(z.sourceEvent,j)}}}).filter(z=>{const D=z.target;return!z.button&&(!N||!wo(D,`.${N}`,w))&&(!p||wo(D,p,w))});f.call(L)}function b(){f==null||f.on(".drag",null)}return{update:y,destroy:b}}function Rf(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())At(o,ct(s))>0&&r.push(s);return r}const Lf=250;function Vf(e,t,n,r){var a,c;let o=[],s=1/0;const i=Rf(e,n,t+Lf);for(const l of i){const u=[...((a=l.internals.handleBounds)==null?void 0:a.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const h of u){if(r.nodeId===h.nodeId&&r.type===h.type&&r.id===h.id)continue;const{x:f,y:g}=Tt(l,h,h.position,!0),m=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(g-e.y,2));m>t||(m<s?(o=[{...h,x:f,y:g}],s=m):m===s&&o.push({...h,x:f,y:g}))}}if(!o.length)return null;if(o.length>1){const l=r.type==="source"?"target":"source";return o.find(u=>u.type===l)??o[0]}return o[0]}function ni(e,t,n,r,o,s=!1){var l,u,h;const i=r.get(e);if(!i)return null;const a=o==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((h=i.internals.handleBounds)==null?void 0:h.target)??[]],c=(n?a==null?void 0:a.find(f=>f.id===n):a==null?void 0:a[0])??null;return c&&s?{...c,...Tt(i,c,c.position,!0)}:c}function ri(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Hf(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const oi=()=>!0;function Bf(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:h,panBy:f,cancelConnection:g,onConnectStart:m,onConnect:x,onConnectEnd:y,isValidConnection:b=oi,onReconnectEnd:N,updateConnection:p,getTransform:w,getFromHandle:C,autoPanSpeed:E,dragThreshold:A=1,handleDomNode:k}){const T=Ws(e.target);let H=0,L;const{x:z,y:D}=Ee(e),v=ri(s,k),P=a==null?void 0:a.getBoundingClientRect();let S=!1;if(!P||!v)return;const _=ni(o,v,r,c,t);if(!_)return;let j=Ee(e,P),M=!1,$=null,R=!1,V=null;function F(){if(!u||!P)return;const[te,K]=Os(j,P,E);f({x:te,y:K}),H=requestAnimationFrame(F)}const O={..._,nodeId:o,type:v,position:_.position},q=c.get(o);let Y={inProgress:!0,isValid:null,from:Tt(q,O,G.Left,!0),fromHandle:O,fromPosition:O.position,fromNode:q,to:j,toHandle:null,toPosition:ao[O.position],toNode:null};function B(){S=!0,p(Y),m==null||m(e,{nodeId:o,handleId:r,handleType:v})}A===0&&B();function U(te){if(!S){const{x:oe,y:ie}=Ee(te),pe=oe-z,qe=ie-D;if(!(pe*pe+qe*qe>A*A))return;B()}if(!C()||!O){ee(te);return}const K=w();j=Ee(te,P),L=Vf(Ot(j,K,!1,[1,1]),n,c,O),M||(F(),M=!0);const Q=si(te,{handle:L,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:T,lib:l,flowId:h,nodeLookup:c});V=Q.handleDomNode,$=Q.connection,R=Hf(!!L,Q.isValid);const J={...Y,isValid:R,to:Q.toHandle&&R?vn({x:Q.toHandle.x,y:Q.toHandle.y},K):j,toHandle:Q.toHandle,toPosition:R&&Q.toHandle?Q.toHandle.position:ao[O.position],toNode:Q.toHandle?c.get(Q.toHandle.nodeId):null};R&&L&&Y.toHandle&&J.toHandle&&Y.toHandle.type===J.toHandle.type&&Y.toHandle.nodeId===J.toHandle.nodeId&&Y.toHandle.id===J.toHandle.id&&Y.to.x===J.to.x&&Y.to.y===J.to.y||(p(J),Y=J)}function ee(te){if(S){(L||V)&&$&&R&&(x==null||x($));const{inProgress:K,...Q}=Y,J={...Q,toPosition:Y.toHandle?Y.toPosition:null};y==null||y(te,J),s&&(N==null||N(te,J))}g(),cancelAnimationFrame(H),M=!1,R=!1,$=null,V=null,T.removeEventListener("mousemove",U),T.removeEventListener("mouseup",ee),T.removeEventListener("touchmove",U),T.removeEventListener("touchend",ee)}T.addEventListener("mousemove",U),T.addEventListener("mouseup",ee),T.addEventListener("touchmove",U),T.addEventListener("touchend",ee)}function si(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:s,doc:i,lib:a,flowId:c,isValidConnection:l=oi,nodeLookup:u}){const h=s==="target",f=t?i.querySelector(`.${a}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:g,y:m}=Ee(e),x=i.elementFromPoint(g,m),y=x!=null&&x.classList.contains(`${a}-flow__handle`)?x:f,b={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const N=ri(void 0,y),p=y.getAttribute("data-nodeid"),w=y.getAttribute("data-handleid"),C=y.classList.contains("connectable"),E=y.classList.contains("connectableend");if(!p||!N)return b;const A={source:h?p:r,sourceHandle:h?w:o,target:h?r:p,targetHandle:h?o:w};b.connection=A;const T=C&&E&&(n===it.Strict?h&&N==="source"||!h&&N==="target":p!==r||w!==o);b.isValid=T&&l(A),b.toHandle=ni(p,N,w,u,n,!0)}return b}const cr={onPointerDown:Bf,isValid:si};function Of({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=fe(e);function s({translateExtent:a,width:c,height:l,zoomStep:u=1,pannable:h=!0,zoomable:f=!0,inversePan:g=!1}){const m=p=>{if(p.sourceEvent.type!=="wheel"||!t)return;const w=n(),C=p.sourceEvent.ctrlKey&&It()?10:1,E=-p.sourceEvent.deltaY*(p.sourceEvent.deltaMode===1?.05:p.sourceEvent.deltaMode?1:.002)*u,A=w[2]*Math.pow(2,E*C);t.scaleTo(A)};let x=[0,0];const y=p=>{(p.sourceEvent.type==="mousedown"||p.sourceEvent.type==="touchstart")&&(x=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY])},b=p=>{const w=n();if(p.sourceEvent.type!=="mousemove"&&p.sourceEvent.type!=="touchmove"||!t)return;const C=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY],E=[C[0]-x[0],C[1]-x[1]];x=C;const A=r()*Math.max(w[2],Math.log(w[2]))*(g?-1:1),k={x:w[0]-E[0]*A,y:w[1]-E[1]*A},T=[[0,0],[c,l]];t.setViewportConstrained({x:k.x,y:k.y,zoom:w[2]},T,a)},N=zs().on("start",y).on("zoom",h?b:null).on("zoom.wheel",f?m:null);o.call(N,{})}function i(){o.on("zoom",null)}return{update:s,destroy:i,pointer:xe}}const Ff=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Pn=e=>({x:e.x,y:e.y,zoom:e.k}),Yn=({x:e,y:t,zoom:n})=>_n.translate(e,t).scale(n),Je=(e,t)=>e.target.closest(`.${t}`),ii=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Yf=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,Xn=(e,t=0,n=Yf,r=()=>{})=>{const o=typeof t=="number"&&t>0;return o||r(),o?e.transition().duration(t).ease(n).on("end",r):e},ai=e=>{const t=e.ctrlKey&&It()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Xf({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(Je(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const h=n.property("__zoom").k||1;if(u.ctrlKey&&i){const y=xe(u),b=ai(u),N=h*Math.pow(2,b);r.scaleTo(n,N,y,u);return}const f=u.deltaMode===1?20:1;let g=o===Fe.Vertical?0:u.deltaX*f,m=o===Fe.Horizontal?0:u.deltaY*f;!It()&&u.shiftKey&&o!==Fe.Vertical&&(g=u.deltaY*f,m=0),r.translateBy(n,-(g/h)*s,-(m/h)*s,{internal:!0});const x=Pn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,x)),e.isPanScrolling&&(c==null||c(u,x),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,x),e.isPanScrolling=!1},150))}}function Wf({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){const s=r.type==="wheel",i=!t&&s&&!r.ctrlKey,a=Je(r,e);if(r.ctrlKey&&s&&a&&r.preventDefault(),i||a)return null;r.preventDefault(),n.call(this,r,o)}}function Gf({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,i,a;if((s=r.sourceEvent)!=null&&s.internal)return;const o=Pn(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function Uf({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return s=>{var i,a;e.usedRightMouseButton=!!(n&&ii(t,e.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||r([s.transform.x,s.transform.y,s.transform.k]),o&&!((a=s.sourceEvent)!=null&&a.internal)&&(o==null||o(s.sourceEvent,Pn(s.transform)))}}function qf({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:s}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&ii(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&Ff(e.prevViewport,i.transform))){const c=Pn(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,c)},n?150:0)}}}function Kf({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:c,lib:l}){return u=>{var m;const h=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Je(u,`${l}-flow__node`)||Je(u,`${l}-flow__edge`)))return!0;if(!r&&!h&&!o&&!s&&!n||i||Je(u,a)&&u.type==="wheel"||Je(u,c)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((m=u.touches)==null?void 0:m.length)>1)return u.preventDefault(),!1;if(!h&&!o&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const g=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&g}}function Zf({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:s,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),f=zs().clickDistance(!we(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),g=fe(e).call(f);p({x:s.x,y:s.y,zoom:at(s.zoom,t,n)},[[0,0],[h.width,h.height]],o);const m=g.on("wheel.zoom"),x=g.on("dblclick.zoom");f.wheelDelta(ai);function y(z,D){return g?new Promise(v=>{f==null||f.interpolate((D==null?void 0:D.interpolate)==="linear"?Nt:cn).transform(Xn(g,D==null?void 0:D.duration,D==null?void 0:D.ease,()=>v(!0)),z)}):Promise.resolve(!1)}function b({noWheelClassName:z,noPanClassName:D,onPaneContextMenu:v,userSelectionActive:P,panOnScroll:S,panOnDrag:_,panOnScrollMode:j,panOnScrollSpeed:M,preventScrolling:$,zoomOnPinch:R,zoomOnScroll:V,zoomOnDoubleClick:F,zoomActivationKeyPressed:O,lib:q,onTransformChange:Z}){P&&!u.isZoomingOrPanning&&N();const B=S&&!O&&!P?Xf({zoomPanValues:u,noWheelClassName:z,d3Selection:g,d3Zoom:f,panOnScrollMode:j,panOnScrollSpeed:M,zoomOnPinch:R,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:c}):Wf({noWheelClassName:z,preventScrolling:$,d3ZoomHandler:m});if(g.on("wheel.zoom",B,{passive:!1}),!P){const ee=Gf({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:a});f.on("start",ee);const te=Uf({zoomPanValues:u,panOnDrag:_,onPaneContextMenu:!!v,onPanZoom:i,onTransformChange:Z});f.on("zoom",te);const K=qf({zoomPanValues:u,panOnDrag:_,panOnScroll:S,onPaneContextMenu:v,onPanZoomEnd:c,onDraggingChange:l});f.on("end",K)}const U=Kf({zoomActivationKeyPressed:O,panOnDrag:_,zoomOnScroll:V,panOnScroll:S,zoomOnDoubleClick:F,zoomOnPinch:R,userSelectionActive:P,noPanClassName:D,noWheelClassName:z,lib:q});f.filter(U),F?g.on("dblclick.zoom",x):g.on("dblclick.zoom",null)}function N(){f.on("zoom",null)}async function p(z,D,v){const P=Yn(z),S=f==null?void 0:f.constrain()(P,D,v);return S&&await y(S),new Promise(_=>_(S))}async function w(z,D){const v=Yn(z);return await y(v,D),new Promise(P=>P(v))}function C(z){if(g){const D=Yn(z),v=g.property("__zoom");(v.k!==z.zoom||v.x!==z.x||v.y!==z.y)&&(f==null||f.transform(g,D,null,{sync:!0}))}}function E(){const z=g?Ts(g.node()):{x:0,y:0,k:1};return{x:z.x,y:z.y,zoom:z.k}}function A(z,D){return g?new Promise(v=>{f==null||f.interpolate((D==null?void 0:D.interpolate)==="linear"?Nt:cn).scaleTo(Xn(g,D==null?void 0:D.duration,D==null?void 0:D.ease,()=>v(!0)),z)}):Promise.resolve(!1)}function k(z,D){return g?new Promise(v=>{f==null||f.interpolate((D==null?void 0:D.interpolate)==="linear"?Nt:cn).scaleBy(Xn(g,D==null?void 0:D.duration,D==null?void 0:D.ease,()=>v(!0)),z)}):Promise.resolve(!1)}function T(z){f==null||f.scaleExtent(z)}function H(z){f==null||f.translateExtent(z)}function L(z){const D=!we(z)||z<0?0:z;f==null||f.clickDistance(D)}return{update:b,destroy:N,setViewport:w,setViewportConstrained:p,getViewport:E,scaleTo:A,scaleBy:k,setScaleExtent:T,setTranslateExtent:H,syncViewport:C,setClickDistance:L}}var ut;(function(e){e.Line="line",e.Handle="handle"})(ut||(ut={}));function Qf({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:s}){const i=e-t,a=n-r,c=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&o&&(c[0]=c[0]*-1),a&&s&&(c[1]=c[1]*-1),c}function Jf(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function Te(e,t){return Math.max(0,t-e)}function ze(e,t){return Math.max(0,e-t)}function en(e,t,n){return Math.max(0,t-e,e-n)}function vo(e,t){return e?!t:t}function eh(e,t,n,r,o,s,i,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:h}=t,f=u&&h,{xSnapped:g,ySnapped:m}=n,{minWidth:x,maxWidth:y,minHeight:b,maxHeight:N}=r,{x:p,y:w,width:C,height:E,aspectRatio:A}=e;let k=Math.floor(u?g-e.pointerX:0),T=Math.floor(h?m-e.pointerY:0);const H=C+(c?-k:k),L=E+(l?-T:T),z=-s[0]*C,D=-s[1]*E;let v=en(H,x,y),P=en(L,b,N);if(i){let j=0,M=0;c&&k<0?j=Te(p+k+z,i[0][0]):!c&&k>0&&(j=ze(p+H+z,i[1][0])),l&&T<0?M=Te(w+T+D,i[0][1]):!l&&T>0&&(M=ze(w+L+D,i[1][1])),v=Math.max(v,j),P=Math.max(P,M)}if(a){let j=0,M=0;c&&k>0?j=ze(p+k,a[0][0]):!c&&k<0&&(j=Te(p+H,a[1][0])),l&&T>0?M=ze(w+T,a[0][1]):!l&&T<0&&(M=Te(w+L,a[1][1])),v=Math.max(v,j),P=Math.max(P,M)}if(o){if(u){const j=en(H/A,b,N)*A;if(v=Math.max(v,j),i){let M=0;!c&&!l||c&&!l&&f?M=ze(w+D+H/A,i[1][1])*A:M=Te(w+D+(c?k:-k)/A,i[0][1])*A,v=Math.max(v,M)}if(a){let M=0;!c&&!l||c&&!l&&f?M=Te(w+H/A,a[1][1])*A:M=ze(w+(c?k:-k)/A,a[0][1])*A,v=Math.max(v,M)}}if(h){const j=en(L*A,x,y)/A;if(P=Math.max(P,j),i){let M=0;!c&&!l||l&&!c&&f?M=ze(p+L*A+z,i[1][0])/A:M=Te(p+(l?T:-T)*A+z,i[0][0])/A,P=Math.max(P,M)}if(a){let M=0;!c&&!l||l&&!c&&f?M=Te(p+L*A,a[1][0])/A:M=ze(p+(l?T:-T)*A,a[0][0])/A,P=Math.max(P,M)}}}T=T+(T<0?P:-P),k=k+(k<0?v:-v),o&&(f?H>L*A?T=(vo(c,l)?-k:k)/A:k=(vo(c,l)?-T:T)*A:u?(T=k/A,l=c):(k=T*A,c=l));const S=c?p+k:p,_=l?w+T:w;return{width:C+(c?-k:k),height:E+(l?-T:T),x:s[0]*k*(c?-1:1)+S,y:s[1]*T*(l?-1:1)+_}}const ci={width:0,height:0,x:0,y:0},th={...ci,pointerX:0,pointerY:0,aspectRatio:1};function nh(e){return[[0,0],[e.measured.width,e.measured.height]]}function rh(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,c=n[1]*i;return[[r-a,o-c],[r+s-a,o+i-c]]}function oh({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const s=fe(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,resizeDirection:h,onResizeStart:f,onResize:g,onResizeEnd:m,shouldResize:x}){let y={...ci},b={...th};const N=Jf(c);let p,w=null,C=[],E,A,k;const T=bs().on("start",H=>{const{nodeLookup:L,transform:z,snapGrid:D,snapToGrid:v,nodeOrigin:P,paneDomNode:S}=n();if(p=L.get(t),!p)return;w=(S==null?void 0:S.getBoundingClientRect())??null;const{xSnapped:_,ySnapped:j}=St(H.sourceEvent,{transform:z,snapGrid:D,snapToGrid:v,containerBounds:w});y={width:p.measured.width??0,height:p.measured.height??0,x:p.position.x??0,y:p.position.y??0},b={...y,pointerX:_,pointerY:j,aspectRatio:y.width/y.height},E=void 0,p.parentId&&(p.extent==="parent"||p.expandParent)&&(E=L.get(p.parentId),A=E&&p.extent==="parent"?nh(E):void 0),C=[],k=void 0;for(const[M,$]of L)if($.parentId===t&&(C.push({id:M,position:{...$.position},extent:$.extent}),$.extent==="parent"||$.expandParent)){const R=rh($,p,$.origin??P);k?k=[[Math.min(R[0][0],k[0][0]),Math.min(R[0][1],k[0][1])],[Math.max(R[1][0],k[1][0]),Math.max(R[1][1],k[1][1])]]:k=R}f==null||f(H,{...y})}).on("drag",H=>{const{transform:L,snapGrid:z,snapToGrid:D,nodeOrigin:v}=n(),P=St(H.sourceEvent,{transform:L,snapGrid:z,snapToGrid:D,containerBounds:w}),S=[];if(!p)return;const{x:_,y:j,width:M,height:$}=y,R={},V=p.origin??v,{width:F,height:O,x:q,y:Z}=eh(b,N,P,l,u,V,A,k),Y=F!==M,B=O!==$,U=q!==_&&Y,ee=Z!==j&&B;if(!U&&!ee&&!Y&&!B)return;if((U||ee||V[0]===1||V[1]===1)&&(R.x=U?q:y.x,R.y=ee?Z:y.y,y.x=R.x,y.y=R.y,C.length>0)){const J=q-_,oe=Z-j;for(const ie of C)ie.position={x:ie.position.x-J+V[0]*(F-M),y:ie.position.y-oe+V[1]*(O-$)},S.push(ie)}if((Y||B)&&(R.width=Y&&(!h||h==="horizontal")?F:y.width,R.height=B&&(!h||h==="vertical")?O:y.height,y.width=R.width,y.height=R.height),E&&p.expandParent){const J=V[0]*(R.width??0);R.x&&R.x<J&&(y.x=J,b.x=b.x-(R.x-J));const oe=V[1]*(R.height??0);R.y&&R.y<oe&&(y.y=oe,b.y=b.y-(R.y-oe))}const te=Qf({width:y.width,prevWidth:M,height:y.height,prevHeight:$,affectsX:N.affectsX,affectsY:N.affectsY}),K={...y,direction:te};(x==null?void 0:x(H,K))!==!1&&(g==null||g(H,K),r(R,S))}).on("end",H=>{m==null||m(H,{...y}),o==null||o({...y})});s.call(T)}function a(){s.on(".drag",null)}return{update:i,destroy:a}}const An=I.createContext(null),sh=An.Provider,li=ke.error001();function re(e,t){const n=I.useContext(An);if(n===null)throw new Error(li);return mc(n,e,t)}function se(){const e=I.useContext(An);if(e===null)throw new Error(li);return I.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const No={display:"none"},ih={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ui="react-flow__node-desc",di="react-flow__edge-desc",ah="react-flow__aria-live",ch=e=>e.ariaLiveMessage,lh=e=>e.ariaLabelConfig;function uh({rfId:e}){const t=re(ch);return d.jsx("div",{id:`${ah}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ih,children:t})}function dh({rfId:e,disableKeyboardA11y:t}){const n=re(lh);return d.jsxs(d.Fragment,{children:[d.jsx("div",{id:`${ui}-${e}`,style:No,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),d.jsx("div",{id:`${di}-${e}`,style:No,children:n["edge.a11yDescription.default"]}),!t&&d.jsx(uh,{rfId:e})]})}const In=I.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},s)=>{const i=`${e}`.split("-");return d.jsx("div",{className:le(["react-flow__panel",n,...i]),style:r,ref:s,...o,children:t})});In.displayName="Panel";function fh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:d.jsx(In,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:d.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const hh=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},tn=e=>e.id;function gh(e,t){return ae(e.selectedNodes.map(tn),t.selectedNodes.map(tn))&&ae(e.selectedEdges.map(tn),t.selectedEdges.map(tn))}function mh({onSelectionChange:e}){const t=se(),{selectedNodes:n,selectedEdges:r}=re(hh,gh);return I.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(s=>s(o))},[n,r,e]),null}const ph=e=>!!e.onSelectionChangeHandlers;function xh({onSelectionChange:e}){const t=re(ph);return e||t?d.jsx(mh,{onSelectionChange:e}):null}const fi=[0,0],yh={x:0,y:0,zoom:1},bh=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],So=[...bh,"rfId"],wh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Eo={translateExtent:Mt,nodeOrigin:fi,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function vh(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=re(wh,ae),u=se();I.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{h.current=Eo,a()}),[]);const h=I.useRef(Eo);return I.useEffect(()=>{for(const f of So){const g=e[f],m=h.current[f];g!==m&&(typeof e[f]>"u"||(f==="nodes"?t(g):f==="edges"?n(g):f==="minZoom"?r(g):f==="maxZoom"?o(g):f==="translateExtent"?s(g):f==="nodeExtent"?i(g):f==="paneClickDistance"?l(g):f==="ariaLabelConfig"?u.setState({ariaLabelConfig:pf(g)}):f==="fitView"?u.setState({fitViewQueued:g}):f==="fitViewOptions"?u.setState({fitViewOptions:g}):u.setState({[f]:g})))}h.current=e},So.map(f=>e[f])),null}function Co(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Nh(e){var r;const[t,n]=I.useState(e==="system"?null:e);return I.useEffect(()=>{if(e!=="system"){n(e);return}const o=Co(),s=()=>n(o!=null&&o.matches?"dark":"light");return s(),o==null||o.addEventListener("change",s),()=>{o==null||o.removeEventListener("change",s)}},[e]),t!==null?t:(r=Co())!=null&&r.matches?"dark":"light"}const ko=typeof document<"u"?document:null;function zt(e=null,t={target:ko,actInsideInputWithModifier:!0}){const[n,r]=I.useState(!1),o=I.useRef(!1),s=I.useRef(new Set([])),[i,a]=I.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(h=>typeof h=="string").map(h=>h.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=l.reduce((h,f)=>h.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return I.useEffect(()=>{const c=(t==null?void 0:t.target)??ko,l=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const u=g=>{var y,b;if(o.current=g.ctrlKey||g.metaKey||g.shiftKey||g.altKey,(!o.current||o.current&&!l)&&Gs(g))return!1;const x=jo(g.code,a);if(s.current.add(g[x]),_o(i,s.current,!1)){const N=((b=(y=g.composedPath)==null?void 0:y.call(g))==null?void 0:b[0])||g.target,p=(N==null?void 0:N.nodeName)==="BUTTON"||(N==null?void 0:N.nodeName)==="A";t.preventDefault!==!1&&(o.current||!p)&&g.preventDefault(),r(!0)}},h=g=>{const m=jo(g.code,a);_o(i,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(g[m]),g.key==="Meta"&&s.current.clear(),o.current=!1},f=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",u),c==null||c.addEventListener("keyup",h),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{c==null||c.removeEventListener("keydown",u),c==null||c.removeEventListener("keyup",h),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function _o(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function jo(e,t){return t.includes(e)?"code":"key"}const Sh=()=>{const e=se();return I.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??s},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),c=Cr(t,r,o,s,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(c,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:c}=i.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},u=n.snapGrid??o,h=n.snapToGrid??s;return Ot(l,r,h,u)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:s}=r.getBoundingClientRect(),i=vn(t,n);return{x:i.x+o,y:i.y+s}}}),[])};function hi(e,t){const n=[],r=new Map,o=[];for(const s of e)if(s.type==="add"){o.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const i=r.get(s.id);i?i.push(s):r.set(s.id,[s])}for(const s of t){const i=r.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const c of i)Eh(c,a);n.push(a)}return o.length&&o.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function Eh(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function gi(e,t){return hi(e,t)}function mi(e,t){return hi(e,t)}function He(e,t){return{id:e,type:"select",selected:t}}function et(e,t=new Set,n=!1){const r=[];for(const[o,s]of e){const i=t.has(o);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),r.push(He(s.id,i)))}return r}function Mo({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,i]of e.entries()){const a=t.get(i.id),c=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function Po(e){return{id:e.id,type:"remove"}}const Ao=e=>sf(e),Ch=e=>Vs(e);function pi(e){return I.forwardRef(e)}const kh=typeof window<"u"?I.useLayoutEffect:I.useEffect;function Io(e){const[t,n]=I.useState(BigInt(0)),[r]=I.useState(()=>_h(()=>n(o=>o+BigInt(1))));return kh(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function _h(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const xi=I.createContext(null);function jh({children:e}){const t=se(),n=I.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:h,nodeLookup:f,fitViewQueued:g}=t.getState();let m=c;for(const y of a)m=typeof y=="function"?y(m):y;const x=Mo({items:m,lookup:f});u&&l(m),x.length>0?h==null||h(x):g&&window.requestAnimationFrame(()=>{const{fitViewQueued:y,nodes:b,setNodes:N}=t.getState();y&&N(b)})},[]),r=Io(n),o=I.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:h,edgeLookup:f}=t.getState();let g=c;for(const m of a)g=typeof m=="function"?m(g):m;u?l(g):h&&h(Mo({items:g,lookup:f}))},[]),s=Io(o),i=I.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return d.jsx(xi.Provider,{value:i,children:e})}function Mh(){const e=I.useContext(xi);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Ph=e=>!!e.panZoom;function Tn(){const e=Sh(),t=se(),n=Mh(),r=re(Ph),o=I.useMemo(()=>{const s=h=>t.getState().nodeLookup.get(h),i=h=>{n.nodeQueue.push(h)},a=h=>{n.edgeQueue.push(h)},c=h=>{var b,N;const{nodeLookup:f,nodeOrigin:g}=t.getState(),m=Ao(h)?h:f.get(h.id),x=m.parentId?Xs(m.position,m.measured,m.parentId,f,g):m.position,y={...m,position:x,width:((b=m.measured)==null?void 0:b.width)??m.width,height:((N=m.measured)==null?void 0:N.height)??m.height};return ct(y)},l=(h,f,g={replace:!1})=>{i(m=>m.map(x=>{if(x.id===h){const y=typeof f=="function"?f(x):f;return g.replace&&Ao(y)?y:{...x,...y}}return x}))},u=(h,f,g={replace:!1})=>{a(m=>m.map(x=>{if(x.id===h){const y=typeof f=="function"?f(x):f;return g.replace&&Ch(y)?y:{...x,...y}}return x}))};return{getNodes:()=>t.getState().nodes.map(h=>({...h})),getNode:h=>{var f;return(f=s(h))==null?void 0:f.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:h=[]}=t.getState();return h.map(f=>({...f}))},getEdge:h=>t.getState().edgeLookup.get(h),setNodes:i,setEdges:a,addNodes:h=>{const f=Array.isArray(h)?h:[h];n.nodeQueue.push(g=>[...g,...f])},addEdges:h=>{const f=Array.isArray(h)?h:[h];n.edgeQueue.push(g=>[...g,...f])},toObject:()=>{const{nodes:h=[],edges:f=[],transform:g}=t.getState(),[m,x,y]=g;return{nodes:h.map(b=>({...b})),edges:f.map(b=>({...b})),viewport:{x:m,y:x,zoom:y}}},deleteElements:async({nodes:h=[],edges:f=[]})=>{const{nodes:g,edges:m,onNodesDelete:x,onEdgesDelete:y,triggerNodeChanges:b,triggerEdgeChanges:N,onDelete:p,onBeforeDelete:w}=t.getState(),{nodes:C,edges:E}=await df({nodesToRemove:h,edgesToRemove:f,nodes:g,edges:m,onBeforeDelete:w}),A=E.length>0,k=C.length>0;if(A){const T=E.map(Po);y==null||y(E),N(T)}if(k){const T=C.map(Po);x==null||x(C),b(T)}return(k||A)&&(p==null||p({nodes:C,edges:E})),{deletedNodes:C,deletedEdges:E}},getIntersectingNodes:(h,f=!0,g)=>{const m=lo(h),x=m?h:c(h),y=g!==void 0;return x?(g||t.getState().nodes).filter(b=>{const N=t.getState().nodeLookup.get(b.id);if(N&&!m&&(b.id===h.id||!N.internals.positionAbsolute))return!1;const p=ct(y?b:N),w=At(p,x);return f&&w>0||w>=p.width*p.height||w>=x.width*x.height}):[]},isNodeIntersecting:(h,f,g=!0)=>{const x=lo(h)?h:c(h);if(!x)return!1;const y=At(x,f);return g&&y>0||y>=x.width*x.height},updateNode:l,updateNodeData:(h,f,g={replace:!1})=>{l(h,m=>{const x=typeof f=="function"?f(m):f;return g.replace?{...m,data:x}:{...m,data:{...m.data,...x}}},g)},updateEdge:u,updateEdgeData:(h,f,g={replace:!1})=>{u(h,m=>{const x=typeof f=="function"?f(m):f;return g.replace?{...m,data:x}:{...m,data:{...m.data,...x}}},g)},getNodesBounds:h=>{const{nodeLookup:f,nodeOrigin:g}=t.getState();return af(h,{nodeLookup:f,nodeOrigin:g})},getHandleConnections:({type:h,id:f,nodeId:g})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${g}-${h}${f?`-${f}`:""}`))==null?void 0:m.values())??[])},getNodeConnections:({type:h,handleId:f,nodeId:g})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${g}${h?f?`-${h}-${f}`:`-${h}`:""}`))==null?void 0:m.values())??[])},fitView:async h=>{const f=t.getState().fitViewResolver??mf();return t.setState({fitViewQueued:!0,fitViewOptions:h,fitViewResolver:f}),n.nodeQueue.push(g=>[...g]),f.promise}}},[]);return I.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const To=e=>e.selected,Ah=typeof window<"u"?window:void 0;function Ih({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=se(),{deleteElements:r}=Tn(),o=zt(e,{actInsideInputWithModifier:!1}),s=zt(t,{target:Ah});I.useEffect(()=>{if(o){const{edges:i,nodes:a}=n.getState();r({nodes:a.filter(To),edges:i.filter(To)}),n.setState({nodesSelectionActive:!1})}},[o]),I.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function Th(e){const t=se();I.useEffect(()=>{const n=()=>{var o,s;if(!e.current)return!1;const r=kr(e.current);(r.height===0||r.width===0)&&((s=(o=t.getState()).onError)==null||s.call(o,"004",ke.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const zn={position:"absolute",width:"100%",height:"100%",top:0,left:0},zh=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function $h({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:s=Fe.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:h,zoomActivationKeyCode:f,preventScrolling:g=!0,children:m,noWheelClassName:x,noPanClassName:y,onViewportChange:b,isControlledViewport:N,paneClickDistance:p}){const w=se(),C=I.useRef(null),{userSelectionActive:E,lib:A}=re(zh,ae),k=zt(f),T=I.useRef();Th(C);const H=I.useCallback(L=>{b==null||b({x:L[0],y:L[1],zoom:L[2]}),N||w.setState({transform:L})},[b,N]);return I.useEffect(()=>{if(C.current){T.current=Zf({domNode:C.current,minZoom:u,maxZoom:h,translateExtent:l,viewport:c,paneClickDistance:p,onDraggingChange:v=>w.setState({paneDragging:v}),onPanZoomStart:(v,P)=>{const{onViewportChangeStart:S,onMoveStart:_}=w.getState();_==null||_(v,P),S==null||S(P)},onPanZoom:(v,P)=>{const{onViewportChange:S,onMove:_}=w.getState();_==null||_(v,P),S==null||S(P)},onPanZoomEnd:(v,P)=>{const{onViewportChangeEnd:S,onMoveEnd:_}=w.getState();_==null||_(v,P),S==null||S(P)}});const{x:L,y:z,zoom:D}=T.current.getViewport();return w.setState({panZoom:T.current,transform:[L,z,D],domNode:C.current.closest(".react-flow")}),()=>{var v;(v=T.current)==null||v.destroy()}}},[]),I.useEffect(()=>{var L;(L=T.current)==null||L.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:k,preventScrolling:g,noPanClassName:y,userSelectionActive:E,noWheelClassName:x,lib:A,onTransformChange:H})},[e,t,n,r,o,s,i,a,k,g,y,E,x,A,H]),d.jsx("div",{className:"react-flow__renderer",ref:C,style:zn,children:m})}const Dh=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Rh(){const{userSelectionActive:e,userSelectionRect:t}=re(Dh,ae);return e&&t?d.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Wn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Lh=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Vh({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Pt.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:s,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:h,onPaneMouseLeave:f,children:g}){const m=se(),{userSelectionActive:x,elementsSelectable:y,dragging:b,connectionInProgress:N}=re(Lh,ae),p=y&&(e||x),w=I.useRef(null),C=I.useRef(),E=I.useRef(new Set),A=I.useRef(new Set),k=I.useRef(!1),T=I.useRef(!1),H=_=>{if(k.current||N){k.current=!1;return}a==null||a(_),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},L=_=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){_.preventDefault();return}c==null||c(_)},z=l?_=>l(_):void 0,D=_=>{var V,F;const{resetSelectedElements:j,domNode:M}=m.getState();if(C.current=M==null?void 0:M.getBoundingClientRect(),!y||!e||_.button!==0||_.target!==w.current||!C.current)return;(F=(V=_.target)==null?void 0:V.setPointerCapture)==null||F.call(V,_.pointerId),T.current=!0,k.current=!1;const{x:$,y:R}=Ee(_.nativeEvent,C.current);j(),m.setState({userSelectionRect:{width:0,height:0,startX:$,startY:R,x:$,y:R}}),s==null||s(_)},v=_=>{const{userSelectionRect:j,transform:M,nodeLookup:$,edgeLookup:R,connectionLookup:V,triggerNodeChanges:F,triggerEdgeChanges:O,defaultEdgeOptions:q}=m.getState();if(!C.current||!j)return;k.current=!0;const{x:Z,y:Y}=Ee(_.nativeEvent,C.current),{startX:B,startY:U}=j,ee={startX:B,startY:U,x:Z<B?Z:B,y:Y<U?Y:U,width:Math.abs(Z-B),height:Math.abs(Y-U)},te=E.current,K=A.current;E.current=new Set(Er($,ee,M,n===Pt.Partial,!0).map(J=>J.id)),A.current=new Set;const Q=(q==null?void 0:q.selectable)??!0;for(const J of E.current){const oe=V.get(J);if(oe)for(const{edgeId:ie}of oe.values()){const pe=R.get(ie);pe&&(pe.selectable??Q)&&A.current.add(ie)}}if(!uo(te,E.current)){const J=et($,E.current,!0);F(J)}if(!uo(K,A.current)){const J=et(R,A.current);O(J)}m.setState({userSelectionRect:ee,userSelectionActive:!0,nodesSelectionActive:!1})},P=_=>{var M,$;if(_.button!==0||!T.current)return;($=(M=_.target)==null?void 0:M.releasePointerCapture)==null||$.call(M,_.pointerId);const{userSelectionRect:j}=m.getState();!x&&j&&_.target===w.current&&(H==null||H(_)),m.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:E.current.size>0}),i==null||i(_),(t||o)&&(k.current=!1),T.current=!1},S=r===!0||Array.isArray(r)&&r.includes(0);return d.jsxs("div",{className:le(["react-flow__pane",{draggable:S,dragging:b,selection:e}]),onClick:p?void 0:Wn(H,w),onContextMenu:Wn(L,w),onWheel:Wn(z,w),onPointerEnter:p?void 0:u,onPointerDown:p?D:h,onPointerMove:p?v:h,onPointerUp:p?P:void 0,onPointerLeave:f,ref:w,style:zn,children:[g,d.jsx(Rh,{})]})}function lr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",ke.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(s({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):o([e])}function yi({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:s,nodeClickDistance:i}){const a=se(),[c,l]=I.useState(!1),u=I.useRef();return I.useEffect(()=>{u.current=Df({getStoreItems:()=>a.getState(),onNodeMouseDown:h=>{lr({id:h,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),I.useEffect(()=>{var h,f;if(t)(h=u.current)==null||h.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:o,nodeClickDistance:i}),()=>{var g;(g=u.current)==null||g.destroy()}},[n,r,t,s,e,o]),c}const Hh=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function bi(){const e=se();return I.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:u}=e.getState(),h=new Map,f=Hh(i),g=o?s[0]:5,m=o?s[1]:5,x=n.direction.x*g*n.factor,y=n.direction.y*m*n.factor;for(const[,b]of l){if(!f(b))continue;let N={x:b.internals.positionAbsolute.x+x,y:b.internals.positionAbsolute.y+y};o&&(N=Bt(N,s));const{position:p,positionAbsolute:w}=Hs({nodeId:b.id,nextPosition:N,nodeLookup:l,nodeExtent:r,nodeOrigin:u,onError:a});b.position=p,b.internals.positionAbsolute=w,h.set(b.id,b)}c(h)},[])}const Ar=I.createContext(null),Bh=Ar.Provider;Ar.Consumer;const wi=()=>I.useContext(Ar),Oh=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Fh=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:s,connection:i}=r,{fromHandle:a,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:s===it.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:u&&l}};function Yh({type:e="source",position:t=G.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:h,...f},g){var P,S;const m=i||null,x=e==="target",y=se(),b=wi(),{connectOnClick:N,noPanClassName:p,rfId:w}=re(Oh,ae),{connectingFrom:C,connectingTo:E,clickConnecting:A,isPossibleEndHandle:k,connectionInProcess:T,clickConnectionInProcess:H,valid:L}=re(Fh(b,m,e),ae);b||(S=(P=y.getState()).onError)==null||S.call(P,"010",ke.error010());const z=_=>{const{defaultEdgeOptions:j,onConnect:M,hasDefaultEdges:$}=y.getState(),R={...j,..._};if($){const{edges:V,setEdges:F}=y.getState();F(Nf(R,V))}M==null||M(R),a==null||a(R)},D=_=>{if(!b)return;const j=Us(_.nativeEvent);if(o&&(j&&_.button===0||!j)){const M=y.getState();cr.onPointerDown(_.nativeEvent,{handleDomNode:_.currentTarget,autoPanOnConnect:M.autoPanOnConnect,connectionMode:M.connectionMode,connectionRadius:M.connectionRadius,domNode:M.domNode,nodeLookup:M.nodeLookup,lib:M.lib,isTarget:x,handleId:m,nodeId:b,flowId:M.rfId,panBy:M.panBy,cancelConnection:M.cancelConnection,onConnectStart:M.onConnectStart,onConnectEnd:M.onConnectEnd,updateConnection:M.updateConnection,onConnect:z,isValidConnection:n||M.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:M.autoPanSpeed,dragThreshold:M.connectionDragThreshold})}j?u==null||u(_):h==null||h(_)},v=_=>{const{onClickConnectStart:j,onClickConnectEnd:M,connectionClickStartHandle:$,connectionMode:R,isValidConnection:V,lib:F,rfId:O,nodeLookup:q,connection:Z}=y.getState();if(!b||!$&&!o)return;if(!$){j==null||j(_.nativeEvent,{nodeId:b,handleId:m,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:b,type:e,id:m}});return}const Y=Ws(_.target),B=n||V,{connection:U,isValid:ee}=cr.isValid(_.nativeEvent,{handle:{nodeId:b,id:m,type:e},connectionMode:R,fromNodeId:$.nodeId,fromHandleId:$.id||null,fromType:$.type,isValidConnection:B,flowId:O,doc:Y,lib:F,nodeLookup:q});ee&&U&&z(U);const te=structuredClone(Z);delete te.inProgress,te.toPosition=te.toHandle?te.toHandle.position:null,M==null||M(_,te),y.setState({connectionClickStartHandle:null})};return d.jsx("div",{"data-handleid":m,"data-nodeid":b,"data-handlepos":t,"data-id":`${w}-${b}-${m}-${e}`,className:le(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",p,l,{source:!x,target:x,connectable:r,connectablestart:o,connectableend:s,clickconnecting:A,connectingfrom:C,connectingto:E,valid:L,connectionindicator:r&&(!T||k)&&(T||H?s:o)}]),onMouseDown:D,onTouchStart:D,onClick:N?v:void 0,ref:g,...f,children:c})}const Le=I.memo(pi(Yh));function Xh({data:e,isConnectable:t,sourcePosition:n=G.Bottom}){return d.jsxs(d.Fragment,{children:[e==null?void 0:e.label,d.jsx(Le,{type:"source",position:n,isConnectable:t})]})}function Wh({data:e,isConnectable:t,targetPosition:n=G.Top,sourcePosition:r=G.Bottom}){return d.jsxs(d.Fragment,{children:[d.jsx(Le,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,d.jsx(Le,{type:"source",position:r,isConnectable:t})]})}function Gh(){return null}function Uh({data:e,isConnectable:t,targetPosition:n=G.Top}){return d.jsxs(d.Fragment,{children:[d.jsx(Le,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Nn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},zo={input:Xh,default:Wh,output:Uh,group:Gh};function qh(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const Kh=e=>{const{width:t,height:n,x:r,y:o}=Ht(e.nodeLookup,{filter:s=>!!s.selected});return{width:we(t)?t:null,height:we(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function Zh({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=se(),{width:o,height:s,transformString:i,userSelectionActive:a}=re(Kh,ae),c=bi(),l=I.useRef(null);if(I.useEffect(()=>{var f;n||(f=l.current)==null||f.focus({preventScroll:!0})},[n]),yi({nodeRef:l}),a||!o||!s)return null;const u=e?f=>{const g=r.getState().nodes.filter(m=>m.selected);e(f,g)}:void 0,h=f=>{Object.prototype.hasOwnProperty.call(Nn,f.key)&&(f.preventDefault(),c({direction:Nn[f.key],factor:f.shiftKey?4:1}))};return d.jsx("div",{className:le(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:d.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:o,height:s}})})}const $o=typeof window<"u"?window:void 0,Qh=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function vi({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:h,onSelectionStart:f,onSelectionEnd:g,multiSelectionKeyCode:m,panActivationKeyCode:x,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:N,zoomOnPinch:p,panOnScroll:w,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:A,panOnDrag:k,defaultViewport:T,translateExtent:H,minZoom:L,maxZoom:z,preventScrolling:D,onSelectionContextMenu:v,noWheelClassName:P,noPanClassName:S,disableKeyboardA11y:_,onViewportChange:j,isControlledViewport:M}){const{nodesSelectionActive:$,userSelectionActive:R}=re(Qh),V=zt(l,{target:$o}),F=zt(x,{target:$o}),O=F||k,q=F||w,Z=u&&O!==!0,Y=V||R||Z;return Ih({deleteKeyCode:c,multiSelectionKeyCode:m}),d.jsx($h,{onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:N,zoomOnPinch:p,panOnScroll:q,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:A,panOnDrag:!V&&O,defaultViewport:T,translateExtent:H,minZoom:L,maxZoom:z,zoomActivationKeyCode:y,preventScrolling:D,noWheelClassName:P,noPanClassName:S,onViewportChange:j,isControlledViewport:M,paneClickDistance:a,children:d.jsxs(Vh,{onSelectionStart:f,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:O,isSelecting:!!Y,selectionMode:h,selectionKeyPressed:V,selectionOnDrag:Z,children:[e,$&&d.jsx(Zh,{onSelectionContextMenu:v,noPanClassName:S,disableKeyboardA11y:_})]})})}vi.displayName="FlowRenderer";const Jh=I.memo(vi),eg=e=>t=>e?Er(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function tg(e){return re(I.useCallback(eg(e),[e]),ae)}const ng=e=>e.updateNodeInternals;function rg(){const e=re(ng),[t]=I.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const s=o.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:o.target,force:!0})}),e(r)}));return I.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function og({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=se(),s=I.useRef(null),i=I.useRef(null),a=I.useRef(e.sourcePosition),c=I.useRef(e.targetPosition),l=I.useRef(t),u=n&&!!e.internals.handleBounds;return I.useEffect(()=>{s.current&&!e.hidden&&(!u||i.current!==s.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(s.current),i.current=s.current)},[u,e.hidden]),I.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),I.useEffect(()=>{if(s.current){const h=l.current!==t,f=a.current!==e.sourcePosition,g=c.current!==e.targetPosition;(h||f||g)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function sg({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:h,noDragClassName:f,noPanClassName:g,disableKeyboardA11y:m,rfId:x,nodeTypes:y,nodeClickDistance:b,onError:N}){const{node:p,internals:w,isParent:C}=re(B=>{const U=B.nodeLookup.get(e),ee=B.parentLookup.has(e);return{node:U,internals:U.internals,isParent:ee}},ae);let E=p.type||"default",A=(y==null?void 0:y[E])||zo[E];A===void 0&&(N==null||N("003",ke.error003(E)),E="default",A=(y==null?void 0:y.default)||zo.default);const k=!!(p.draggable||a&&typeof p.draggable>"u"),T=!!(p.selectable||c&&typeof p.selectable>"u"),H=!!(p.connectable||l&&typeof p.connectable>"u"),L=!!(p.focusable||u&&typeof p.focusable>"u"),z=se(),D=Ys(p),v=og({node:p,nodeType:E,hasDimensions:D,resizeObserver:h}),P=yi({nodeRef:v,disabled:p.hidden||!k,noDragClassName:f,handleSelector:p.dragHandle,nodeId:e,isSelectable:T,nodeClickDistance:b}),S=bi();if(p.hidden)return null;const _=Ie(p),j=qh(p),M=T||k||t||n||r||o,$=n?B=>n(B,{...w.userNode}):void 0,R=r?B=>r(B,{...w.userNode}):void 0,V=o?B=>o(B,{...w.userNode}):void 0,F=s?B=>s(B,{...w.userNode}):void 0,O=i?B=>i(B,{...w.userNode}):void 0,q=B=>{const{selectNodesOnDrag:U,nodeDragThreshold:ee}=z.getState();T&&(!U||!k||ee>0)&&lr({id:e,store:z,nodeRef:v}),t&&t(B,{...w.userNode})},Z=B=>{if(!(Gs(B.nativeEvent)||m)){if($s.includes(B.key)&&T){const U=B.key==="Escape";lr({id:e,store:z,unselect:U,nodeRef:v})}else if(k&&p.selected&&Object.prototype.hasOwnProperty.call(Nn,B.key)){B.preventDefault();const{ariaLabelConfig:U}=z.getState();z.setState({ariaLiveMessage:U["node.a11yDescription.ariaLiveMessage"]({direction:B.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),S({direction:Nn[B.key],factor:B.shiftKey?4:1})}}},Y=()=>{var J;if(m||!((J=v.current)!=null&&J.matches(":focus-visible")))return;const{transform:B,width:U,height:ee,autoPanOnNodeFocus:te,setCenter:K}=z.getState();if(!te)return;Er(new Map([[e,p]]),{x:0,y:0,width:U,height:ee},B,!0).length>0||K(p.position.x+_.width/2,p.position.y+_.height/2,{zoom:B[2]})};return d.jsx("div",{className:le(["react-flow__node",`react-flow__node-${E}`,{[g]:k},p.className,{selected:p.selected,selectable:T,parent:C,draggable:k,dragging:P}]),ref:v,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:M?"all":"none",visibility:D?"visible":"hidden",...p.style,...j},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:$,onMouseMove:R,onMouseLeave:V,onContextMenu:F,onClick:q,onDoubleClick:O,onKeyDown:L?Z:void 0,tabIndex:L?0:void 0,onFocus:L?Y:void 0,role:p.ariaRole??(L?"group":void 0),"aria-roledescription":"node","aria-describedby":m?void 0:`${ui}-${x}`,"aria-label":p.ariaLabel,...p.domAttributes,children:d.jsx(Bh,{value:e,children:d.jsx(A,{id:e,data:p.data,type:E,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:p.selected??!1,selectable:T,draggable:k,deletable:p.deletable??!0,isConnectable:H,sourcePosition:p.sourcePosition,targetPosition:p.targetPosition,dragging:P,dragHandle:p.dragHandle,zIndex:w.z,parentId:p.parentId,..._})})})}const ig=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Ni(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:s}=re(ig,ae),i=tg(e.onlyRenderVisibleElements),a=rg();return d.jsx("div",{className:"react-flow__nodes",style:zn,children:i.map(c=>d.jsx(sg,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:s},c))})}Ni.displayName="NodeRenderer";const ag=I.memo(Ni);function cg(e){return re(I.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const s=n.nodeLookup.get(o.source),i=n.nodeLookup.get(o.target);s&&i&&bf({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),ae)}const lg=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return d.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},ug=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return d.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Do={[bn.Arrow]:lg,[bn.ArrowClosed]:ug};function dg(e){const t=se();return I.useMemo(()=>{var o,s;return Object.prototype.hasOwnProperty.call(Do,e)?Do[e]:((s=(o=t.getState()).onError)==null||s.call(o,"009",ke.error009(e)),null)},[e])}const fg=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=dg(t);return c?d.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:d.jsx(c,{color:n,strokeWidth:i})}):null},Si=({defaultColor:e,rfId:t})=>{const n=re(s=>s.edges),r=re(s=>s.defaultEdgeOptions),o=I.useMemo(()=>_f(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?d.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:d.jsx("defs",{children:o.map(s=>d.jsx(fg,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Si.displayName="MarkerDefinitions";var hg=I.memo(Si);function Ei({x:e,y:t,label:n,labelStyle:r,labelShowBg:o=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u}){const[h,f]=I.useState({x:1,y:0,width:0,height:0}),g=le(["react-flow__edge-textwrapper",l]),m=I.useRef(null);return I.useEffect(()=>{if(m.current){const x=m.current.getBBox();f({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),n?d.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:g,visibility:h.width?"visible":"hidden",...u,children:[o&&d.jsx("rect",{width:h.width+2*i[0],x:-i[0],y:-i[1],height:h.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),d.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:m,style:r,children:n}),c]}):null}Ei.displayName="EdgeText";const gg=I.memo(Ei);function $n({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...u}){return d.jsxs(d.Fragment,{children:[d.jsx("path",{...u,d:e,fill:"none",className:le(["react-flow__edge-path",u.className])}),l?d.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}):null,r&&we(t)&&we(n)?d.jsx(gg,{x:t,y:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function Ro({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===G.Left||e===G.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Ci({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top}){const[i,a]=Ro({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,l]=Ro({pos:s,x1:r,y1:o,x2:e,y2:t}),[u,h,f,g]=qs({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${a} ${c},${l} ${r},${o}`,u,h,f,g]}function ki(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i,targetPosition:a,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,markerEnd:x,markerStart:y,interactionWidth:b})=>{const[N,p,w]=Ci({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a}),C=e.isInternal?void 0:t;return d.jsx($n,{id:C,path:N,labelX:p,labelY:w,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,markerEnd:x,markerStart:y,interactionWidth:b})})}const mg=ki({isInternal:!1}),_i=ki({isInternal:!0});mg.displayName="SimpleBezierEdge";_i.displayName="SimpleBezierEdgeInternal";function ji(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:f,sourcePosition:g=G.Bottom,targetPosition:m=G.Top,markerEnd:x,markerStart:y,pathOptions:b,interactionWidth:N})=>{const[p,w,C]=sr({sourceX:n,sourceY:r,sourcePosition:g,targetX:o,targetY:s,targetPosition:m,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset,stepPosition:b==null?void 0:b.stepPosition}),E=e.isInternal?void 0:t;return d.jsx($n,{id:E,path:p,labelX:w,labelY:C,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:x,markerStart:y,interactionWidth:N})})}const Mi=ji({isInternal:!1}),Pi=ji({isInternal:!0});Mi.displayName="SmoothStepEdge";Pi.displayName="SmoothStepEdgeInternal";function Ai(e){return I.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return d.jsx(Mi,{...n,id:r,pathOptions:I.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const pg=Ai({isInternal:!1}),Ii=Ai({isInternal:!0});pg.displayName="StepEdge";Ii.displayName="StepEdgeInternal";function Ti(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:m,interactionWidth:x})=>{const[y,b,N]=Qs({sourceX:n,sourceY:r,targetX:o,targetY:s}),p=e.isInternal?void 0:t;return d.jsx($n,{id:p,path:y,labelX:b,labelY:N,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:m,interactionWidth:x})})}const xg=Ti({isInternal:!1}),zi=Ti({isInternal:!0});xg.displayName="StraightEdge";zi.displayName="StraightEdgeInternal";function $i(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i=G.Bottom,targetPosition:a=G.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,markerEnd:x,markerStart:y,pathOptions:b,interactionWidth:N})=>{const[p,w,C]=Ks({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a,curvature:b==null?void 0:b.curvature}),E=e.isInternal?void 0:t;return d.jsx($n,{id:E,path:p,labelX:w,labelY:C,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:m,markerEnd:x,markerStart:y,interactionWidth:N})})}const yg=$i({isInternal:!1}),Di=$i({isInternal:!0});yg.displayName="BezierEdge";Di.displayName="BezierEdgeInternal";const Lo={default:Di,straight:zi,step:Ii,smoothstep:Pi,simplebezier:_i},Vo={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},bg=(e,t,n)=>n===G.Left?e-t:n===G.Right?e+t:e,wg=(e,t,n)=>n===G.Top?e-t:n===G.Bottom?e+t:e,Ho="react-flow__edgeupdater";function Bo({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:s,onMouseOut:i,type:a}){return d.jsx("circle",{onMouseDown:o,onMouseEnter:s,onMouseOut:i,className:le([Ho,`${Ho}-${a}`]),cx:bg(t,r,e),cy:wg(n,r,e),r,stroke:"transparent",fill:"transparent"})}function vg({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:s,targetY:i,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:h,setReconnecting:f,setUpdateHover:g}){const m=se(),x=(w,C)=>{if(w.button!==0)return;const{autoPanOnConnect:E,domNode:A,isValidConnection:k,connectionMode:T,connectionRadius:H,lib:L,onConnectStart:z,onConnectEnd:D,cancelConnection:v,nodeLookup:P,rfId:S,panBy:_,updateConnection:j}=m.getState(),M=C.type==="target",$=(F,O)=>{f(!1),h==null||h(F,n,C.type,O)},R=F=>l==null?void 0:l(n,F),V=(F,O)=>{f(!0),u==null||u(w,n,C.type),z==null||z(F,O)};cr.onPointerDown(w.nativeEvent,{autoPanOnConnect:E,connectionMode:T,connectionRadius:H,domNode:A,handleId:C.id,nodeId:C.nodeId,nodeLookup:P,isTarget:M,edgeUpdaterType:C.type,lib:L,flowId:S,cancelConnection:v,panBy:_,isValidConnection:k,onConnect:R,onConnectStart:V,onConnectEnd:D,onReconnectEnd:$,updateConnection:j,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:w.currentTarget})},y=w=>x(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=w=>x(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),N=()=>g(!0),p=()=>g(!1);return d.jsxs(d.Fragment,{children:[(e===!0||e==="source")&&d.jsx(Bo,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:y,onMouseEnter:N,onMouseOut:p,type:"source"}),(e===!0||e==="target")&&d.jsx(Bo,{position:c,centerX:s,centerY:i,radius:t,onMouseDown:b,onMouseEnter:N,onMouseOut:p,type:"target"})]})}function Ng({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:h,onReconnectStart:f,onReconnectEnd:g,rfId:m,edgeTypes:x,noPanClassName:y,onError:b,disableKeyboardA11y:N}){let p=re(K=>K.edgeLookup.get(e));const w=re(K=>K.defaultEdgeOptions);p=w?{...w,...p}:p;let C=p.type||"default",E=(x==null?void 0:x[C])||Lo[C];E===void 0&&(b==null||b("011",ke.error011(C)),C="default",E=(x==null?void 0:x.default)||Lo.default);const A=!!(p.focusable||t&&typeof p.focusable>"u"),k=typeof h<"u"&&(p.reconnectable||n&&typeof p.reconnectable>"u"),T=!!(p.selectable||r&&typeof p.selectable>"u"),H=I.useRef(null),[L,z]=I.useState(!1),[D,v]=I.useState(!1),P=se(),{zIndex:S,sourceX:_,sourceY:j,targetX:M,targetY:$,sourcePosition:R,targetPosition:V}=re(I.useCallback(K=>{const Q=K.nodeLookup.get(p.source),J=K.nodeLookup.get(p.target);if(!Q||!J)return{zIndex:p.zIndex,...Vo};const oe=kf({id:e,sourceNode:Q,targetNode:J,sourceHandle:p.sourceHandle||null,targetHandle:p.targetHandle||null,connectionMode:K.connectionMode,onError:b});return{zIndex:yf({selected:p.selected,zIndex:p.zIndex,sourceNode:Q,targetNode:J,elevateOnSelect:K.elevateEdgesOnSelect}),...oe||Vo}},[p.source,p.target,p.sourceHandle,p.targetHandle,p.selected,p.zIndex]),ae),F=I.useMemo(()=>p.markerStart?`url('#${ir(p.markerStart,m)}')`:void 0,[p.markerStart,m]),O=I.useMemo(()=>p.markerEnd?`url('#${ir(p.markerEnd,m)}')`:void 0,[p.markerEnd,m]);if(p.hidden||_===null||j===null||M===null||$===null)return null;const q=K=>{var ie;const{addSelectedEdges:Q,unselectNodesAndEdges:J,multiSelectionActive:oe}=P.getState();T&&(P.setState({nodesSelectionActive:!1}),p.selected&&oe?(J({nodes:[],edges:[p]}),(ie=H.current)==null||ie.blur()):Q([e])),o&&o(K,p)},Z=s?K=>{s(K,{...p})}:void 0,Y=i?K=>{i(K,{...p})}:void 0,B=a?K=>{a(K,{...p})}:void 0,U=c?K=>{c(K,{...p})}:void 0,ee=l?K=>{l(K,{...p})}:void 0,te=K=>{var Q;if(!N&&$s.includes(K.key)&&T){const{unselectNodesAndEdges:J,addSelectedEdges:oe}=P.getState();K.key==="Escape"?((Q=H.current)==null||Q.blur(),J({edges:[p]})):oe([e])}};return d.jsx("svg",{style:{zIndex:S},children:d.jsxs("g",{className:le(["react-flow__edge",`react-flow__edge-${C}`,p.className,y,{selected:p.selected,animated:p.animated,inactive:!T&&!o,updating:L,selectable:T}]),onClick:q,onDoubleClick:Z,onContextMenu:Y,onMouseEnter:B,onMouseMove:U,onMouseLeave:ee,onKeyDown:A?te:void 0,tabIndex:A?0:void 0,role:p.ariaRole??(A?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":p.ariaLabel===null?void 0:p.ariaLabel||`Edge from ${p.source} to ${p.target}`,"aria-describedby":A?`${di}-${m}`:void 0,ref:H,...p.domAttributes,children:[!D&&d.jsx(E,{id:e,source:p.source,target:p.target,type:p.type,selected:p.selected,animated:p.animated,selectable:T,deletable:p.deletable??!0,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,sourceX:_,sourceY:j,targetX:M,targetY:$,sourcePosition:R,targetPosition:V,data:p.data,style:p.style,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerStart:F,markerEnd:O,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth}),k&&d.jsx(vg,{edge:p,isReconnectable:k,reconnectRadius:u,onReconnect:h,onReconnectStart:f,onReconnectEnd:g,sourceX:_,sourceY:j,targetX:M,targetY:$,sourcePosition:R,targetPosition:V,setUpdateHover:z,setReconnecting:v})]})})}const Sg=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Ri({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:h,onEdgeDoubleClick:f,onReconnectStart:g,onReconnectEnd:m,disableKeyboardA11y:x}){const{edgesFocusable:y,edgesReconnectable:b,elementsSelectable:N,onError:p}=re(Sg,ae),w=cg(t);return d.jsxs("div",{className:"react-flow__edges",children:[d.jsx(hg,{defaultColor:e,rfId:n}),w.map(C=>d.jsx(Ng,{id:C,edgesFocusable:y,edgesReconnectable:b,elementsSelectable:N,noPanClassName:o,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:h,onDoubleClick:f,onReconnectStart:g,onReconnectEnd:m,rfId:n,onError:p,edgeTypes:r,disableKeyboardA11y:x},C))]})}Ri.displayName="EdgeRenderer";const Eg=I.memo(Ri),Cg=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function kg({children:e}){const t=re(Cg);return d.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function _g(e){const t=Tn(),n=I.useRef(!1);I.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const jg=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function Mg(e){const t=re(jg),n=se();return I.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Oo(e){return e.connection.inProgress?{...e.connection,to:Ot(e.connection.to,e.transform)}:{...e.connection}}function Pg(e){return e?n=>{const r=Oo(n);return e(r)}:Oo}function Ag(e){const t=Pg(e);return re(t,ae)}const Ig=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Tg({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:s,height:i,isValid:a,inProgress:c}=re(Ig,ae);return!(s&&o&&c)?null:d.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:d.jsx("g",{className:le(["react-flow__connection",Ls(a)]),children:d.jsx(Li,{style:t,type:n,CustomComponent:r,isValid:a})})})}const Li=({style:e,type:t=Se.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:s,fromNode:i,fromHandle:a,fromPosition:c,to:l,toNode:u,toHandle:h,toPosition:f}=Ag();if(!o)return;if(n)return d.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:Ls(r),toNode:u,toHandle:h});let g="";const m={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case Se.Bezier:[g]=Ks(m);break;case Se.SimpleBezier:[g]=Ci(m);break;case Se.Step:[g]=sr({...m,borderRadius:0});break;case Se.SmoothStep:[g]=sr(m);break;default:[g]=Qs(m)}return d.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};Li.displayName="ConnectionLine";const zg={};function Fo(e=zg){I.useRef(e),se(),I.useEffect(()=>{},[e])}function $g(){se(),I.useRef(!1),I.useEffect(()=>{},[])}function Vi({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:h,onSelectionStart:f,onSelectionEnd:g,connectionLineType:m,connectionLineStyle:x,connectionLineComponent:y,connectionLineContainerStyle:b,selectionKeyCode:N,selectionOnDrag:p,selectionMode:w,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:A,deleteKeyCode:k,onlyRenderVisibleElements:T,elementsSelectable:H,defaultViewport:L,translateExtent:z,minZoom:D,maxZoom:v,preventScrolling:P,defaultMarkerColor:S,zoomOnScroll:_,zoomOnPinch:j,panOnScroll:M,panOnScrollSpeed:$,panOnScrollMode:R,zoomOnDoubleClick:V,panOnDrag:F,onPaneClick:O,onPaneMouseEnter:q,onPaneMouseMove:Z,onPaneMouseLeave:Y,onPaneScroll:B,onPaneContextMenu:U,paneClickDistance:ee,nodeClickDistance:te,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:oe,reconnectRadius:ie,onReconnect:pe,onReconnectStart:qe,onReconnectEnd:Ft,noDragClassName:Yt,noWheelClassName:Xt,noPanClassName:ht,disableKeyboardA11y:gt,nodeExtent:Dn,rfId:Wt,viewport:Ke,onViewportChange:mt}){return Fo(e),Fo(t),$g(),_g(n),Mg(Ke),d.jsx(Jh,{onPaneClick:O,onPaneMouseEnter:q,onPaneMouseMove:Z,onPaneMouseLeave:Y,onPaneContextMenu:U,onPaneScroll:B,paneClickDistance:ee,deleteKeyCode:k,selectionKeyCode:N,selectionOnDrag:p,selectionMode:w,onSelectionStart:f,onSelectionEnd:g,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:A,elementsSelectable:H,zoomOnScroll:_,zoomOnPinch:j,zoomOnDoubleClick:V,panOnScroll:M,panOnScrollSpeed:$,panOnScrollMode:R,panOnDrag:F,defaultViewport:L,translateExtent:z,minZoom:D,maxZoom:v,onSelectionContextMenu:h,preventScrolling:P,noDragClassName:Yt,noWheelClassName:Xt,noPanClassName:ht,disableKeyboardA11y:gt,onViewportChange:mt,isControlledViewport:!!Ke,children:d.jsxs(kg,{children:[d.jsx(Eg,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:i,onReconnect:pe,onReconnectStart:qe,onReconnectEnd:Ft,onlyRenderVisibleElements:T,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:oe,reconnectRadius:ie,defaultMarkerColor:S,noPanClassName:ht,disableKeyboardA11y:gt,rfId:Wt}),d.jsx(Tg,{style:x,type:m,component:y,containerStyle:b}),d.jsx("div",{className:"react-flow__edgelabel-renderer"}),d.jsx(ag,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:te,onlyRenderVisibleElements:T,noPanClassName:ht,noDragClassName:Yt,disableKeyboardA11y:gt,nodeExtent:Dn,rfId:Wt}),d.jsx("div",{className:"react-flow__viewport-portal"})]})})}Vi.displayName="GraphView";const Dg=I.memo(Vi),Yo=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c=.5,maxZoom:l=2,nodeOrigin:u,nodeExtent:h}={})=>{const f=new Map,g=new Map,m=new Map,x=new Map,y=r??t??[],b=n??e??[],N=u??[0,0],p=h??Mt;ei(m,x,y);const w=ar(b,f,g,{nodeOrigin:N,nodeExtent:p,elevateNodesOnSelect:!1});let C=[0,0,1];if(i&&o&&s){const E=Ht(f,{filter:H=>!!((H.width||H.initialWidth)&&(H.height||H.initialHeight))}),{x:A,y:k,zoom:T}=Cr(E,o,s,c,l,(a==null?void 0:a.padding)??.1);C=[A,k,T]}return{rfId:"1",width:0,height:0,transform:C,nodes:b,nodesInitialized:w,nodeLookup:f,parentLookup:g,edges:y,edgeLookup:x,connectionLookup:m,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:c,maxZoom:l,translateExtent:Mt,nodeExtent:p,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:it.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:N,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Rs},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:ff,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Ds}},Rg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:h})=>pc((f,g)=>{async function m(){const{nodeLookup:x,panZoom:y,fitViewOptions:b,fitViewResolver:N,width:p,height:w,minZoom:C,maxZoom:E}=g();y&&(await uf({nodes:x,width:p,height:w,panZoom:y,minZoom:C,maxZoom:E},b),N==null||N.resolve(!0),f({fitViewResolver:null}))}return{...Yo({nodes:e,edges:t,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:h,defaultNodes:n,defaultEdges:r}),setNodes:x=>{const{nodeLookup:y,parentLookup:b,nodeOrigin:N,elevateNodesOnSelect:p,fitViewQueued:w}=g(),C=ar(x,y,b,{nodeOrigin:N,nodeExtent:h,elevateNodesOnSelect:p,checkEquality:!0});w&&C?(m(),f({nodes:x,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):f({nodes:x,nodesInitialized:C})},setEdges:x=>{const{connectionLookup:y,edgeLookup:b}=g();ei(y,b,x),f({edges:x})},setDefaultNodesAndEdges:(x,y)=>{if(x){const{setNodes:b}=g();b(x),f({hasDefaultNodes:!0})}if(y){const{setEdges:b}=g();b(y),f({hasDefaultEdges:!0})}},updateNodeInternals:x=>{const{triggerNodeChanges:y,nodeLookup:b,parentLookup:N,domNode:p,nodeOrigin:w,nodeExtent:C,debug:E,fitViewQueued:A}=g(),{changes:k,updatedInternals:T}=If(x,b,N,p,w,C);T&&(Mf(b,N,{nodeOrigin:w,nodeExtent:C}),A?(m(),f({fitViewQueued:!1,fitViewOptions:void 0})):f({}),(k==null?void 0:k.length)>0&&(E&&console.log("React Flow: trigger node changes",k),y==null||y(k)))},updateNodePositions:(x,y=!1)=>{const b=[],N=[],{nodeLookup:p,triggerNodeChanges:w}=g();for(const[C,E]of x){const A=p.get(C),k=!!(A!=null&&A.expandParent&&(A!=null&&A.parentId)&&(E!=null&&E.position)),T={id:C,type:"position",position:k?{x:Math.max(0,E.position.x),y:Math.max(0,E.position.y)}:E.position,dragging:y};k&&A.parentId&&b.push({id:C,parentId:A.parentId,rect:{...E.internals.positionAbsolute,width:E.measured.width??0,height:E.measured.height??0}}),N.push(T)}if(b.length>0){const{parentLookup:C,nodeOrigin:E}=g(),A=Pr(b,p,C,E);N.push(...A)}w(N)},triggerNodeChanges:x=>{const{onNodesChange:y,setNodes:b,nodes:N,hasDefaultNodes:p,debug:w}=g();if(x!=null&&x.length){if(p){const C=gi(x,N);b(C)}w&&console.log("React Flow: trigger node changes",x),y==null||y(x)}},triggerEdgeChanges:x=>{const{onEdgesChange:y,setEdges:b,edges:N,hasDefaultEdges:p,debug:w}=g();if(x!=null&&x.length){if(p){const C=mi(x,N);b(C)}w&&console.log("React Flow: trigger edge changes",x),y==null||y(x)}},addSelectedNodes:x=>{const{multiSelectionActive:y,edgeLookup:b,nodeLookup:N,triggerNodeChanges:p,triggerEdgeChanges:w}=g();if(y){const C=x.map(E=>He(E,!0));p(C);return}p(et(N,new Set([...x]),!0)),w(et(b))},addSelectedEdges:x=>{const{multiSelectionActive:y,edgeLookup:b,nodeLookup:N,triggerNodeChanges:p,triggerEdgeChanges:w}=g();if(y){const C=x.map(E=>He(E,!0));w(C);return}w(et(b,new Set([...x]))),p(et(N,new Set,!0))},unselectNodesAndEdges:({nodes:x,edges:y}={})=>{const{edges:b,nodes:N,nodeLookup:p,triggerNodeChanges:w,triggerEdgeChanges:C}=g(),E=x||N,A=y||b,k=E.map(H=>{const L=p.get(H.id);return L&&(L.selected=!1),He(H.id,!1)}),T=A.map(H=>He(H.id,!1));w(k),C(T)},setMinZoom:x=>{const{panZoom:y,maxZoom:b}=g();y==null||y.setScaleExtent([x,b]),f({minZoom:x})},setMaxZoom:x=>{const{panZoom:y,minZoom:b}=g();y==null||y.setScaleExtent([b,x]),f({maxZoom:x})},setTranslateExtent:x=>{var y;(y=g().panZoom)==null||y.setTranslateExtent(x),f({translateExtent:x})},setPaneClickDistance:x=>{var y;(y=g().panZoom)==null||y.setClickDistance(x)},resetSelectedElements:()=>{const{edges:x,nodes:y,triggerNodeChanges:b,triggerEdgeChanges:N,elementsSelectable:p}=g();if(!p)return;const w=y.reduce((E,A)=>A.selected?[...E,He(A.id,!1)]:E,[]),C=x.reduce((E,A)=>A.selected?[...E,He(A.id,!1)]:E,[]);b(w),N(C)},setNodeExtent:x=>{const{nodes:y,nodeLookup:b,parentLookup:N,nodeOrigin:p,elevateNodesOnSelect:w,nodeExtent:C}=g();x[0][0]===C[0][0]&&x[0][1]===C[0][1]&&x[1][0]===C[1][0]&&x[1][1]===C[1][1]||(ar(y,b,N,{nodeOrigin:p,nodeExtent:x,elevateNodesOnSelect:w,checkEquality:!1}),f({nodeExtent:x}))},panBy:x=>{const{transform:y,width:b,height:N,panZoom:p,translateExtent:w}=g();return Tf({delta:x,panZoom:p,transform:y,translateExtent:w,width:b,height:N})},setCenter:async(x,y,b)=>{const{width:N,height:p,maxZoom:w,panZoom:C}=g();if(!C)return Promise.resolve(!1);const E=typeof(b==null?void 0:b.zoom)<"u"?b.zoom:w;return await C.setViewport({x:N/2-x*E,y:p/2-y*E,zoom:E},{duration:b==null?void 0:b.duration,ease:b==null?void 0:b.ease,interpolate:b==null?void 0:b.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{f({connection:{...Rs}})},updateConnection:x=>{f({connection:x})},reset:()=>f({...Yo()})}},Object.is);function Hi({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:s,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:c,fitView:l,nodeOrigin:u,nodeExtent:h,children:f}){const[g]=I.useState(()=>Rg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:l,minZoom:i,maxZoom:a,fitViewOptions:c,nodeOrigin:u,nodeExtent:h}));return d.jsx(sh,{value:g,children:d.jsx(jh,{children:f})})}function Lg({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:s,height:i,fitView:a,fitViewOptions:c,minZoom:l,maxZoom:u,nodeOrigin:h,nodeExtent:f}){return I.useContext(An)?d.jsx(d.Fragment,{children:e}):d.jsx(Hi,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:s,initialHeight:i,fitView:a,initialFitViewOptions:c,initialMinZoom:l,initialMaxZoom:u,nodeOrigin:h,nodeExtent:f,children:e})}const Vg={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Hg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:h,onMoveEnd:f,onConnect:g,onConnectStart:m,onConnectEnd:x,onClickConnectStart:y,onClickConnectEnd:b,onNodeMouseEnter:N,onNodeMouseMove:p,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:E,onNodeDragStart:A,onNodeDrag:k,onNodeDragStop:T,onNodesDelete:H,onEdgesDelete:L,onDelete:z,onSelectionChange:D,onSelectionDragStart:v,onSelectionDrag:P,onSelectionDragStop:S,onSelectionContextMenu:_,onSelectionStart:j,onSelectionEnd:M,onBeforeDelete:$,connectionMode:R,connectionLineType:V=Se.Bezier,connectionLineStyle:F,connectionLineComponent:O,connectionLineContainerStyle:q,deleteKeyCode:Z="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:B=!1,selectionMode:U=Pt.Full,panActivationKeyCode:ee="Space",multiSelectionKeyCode:te=It()?"Meta":"Control",zoomActivationKeyCode:K=It()?"Meta":"Control",snapToGrid:Q,snapGrid:J,onlyRenderVisibleElements:oe=!1,selectNodesOnDrag:ie,nodesDraggable:pe,autoPanOnNodeFocus:qe,nodesConnectable:Ft,nodesFocusable:Yt,nodeOrigin:Xt=fi,edgesFocusable:ht,edgesReconnectable:gt,elementsSelectable:Dn=!0,defaultViewport:Wt=yh,minZoom:Ke=.5,maxZoom:mt=2,translateExtent:zr=Mt,preventScrolling:ca=!0,nodeExtent:Rn,defaultMarkerColor:la="#b1b1b7",zoomOnScroll:ua=!0,zoomOnPinch:da=!0,panOnScroll:fa=!1,panOnScrollSpeed:ha=.5,panOnScrollMode:ga=Fe.Free,zoomOnDoubleClick:ma=!0,panOnDrag:pa=!0,onPaneClick:xa,onPaneMouseEnter:ya,onPaneMouseMove:ba,onPaneMouseLeave:wa,onPaneScroll:va,onPaneContextMenu:Na,paneClickDistance:$r=0,nodeClickDistance:Sa=0,children:Ea,onReconnect:Ca,onReconnectStart:ka,onReconnectEnd:_a,onEdgeContextMenu:ja,onEdgeDoubleClick:Ma,onEdgeMouseEnter:Pa,onEdgeMouseMove:Aa,onEdgeMouseLeave:Ia,reconnectRadius:Ta=10,onNodesChange:za,onEdgesChange:$a,noDragClassName:Da="nodrag",noWheelClassName:Ra="nowheel",noPanClassName:Dr="nopan",fitView:Rr,fitViewOptions:Lr,connectOnClick:La,attributionPosition:Va,proOptions:Ha,defaultEdgeOptions:Ba,elevateNodesOnSelect:Oa,elevateEdgesOnSelect:Fa,disableKeyboardA11y:Vr=!1,autoPanOnConnect:Ya,autoPanOnNodeDrag:Xa,autoPanSpeed:Wa,connectionRadius:Ga,isValidConnection:Ua,onError:qa,style:Ka,id:Hr,nodeDragThreshold:Za,connectionDragThreshold:Qa,viewport:Ja,onViewportChange:ec,width:tc,height:nc,colorMode:rc="light",debug:oc,onScroll:Gt,ariaLabelConfig:sc,...ic},ac){const Ln=Hr||"1",cc=Nh(rc),lc=I.useCallback(Br=>{Br.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Gt==null||Gt(Br)},[Gt]);return d.jsx("div",{"data-testid":"rf__wrapper",...ic,onScroll:lc,style:{...Ka,...Vg},ref:ac,className:le(["react-flow",o,cc]),id:Hr,role:"application",children:d.jsxs(Lg,{nodes:e,edges:t,width:tc,height:nc,fitView:Rr,fitViewOptions:Lr,minZoom:Ke,maxZoom:mt,nodeOrigin:Xt,nodeExtent:Rn,children:[d.jsx(Dg,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:N,onNodeMouseMove:p,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:E,nodeTypes:s,edgeTypes:i,connectionLineType:V,connectionLineStyle:F,connectionLineComponent:O,connectionLineContainerStyle:q,selectionKeyCode:Y,selectionOnDrag:B,selectionMode:U,deleteKeyCode:Z,multiSelectionKeyCode:te,panActivationKeyCode:ee,zoomActivationKeyCode:K,onlyRenderVisibleElements:oe,defaultViewport:Wt,translateExtent:zr,minZoom:Ke,maxZoom:mt,preventScrolling:ca,zoomOnScroll:ua,zoomOnPinch:da,zoomOnDoubleClick:ma,panOnScroll:fa,panOnScrollSpeed:ha,panOnScrollMode:ga,panOnDrag:pa,onPaneClick:xa,onPaneMouseEnter:ya,onPaneMouseMove:ba,onPaneMouseLeave:wa,onPaneScroll:va,onPaneContextMenu:Na,paneClickDistance:$r,nodeClickDistance:Sa,onSelectionContextMenu:_,onSelectionStart:j,onSelectionEnd:M,onReconnect:Ca,onReconnectStart:ka,onReconnectEnd:_a,onEdgeContextMenu:ja,onEdgeDoubleClick:Ma,onEdgeMouseEnter:Pa,onEdgeMouseMove:Aa,onEdgeMouseLeave:Ia,reconnectRadius:Ta,defaultMarkerColor:la,noDragClassName:Da,noWheelClassName:Ra,noPanClassName:Dr,rfId:Ln,disableKeyboardA11y:Vr,nodeExtent:Rn,viewport:Ja,onViewportChange:ec}),d.jsx(vh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:g,onConnectStart:m,onConnectEnd:x,onClickConnectStart:y,onClickConnectEnd:b,nodesDraggable:pe,autoPanOnNodeFocus:qe,nodesConnectable:Ft,nodesFocusable:Yt,edgesFocusable:ht,edgesReconnectable:gt,elementsSelectable:Dn,elevateNodesOnSelect:Oa,elevateEdgesOnSelect:Fa,minZoom:Ke,maxZoom:mt,nodeExtent:Rn,onNodesChange:za,onEdgesChange:$a,snapToGrid:Q,snapGrid:J,connectionMode:R,translateExtent:zr,connectOnClick:La,defaultEdgeOptions:Ba,fitView:Rr,fitViewOptions:Lr,onNodesDelete:H,onEdgesDelete:L,onDelete:z,onNodeDragStart:A,onNodeDrag:k,onNodeDragStop:T,onSelectionDrag:P,onSelectionDragStart:v,onSelectionDragStop:S,onMove:u,onMoveStart:h,onMoveEnd:f,noPanClassName:Dr,nodeOrigin:Xt,rfId:Ln,autoPanOnConnect:Ya,autoPanOnNodeDrag:Xa,autoPanSpeed:Wa,onError:qa,connectionRadius:Ga,isValidConnection:Ua,selectNodesOnDrag:ie,nodeDragThreshold:Za,connectionDragThreshold:Qa,onBeforeDelete:$,paneClickDistance:$r,debug:oc,ariaLabelConfig:sc}),d.jsx(xh,{onSelectionChange:D}),Ea,d.jsx(fh,{proOptions:Ha,position:Va}),d.jsx(dh,{rfId:Ln,disableKeyboardA11y:Vr})]})})}var Bi=pi(Hg);function Bg({dimensions:e,lineWidth:t,variant:n,className:r}){return d.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:le(["react-flow__background-pattern",n,r])})}function Og({radius:e,className:t}){return d.jsx("circle",{cx:e,cy:e,r:e,className:le(["react-flow__background-pattern","dots",t])})}var Re;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Re||(Re={}));const Fg={[Re.Dots]:1,[Re.Lines]:1,[Re.Cross]:6},Yg=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Oi({id:e,variant:t=Re.Dots,gap:n=20,size:r,lineWidth:o=1,offset:s=0,color:i,bgColor:a,style:c,className:l,patternClassName:u}){const h=I.useRef(null),{transform:f,patternId:g}=re(Yg,ae),m=r||Fg[t],x=t===Re.Dots,y=t===Re.Cross,b=Array.isArray(n)?n:[n,n],N=[b[0]*f[2]||1,b[1]*f[2]||1],p=m*f[2],w=Array.isArray(s)?s:[s,s],C=y?[p,p]:N,E=[w[0]*f[2]||1+C[0]/2,w[1]*f[2]||1+C[1]/2],A=`${g}${e||""}`;return d.jsxs("svg",{className:le(["react-flow__background",l]),style:{...c,...zn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:h,"data-testid":"rf__background",children:[d.jsx("pattern",{id:A,x:f[0]%N[0],y:f[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:x?d.jsx(Og,{radius:p/2,className:u}):d.jsx(Bg,{dimensions:C,lineWidth:o,variant:t,className:u})}),d.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${A})`})]})}Oi.displayName="Background";const Fi=I.memo(Oi);function Xg(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:d.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Wg(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:d.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Gg(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:d.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Ug(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:d.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function qg(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:d.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function nn({children:e,className:t,...n}){return d.jsx("button",{type:"button",className:le(["react-flow__controls-button",t]),...n,children:e})}const Kg=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function Yi({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:c,className:l,children:u,position:h="bottom-left",orientation:f="vertical","aria-label":g}){const m=se(),{isInteractive:x,minZoomReached:y,maxZoomReached:b,ariaLabelConfig:N}=re(Kg,ae),{zoomIn:p,zoomOut:w,fitView:C}=Tn(),E=()=>{p(),s==null||s()},A=()=>{w(),i==null||i()},k=()=>{C(o),a==null||a()},T=()=>{m.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),c==null||c(!x)},H=f==="horizontal"?"horizontal":"vertical";return d.jsxs(In,{className:le(["react-flow__controls",H,l]),position:h,style:e,"data-testid":"rf__controls","aria-label":g??N["controls.ariaLabel"],children:[t&&d.jsxs(d.Fragment,{children:[d.jsx(nn,{onClick:E,className:"react-flow__controls-zoomin",title:N["controls.zoomIn.ariaLabel"],"aria-label":N["controls.zoomIn.ariaLabel"],disabled:b,children:d.jsx(Xg,{})}),d.jsx(nn,{onClick:A,className:"react-flow__controls-zoomout",title:N["controls.zoomOut.ariaLabel"],"aria-label":N["controls.zoomOut.ariaLabel"],disabled:y,children:d.jsx(Wg,{})})]}),n&&d.jsx(nn,{className:"react-flow__controls-fitview",onClick:k,title:N["controls.fitView.ariaLabel"],"aria-label":N["controls.fitView.ariaLabel"],children:d.jsx(Gg,{})}),r&&d.jsx(nn,{className:"react-flow__controls-interactive",onClick:T,title:N["controls.interactive.ariaLabel"],"aria-label":N["controls.interactive.ariaLabel"],children:x?d.jsx(qg,{}):d.jsx(Ug,{})}),u]})}Yi.displayName="Controls";const Xi=I.memo(Yi);function Zg({id:e,x:t,y:n,width:r,height:o,style:s,color:i,strokeColor:a,strokeWidth:c,className:l,borderRadius:u,shapeRendering:h,selected:f,onClick:g}){const{background:m,backgroundColor:x}=s||{},y=i||m||x;return d.jsx("rect",{className:le(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:o,style:{fill:y,stroke:a,strokeWidth:c},shapeRendering:h,onClick:g?b=>g(b,e):void 0})}const Qg=I.memo(Zg),Jg=e=>e.nodes.map(t=>t.id),Gn=e=>e instanceof Function?e:()=>e;function em({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:s=Qg,onClick:i}){const a=re(Jg,ae),c=Gn(t),l=Gn(e),u=Gn(n),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return d.jsx(d.Fragment,{children:a.map(f=>d.jsx(nm,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:s,onClick:i,shapeRendering:h},f))})}function tm({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:c}){const{node:l,x:u,y:h,width:f,height:g}=re(m=>{const{internals:x}=m.nodeLookup.get(e),y=x.userNode,{x:b,y:N}=x.positionAbsolute,{width:p,height:w}=Ie(y);return{node:y,x:b,y:N,width:p,height:w}},ae);return!l||l.hidden||!Ys(l)?null:d.jsx(a,{x:u,y:h,width:f,height:g,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:o,strokeColor:n(l),strokeWidth:s,shapeRendering:i,onClick:c,id:l.id})}const nm=I.memo(tm);var rm=I.memo(em);const om=200,sm=150,im=e=>!e.hidden,am=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Fs(Ht(e.nodeLookup,{filter:im}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},cm="react-flow__minimap-desc";function Wi({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:h,position:f="bottom-right",onClick:g,onNodeClick:m,pannable:x=!1,zoomable:y=!1,ariaLabel:b,inversePan:N,zoomStep:p=1,offsetScale:w=5}){const C=se(),E=I.useRef(null),{boundingRect:A,viewBB:k,rfId:T,panZoom:H,translateExtent:L,flowWidth:z,flowHeight:D,ariaLabelConfig:v}=re(am,ae),P=(e==null?void 0:e.width)??om,S=(e==null?void 0:e.height)??sm,_=A.width/P,j=A.height/S,M=Math.max(_,j),$=M*P,R=M*S,V=w*M,F=A.x-($-A.width)/2-V,O=A.y-(R-A.height)/2-V,q=$+V*2,Z=R+V*2,Y=`${cm}-${T}`,B=I.useRef(0),U=I.useRef();B.current=M,I.useEffect(()=>{if(E.current&&H)return U.current=Of({domNode:E.current,panZoom:H,getTransform:()=>C.getState().transform,getViewScale:()=>B.current}),()=>{var Q;(Q=U.current)==null||Q.destroy()}},[H]),I.useEffect(()=>{var Q;(Q=U.current)==null||Q.update({translateExtent:L,width:z,height:D,inversePan:N,pannable:x,zoomStep:p,zoomable:y})},[x,y,N,p,L,z,D]);const ee=g?Q=>{var ie;const[J,oe]=((ie=U.current)==null?void 0:ie.pointer(Q))||[0,0];g(Q,{x:J,y:oe})}:void 0,te=m?I.useCallback((Q,J)=>{const oe=C.getState().nodeLookup.get(J).internals.userNode;m(Q,oe)},[]):void 0,K=b??v["minimap.ariaLabel"];return d.jsx(In,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof h=="number"?h*M:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:le(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:d.jsxs("svg",{width:P,height:S,viewBox:`${F} ${O} ${q} ${Z}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:E,onClick:ee,children:[K&&d.jsx("title",{id:Y,children:K}),d.jsx(rm,{onClick:te,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:a}),d.jsx("path",{className:"react-flow__minimap-mask",d:`M${F-V},${O-V}h${q+V*2}v${Z+V*2}h${-q-V*2}z
        M${k.x},${k.y}h${k.width}v${k.height}h${-k.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Wi.displayName="MiniMap";const Gi=I.memo(Wi),lm=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,um={[ut.Line]:"right",[ut.Handle]:"bottom-right"};function dm({nodeId:e,position:t,variant:n=ut.Handle,className:r,style:o=void 0,children:s,color:i,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:h=!1,resizeDirection:f,autoScale:g=!0,shouldResize:m,onResizeStart:x,onResize:y,onResizeEnd:b}){const N=wi(),p=typeof e=="string"?e:N,w=se(),C=I.useRef(null),E=n===ut.Handle,A=re(I.useCallback(lm(E&&g),[E,g]),ae),k=I.useRef(null),T=t??um[n];I.useEffect(()=>{if(!(!C.current||!p))return k.current||(k.current=oh({domNode:C.current,nodeId:p,getStoreItems:()=>{const{nodeLookup:L,transform:z,snapGrid:D,snapToGrid:v,nodeOrigin:P,domNode:S}=w.getState();return{nodeLookup:L,transform:z,snapGrid:D,snapToGrid:v,nodeOrigin:P,paneDomNode:S}},onChange:(L,z)=>{const{triggerNodeChanges:D,nodeLookup:v,parentLookup:P,nodeOrigin:S}=w.getState(),_=[],j={x:L.x,y:L.y},M=v.get(p);if(M&&M.expandParent&&M.parentId){const $=M.origin??S,R=L.width??M.measured.width??0,V=L.height??M.measured.height??0,F={id:M.id,parentId:M.parentId,rect:{width:R,height:V,...Xs({x:L.x??M.position.x,y:L.y??M.position.y},{width:R,height:V},M.parentId,v,$)}},O=Pr([F],v,P,S);_.push(...O),j.x=L.x?Math.max($[0]*R,L.x):void 0,j.y=L.y?Math.max($[1]*V,L.y):void 0}if(j.x!==void 0&&j.y!==void 0){const $={id:p,type:"position",position:{...j}};_.push($)}if(L.width!==void 0&&L.height!==void 0){const R={id:p,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:L.width,height:L.height}};_.push(R)}for(const $ of z){const R={...$,type:"position"};_.push(R)}D(_)},onEnd:({width:L,height:z})=>{const D={id:p,type:"dimensions",resizing:!1,dimensions:{width:L,height:z}};w.getState().triggerNodeChanges([D])}})),k.current.update({controlPosition:T,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:h,resizeDirection:f,onResizeStart:x,onResize:y,onResizeEnd:b,shouldResize:m}),()=>{var L;(L=k.current)==null||L.destroy()}},[T,a,c,l,u,h,x,y,b,m]);const H=T.split("-");return d.jsx("div",{className:le(["react-flow__resize-control","nodrag",...H,n,r]),ref:C,style:{...o,scale:A,...i&&{[E?"backgroundColor":"borderColor"]:i}},children:s})}I.memo(dm);const Ye=e=>e.type==="scene",Xe=e=>e.type==="choice",fm=24,Xo=(e,t=fm)=>Math.round(e/t)*t,ur=e=>({x:Xo(e.x),y:Xo(e.y)}),Wo=e=>{const t=Date.now().toString(36),n=Math.random().toString(36).substring(2,9);return`${e}_${t}_${n}`},$t="scene_start",Go=()=>[{id:$t,type:"scene",position:ur({x:250,y:250}),data:{label:"Start",durationSec:5,isStart:!0}}],ce=Dt()(ts((e,t)=>({nodes:Go(),edges:[],selectedNodeId:null,onNodesChange:n=>e(r=>({nodes:gi(n,r.nodes)})),onEdgesChange:n=>e(r=>({edges:mi(n,r.edges)})),createChoice:(n,r)=>e(o=>{const s=o.nodes.find(c=>c.id===n),i=o.nodes.find(c=>c.id===r);if(!s||!i||o.edges.find(c=>c.source===n&&c.target===r))return o;if(Ye(s)&&Ye(i)){const c=Wo("choice"),l={id:c,type:"choice",position:ur({x:(s.position.x+i.position.x)/2,y:(s.position.y+i.position.y)/2}),data:{label:"Choice",effects:{}}};return{nodes:[...o.nodes,l],edges:[...o.edges,{id:`edge_${n}_${c}`,source:n,target:c},{id:`edge_${c}_${r}`,source:c,target:r}]}}return{...o,edges:[...o.edges,{id:`edge_${n}_${r}`,source:n,target:r}]}}),selectNode:n=>e({selectedNodeId:n}),updateNode:(n,r)=>e(o=>({nodes:o.nodes.map(s=>s.id===n?{...s,data:{...s.data,...r}}:s)})),deleteNode:n=>{n!==$t&&e(r=>{const o=r.nodes.find(a=>a.id===n);if(!o)return r;const s=[n],i=new Set;return r.edges.forEach(a=>{(a.source===n||a.target===n)&&i.add(a.id)}),Ye(o)&&r.nodes.forEach(a=>{Xe(a)&&r.edges.filter(l=>(l.source===a.id||l.target===a.id)&&!i.has(l.id)).length<2&&(s.push(a.id),r.edges.forEach(l=>{(l.source===a.id||l.target===a.id)&&i.add(l.id)}))}),{nodes:r.nodes.filter(a=>!s.includes(a.id)),edges:r.edges.filter(a=>!i.has(a.id)),selectedNodeId:s.includes(r.selectedNodeId||"")?null:r.selectedNodeId}})},addSceneNode:()=>e(n=>{const r=n.nodes.reduce((s,i)=>Math.max(s,i.position.y),250),o={id:Wo("scene"),type:"scene",position:ur({x:400,y:r+100}),data:{label:`Scene ${n.nodes.filter(s=>s.type==="scene").length}`,durationSec:5}};return{nodes:[...n.nodes,o],selectedNodeId:o.id}}),getNode:n=>t().nodes.find(r=>r.id===n),getChoicesForScene:n=>{const r=t();return r.edges.filter(s=>s.source===n).map(s=>r.nodes.find(i=>i.id===s.target)).filter(s=>!!s&&Xe(s))},loadNodes:n=>e({nodes:n,selectedNodeId:null}),loadEdges:n=>e({edges:n}),reset:()=>e({nodes:Go(),edges:[],selectedNodeId:null})}),{name:"flow-storage",partialize:e=>({nodes:e.nodes,edges:e.edges})})),Uo=[{name:"health",value:10,initialValue:10},{name:"energy",value:5,initialValue:5}],he=Dt()(ts(e=>({variables:Uo,updateVariable:(t,n)=>e(r=>({variables:r.variables.map(o=>o.name===t?{...o,value:n}:o)})),addVariable:t=>e(n=>({variables:[...n.variables,{name:t,value:0,initialValue:0}]})),removeVariable:t=>e(n=>({variables:n.variables.filter(r=>r.name!==t)})),reset:()=>e({variables:Uo}),loadVariables:t=>e({variables:t})}),{name:"variables-storage"})),Ir=Dt((e,t)=>({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,isPlaying:!1,currentTime:0,duration:0,volume:50,isLoading:!1,setCurrentVideo:(n,r)=>{const o=t();if(o.currentVideoUrl&&URL.revokeObjectURL(o.currentVideoUrl),!r){e({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,currentTime:0,duration:0,isPlaying:!1});return}const s=URL.createObjectURL(r);e({currentVideoId:n,currentVideoFile:r,currentVideoUrl:s,currentTime:0,isPlaying:!1})},setIsPlaying:n=>e({isPlaying:n}),setCurrentTime:n=>e({currentTime:n}),setDuration:n=>e({duration:n}),setVolume:n=>e({volume:n}),setIsLoading:n=>e({isLoading:n}),clearCurrentVideo:()=>{const n=t();n.currentVideoUrl&&URL.revokeObjectURL(n.currentVideoUrl),e({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,currentTime:0,duration:0,isPlaying:!1})}})),De=Dt((e,t)=>({projectTitle:"Untitled Project",lastSaved:null,isDirty:!1,setProjectTitle:n=>e({projectTitle:n,isDirty:!0}),markAsSaved:()=>e({lastSaved:new Date,isDirty:!1}),markAsDirty:()=>e({isDirty:!0}),exportProject:()=>{const n=ce.getState(),r=he.getState(),{projectTitle:o}=t();return{title:o,nodes:n.nodes,edges:n.edges,variables:r.variables,version:"1.0.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},importProject:n=>{ce.getState().loadNodes(n.nodes),ce.getState().loadEdges(n.edges),he.getState().loadVariables(n.variables),e({projectTitle:n.title,lastSaved:null,isDirty:!1})},newProject:()=>{ce.getState().reset(),he.getState().reset(),Ir.getState().clearCurrentVideo(),e({projectTitle:"Untitled Project",lastSaved:null,isDirty:!1})}}));class me{static exportProject(t){const n=De.getState().exportProject();return t&&t!==n.title?{...n,title:t}:n}static downloadProject(t){const n=JSON.stringify(t,null,2),r=new Blob([n],{type:"application/json"}),o=URL.createObjectURL(r),s=document.createElement("a");s.href=o,s.download=`${t.title.replace(/\s+/g,"_")}_${Date.now()}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o)}static async importProject(t){this.validateProjectData(t),De.getState().importProject(t)}static async loadProjectFromFile(t){return new Promise((n,r)=>{const o=new FileReader;o.onload=s=>{var i;try{const a=(i=s.target)==null?void 0:i.result,c=JSON.parse(a);n(c)}catch{r(new Error("Nieprawidłowy format pliku projektu"))}},o.onerror=()=>r(new Error("Błąd odczytu pliku")),o.readAsText(t)})}static createNewProject(){De.getState().newProject()}static autoSave(t){try{const n=this.exportProject(t);localStorage.setItem(this.AUTOSAVE_KEY,JSON.stringify(n)),localStorage.setItem(this.AUTOSAVE_TIME_KEY,new Date().toISOString())}catch(n){console.error("Błąd auto-zapisu:",n)}}static loadAutoSave(){try{const t=localStorage.getItem(this.AUTOSAVE_KEY);return t?JSON.parse(t):null}catch(t){return console.error("Błąd wczytywania auto-zapisu:",t),null}}static getAutoSaveTime(){const t=localStorage.getItem(this.AUTOSAVE_TIME_KEY);return t?new Date(t):null}static clearAutoSave(){localStorage.removeItem(this.AUTOSAVE_KEY),localStorage.removeItem(this.AUTOSAVE_TIME_KEY)}static async getProjectMetadata(t){const n=await this.loadProjectFromFile(t);return{title:n.title,version:n.version,createdAt:n.createdAt||"Nieznana",updatedAt:n.updatedAt||"Nieznana",nodeCount:n.nodes.length,edgeCount:n.edges.length}}static validateProjectData(t){if(!t.title||typeof t.title!="string")throw new Error("Nieprawidłowy projekt: brak tytułu");if(!Array.isArray(t.nodes))throw new Error("Nieprawidłowy projekt: nodes musi być tablicą");if(!Array.isArray(t.edges))throw new Error("Nieprawidłowy projekt: edges musi być tablicą");if(!Array.isArray(t.variables))throw new Error("Nieprawidłowy projekt: variables musi być tablicą");if(t.version&&!this.isVersionCompatible(t.version))throw new Error(`Niezgodna wersja projektu: ${t.version}`)}static isVersionCompatible(t){const[n]=t.split("."),[r]=this.CURRENT_VERSION.split(".");return n===r}}me.CURRENT_VERSION="1.0.0";me.AUTOSAVE_KEY="storyflow-autosave";me.AUTOSAVE_TIME_KEY="storyflow-autosave-time";const hm=(e,t={})=>{const[n,r]=I.useState(!1),[o,s]=I.useState(!1),[i,a]=I.useState(null),c=I.useRef(null);I.useEffect(()=>{if(!t.autoSaveEnabled||!t.autoSaveInterval)return;const y=setInterval(()=>{me.autoSave(e),a(new Date)},t.autoSaveInterval);return()=>clearInterval(y)},[e,t.autoSaveEnabled,t.autoSaveInterval]);const l=I.useCallback(async()=>{var y;try{s(!0);const b=me.exportProject(e);me.downloadProject(b),(y=t.onExportSuccess)==null||y.call(t)}catch(b){console.error("Błąd eksportu:",b)}finally{s(!1)}},[e,t]),u=I.useCallback(async y=>{var b,N;try{r(!0);const p=await me.loadProjectFromFile(y);await me.importProject(p),(b=t.onImportSuccess)==null||b.call(t,p)}catch(p){console.error("Błąd importu:",p),(N=t.onImportError)==null||N.call(t,p)}finally{r(!1)}},[t]),h=I.useCallback(y=>{var N;const b=(N=y.target.files)==null?void 0:N[0];b&&u(b),c.current&&(c.current.value="")},[u]),f=I.useCallback(()=>{var y;(y=c.current)==null||y.click()},[]),g=I.useCallback(()=>t.confirmNewProject&&!confirm("Utworzyć nowy projekt? Niezapisane zmiany zostaną utracone.")?!1:(me.createNewProject(),!0),[t.confirmNewProject]),m=I.useCallback(async()=>{const y=me.loadAutoSave();return y?(await me.importProject(y),y):null},[]),x=I.useCallback(()=>me.loadAutoSave()!==null,[]);return{fileInputRef:c,isImporting:n,isExporting:o,lastAutoSave:i,handleExport:l,handleImport:u,handleFileSelect:h,triggerImport:f,createNewProject:g,loadAutoSave:m,hasAutoSave:x}},gm=({tabs:e})=>{const t=es(),n=e.find(r=>r.path===t.pathname)||e[0];return d.jsx("div",{className:"flex h-full",children:e.map(r=>d.jsxs(uc,{to:r.path,className:`h-full px-8 flex items-center gap-3 transition-all border-r border-[#0a0a0a] ${n.id===r.id?"bg-[#1a1a1a] text-[#E84E36] border-b-2 border-b-[#E84E36]":"bg-transparent text-[#666] border-b-2 border-b-transparent"}`,children:[d.jsx(r.icon,{className:"w-5 h-5"}),d.jsx("span",{className:"font-medium text-sm",children:r.label})]},r.id))})},mm=()=>{const e=es(),t=De(N=>N.projectTitle),n=De(N=>N.setProjectTitle),r=De(N=>N.exportProject),o=De(N=>N.importProject),s=De(N=>N.newProject),{fileInputRef:i,isImporting:a,isExporting:c,lastAutoSave:l,handleExport:u,handleFileSelect:h,triggerImport:f,createNewProject:g}=hm(t,{confirmNewProject:!0,autoSaveEnabled:!0,autoSaveInterval:3e4,onImportSuccess:N=>{o(N),alert(`Projekt "${N.title}" został wczytany pomyślnie!`)},onImportError:N=>{alert(`Błąd wczytywania projektu: ${N.message}`)},onExportSuccess:()=>{console.log("Projekt wyeksportowany pomyślnie")}}),m=()=>{g()&&s()},x=()=>{r(),u()},y=[{id:"projects",path:"/",label:"Projects",icon:ns},{id:"video",path:"/video",label:"Video",icon:Et},{id:"story",path:"/story",label:"Story",icon:rs},{id:"decisions",path:"/decisions",label:"Decisions",icon:Or},{id:"variables",path:"/variables",label:"Variables",icon:Or},{id:"play",path:"/play",label:"Play",icon:xc}],b=y.find(N=>N.path===e.pathname)||y[0];return d.jsx(Hi,{children:d.jsxs("div",{className:"h-screen flex flex-col bg-[#1a1a1a]",children:[d.jsx("header",{className:"flex-shrink-0 h-10 bg-gradient-to-b from-[#2a2a2a] to-[#242424] border-b border-[#0a0a0a]",children:d.jsxs("div",{className:"h-full flex items-center",children:[d.jsx("div",{className:"px-3 h-full flex items-center border-r border-[#0a0a0a]",children:d.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[d.jsx("rect",{width:"32",height:"32",fill:"#E84E36"}),d.jsx("path",{d:"M8 8h16v16H8V8z",fill:"white",fillOpacity:"0.9"}),d.jsx("path",{d:"M12 12h8v8h-8v-8z",fill:"#E84E36"})]})}),d.jsx("div",{className:"flex items-center h-full",children:["File","Edit","Timeline","Workspace","Help"].map(N=>d.jsx("button",{className:"px-4 h-full hover:bg-white/5 text-sm text-[#999]",children:N},N))}),d.jsxs("div",{className:"flex-1 flex items-center justify-center",children:[d.jsx("input",{type:"text",value:t,onChange:N=>n(N.target.value),className:"bg-transparent text-center font-medium text-[#ccc] text-[13px] outline-none border-none"}),l&&d.jsxs("span",{className:"ml-2 text-[10px] text-[#666]",children:["(auto-save: ",l.toLocaleTimeString(),")"]})]}),d.jsx("div",{className:"flex items-center gap-2 px-3",children:d.jsx("button",{onClick:m,className:"p-1.5 hover:bg:white/5 rounded",title:"New project",children:d.jsx("svg",{className:"w-4 h-4 text-[#999]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]})}),d.jsxs("div",{className:"h-12 bg-[#282828] border-b border-[#0a0a0a] flex items-center",children:[d.jsx(gm,{tabs:y}),d.jsx("div",{className:"flex-1 flex items-center justify-end px-4 gap-2",children:b.id!=="projects"&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:f,disabled:a,className:"px-3 py-1.5 text-xs font-medium bg-[#2a2a2a] text-[#999] border border-[#3a3a3a] transition-colors hover:bg-[#333] hover:text-white disabled:opacity-50 flex items-center gap-2",children:[d.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),a?"Importing...":"Import"]}),d.jsx("input",{ref:i,type:"file",accept:".json",onChange:h,className:"hidden"}),d.jsxs("button",{onClick:x,disabled:c,className:"px-3 py-1.5 text-xs font-medium bg-[#2a2a2a] text-[#999] border border-[#3a3a3a] transition-colors hover:bg-[#333] hover:text-white disabled:opacity-50 flex items-center gap-2",children:[d.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),c?"Exporting...":"Export"]})]})})]}),d.jsx("div",{className:"flex-1 overflow-hidden",children:d.jsx(dc,{})})]})})},pm=()=>d.jsx("div",{className:"h-full bg-[#1a1a1a] flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx(ns,{className:"w-24 h-24 mx-auto mb-6 text-[#444]"}),d.jsx("h1",{className:"text-2xl font-bold text-[#ccc] mb-2",children:"Projects"}),d.jsx("p",{className:"text-[#666] text-sm mb-8",children:"TODO: Project management interface"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("button",{className:"flex items-center gap-3 px-6 py-3 bg-[#E84E36] text-white font-medium hover:bg-[#d63d2a] transition-colors mx-auto",children:[d.jsx(mr,{className:"w-5 h-5"}),"Create New Project"]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 max-w-md mx-auto mt-8",children:[d.jsxs("div",{className:"bg-[#252525] border border-[#2a2a2a] p-4 text-left hover:border-[#3a3a3a] transition-colors cursor-pointer",children:[d.jsx(Et,{className:"w-8 h-8 text-[#666] mb-2"}),d.jsx("h3",{className:"text-sm font-medium text-[#ccc]",children:"Recent Project 1"}),d.jsx("p",{className:"text-xs text-[#666] mt-1",children:"Last edited 2 hours ago"})]}),d.jsxs("div",{className:"bg-[#252525] border border-[#2a2a2a] p-4 text-left hover:border-[#3a3a3a] transition-colors cursor-pointer",children:[d.jsx(Et,{className:"w-8 h-8 text-[#666] mb-2"}),d.jsx("h3",{className:"text-sm font-medium text-[#ccc]",children:"Recent Project 2"}),d.jsx("p",{className:"text-xs text-[#666] mt-1",children:"Last edited yesterday"})]})]})]})]})});class tt{constructor(){this.root=null,this.videosDir=null,this.metadataCache=new Map,this.subscribers=new Set}static getInstance(){return tt.instance||(tt.instance=new tt),tt.instance}subscribe(t){return this.subscribers.add(t),()=>this.subscribers.delete(t)}notify(){this.subscribers.forEach(t=>{try{t()}catch{}})}async initialize(){try{return!("storage"in navigator)||!("getDirectory"in navigator.storage)?(console.warn("OPFS not supported"),!1):(this.root=await navigator.storage.getDirectory(),this.videosDir=await this.root.getDirectoryHandle("videos",{create:!0}),await this.loadMetadata(),!0)}catch(t){return console.error("Failed to initialize OPFS:",t),!1}}async storeVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");const n=`video-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=t.name.includes(".")?t.name.split(".").pop().toLowerCase():"bin",o=`${n}.${r}`;try{const i=await(await this.videosDir.getFileHandle(o,{create:!0})).createWritable();await i.write(t),await i.close();const a={id:n,fileName:t.name,fileSize:t.size,lastModified:t.lastModified,mimeType:t.type,storedFileName:o};return await this.saveMetadata(n,a),this.metadataCache.set(n,a),this.generateThumbnails(n,t).catch(console.error),this.notify(),n}catch(s){throw console.error("Failed to store video:",s),s}}async retrieveVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");try{const n=this.metadataCache.get(t);if(!n)return console.warn("No metadata found for video:",t),null;const o=await(await this.videosDir.getFileHandle(n.storedFileName)).getFile();return new File([o],n.fileName,{type:n.mimeType})}catch(n){return console.error("Failed to retrieve video:",n),null}}async deleteVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");try{const n=this.metadataCache.get(t),r=(n==null?void 0:n.storedFileName)??`${t}.mp4`;await this.videosDir.removeEntry(r).catch(()=>{}),await this.videosDir.removeEntry(`${t}.json`).catch(()=>{});const o=await this.videosDir.getDirectoryHandle("thumbnails",{create:!1}).catch(()=>null);if(o)for await(const[s]of o.entries())typeof s=="string"&&s.startsWith(t)&&await o.removeEntry(s).catch(()=>{});this.metadataCache.delete(t),this.notify()}catch(n){console.error("Failed to delete video:",n)}}async listVideos(){return Array.from(this.metadataCache.values())}async getStorageEstimate(){if("estimate"in navigator.storage){const t=await navigator.storage.estimate();return{usage:t.usage||0,quota:t.quota||0}}return{usage:0,quota:0}}async generateThumbnails(t,n){const r=document.createElement("video"),o=document.createElement("canvas"),s=o.getContext("2d");if(!s)return;r.src=URL.createObjectURL(n),r.muted=!0,r.playsInline=!0,await new Promise(u=>{r.onloadedmetadata=()=>u()});const i=Math.max(0,r.duration||0),a=i>0?[0,i*.25,i*.5,i*.75]:[0],c=[];o.width=320,o.height=180;for(const u of a)await new Promise(h=>{r.currentTime=u,r.onseeked=()=>h()}),s.drawImage(r,0,0,o.width,o.height),c.push(o.toDataURL("image/jpeg",.7));URL.revokeObjectURL(r.src);const l=this.metadataCache.get(t);l&&(l.thumbnails=c,await this.saveMetadata(t,l),this.metadataCache.set(t,l),this.notify())}async saveMetadata(t,n){if(!this.videosDir)return;const o=await(await this.videosDir.getFileHandle(`${t}.json`,{create:!0})).createWritable();await o.write(JSON.stringify(n)),await o.close()}async loadMetadata(){if(this.videosDir)try{for await(const[t,n]of this.videosDir.entries()){const r=n;if(r.kind==="file"&&typeof t=="string"&&t.endsWith(".json")){const s=await(await r.getFile()).text(),i=JSON.parse(s),a=i.storedFileName??`${i.id}.mp4`,c={id:i.id,fileName:i.fileName,fileSize:i.fileSize,lastModified:i.lastModified,mimeType:i.mimeType,storedFileName:a,thumbnails:i.thumbnails??[]};this.metadataCache.set(c.id,c)}}}catch(t){console.error("Failed to load metadata:",t)}}}function xm(){const[e,t]=I.useState(!1),[n,r]=I.useState([]),o=tt.getInstance();return I.useEffect(()=>{let c=null;return o.initialize().then(async l=>{t(l),l&&(r(await o.listVideos()),c=o.subscribe(async()=>{r(await o.listVideos())}))}),()=>{c&&c()}},[]),{isInitialized:e,videos:n,storeVideo:async c=>{const l=await o.storeVideo(c);return r(await o.listVideos()),l},retrieveVideo:c=>o.retrieveVideo(c),deleteVideo:async c=>{await o.deleteVideo(c),r(await o.listVideos())},getStorageEstimate:()=>o.getStorageEstimate()}}const ym=()=>{const e=I.useRef(null),{isInitialized:t,videos:n,storeVideo:r,retrieveVideo:o,deleteVideo:s,getStorageEstimate:i}=xm(),{currentVideoId:a,setCurrentVideo:c,setIsLoading:l,clearCurrentVideo:u}=Ir(),[h,f]=ye.useState({usage:0,quota:0}),[g,m]=ye.useState(0);ye.useEffect(()=>{t&&i().then(f)},[t,n,i]);const x=async p=>{const C=Array.from(p.target.files||[]).filter(E=>E.type.startsWith("video/"));m(C.length);for(const E of C)try{const A=await r(E);n.length===0&&!a&&y(A)}catch(A){console.error("Failed to store video:",A),alert(`Failed to store ${E.name}. Storage might be full.`)}m(0),e.current&&(e.current.value="")},y=async p=>{if(a!==p){l(!0);try{const w=await o(p);w&&c(p,w)}catch(w){console.error("Failed to load video:",w)}finally{l(!1)}}},b=async p=>{if(confirm("Delete this video from storage?")&&(await s(p),a===p)){u();const w=n.filter(C=>C.id!==p);w.length>0&&y(w[0].id)}},N=p=>{if(p===0)return"0 Bytes";const w=1024,C=["Bytes","KB","MB","GB"],E=Math.floor(Math.log(p)/Math.log(w));return parseFloat((p/Math.pow(w,E)).toFixed(2))+" "+C[E]};return d.jsxs("div",{className:"w-80 bg-[#1e1e1e] border-r border-[#0a0a0a] flex flex-col",children:[d.jsxs("div",{className:"h-8 bg-[#252525] border-b border-[#0a0a0a] flex items-center justify-between px-3",children:[d.jsx("span",{className:"text-xs text-[#999] font-medium",children:"MEDIA POOL"}),d.jsx("button",{onClick:()=>{var p;return(p=e.current)==null?void 0:p.click()},disabled:!t||g>0,className:"text-xs text-[#999] hover:text-white transition-colors disabled:opacity-50",children:g>0?d.jsxs("span",{className:"text-[10px]",children:["Uploading ",g,"..."]}):d.jsx(yc,{className:"w-4 h-4"})}),d.jsx("input",{ref:e,type:"file",accept:"video/*",multiple:!0,onChange:x,className:"hidden"})]}),t&&d.jsxs("div",{className:"px-3 py-2 bg-[#1a1a1a] border-b border-[#0a0a0a]",children:[d.jsxs("div",{className:"flex items-center justify-between text-[10px] text-[#666] mb-1",children:[d.jsxs("span",{className:"flex items-center gap-1",children:[d.jsx(Fr,{className:"w-3 h-3"}),"Browser Storage"]}),d.jsxs("span",{children:[N(h.usage)," / ",N(h.quota)]})]}),d.jsx("div",{className:"h-1 bg-[#0a0a0a] rounded overflow-hidden",children:d.jsx("div",{className:"h-full bg-[#E84E36] transition-all",style:{width:`${h.usage/h.quota*100}%`}})})]}),d.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:t?n.length===0?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Et,{className:"w-12 h-12 mx-auto mb-4 text-[#444]"}),d.jsx("p",{className:"text-[#666] text-xs mb-4",children:"No videos in storage"}),d.jsx("button",{onClick:()=>{var p;return(p=e.current)==null?void 0:p.click()},disabled:g>0,className:"px-4 py-2 bg-[#2a2a2a] text-[#999] text-xs border border-[#3a3a3a] hover:bg-[#333] hover:text-white transition-colors disabled:opacity-50",children:"Import Videos"})]}):d.jsx("div",{className:"space-y-1",children:n.map(p=>d.jsxs("div",{onClick:()=>y(p.id),className:`p-3 bg-[#1a1a1a] border-2 cursor-pointer transition-all ${a===p.id?"border-[#E84E36]":"border-transparent hover:border-[#3a3a3a]"}`,children:[d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx(Et,{className:"w-4 h-4 text-[#666] flex-shrink-0"}),d.jsx("p",{className:"text-xs text-[#ccc] truncate",children:p.fileName})]}),d.jsx("div",{className:"flex items-center gap-3 text-[10px] text-[#666]",children:d.jsx("span",{children:N(p.fileSize)})})]}),d.jsx("button",{onClick:w=>{w.stopPropagation(),b(p.id)},className:"p-1 hover:bg-[#2a2a2a] transition-colors",children:d.jsx(os,{className:"w-3 h-3 text-[#666] hover:text-red-500"})})]}),p.thumbnails&&p.thumbnails.length>0&&d.jsx("div",{className:"flex gap-1 mt-2",children:p.thumbnails.slice(0,4).map((w,C)=>d.jsx("img",{src:w,className:"w-1/4 h-auto opacity-50",alt:""},C))})]},p.id))}):d.jsx("div",{className:"text-center py-12",children:d.jsxs("div",{className:"animate-pulse",children:[d.jsx(Fr,{className:"w-12 h-12 mx-auto mb-4 text-[#444]"}),d.jsx("p",{className:"text-[#666] text-xs",children:"Initializing storage..."})]})})}),d.jsx("div",{className:"h-6 bg-[#1a1a1a] border-t border-[#0a0a0a] flex items-center px-3",children:d.jsxs("span",{className:"text-[10px] text-[#666]",children:[n.length," video",n.length!==1?"s":""," stored"]})})]})},bm=()=>{const e=I.useRef(null),{currentVideoUrl:t,isPlaying:n,currentTime:r,duration:o,volume:s,setIsPlaying:i,setCurrentTime:a,setDuration:c,setVolume:l}=Ir();I.useEffect(()=>{const g=e.current;if(!g)return;const m=()=>c(g.duration),x=()=>a(g.currentTime),y=()=>i(!0),b=()=>i(!1);return g.addEventListener("loadedmetadata",m),g.addEventListener("timeupdate",x),g.addEventListener("play",y),g.addEventListener("pause",b),g.volume=s/100,()=>{g.removeEventListener("loadedmetadata",m),g.removeEventListener("timeupdate",x),g.removeEventListener("play",y),g.removeEventListener("pause",b)}},[t,s]);const u=()=>{e.current&&(e.current.paused?e.current.play():e.current.pause())},h=g=>{e.current&&(e.current.currentTime=g)},f=g=>{const m=Math.floor(g/60),x=Math.floor(g%60);return`${m}:${x.toString().padStart(2,"0")}`};return t?d.jsxs("div",{className:"flex-1 flex flex-col bg-black",children:[d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsx("video",{ref:e,src:t,className:"max-w-full max-h-full"})}),d.jsxs("div",{className:"h-24 bg-[#252525] border-t border-[#0a0a0a] p-3",children:[d.jsx("div",{className:"mb-3",children:d.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-[#666] mb-1",children:[d.jsx("span",{children:f(r)}),d.jsxs("div",{className:"flex-1 h-1 bg-[#1a1a1a] relative",children:[d.jsx("div",{className:"absolute h-full bg-[#E84E36]",style:{width:`${o>0?r/o*100:0}%`}}),d.jsx("input",{type:"range",min:"0",max:o,value:r,onChange:g=>h(parseFloat(g.target.value)),className:"absolute inset-0 w-full opacity-0 cursor-pointer"})]}),d.jsx("span",{children:f(o)})]})}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>h(0),className:"p-2 bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] hover:bg-[#333] hover:text-white transition-colors",children:d.jsx(bc,{className:"w-4 h-4"})}),d.jsx("button",{onClick:u,className:"p-2 bg-[#E84E36] text-white hover:bg-[#d63d2a] transition-colors",children:n?d.jsx(wc,{className:"w-4 h-4"}):d.jsx(vc,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>h(o),className:"p-2 bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] hover:bg-[#333] hover:text-white transition-colors",children:d.jsx(Nc,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-[10px] text-[#666]",children:"Vol"}),d.jsx("input",{type:"range",min:"0",max:"100",value:s,onChange:g=>{const m=parseInt(g.target.value);l(m),e.current&&(e.current.volume=m/100)},className:"w-24",style:{height:"4px",backgroundColor:"#1a1a1a",outline:"none"}}),d.jsxs("span",{className:"text-[10px] text-[#666] w-8 text-right",children:[s,"%"]})]})]})]})]}):d.jsx("div",{className:"flex-1 flex items-center justify-center bg-black",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 text-[#444]",children:d.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:d.jsx("path",{d:"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"})})}),d.jsx("p",{className:"text-[#666] text-sm",children:"Select a video to preview"})]})})},wm=()=>d.jsxs("div",{className:"h-full bg-[#1a1a1a] flex",children:[d.jsx(ym,{}),d.jsx(bm,{})]});function Ui(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=Ui(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function vm(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=Ui(e))&&(r&&(r+=" "),r+=t);return r}const Tr="-",Nm=e=>{const t=Em(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:i=>{const a=i.split(Tr);return a[0]===""&&a.length!==1&&a.shift(),qi(a,t)||Sm(i)},getConflictingClassGroupIds:(i,a)=>{const c=n[i]||[];return a&&r[i]?[...c,...r[i]]:c}}},qi=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?qi(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const s=e.join(Tr);return(i=t.validators.find(({validator:a})=>a(s)))==null?void 0:i.classGroupId},qo=/^\[(.+)\]$/,Sm=e=>{if(qo.test(e)){const t=qo.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Em=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const o in n)dr(n[o],r,o,t);return r},dr=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const s=o===""?t:Ko(t,o);s.classGroupId=n;return}if(typeof o=="function"){if(Cm(o)){dr(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([s,i])=>{dr(i,Ko(t,s),n,r)})})},Ko=(e,t)=>{let n=e;return t.split(Tr).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Cm=e=>e.isThemeGetter,km=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(s,i)=>{n.set(s,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(s){let i=n.get(s);if(i!==void 0)return i;if((i=r.get(s))!==void 0)return o(s,i),i},set(s,i){n.has(s)?n.set(s,i):o(s,i)}}},fr="!",hr=":",_m=hr.length,jm=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=o=>{const s=[];let i=0,a=0,c=0,l;for(let m=0;m<o.length;m++){let x=o[m];if(i===0&&a===0){if(x===hr){s.push(o.slice(c,m)),c=m+_m;continue}if(x==="/"){l=m;continue}}x==="["?i++:x==="]"?i--:x==="("?a++:x===")"&&a--}const u=s.length===0?o:o.substring(c),h=Mm(u),f=h!==u,g=l&&l>c?l-c:void 0;return{modifiers:s,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:g}};if(t){const o=t+hr,s=r;r=i=>i.startsWith(o)?s(i.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:i,maybePostfixModifierPosition:void 0}}if(n){const o=r;r=s=>n({className:s,parseClassName:o})}return r},Mm=e=>e.endsWith(fr)?e.substring(0,e.length-1):e.startsWith(fr)?e.substring(1):e,Pm=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let s=[];return r.forEach(i=>{i[0]==="["||t[i]?(o.push(...s.sort(),i),s=[]):s.push(i)}),o.push(...s.sort()),o}},Am=e=>({cache:km(e.cacheSize),parseClassName:jm(e),sortModifiers:Pm(e),...Nm(e)}),Im=/\s+/,Tm=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:s}=t,i=[],a=e.trim().split(Im);let c="";for(let l=a.length-1;l>=0;l-=1){const u=a[l],{isExternal:h,modifiers:f,hasImportantModifier:g,baseClassName:m,maybePostfixModifierPosition:x}=n(u);if(h){c=u+(c.length>0?" "+c:c);continue}let y=!!x,b=r(y?m.substring(0,x):m);if(!b){if(!y){c=u+(c.length>0?" "+c:c);continue}if(b=r(m),!b){c=u+(c.length>0?" "+c:c);continue}y=!1}const N=s(f).join(":"),p=g?N+fr:N,w=p+b;if(i.includes(w))continue;i.push(w);const C=o(b,y);for(let E=0;E<C.length;++E){const A=C[E];i.push(p+A)}c=u+(c.length>0?" "+c:c)}return c};function zm(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=Ki(t))&&(r&&(r+=" "),r+=n);return r}const Ki=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=Ki(e[r]))&&(n&&(n+=" "),n+=t);return n};function $m(e,...t){let n,r,o,s=i;function i(c){const l=t.reduce((u,h)=>h(u),e());return n=Am(l),r=n.cache.get,o=n.cache.set,s=a,a(c)}function a(c){const l=r(c);if(l)return l;const u=Tm(c,n);return o(c,u),u}return function(){return s(zm.apply(null,arguments))}}const ue=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},Zi=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Qi=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Dm=/^\d+\/\d+$/,Rm=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Lm=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Vm=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Hm=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Bm=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Qe=e=>Dm.test(e),ne=e=>!!e&&!Number.isNaN(Number(e)),$e=e=>!!e&&Number.isInteger(Number(e)),Un=e=>e.endsWith("%")&&ne(e.slice(0,-1)),Me=e=>Rm.test(e),Om=()=>!0,Fm=e=>Lm.test(e)&&!Vm.test(e),Ji=()=>!1,Ym=e=>Hm.test(e),Xm=e=>Bm.test(e),Wm=e=>!X(e)&&!W(e),Gm=e=>dt(e,na,Ji),X=e=>Zi.test(e),Ve=e=>dt(e,ra,Fm),qn=e=>dt(e,Qm,ne),Zo=e=>dt(e,ea,Ji),Um=e=>dt(e,ta,Xm),rn=e=>dt(e,oa,Ym),W=e=>Qi.test(e),yt=e=>ft(e,ra),qm=e=>ft(e,Jm),Qo=e=>ft(e,ea),Km=e=>ft(e,na),Zm=e=>ft(e,ta),on=e=>ft(e,oa,!0),dt=(e,t,n)=>{const r=Zi.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},ft=(e,t,n=!1)=>{const r=Qi.exec(e);return r?r[1]?t(r[1]):n:!1},ea=e=>e==="position"||e==="percentage",ta=e=>e==="image"||e==="url",na=e=>e==="length"||e==="size"||e==="bg-size",ra=e=>e==="length",Qm=e=>e==="number",Jm=e=>e==="family-name",oa=e=>e==="shadow",ep=()=>{const e=ue("color"),t=ue("font"),n=ue("text"),r=ue("font-weight"),o=ue("tracking"),s=ue("leading"),i=ue("breakpoint"),a=ue("container"),c=ue("spacing"),l=ue("radius"),u=ue("shadow"),h=ue("inset-shadow"),f=ue("text-shadow"),g=ue("drop-shadow"),m=ue("blur"),x=ue("perspective"),y=ue("aspect"),b=ue("ease"),N=ue("animate"),p=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...w(),W,X],E=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],k=()=>[W,X,c],T=()=>[Qe,"full","auto",...k()],H=()=>[$e,"none","subgrid",W,X],L=()=>["auto",{span:["full",$e,W,X]},$e,W,X],z=()=>[$e,"auto",W,X],D=()=>["auto","min","max","fr",W,X],v=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],P=()=>["start","end","center","stretch","center-safe","end-safe"],S=()=>["auto",...k()],_=()=>[Qe,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],j=()=>[e,W,X],M=()=>[...w(),Qo,Zo,{position:[W,X]}],$=()=>["no-repeat",{repeat:["","x","y","space","round"]}],R=()=>["auto","cover","contain",Km,Gm,{size:[W,X]}],V=()=>[Un,yt,Ve],F=()=>["","none","full",l,W,X],O=()=>["",ne,yt,Ve],q=()=>["solid","dashed","dotted","double"],Z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Y=()=>[ne,Un,Qo,Zo],B=()=>["","none",m,W,X],U=()=>["none",ne,W,X],ee=()=>["none",ne,W,X],te=()=>[ne,W,X],K=()=>[Qe,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Me],breakpoint:[Me],color:[Om],container:[Me],"drop-shadow":[Me],ease:["in","out","in-out"],font:[Wm],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Me],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Me],shadow:[Me],spacing:["px",ne],text:[Me],"text-shadow":[Me],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Qe,X,W,y]}],container:["container"],columns:[{columns:[ne,X,W,a]}],"break-after":[{"break-after":p()}],"break-before":[{"break-before":p()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:T()}],"inset-x":[{"inset-x":T()}],"inset-y":[{"inset-y":T()}],start:[{start:T()}],end:[{end:T()}],top:[{top:T()}],right:[{right:T()}],bottom:[{bottom:T()}],left:[{left:T()}],visibility:["visible","invisible","collapse"],z:[{z:[$e,"auto",W,X]}],basis:[{basis:[Qe,"full","auto",a,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ne,Qe,"auto","initial","none",X]}],grow:[{grow:["",ne,W,X]}],shrink:[{shrink:["",ne,W,X]}],order:[{order:[$e,"first","last","none",W,X]}],"grid-cols":[{"grid-cols":H()}],"col-start-end":[{col:L()}],"col-start":[{"col-start":z()}],"col-end":[{"col-end":z()}],"grid-rows":[{"grid-rows":H()}],"row-start-end":[{row:L()}],"row-start":[{"row-start":z()}],"row-end":[{"row-end":z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":D()}],"auto-rows":[{"auto-rows":D()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...v(),"normal"]}],"justify-items":[{"justify-items":[...P(),"normal"]}],"justify-self":[{"justify-self":["auto",...P()]}],"align-content":[{content:["normal",...v()]}],"align-items":[{items:[...P(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...P(),{baseline:["","last"]}]}],"place-content":[{"place-content":v()}],"place-items":[{"place-items":[...P(),"baseline"]}],"place-self":[{"place-self":["auto",...P()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:S()}],mx:[{mx:S()}],my:[{my:S()}],ms:[{ms:S()}],me:[{me:S()}],mt:[{mt:S()}],mr:[{mr:S()}],mb:[{mb:S()}],ml:[{ml:S()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:_()}],w:[{w:[a,"screen",..._()]}],"min-w":[{"min-w":[a,"screen","none",..._()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[i]},..._()]}],h:[{h:["screen","lh",..._()]}],"min-h":[{"min-h":["screen","lh","none",..._()]}],"max-h":[{"max-h":["screen","lh",..._()]}],"font-size":[{text:["base",n,yt,Ve]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,W,qn]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Un,X]}],"font-family":[{font:[qm,X,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,W,X]}],"line-clamp":[{"line-clamp":[ne,"none",W,qn]}],leading:[{leading:[s,...k()]}],"list-image":[{"list-image":["none",W,X]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",W,X]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:j()}],"text-color":[{text:j()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:[ne,"from-font","auto",W,Ve]}],"text-decoration-color":[{decoration:j()}],"underline-offset":[{"underline-offset":[ne,"auto",W,X]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",W,X]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",W,X]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:M()}],"bg-repeat":[{bg:$()}],"bg-size":[{bg:R()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},$e,W,X],radial:["",W,X],conic:[$e,W,X]},Zm,Um]}],"bg-color":[{bg:j()}],"gradient-from-pos":[{from:V()}],"gradient-via-pos":[{via:V()}],"gradient-to-pos":[{to:V()}],"gradient-from":[{from:j()}],"gradient-via":[{via:j()}],"gradient-to":[{to:j()}],rounded:[{rounded:F()}],"rounded-s":[{"rounded-s":F()}],"rounded-e":[{"rounded-e":F()}],"rounded-t":[{"rounded-t":F()}],"rounded-r":[{"rounded-r":F()}],"rounded-b":[{"rounded-b":F()}],"rounded-l":[{"rounded-l":F()}],"rounded-ss":[{"rounded-ss":F()}],"rounded-se":[{"rounded-se":F()}],"rounded-ee":[{"rounded-ee":F()}],"rounded-es":[{"rounded-es":F()}],"rounded-tl":[{"rounded-tl":F()}],"rounded-tr":[{"rounded-tr":F()}],"rounded-br":[{"rounded-br":F()}],"rounded-bl":[{"rounded-bl":F()}],"border-w":[{border:O()}],"border-w-x":[{"border-x":O()}],"border-w-y":[{"border-y":O()}],"border-w-s":[{"border-s":O()}],"border-w-e":[{"border-e":O()}],"border-w-t":[{"border-t":O()}],"border-w-r":[{"border-r":O()}],"border-w-b":[{"border-b":O()}],"border-w-l":[{"border-l":O()}],"divide-x":[{"divide-x":O()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":O()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...q(),"hidden","none"]}],"divide-style":[{divide:[...q(),"hidden","none"]}],"border-color":[{border:j()}],"border-color-x":[{"border-x":j()}],"border-color-y":[{"border-y":j()}],"border-color-s":[{"border-s":j()}],"border-color-e":[{"border-e":j()}],"border-color-t":[{"border-t":j()}],"border-color-r":[{"border-r":j()}],"border-color-b":[{"border-b":j()}],"border-color-l":[{"border-l":j()}],"divide-color":[{divide:j()}],"outline-style":[{outline:[...q(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ne,W,X]}],"outline-w":[{outline:["",ne,yt,Ve]}],"outline-color":[{outline:j()}],shadow:[{shadow:["","none",u,on,rn]}],"shadow-color":[{shadow:j()}],"inset-shadow":[{"inset-shadow":["none",h,on,rn]}],"inset-shadow-color":[{"inset-shadow":j()}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:j()}],"ring-offset-w":[{"ring-offset":[ne,Ve]}],"ring-offset-color":[{"ring-offset":j()}],"inset-ring-w":[{"inset-ring":O()}],"inset-ring-color":[{"inset-ring":j()}],"text-shadow":[{"text-shadow":["none",f,on,rn]}],"text-shadow-color":[{"text-shadow":j()}],opacity:[{opacity:[ne,W,X]}],"mix-blend":[{"mix-blend":[...Z(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Z()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ne]}],"mask-image-linear-from-pos":[{"mask-linear-from":Y()}],"mask-image-linear-to-pos":[{"mask-linear-to":Y()}],"mask-image-linear-from-color":[{"mask-linear-from":j()}],"mask-image-linear-to-color":[{"mask-linear-to":j()}],"mask-image-t-from-pos":[{"mask-t-from":Y()}],"mask-image-t-to-pos":[{"mask-t-to":Y()}],"mask-image-t-from-color":[{"mask-t-from":j()}],"mask-image-t-to-color":[{"mask-t-to":j()}],"mask-image-r-from-pos":[{"mask-r-from":Y()}],"mask-image-r-to-pos":[{"mask-r-to":Y()}],"mask-image-r-from-color":[{"mask-r-from":j()}],"mask-image-r-to-color":[{"mask-r-to":j()}],"mask-image-b-from-pos":[{"mask-b-from":Y()}],"mask-image-b-to-pos":[{"mask-b-to":Y()}],"mask-image-b-from-color":[{"mask-b-from":j()}],"mask-image-b-to-color":[{"mask-b-to":j()}],"mask-image-l-from-pos":[{"mask-l-from":Y()}],"mask-image-l-to-pos":[{"mask-l-to":Y()}],"mask-image-l-from-color":[{"mask-l-from":j()}],"mask-image-l-to-color":[{"mask-l-to":j()}],"mask-image-x-from-pos":[{"mask-x-from":Y()}],"mask-image-x-to-pos":[{"mask-x-to":Y()}],"mask-image-x-from-color":[{"mask-x-from":j()}],"mask-image-x-to-color":[{"mask-x-to":j()}],"mask-image-y-from-pos":[{"mask-y-from":Y()}],"mask-image-y-to-pos":[{"mask-y-to":Y()}],"mask-image-y-from-color":[{"mask-y-from":j()}],"mask-image-y-to-color":[{"mask-y-to":j()}],"mask-image-radial":[{"mask-radial":[W,X]}],"mask-image-radial-from-pos":[{"mask-radial-from":Y()}],"mask-image-radial-to-pos":[{"mask-radial-to":Y()}],"mask-image-radial-from-color":[{"mask-radial-from":j()}],"mask-image-radial-to-color":[{"mask-radial-to":j()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[ne]}],"mask-image-conic-from-pos":[{"mask-conic-from":Y()}],"mask-image-conic-to-pos":[{"mask-conic-to":Y()}],"mask-image-conic-from-color":[{"mask-conic-from":j()}],"mask-image-conic-to-color":[{"mask-conic-to":j()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:M()}],"mask-repeat":[{mask:$()}],"mask-size":[{mask:R()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",W,X]}],filter:[{filter:["","none",W,X]}],blur:[{blur:B()}],brightness:[{brightness:[ne,W,X]}],contrast:[{contrast:[ne,W,X]}],"drop-shadow":[{"drop-shadow":["","none",g,on,rn]}],"drop-shadow-color":[{"drop-shadow":j()}],grayscale:[{grayscale:["",ne,W,X]}],"hue-rotate":[{"hue-rotate":[ne,W,X]}],invert:[{invert:["",ne,W,X]}],saturate:[{saturate:[ne,W,X]}],sepia:[{sepia:["",ne,W,X]}],"backdrop-filter":[{"backdrop-filter":["","none",W,X]}],"backdrop-blur":[{"backdrop-blur":B()}],"backdrop-brightness":[{"backdrop-brightness":[ne,W,X]}],"backdrop-contrast":[{"backdrop-contrast":[ne,W,X]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ne,W,X]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ne,W,X]}],"backdrop-invert":[{"backdrop-invert":["",ne,W,X]}],"backdrop-opacity":[{"backdrop-opacity":[ne,W,X]}],"backdrop-saturate":[{"backdrop-saturate":[ne,W,X]}],"backdrop-sepia":[{"backdrop-sepia":["",ne,W,X]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",W,X]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ne,"initial",W,X]}],ease:[{ease:["linear","initial",b,W,X]}],delay:[{delay:[ne,W,X]}],animate:[{animate:["none",N,W,X]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[x,W,X]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:U()}],"rotate-x":[{"rotate-x":U()}],"rotate-y":[{"rotate-y":U()}],"rotate-z":[{"rotate-z":U()}],scale:[{scale:ee()}],"scale-x":[{"scale-x":ee()}],"scale-y":[{"scale-y":ee()}],"scale-z":[{"scale-z":ee()}],"scale-3d":["scale-3d"],skew:[{skew:te()}],"skew-x":[{"skew-x":te()}],"skew-y":[{"skew-y":te()}],transform:[{transform:[W,X,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:K()}],"translate-x":[{"translate-x":K()}],"translate-y":[{"translate-y":K()}],"translate-z":[{"translate-z":K()}],"translate-none":["translate-none"],accent:[{accent:j()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:j()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",W,X]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",W,X]}],fill:[{fill:["none",...j()]}],"stroke-w":[{stroke:[ne,yt,Ve,qn]}],stroke:[{stroke:["none",...j()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},tp=$m(ep);function vt(...e){return tp(vm(e))}const np=(e,t)=>{var n;return(n=e.find(r=>r.name===t))==null?void 0:n.value},rp=(e,t)=>{let n=t;return typeof e.min=="number"&&(n=Math.max(n,e.min)),typeof e.max=="number"&&(n=Math.min(n,e.max)),n},op=(e,t)=>{const n=np(t,e.varName);if(typeof n!="number")return!1;switch(e.op){case"lt":return n<e.value;case"lte":return n<=e.value;case"eq":return n===e.value;case"neq":return n!==e.value;case"gte":return n>=e.value;case"gt":return n>e.value;default:return!0}},gr=(e,t)=>!e||e.length===0?!0:e.every(n=>op(n,t)),sp=e=>{const t={lt:"<",lte:"≤",eq:"=",neq:"≠",gte:"≥",gt:">"}[e.op];return`${e.varName} ${t} ${e.value}`},ip=(e,t)=>t.map(n=>{const r=e[n.name]??0;if(r===0)return n;const o=rp(n,n.value+r);return{...n,value:o}}),sa=({data:e,selected:t})=>{const{label:n,description:r,durationSec:o,conditions:s}=e,i=he(c=>c.variables),a=I.useMemo(()=>gr(s,i),[s,i]);return d.jsxs("div",{className:vt("relative w-60 h-60 transition-all duration-150 ease-in-out","border-2 bg-zinc-800",t?"border-red-500":"border-zinc-700",!a&&"opacity-60"),children:[!a&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60",children:d.jsxs("div",{className:"flex flex-col items-center gap-1 text-xs text-zinc-300",children:[d.jsx(Sc,{className:"w-5 h-5 text-zinc-400"}),s==null?void 0:s.map((c,l)=>d.jsx("span",{className:"font-mono",children:sp(c)},l))]})}),d.jsxs("div",{className:"p-4 h-full flex flex-col",children:[d.jsx("div",{className:"flex items-start justify-between mb-3",children:d.jsx("h3",{className:"text-sm font-semibold text-zinc-200",children:n})}),d.jsx("div",{className:"flex-1 mb-3",children:r&&d.jsx("p",{className:"text-xs leading-relaxed text-zinc-500 overflow-hidden text-ellipsis line-clamp-6",children:r})}),d.jsxs("div",{className:"mt-auto",children:[d.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[d.jsx("span",{className:"text-xs text-zinc-500",children:"Duration"}),d.jsxs("span",{className:"text-xs text-zinc-300 font-mono",children:[o,"s"]})]}),d.jsx("div",{className:"h-1 bg-zinc-900 relative overflow-hidden rounded-sm"})]})]}),d.jsx(Le,{type:"target",position:G.Left,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !left-[-5px]"}),d.jsx(Le,{type:"source",position:G.Right,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !right-[-5px]"})]})},ia=({data:e,selected:t})=>{const{label:n,effects:r}=e,o=he(a=>a.variables),s=Object.entries(r).filter(([a,c])=>c!==0),i=s.length>0;return d.jsxs("div",{className:"relative group",children:[d.jsxs("div",{className:vt("relative px-5 py-2.5 border-2 text-xs font-medium","inline-flex items-center gap-2 h-12","bg-zinc-700 border-zinc-600 text-zinc-200",t&&"border-red-500"),children:[d.jsx("span",{children:n}),i&&d.jsx("div",{className:"flex items-center gap-1 ml-1",children:s.map(([a,c])=>d.jsx("div",{className:vt("w-4 h-4 bg-zinc-800 border border-zinc-700","flex items-center justify-center text-[9px] font-bold",c>0?"text-green-400":"text-red-400"),title:`${a}: ${c>0?"+":""}${c}`,children:c>0?"↑":"↓"},a))}),d.jsx(Le,{type:"target",position:G.Left,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !left-[-5px]"}),d.jsx(Le,{type:"source",position:G.Right,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !right-[-5px]"})]}),i&&d.jsx("div",{className:vt("absolute left-1/2 -translate-x-1/2 -bottom-[60px] z-10","opacity-0 pointer-events-none transition-opacity duration-200","group-hover:opacity-100"),children:d.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 px-2.5 py-1.5 text-[10px] whitespace-nowrap",children:[d.jsx("div",{className:"flex flex-col gap-0.5",children:s.map(([a,c])=>o.find(u=>u.name===a)?d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("span",{className:"text-zinc-500",children:[a,":"]}),d.jsxs("span",{className:vt("font-mono font-medium",c>0?"text-green-400":"text-red-400"),children:[c>0?"+":"",c]})]},a):null)}),d.jsx("div",{className:"absolute -top-[3px] left-1/2 -translate-x-1/2 w-0 h-0 border-l-[4px] border-r-[4px] border-b-[4px] border-l-transparent border-r-transparent border-b-zinc-700"})]})})]})},ap={scene:sa,choice:ia},Jo={type:"smoothstep",markerEnd:{type:"arrow"},style:{strokeWidth:2,stroke:"#52525b"}},aa=ye.memo(()=>{const e=ce(m=>m.nodes),t=ce(m=>m.edges),n=ce(m=>m.selectedNodeId),r=ce(m=>m.onNodesChange),o=ce(m=>m.onEdgesChange),s=ce(m=>m.createChoice),i=ce(m=>m.selectNode),a=ce(m=>m.deleteNode),c=I.useMemo(()=>new Map(e.map(m=>[m.id,m])),[e]),l=I.useMemo(()=>t.map(m=>!!n&&(m.source===n||m.target===n)&&!!c.get(n)&&Xe(c.get(n))?{...m,type:"smoothstep",style:{strokeWidth:3,stroke:"#dc2626"},markerEnd:{type:"arrow",color:"#dc2626"}}:{...m,...Jo}),[t,c,n]),u=I.useCallback(m=>{m.source&&m.target&&s(m.source,m.target)},[s]),h=I.useCallback(m=>{if(m.nodes.length>0)i(m.nodes[0].id);else if(m.edges.length>0){const x=m.edges[0],y=c.get(x.source),b=c.get(x.target);y&&Xe(y)?i(y.id):b&&Xe(b)?i(b.id):i(null)}else i(null)},[i,c]),f=I.useCallback(()=>{i(null)},[i]),g=m=>m instanceof HTMLElement&&(m.isContentEditable||["INPUT","TEXTAREA","SELECT"].includes(m.tagName));return ye.useEffect(()=>{const m=x=>{g(x.target)||(x.key==="Delete"||x.key==="Backspace")&&n&&(x.preventDefault(),a(n))};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[n,a]),d.jsxs(Bi,{nodes:e,edges:l,nodeTypes:ap,onNodesChange:r,onEdgesChange:o,onConnect:u,onSelectionChange:h,onPaneClick:f,connectionLineType:Se.SmoothStep,defaultEdgeOptions:Jo,deleteKeyCode:null,snapToGrid:!0,snapGrid:[24,24],fitView:!0,children:[d.jsx(Xi,{}),d.jsx(Gi,{}),d.jsx(Fi,{gap:24,size:1})]})}),cp=()=>d.jsxs("div",{className:"h-full flex",children:[d.jsx("div",{className:"flex-1 flex flex-col bg-[#1a1a1a]",children:d.jsx("div",{className:"flex-1 relative",children:d.jsx(aa,{})})}),d.jsxs("div",{className:"w-[350px] bg-[#1e1e1e] border-l border-[#0a0a0a]",children:[d.jsx("div",{className:"h-8 bg-[#252525] border-b border-[#0a0a0a] flex items-center px-3",children:d.jsx("span",{className:"text-xs text-[#999] font-medium",children:"STORY OVERVIEW"})}),d.jsxs("div",{className:"p-6 text-center",children:[d.jsx(rs,{className:"w-12 h-12 mx-auto mb-4 text-[#666]"}),d.jsx("p",{className:"text-[#666] text-sm mb-4",children:"Story flow visualization"}),d.jsxs("div",{className:"bg-[#252525] border border-[#2a2a2a] p-4 text-left",children:[d.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[d.jsx(Ec,{className:"w-4 h-4 text-[#999] mt-0.5"}),d.jsx("div",{children:d.jsx("p",{className:"text-xs text-[#999] leading-relaxed",children:"This view shows your complete story structure. Add scenes and choices to build branching narratives."})})]}),d.jsxs("div",{className:"space-y-2 mt-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-zinc-800 border border-zinc-700"}),d.jsx("span",{className:"text-xs text-[#999]",children:"Scene nodes"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-zinc-700 border border-zinc-600"}),d.jsx("span",{className:"text-xs text-[#999]",children:"Choice nodes"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-8 h-0.5 bg-orange-500"}),d.jsx("span",{className:"text-xs text-[#999]",children:"Conditional paths"})]})]})]})]})]})]}),lp=()=>{const e=ce(c=>c.nodes),t=ce(c=>c.edges),n=ce(c=>c.selectedNodeId),r=ce(c=>c.updateNode),o=ce(c=>c.deleteNode),s=ce(c=>c.addSceneNode),i=he(c=>c.variables),a=I.useMemo(()=>e.find(c=>c.id===n),[e,n]);return d.jsxs("div",{className:"w-full h-full flex flex-col bg-[#1e1e1e] text-[#ccc]",children:[d.jsx("div",{className:"flex-1 overflow-y-auto",children:a?d.jsxs("div",{className:"bg-[#1a1a1a] border border-[#2a2a2a] mb-px",children:[d.jsxs("div",{className:"bg-[#252525] border-b border-[#0a0a0a] text-[#999] text-[11px] font-semibold uppercase tracking-wider px-3 py-2 h-8 flex items-center justify-between",children:[d.jsxs("span",{children:[Ye(a)?"SCENE":"CHOICE"," PROPERTIES"]}),a.id!==$t&&d.jsx("button",{onClick:()=>o(a.id),className:"text-[#666] text-[11px] hover:text-red-500 transition-colors",children:"Delete"})]}),d.jsxs("div",{className:"p-3",children:[d.jsxs("div",{className:"mb-3",children:[d.jsx("label",{className:"text-[11px] text-[#666] block mb-1",children:"NAME"}),d.jsx("input",{type:"text",value:a.data.label,onChange:c=>r(a.id,{label:c.target.value}),className:"bg-[#1a1a1a] border border-[#2a2a2a] text-[#ccc] text-xs px-2 py-1 w-full outline-none focus:border-[#3a3a3a]"})]}),Ye(a)&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"mb-3",children:[d.jsx("label",{className:"text-[11px] text-[#666] block mb-1",children:"DESCRIPTION"}),d.jsx("textarea",{value:a.data.description||"",onChange:c=>r(a.id,{description:c.target.value}),className:"bg-[#1a1a1a] border border-[#2a2a2a] text-[#ccc] text-xs px-2 py-1 w-full outline-none focus:border-[#3a3a3a] resize-none",rows:3})]}),d.jsxs("div",{className:"mb-3",children:[d.jsx("label",{className:"text-[11px] text-[#666] block mb-1",children:"DURATION (SECONDS)"}),d.jsx("input",{type:"number",value:a.data.durationSec,onChange:c=>{const l=parseInt(c.target.value);!isNaN(l)&&l>=0&&r(a.id,{durationSec:l})},className:"bg-[#1a1a1a] border border-[#2a2a2a] text-[#ccc] text-xs px-2 py-1 w-full outline-none focus:border-[#3a3a3a]"})]}),d.jsxs("div",{className:"mb-3",children:[d.jsx("label",{className:"text-[11px] text-[#666] block mb-2",children:"CONDITIONS"}),d.jsxs("div",{className:"space-y-2",children:[(a.data.conditions??[]).map((c,l)=>d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("select",{value:c.varName,onChange:u=>{const h=[...a.data.conditions??[]];h[l]={...c,varName:u.target.value},r(a.id,{conditions:h})},className:"bg-[#1a1a1a] border border-[#2a2a2a] text-xs px-2 py-1 text-[#ccc] w-28",children:[d.jsx("option",{value:"",children:"(none)"}),i.map(u=>d.jsx("option",{value:u.name,children:u.name},u.name))]}),d.jsxs("select",{value:c.op,onChange:u=>{const h=[...a.data.conditions??[]];h[l]={...c,op:u.target.value},r(a.id,{conditions:h})},className:"bg-[#1a1a1a] border border-[#2a2a2a] text-xs px-2 py-1 text-[#ccc] w-16",children:[d.jsx("option",{value:"lt",children:"<"}),d.jsx("option",{value:"lte",children:"≤"}),d.jsx("option",{value:"eq",children:"="}),d.jsx("option",{value:"neq",children:"≠"}),d.jsx("option",{value:"gte",children:"≥"}),d.jsx("option",{value:"gt",children:">"})]}),d.jsx("input",{type:"number",value:c.value,onChange:u=>{const h=parseFloat(u.target.value),f=[...a.data.conditions??[]];f[l]={...c,value:isNaN(h)?0:h},r(a.id,{conditions:f})},className:"bg-[#1a1a1a] border border-[#2a2a2a] text-xs px-2 py-1 text-[#ccc] w-20 text-right"}),d.jsx("button",{onClick:()=>{const u=(a.data.conditions??[]).filter((h,f)=>f!==l);r(a.id,{conditions:u})},className:"px-2 py-1 text-[11px] bg-[#2a2a2a] border border-[#3a3a3a] text-[#bbb] hover:bg-[#333]","aria-label":"Remove condition",title:"Remove",children:"×"})]},l)),d.jsx("button",{onClick:()=>{var l;const c=[...a.data.conditions??[],{varName:((l=i[0])==null?void 0:l.name)??"",op:"gte",value:0}];r(a.id,{conditions:c})},className:"px-2 py-1 text-[11px] bg-[#2a2a2a] border border-[#3a3a3a] text-[#bbb] hover:bg-[#333]",children:"+ Add condition"})]})]})]}),Xe(a)&&d.jsxs("div",{children:[d.jsx("label",{className:"text-[11px] text-[#666] block mb-2",children:"VARIABLE EFFECTS"}),d.jsxs("div",{className:"bg-[#0f0f0f] p-2 border border-[#2a2a2a]",children:[i.map(c=>{const l=a.data.effects[c.name]??0;return d.jsxs("div",{className:"flex items-center gap-2 mb-2 last:mb-0",children:[d.jsx("span",{className:"w-20 text-[11px] text-[#666] font-mono",children:c.name}),d.jsx("button",{onClick:()=>r(a.id,{effects:{...a.data.effects,[c.name]:l-1}}),className:"w-6 h-6 bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] text-sm font-medium hover:bg-[#333]",children:"-"}),d.jsxs("span",{className:`w-10 text-center text-xs font-mono ${l>0?"text-green-400":l<0?"text-red-400":"text-[#666]"}`,children:[l>0?"+":"",l]}),d.jsx("button",{onClick:()=>r(a.id,{effects:{...a.data.effects,[c.name]:l+1}}),className:"w-6 h-6 bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] text-sm font-medium hover:bg-[#333]",children:"+"})]},c.name)}),i.length===0&&d.jsx("p",{className:"text-[11px] text-[#777]",children:"Brak zarejestrowanych zmiennych."})]})]})]})]}):d.jsxs("div",{className:"p-6 text-center",children:[d.jsx("p",{className:"text-[#666] text-xs mb-4",children:"No node selected"}),d.jsxs("button",{onClick:s,className:"bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] text-xs font-medium py-1.5 px-3 hover:border-[#4a4a4a] hover:bg-[#333] transition-colors inline-flex items-center",children:[d.jsx(mr,{size:12,className:"mr-2"}),"Add Scene"]})]})}),d.jsxs("div",{className:"h-6 bg-[#1a1a1a] border-t border-[#0a0a0a] flex items-center justify-between px-3 text-[11px] text-[#666]",children:[d.jsxs("span",{children:[e.length," nodes • ",t.length," edges"]}),d.jsx("span",{children:n?`ID: ${n}`:"Ready"})]})]})},up=()=>d.jsxs("div",{className:"h-full flex",children:[d.jsx("div",{className:"flex-1 flex flex-col bg-[#1a1a1a]",children:d.jsx("div",{className:"flex-1 relative",children:d.jsx(aa,{})})}),d.jsxs("div",{className:"w-[350px] bg-[#1e1e1e] border-l border-[#0a0a0a]",children:[d.jsx("div",{className:"h-8 bg-[#252525] border-b border-[#0a0a0a] flex items-center px-3",children:d.jsx("span",{className:"text-xs text-[#999] font-medium",children:"INSPECTOR"})}),d.jsx(lp,{})]})]}),dp=()=>{const e=he(c=>c.variables),t=he(c=>c.addVariable),n=he(c=>c.removeVariable),r=he(c=>c.reset),o=he(c=>c.loadVariables),s=I.useMemo(()=>new Map(e.map(c=>[c.name,c])),[e]),i=(c,l)=>{o(e.map(u=>u.name===c?{...u,...l}:u))},a=()=>{const c=prompt("Variable name:");if(c){if(s.has(c)){alert("Variable with this name already exists.");return}t(c)}};return d.jsxs("div",{className:"h-full bg-[#1a1a1a] text-[#ccc]",children:[d.jsxs("div",{className:"h-12 px-4 border-b border-[#0a0a0a] bg-[#242424] flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("h1",{className:"text-sm font-semibold",children:"Variables"}),d.jsxs("span",{className:"text-[11px] text-[#777]",children:[e.length," items"]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:a,className:"px-3 py-1.5 text-xs font-medium bg-[#2a2a2a] text-[#bbb] border border-[#3a3a3a] hover:bg-[#333]",children:d.jsxs("span",{className:"inline-flex items-center gap-2",children:[d.jsx(mr,{className:"w-3 h-3"})," Add"]})}),d.jsx("button",{onClick:r,className:"px-3 py-1.5 text-xs font-medium bg-[#2a2a2a] text-[#bbb] border border-[#3a3a3a] hover:bg-[#333]",children:d.jsxs("span",{className:"inline-flex items-center gap-2",children:[d.jsx(Cc,{className:"w-3 h-3"})," Reset to defaults"]})})]})]}),d.jsx("div",{className:"p-4 space-y-2",children:e.map(c=>d.jsxs("div",{className:"bg-[#202020] border border-[#2a2a2a] p-3",children:[d.jsxs("div",{className:"flex items-center justify-between mb-3",children:[d.jsx("span",{className:"text-xs px-2 py-1 bg-[#141414] border border-[#2a2a2a] font-mono",children:c.name}),d.jsx("button",{onClick:()=>n(c.name),className:"text-[#666] hover:text-red-500",children:d.jsx(os,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-3 gap-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[11px] text-[#777] block mb-1",children:"Initial"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>i(c.name,{initialValue:c.initialValue-1}),className:"w-7 h-7 bg-[#2a2a2a] border border-[#3a3a3a] text-[#bbb] hover:bg-[#333]",children:"–"}),d.jsx("input",{type:"number",value:c.initialValue,onChange:l=>i(c.name,{initialValue:parseInt(l.target.value)||0}),className:"w-20 text-xs bg-[#141414] border border-[#2a2a2a] px-2 py-1 text-right"}),d.jsx("button",{onClick:()=>i(c.name,{initialValue:c.initialValue+1}),className:"w-7 h-7 bg-[#2a2a2a] border border-[#3a3a3a] text-[#bbb] hover:bg-[#333]",children:"+"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[11px] text-[#777] block mb-1",children:"Min"}),d.jsx("input",{type:"number",value:typeof c.min=="number"?c.min:"",placeholder:"(none)",onChange:l=>i(c.name,{min:l.target.value===""?void 0:parseInt(l.target.value)||0}),className:"w-20 text-xs bg-[#141414] border border-[#2a2a2a] px-2 py-1 text-right"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[11px] text-[#777] block mb-1",children:"Max"}),d.jsx("input",{type:"number",value:typeof c.max=="number"?c.max:"",placeholder:"(none)",onChange:l=>i(c.name,{max:l.target.value===""?void 0:parseInt(l.target.value)||0}),className:"w-20 text-xs bg-[#141414] border border-[#2a2a2a] px-2 py-1 text-right"})]})]})]},c.name))})]})},sn=Dt(e=>({currentSceneId:null,start:()=>e({currentSceneId:$t}),goTo:t=>e({currentSceneId:t}),reset:()=>e({currentSceneId:$t})})),fp={scene:sa,choice:ia},hp={type:"smoothstep",markerEnd:{type:"arrow"},style:{strokeWidth:2,stroke:"#52525b"}},gp=()=>{const e=ce(m=>m.nodes),t=ce(m=>m.edges),n=ce(m=>m.getChoicesForScene),r=sn(m=>m.currentSceneId),o=sn(m=>m.start),s=sn(m=>m.goTo),i=sn(m=>m.reset),a=he(m=>m.variables),c=he(m=>m.loadVariables),l=Tn();ye.useEffect(()=>{r||o()},[r,o]);const u=ye.useMemo(()=>e.find(m=>m.id===r&&Ye(m)),[e,r]);ye.useEffect(()=>{if(!u)return;const m=u.position.x+120,x=u.position.y+120;l.setCenter(m,x,{zoom:.8,duration:300})},[u,l]);const h=ye.useMemo(()=>u?n(u.id):[],[u,n]),f=ye.useCallback(m=>{const x=t.find(b=>b.source===m);if(!x)return;const y=e.find(b=>b.id===x.target);return y&&Ye(y)?y:void 0},[t,e]),g=m=>{const x=e.find(p=>p.id===m);if(!x||!Xe(x))return;const y=f(m);if(!y||!gr(y.data.conditions,a))return;const N=ip(x.data.effects||{},a);c(N),s(y.id)};return d.jsxs("div",{className:"h-full flex",children:[d.jsx("div",{className:"flex-1 relative",children:d.jsxs(Bi,{nodes:e,edges:t,nodeTypes:fp,defaultEdgeOptions:hp,connectionLineType:Se.SmoothStep,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnDrag:!0,zoomOnScroll:!0,zoomOnPinch:!0,fitView:!0,children:[d.jsx(Xi,{}),d.jsx(Gi,{}),d.jsx(Fi,{gap:24,size:1})]})}),d.jsxs("div",{className:"w-[350px] bg-[#1e1e1e] border-l border-[#0a0a0a] flex flex-col",children:[d.jsxs("div",{className:"h-8 bg-[#252525] border-b border-[#0a0a0a] flex items-center px-3 justify-between",children:[d.jsx("span",{className:"text-xs text-[#999] font-medium",children:"PLAY"}),d.jsx("div",{className:"flex items-center gap-2",children:d.jsx("button",{onClick:i,className:"px-2 py-1 text-[11px] bg-[#2a2a2a] border border-[#3a3a3a] text-[#bbb] hover:bg-[#333]",children:"Restart"})})]}),d.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("div",{className:"text-[11px] text-[#777] mb-1",children:"Current Scene"}),d.jsx("div",{className:"text-sm text-[#ddd] font-semibold",children:u?u.data.label:"—"})]}),d.jsxs("div",{children:[d.jsx("div",{className:"text-[11px] text-[#777] mb-2",children:"Choices"}),d.jsxs("div",{className:"flex flex-col gap-2",children:[h.map(m=>{const x=f(m.id),y=!!x&&gr(x.data.conditions,a);return d.jsx("button",{onClick:()=>g(m.id),disabled:!y,className:`text-left px-3 py-2 text-xs border ${y?"bg-[#2a2a2a] border-[#3a3a3a] text-[#ddd] hover:bg-[#333]":"bg-[#1a1a1a] border-[#2a2a2a] text-[#666] cursor-not-allowed"}`,children:m.data.label},m.id)}),h.length===0&&d.jsx("div",{className:"text-[11px] text-[#666]",children:"No choices"})]})]})]}),d.jsxs("div",{className:"h-6 bg-[#1a1a1a] border-t border-[#0a0a0a] px-3 text-[11px] text-[#666] flex items-center justify-between",children:[d.jsxs("span",{children:[e.length," nodes • ",t.length," edges"]}),d.jsx("span",{children:u?`ID: ${u.id}`:"Ready"})]})]})]})},mp=fc([{element:d.jsx(mm,{}),children:[{path:"/",element:d.jsx(pm,{})},{path:"/video",element:d.jsx(wm,{})},{path:"/story",element:d.jsx(cp,{})},{path:"/decisions",element:d.jsx(up,{})},{path:"/variables",element:d.jsx(dp,{})},{path:"/play",element:d.jsx(gp,{})}]}]);hc.createRoot(document.getElementById("root")).render(d.jsx(ye.StrictMode,{children:d.jsx(gc,{router:mp})}));
