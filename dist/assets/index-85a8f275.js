import{r as I,j as d,u as zr,L as zc,a as Pr,O as Pc,R as fe,c as Ic,b as Ac,d as $c}from"./react-vendor-4ba9703c.js";import{c as Tc,u as Dc,s as ce,a as Ut,p as ps}from"./zustand-vendor-de806005.js";import{P as ht,U as jn,D as xs,G as ys,S as oo,F as gt,C as Vc,a as Rc,b as bs,H as so,X as ws,c as Lc,d as Hc,e as Fc,f as Bc,L as Oc,g as Xc,I as Yc,h as Wc,R as Gc}from"./lucide-vendor-60ffc5a7.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function de(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=de(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Uc={value:()=>{}};function Vn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new wn(n)}function wn(e){this._=e}function qc(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}wn.prototype=Vn.prototype={constructor:wn,on:function(e,t){var n=this._,r=qc(e+"",n),o,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((o=(e=r[s]).type)&&(o=Kc(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(o=(e=r[s]).type)n[o]=io(n[o],e.name,t);else if(t==null)for(o in n)n[o]=io(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new wn(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,s;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,o=s.length;r<o;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(t,n)}};function Kc(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function io(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Uc,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var ur="http://www.w3.org/1999/xhtml";const ao={svg:"http://www.w3.org/2000/svg",xhtml:ur,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Rn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),ao.hasOwnProperty(t)?{space:ao[t],local:e}:e}function Zc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ur&&t.documentElement.namespaceURI===ur?t.createElement(e):t.createElementNS(n,e)}}function Qc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function vs(e){var t=Rn(e);return(t.local?Qc:Zc)(t)}function Jc(){}function Ir(e){return e==null?Jc:function(){return this.querySelector(e)}}function el(e){typeof e!="function"&&(e=Ir(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=new Array(i),c,l,u=0;u<i;++u)(c=s[u])&&(l=e.call(c,c.__data__,u,s))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new ye(r,this._parents)}function tl(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function nl(){return[]}function Ns(e){return e==null?nl:function(){return this.querySelectorAll(e)}}function rl(e){return function(){return tl(e.apply(this,arguments))}}function ol(e){typeof e=="function"?e=rl(e):e=Ns(e);for(var t=this._groups,n=t.length,r=[],o=[],s=0;s<n;++s)for(var i=t[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&(r.push(e.call(c,c.__data__,l,i)),o.push(c));return new ye(r,o)}function Ss(e){return function(){return this.matches(e)}}function Cs(e){return function(t){return t.matches(e)}}var sl=Array.prototype.find;function il(e){return function(){return sl.call(this.children,e)}}function al(){return this.firstElementChild}function cl(e){return this.select(e==null?al:il(typeof e=="function"?e:Cs(e)))}var ll=Array.prototype.filter;function dl(){return Array.from(this.children)}function ul(e){return function(){return ll.call(this.children,e)}}function fl(e){return this.selectAll(e==null?dl:ul(typeof e=="function"?e:Cs(e)))}function hl(e){typeof e!="function"&&(e=Ss(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new ye(r,this._parents)}function js(e){return new Array(e.length)}function gl(){return new ye(this._enter||this._groups.map(js),this._parents)}function kn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}kn.prototype={constructor:kn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ml(e){return function(){return e}}function pl(e,t,n,r,o,s){for(var i=0,a,c=t.length,l=s.length;i<l;++i)(a=t[i])?(a.__data__=s[i],r[i]=a):n[i]=new kn(e,s[i]);for(;i<c;++i)(a=t[i])&&(o[i]=a)}function xl(e,t,n,r,o,s,i){var a,c,l=new Map,u=t.length,h=s.length,f=new Array(u),g;for(a=0;a<u;++a)(c=t[a])&&(f[a]=g=i.call(c,c.__data__,a,t)+"",l.has(g)?o[a]=c:l.set(g,c));for(a=0;a<h;++a)g=i.call(e,s[a],a,s)+"",(c=l.get(g))?(r[a]=c,c.__data__=s[a],l.delete(g)):n[a]=new kn(e,s[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(f[a])===c&&(o[a]=c)}function yl(e){return e.__data__}function bl(e,t){if(!arguments.length)return Array.from(this,yl);var n=t?xl:pl,r=this._parents,o=this._groups;typeof e!="function"&&(e=ml(e));for(var s=o.length,i=new Array(s),a=new Array(s),c=new Array(s),l=0;l<s;++l){var u=r[l],h=o[l],f=h.length,g=wl(e.call(u,u&&u.__data__,l,r)),y=g.length,p=a[l]=new Array(y),x=i[l]=new Array(y),b=c[l]=new Array(f);n(u,h,p,x,b,g,t);for(var S=0,m=0,w,C;S<y;++S)if(w=p[S]){for(S>=m&&(m=S+1);!(C=x[m])&&++m<y;);w._next=C||null}}return i=new ye(i,r),i._enter=a,i._exit=c,i}function wl(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function vl(){return new ye(this._exit||this._groups.map(js),this._parents)}function Nl(e,t,n){var r=this.enter(),o=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?s.remove():n(s),r&&o?r.merge(o).order():o}function Sl(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,s=r.length,i=Math.min(o,s),a=new Array(o),c=0;c<i;++c)for(var l=n[c],u=r[c],h=l.length,f=a[c]=new Array(h),g,y=0;y<h;++y)(g=l[y]||u[y])&&(f[y]=g);for(;c<o;++c)a[c]=n[c];return new ye(a,this._parents)}function Cl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,s=r[o],i;--o>=0;)(i=r[o])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function jl(e){e||(e=kl);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s){for(var i=n[s],a=i.length,c=o[s]=new Array(a),l,u=0;u<a;++u)(l=i[u])&&(c[u]=l);c.sort(t)}return new ye(o,this._parents).order()}function kl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function El(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function _l(){return Array.from(this)}function Ml(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length;o<s;++o){var i=r[o];if(i)return i}return null}function zl(){let e=0;for(const t of this)++e;return e}function Pl(){return!this.node()}function Il(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],s=0,i=o.length,a;s<i;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}function Al(e){return function(){this.removeAttribute(e)}}function $l(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Tl(e,t){return function(){this.setAttribute(e,t)}}function Dl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Vl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Rl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ll(e,t){var n=Rn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?$l:Al:typeof t=="function"?n.local?Rl:Vl:n.local?Dl:Tl)(n,t))}function ks(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Hl(e){return function(){this.style.removeProperty(e)}}function Fl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Bl(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ol(e,t,n){return arguments.length>1?this.each((t==null?Hl:typeof t=="function"?Bl:Fl)(e,t,n??"")):mt(this.node(),e)}function mt(e,t){return e.style.getPropertyValue(t)||ks(e).getComputedStyle(e,null).getPropertyValue(t)}function Xl(e){return function(){delete this[e]}}function Yl(e,t){return function(){this[e]=t}}function Wl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Gl(e,t){return arguments.length>1?this.each((t==null?Xl:typeof t=="function"?Wl:Yl)(e,t)):this.node()[e]}function Es(e){return e.trim().split(/^|\s+/)}function Ar(e){return e.classList||new _s(e)}function _s(e){this._node=e,this._names=Es(e.getAttribute("class")||"")}_s.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ms(e,t){for(var n=Ar(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function zs(e,t){for(var n=Ar(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Ul(e){return function(){Ms(this,e)}}function ql(e){return function(){zs(this,e)}}function Kl(e,t){return function(){(t.apply(this,arguments)?Ms:zs)(this,e)}}function Zl(e,t){var n=Es(e+"");if(arguments.length<2){for(var r=Ar(this.node()),o=-1,s=n.length;++o<s;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?Kl:t?Ul:ql)(n,t))}function Ql(){this.textContent=""}function Jl(e){return function(){this.textContent=e}}function ed(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function td(e){return arguments.length?this.each(e==null?Ql:(typeof e=="function"?ed:Jl)(e)):this.node().textContent}function nd(){this.innerHTML=""}function rd(e){return function(){this.innerHTML=e}}function od(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function sd(e){return arguments.length?this.each(e==null?nd:(typeof e=="function"?od:rd)(e)):this.node().innerHTML}function id(){this.nextSibling&&this.parentNode.appendChild(this)}function ad(){return this.each(id)}function cd(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ld(){return this.each(cd)}function dd(e){var t=typeof e=="function"?e:vs(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function ud(){return null}function fd(e,t){var n=typeof e=="function"?e:vs(e),r=t==null?ud:typeof t=="function"?t:Ir(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function hd(){var e=this.parentNode;e&&e.removeChild(this)}function gd(){return this.each(hd)}function md(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function pd(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xd(e){return this.select(e?pd:md)}function yd(e){return arguments.length?this.property("__data__",e):this.node().__data__}function bd(e){return function(t){e.call(this,t,this.__data__)}}function wd(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function vd(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,s;n<o;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function Nd(e,t,n){return function(){var r=this.__on,o,s=bd(t);if(r){for(var i=0,a=r.length;i<a;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=t;return}}this.addEventListener(e.type,s,n),o={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(o):this.__on=[o]}}function Sd(e,t,n){var r=wd(e+""),o,s=r.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(o=0,u=a[c];o<s;++o)if((i=r[o]).type===u.type&&i.name===u.name)return u.value}return}for(a=t?Nd:vd,o=0;o<s;++o)this.each(a(r[o],t,n));return this}function Ps(e,t,n){var r=ks(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Cd(e,t){return function(){return Ps(this,e,t)}}function jd(e,t){return function(){return Ps(this,e,t.apply(this,arguments))}}function kd(e,t){return this.each((typeof t=="function"?jd:Cd)(e,t))}function*Ed(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length,i;o<s;++o)(i=r[o])&&(yield i)}var Is=[null];function ye(e,t){this._groups=e,this._parents=t}function qt(){return new ye([[document.documentElement]],Is)}function _d(){return this}ye.prototype=qt.prototype={constructor:ye,select:el,selectAll:ol,selectChild:cl,selectChildren:fl,filter:hl,data:bl,enter:gl,exit:vl,join:Nl,merge:Sl,selection:_d,order:Cl,sort:jl,call:El,nodes:_l,node:Ml,size:zl,empty:Pl,each:Il,attr:Ll,style:Ol,property:Gl,classed:Zl,text:td,html:sd,raise:ad,lower:ld,append:dd,insert:fd,remove:gd,clone:xd,datum:yd,on:Sd,dispatch:kd,[Symbol.iterator]:Ed};function pe(e){return typeof e=="string"?new ye([[document.querySelector(e)]],[document.documentElement]):new ye([[e]],Is)}function Md(e){let t;for(;t=e.sourceEvent;)e=t;return e}function we(e,t){if(e=Md(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const zd={passive:!1},Vt={capture:!0,passive:!1};function er(e){e.stopImmediatePropagation()}function ut(e){e.preventDefault(),e.stopImmediatePropagation()}function As(e){var t=e.document.documentElement,n=pe(e).on("dragstart.drag",ut,Vt);"onselectstart"in t?n.on("selectstart.drag",ut,Vt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function $s(e,t){var n=e.document.documentElement,r=pe(e).on("dragstart.drag",null);t&&(r.on("click.drag",ut,Vt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const an=e=>()=>e;function fr(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:s,x:i,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}fr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Pd(e){return!e.ctrlKey&&!e.button}function Id(){return this.parentNode}function Ad(e,t){return t??{x:e.x,y:e.y}}function $d(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ts(){var e=Pd,t=Id,n=Ad,r=$d,o={},s=Vn("start","drag","end"),i=0,a,c,l,u,h=0;function f(w){w.on("mousedown.drag",g).filter(r).on("touchstart.drag",x).on("touchmove.drag",b,zd).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(w,C){if(!(u||!e.call(this,w,C))){var N=m(this,t.call(this,w,C),w,C,"mouse");N&&(pe(w.view).on("mousemove.drag",y,Vt).on("mouseup.drag",p,Vt),As(w.view),er(w),l=!1,a=w.clientX,c=w.clientY,N("start",w))}}function y(w){if(ut(w),!l){var C=w.clientX-a,N=w.clientY-c;l=C*C+N*N>h}o.mouse("drag",w)}function p(w){pe(w.view).on("mousemove.drag mouseup.drag",null),$s(w.view,l),ut(w),o.mouse("end",w)}function x(w,C){if(e.call(this,w,C)){var N=w.changedTouches,M=t.call(this,w,C),k=N.length,A,H;for(A=0;A<k;++A)(H=m(this,M,w,C,N[A].identifier,N[A]))&&(er(w),H("start",w,N[A]))}}function b(w){var C=w.changedTouches,N=C.length,M,k;for(M=0;M<N;++M)(k=o[C[M].identifier])&&(ut(w),k("drag",w,C[M]))}function S(w){var C=w.changedTouches,N=C.length,M,k;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),M=0;M<N;++M)(k=o[C[M].identifier])&&(er(w),k("end",w,C[M]))}function m(w,C,N,M,k,A){var H=s.copy(),R=we(A||N,C),$,D,v;if((v=n.call(w,new fr("beforestart",{sourceEvent:N,target:f,identifier:k,active:i,x:R[0],y:R[1],dx:0,dy:0,dispatch:H}),M))!=null)return $=v.x-R[0]||0,D=v.y-R[1]||0,function P(j,E,_){var z=R,T;switch(j){case"start":o[k]=P,T=i++;break;case"end":delete o[k],--i;case"drag":R=we(_||E,C),T=i;break}H.call(j,w,new fr(j,{sourceEvent:E,subject:v,target:f,identifier:k,active:T,x:R[0]+$,y:R[1]+D,dx:R[0]-z[0],dy:R[1]-z[1],dispatch:H}),M)}}return f.filter=function(w){return arguments.length?(e=typeof w=="function"?w:an(!!w),f):e},f.container=function(w){return arguments.length?(t=typeof w=="function"?w:an(w),f):t},f.subject=function(w){return arguments.length?(n=typeof w=="function"?w:an(w),f):n},f.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:an(!!w),f):r},f.on=function(){var w=s.on.apply(s,arguments);return w===s?f:w},f.clickDistance=function(w){return arguments.length?(h=(w=+w)*w,f):Math.sqrt(h)},f}function $r(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ds(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Kt(){}var Rt=.7,En=1/Rt,ft="\\s*([+-]?\\d+)\\s*",Lt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_e="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Td=/^#([0-9a-f]{3,8})$/,Dd=new RegExp(`^rgb\\(${ft},${ft},${ft}\\)$`),Vd=new RegExp(`^rgb\\(${_e},${_e},${_e}\\)$`),Rd=new RegExp(`^rgba\\(${ft},${ft},${ft},${Lt}\\)$`),Ld=new RegExp(`^rgba\\(${_e},${_e},${_e},${Lt}\\)$`),Hd=new RegExp(`^hsl\\(${Lt},${_e},${_e}\\)$`),Fd=new RegExp(`^hsla\\(${Lt},${_e},${_e},${Lt}\\)$`),co={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$r(Kt,Je,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lo,formatHex:lo,formatHex8:Bd,formatHsl:Od,formatRgb:uo,toString:uo});function lo(){return this.rgb().formatHex()}function Bd(){return this.rgb().formatHex8()}function Od(){return Vs(this).formatHsl()}function uo(){return this.rgb().formatRgb()}function Je(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Td.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?fo(t):n===3?new ge(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?cn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?cn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Dd.exec(e))?new ge(t[1],t[2],t[3],1):(t=Vd.exec(e))?new ge(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Rd.exec(e))?cn(t[1],t[2],t[3],t[4]):(t=Ld.exec(e))?cn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Hd.exec(e))?mo(t[1],t[2]/100,t[3]/100,1):(t=Fd.exec(e))?mo(t[1],t[2]/100,t[3]/100,t[4]):co.hasOwnProperty(e)?fo(co[e]):e==="transparent"?new ge(NaN,NaN,NaN,0):null}function fo(e){return new ge(e>>16&255,e>>8&255,e&255,1)}function cn(e,t,n,r){return r<=0&&(e=t=n=NaN),new ge(e,t,n,r)}function Xd(e){return e instanceof Kt||(e=Je(e)),e?(e=e.rgb(),new ge(e.r,e.g,e.b,e.opacity)):new ge}function hr(e,t,n,r){return arguments.length===1?Xd(e):new ge(e,t,n,r??1)}function ge(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}$r(ge,hr,Ds(Kt,{brighter(e){return e=e==null?En:Math.pow(En,e),new ge(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Rt:Math.pow(Rt,e),new ge(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ge(qe(this.r),qe(this.g),qe(this.b),_n(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ho,formatHex:ho,formatHex8:Yd,formatRgb:go,toString:go}));function ho(){return`#${Ue(this.r)}${Ue(this.g)}${Ue(this.b)}`}function Yd(){return`#${Ue(this.r)}${Ue(this.g)}${Ue(this.b)}${Ue((isNaN(this.opacity)?1:this.opacity)*255)}`}function go(){const e=_n(this.opacity);return`${e===1?"rgb(":"rgba("}${qe(this.r)}, ${qe(this.g)}, ${qe(this.b)}${e===1?")":`, ${e})`}`}function _n(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ue(e){return e=qe(e),(e<16?"0":"")+e.toString(16)}function mo(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ve(e,t,n,r)}function Vs(e){if(e instanceof ve)return new ve(e.h,e.s,e.l,e.opacity);if(e instanceof Kt||(e=Je(e)),!e)return new ve;if(e instanceof ve)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),s=Math.max(t,n,r),i=NaN,a=s-o,c=(s+o)/2;return a?(t===s?i=(n-r)/a+(n<r)*6:n===s?i=(r-t)/a+2:i=(t-n)/a+4,a/=c<.5?s+o:2-s-o,i*=60):a=c>0&&c<1?0:i,new ve(i,a,c,e.opacity)}function Wd(e,t,n,r){return arguments.length===1?Vs(e):new ve(e,t,n,r??1)}function ve(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}$r(ve,Wd,Ds(Kt,{brighter(e){return e=e==null?En:Math.pow(En,e),new ve(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Rt:Math.pow(Rt,e),new ve(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new ge(tr(e>=240?e-240:e+120,o,r),tr(e,o,r),tr(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new ve(po(this.h),ln(this.s),ln(this.l),_n(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=_n(this.opacity);return`${e===1?"hsl(":"hsla("}${po(this.h)}, ${ln(this.s)*100}%, ${ln(this.l)*100}%${e===1?")":`, ${e})`}`}}));function po(e){return e=(e||0)%360,e<0?e+360:e}function ln(e){return Math.max(0,Math.min(1,e||0))}function tr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Tr=e=>()=>e;function Gd(e,t){return function(n){return e+n*t}}function Ud(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function qd(e){return(e=+e)==1?Rs:function(t,n){return n-t?Ud(t,n,e):Tr(isNaN(t)?n:t)}}function Rs(e,t){var n=t-e;return n?Gd(e,n):Tr(isNaN(e)?t:e)}const Mn=function e(t){var n=qd(t);function r(o,s){var i=n((o=hr(o)).r,(s=hr(s)).r),a=n(o.g,s.g),c=n(o.b,s.b),l=Rs(o.opacity,s.opacity);return function(u){return o.r=i(u),o.g=a(u),o.b=c(u),o.opacity=l(u),o+""}}return r.gamma=e,r}(1);function Kd(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),o;return function(s){for(o=0;o<n;++o)r[o]=e[o]*(1-s)+t[o]*s;return r}}function Zd(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Qd(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,o=new Array(r),s=new Array(n),i;for(i=0;i<r;++i)o[i]=Tt(e[i],t[i]);for(;i<n;++i)s[i]=t[i];return function(a){for(i=0;i<r;++i)s[i]=o[i](a);return s}}function Jd(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function je(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function eu(e,t){var n={},r={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?n[o]=Tt(e[o],t[o]):r[o]=t[o];return function(s){for(o in n)r[o]=n[o](s);return r}}var gr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nr=new RegExp(gr.source,"g");function tu(e){return function(){return e}}function nu(e){return function(t){return e(t)+""}}function Ls(e,t){var n=gr.lastIndex=nr.lastIndex=0,r,o,s,i=-1,a=[],c=[];for(e=e+"",t=t+"";(r=gr.exec(e))&&(o=nr.exec(t));)(s=o.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(r=r[0])===(o=o[0])?a[i]?a[i]+=o:a[++i]=o:(a[++i]=null,c.push({i,x:je(r,o)})),n=nr.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?c[0]?nu(c[0].x):tu(t):(t=c.length,function(l){for(var u=0,h;u<t;++u)a[(h=c[u]).i]=h.x(l);return a.join("")})}function Tt(e,t){var n=typeof t,r;return t==null||n==="boolean"?Tr(t):(n==="number"?je:n==="string"?(r=Je(t))?(t=r,Mn):Ls:t instanceof Je?Mn:t instanceof Date?Jd:Zd(t)?Kd:Array.isArray(t)?Qd:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?eu:je)(e,t)}var xo=180/Math.PI,mr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hs(e,t,n,r,o,s){var i,a,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*xo,skewX:Math.atan(c)*xo,scaleX:i,scaleY:a}}var dn;function ru(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?mr:Hs(t.a,t.b,t.c,t.d,t.e,t.f)}function ou(e){return e==null||(dn||(dn=document.createElementNS("http://www.w3.org/2000/svg","g")),dn.setAttribute("transform",e),!(e=dn.transform.baseVal.consolidate()))?mr:(e=e.matrix,Hs(e.a,e.b,e.c,e.d,e.e,e.f))}function Fs(e,t,n,r){function o(l){return l.length?l.pop()+" ":""}function s(l,u,h,f,g,y){if(l!==h||u!==f){var p=g.push("translate(",null,t,null,n);y.push({i:p-4,x:je(l,h)},{i:p-2,x:je(u,f)})}else(h||f)&&g.push("translate("+h+t+f+n)}function i(l,u,h,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:h.push(o(h)+"rotate(",null,r)-2,x:je(l,u)})):u&&h.push(o(h)+"rotate("+u+r)}function a(l,u,h,f){l!==u?f.push({i:h.push(o(h)+"skewX(",null,r)-2,x:je(l,u)}):u&&h.push(o(h)+"skewX("+u+r)}function c(l,u,h,f,g,y){if(l!==h||u!==f){var p=g.push(o(g)+"scale(",null,",",null,")");y.push({i:p-4,x:je(l,h)},{i:p-2,x:je(u,f)})}else(h!==1||f!==1)&&g.push(o(g)+"scale("+h+","+f+")")}return function(l,u){var h=[],f=[];return l=e(l),u=e(u),s(l.translateX,l.translateY,u.translateX,u.translateY,h,f),i(l.rotate,u.rotate,h,f),a(l.skewX,u.skewX,h,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,h,f),l=u=null,function(g){for(var y=-1,p=f.length,x;++y<p;)h[(x=f[y]).i]=x.x(g);return h.join("")}}}var su=Fs(ru,"px, ","px)","deg)"),iu=Fs(ou,", ",")",")"),au=1e-12;function yo(e){return((e=Math.exp(e))+1/e)/2}function cu(e){return((e=Math.exp(e))-1/e)/2}function lu(e){return((e=Math.exp(2*e))-1)/(e+1)}const vn=function e(t,n,r){function o(s,i){var a=s[0],c=s[1],l=s[2],u=i[0],h=i[1],f=i[2],g=u-a,y=h-c,p=g*g+y*y,x,b;if(p<au)b=Math.log(f/l)/t,x=function(M){return[a+M*g,c+M*y,l*Math.exp(t*M*b)]};else{var S=Math.sqrt(p),m=(f*f-l*l+r*p)/(2*l*n*S),w=(f*f-l*l-r*p)/(2*f*n*S),C=Math.log(Math.sqrt(m*m+1)-m),N=Math.log(Math.sqrt(w*w+1)-w);b=(N-C)/t,x=function(M){var k=M*b,A=yo(C),H=l/(n*S)*(A*lu(t*k+C)-cu(C));return[a+H*g,c+H*y,l*A/yo(t*k+C)]}}return x.duration=b*1e3*t/Math.SQRT2,x}return o.rho=function(s){var i=Math.max(.001,+s),a=i*i,c=a*a;return e(i,a,c)},o}(Math.SQRT2,2,4);var pt=0,It=0,Mt=0,Bs=1e3,zn,At,Pn=0,et=0,Ln=0,Ht=typeof performance=="object"&&performance.now?performance:Date,Os=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Dr(){return et||(Os(du),et=Ht.now()+Ln)}function du(){et=0}function In(){this._call=this._time=this._next=null}In.prototype=Xs.prototype={constructor:In,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Dr():+n)+(t==null?0:+t),!this._next&&At!==this&&(At?At._next=this:zn=this,At=this),this._call=e,this._time=n,pr()},stop:function(){this._call&&(this._call=null,this._time=1/0,pr())}};function Xs(e,t,n){var r=new In;return r.restart(e,t,n),r}function uu(){Dr(),++pt;for(var e=zn,t;e;)(t=et-e._time)>=0&&e._call.call(void 0,t),e=e._next;--pt}function bo(){et=(Pn=Ht.now())+Ln,pt=It=0;try{uu()}finally{pt=0,hu(),et=0}}function fu(){var e=Ht.now(),t=e-Pn;t>Bs&&(Ln-=t,Pn=e)}function hu(){for(var e,t=zn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:zn=n);At=e,pr(r)}function pr(e){if(!pt){It&&(It=clearTimeout(It));var t=e-et;t>24?(e<1/0&&(It=setTimeout(bo,e-Ht.now()-Ln)),Mt&&(Mt=clearInterval(Mt))):(Mt||(Pn=Ht.now(),Mt=setInterval(fu,Bs)),pt=1,Os(bo))}}function wo(e,t,n){var r=new In;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var gu=Vn("start","end","cancel","interrupt"),mu=[],Ys=0,vo=1,xr=2,Nn=3,No=4,yr=5,Sn=6;function Hn(e,t,n,r,o,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;pu(e,n,{name:t,index:r,group:o,on:gu,tween:mu,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Ys})}function Vr(e,t){var n=Ce(e,t);if(n.state>Ys)throw new Error("too late; already scheduled");return n}function ze(e,t){var n=Ce(e,t);if(n.state>Nn)throw new Error("too late; already running");return n}function Ce(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function pu(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=Xs(s,0,n.time);function s(l){n.state=vo,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var u,h,f,g;if(n.state!==vo)return c();for(u in r)if(g=r[u],g.name===n.name){if(g.state===Nn)return wo(i);g.state===No?(g.state=Sn,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[u]):+u<t&&(g.state=Sn,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[u])}if(wo(function(){n.state===Nn&&(n.state=No,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=xr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===xr){for(n.state=Nn,o=new Array(f=n.tween.length),u=0,h=-1;u<f;++u)(g=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(o[++h]=g);o.length=h+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=yr,1),h=-1,f=o.length;++h<f;)o[h].call(e,u);n.state===yr&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Sn,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function Cn(e,t){var n=e.__transition,r,o,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){s=!1;continue}o=r.state>xr&&r.state<yr,r.state=Sn,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}s&&delete e.__transition}}function xu(e){return this.each(function(){Cn(this,e)})}function yu(e,t){var n,r;return function(){var o=ze(this,e),s=o.tween;if(s!==n){r=n=s;for(var i=0,a=r.length;i<a;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function bu(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var s=ze(this,e),i=s.tween;if(i!==r){o=(r=i).slice();for(var a={name:t,value:n},c=0,l=o.length;c<l;++c)if(o[c].name===t){o[c]=a;break}c===l&&o.push(a)}s.tween=o}}function wu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ce(this.node(),n).tween,o=0,s=r.length,i;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?yu:bu)(n,e,t))}function Rr(e,t,n){var r=e._id;return e.each(function(){var o=ze(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Ce(o,r).value[t]}}function Ws(e,t){var n;return(typeof t=="number"?je:t instanceof Je?Mn:(n=Je(t))?(t=n,Mn):Ls)(e,t)}function vu(e){return function(){this.removeAttribute(e)}}function Nu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Su(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttribute(e);return i===o?null:i===r?s:s=t(r=i,n)}}function Cu(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?s:s=t(r=i,n)}}function ju(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function ku(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function Eu(e,t){var n=Rn(e),r=n==="transform"?iu:Ws;return this.attrTween(e,typeof t=="function"?(n.local?ku:ju)(n,r,Rr(this,"attr."+e,t)):t==null?(n.local?Nu:vu)(n):(n.local?Cu:Su)(n,r,t))}function _u(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Mu(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function zu(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Mu(e,s)),n}return o._value=t,o}function Pu(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&_u(e,s)),n}return o._value=t,o}function Iu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Rn(e);return this.tween(n,(r.local?zu:Pu)(r,t))}function Au(e,t){return function(){Vr(this,e).delay=+t.apply(this,arguments)}}function $u(e,t){return t=+t,function(){Vr(this,e).delay=t}}function Tu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Au:$u)(t,e)):Ce(this.node(),t).delay}function Du(e,t){return function(){ze(this,e).duration=+t.apply(this,arguments)}}function Vu(e,t){return t=+t,function(){ze(this,e).duration=t}}function Ru(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Du:Vu)(t,e)):Ce(this.node(),t).duration}function Lu(e,t){if(typeof t!="function")throw new Error;return function(){ze(this,e).ease=t}}function Hu(e){var t=this._id;return arguments.length?this.each(Lu(t,e)):Ce(this.node(),t).ease}function Fu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ze(this,e).ease=n}}function Bu(e){if(typeof e!="function")throw new Error;return this.each(Fu(this._id,e))}function Ou(e){typeof e!="function"&&(e=Ss(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new De(r,this._parents,this._name,this._id)}function Xu(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,s=Math.min(r,o),i=new Array(r),a=0;a<s;++a)for(var c=t[a],l=n[a],u=c.length,h=i[a]=new Array(u),f,g=0;g<u;++g)(f=c[g]||l[g])&&(h[g]=f);for(;a<r;++a)i[a]=t[a];return new De(i,this._parents,this._name,this._id)}function Yu(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Wu(e,t,n){var r,o,s=Yu(t)?Vr:ze;return function(){var i=s(this,e),a=i.on;a!==r&&(o=(r=a).copy()).on(t,n),i.on=o}}function Gu(e,t){var n=this._id;return arguments.length<2?Ce(this.node(),n).on.on(e):this.each(Wu(n,e,t))}function Uu(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function qu(){return this.on("end.remove",Uu(this._id))}function Ku(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ir(e));for(var r=this._groups,o=r.length,s=new Array(o),i=0;i<o;++i)for(var a=r[i],c=a.length,l=s[i]=new Array(c),u,h,f=0;f<c;++f)(u=a[f])&&(h=e.call(u,u.__data__,f,a))&&("__data__"in u&&(h.__data__=u.__data__),l[f]=h,Hn(l[f],t,n,f,l,Ce(u,n)));return new De(s,this._parents,t,n)}function Zu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ns(e));for(var r=this._groups,o=r.length,s=[],i=[],a=0;a<o;++a)for(var c=r[a],l=c.length,u,h=0;h<l;++h)if(u=c[h]){for(var f=e.call(u,u.__data__,h,c),g,y=Ce(u,n),p=0,x=f.length;p<x;++p)(g=f[p])&&Hn(g,t,n,p,f,y);s.push(f),i.push(u)}return new De(s,i,t,n)}var Qu=qt.prototype.constructor;function Ju(){return new Qu(this._groups,this._parents)}function ef(e,t){var n,r,o;return function(){var s=mt(this,e),i=(this.style.removeProperty(e),mt(this,e));return s===i?null:s===n&&i===r?o:o=t(n=s,r=i)}}function Gs(e){return function(){this.style.removeProperty(e)}}function tf(e,t,n){var r,o=n+"",s;return function(){var i=mt(this,e);return i===o?null:i===r?s:s=t(r=i,n)}}function nf(e,t,n){var r,o,s;return function(){var i=mt(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),mt(this,e))),i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a))}}function rf(e,t){var n,r,o,s="style."+t,i="end."+s,a;return function(){var c=ze(this,e),l=c.on,u=c.value[s]==null?a||(a=Gs(t)):void 0;(l!==n||o!==u)&&(r=(n=l).copy()).on(i,o=u),c.on=r}}function of(e,t,n){var r=(e+="")=="transform"?su:Ws;return t==null?this.styleTween(e,ef(e,r)).on("end.style."+e,Gs(e)):typeof t=="function"?this.styleTween(e,nf(e,r,Rr(this,"style."+e,t))).each(rf(this._id,e)):this.styleTween(e,tf(e,r,t),n).on("end.style."+e,null)}function sf(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function af(e,t,n){var r,o;function s(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&sf(e,i,n)),r}return s._value=t,s}function cf(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,af(e,t,n??""))}function lf(e){return function(){this.textContent=e}}function df(e){return function(){var t=e(this);this.textContent=t??""}}function uf(e){return this.tween("text",typeof e=="function"?df(Rr(this,"text",e)):lf(e==null?"":e+""))}function ff(e){return function(t){this.textContent=e.call(this,t)}}function hf(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&ff(o)),t}return r._value=e,r}function gf(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,hf(e))}function mf(){for(var e=this._name,t=this._id,n=Us(),r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,l=0;l<a;++l)if(c=i[l]){var u=Ce(c,t);Hn(c,e,n,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new De(r,this._parents,e,n)}function pf(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(s,i){var a={value:i},c={value:function(){--o===0&&s()}};n.each(function(){var l=ze(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),o===0&&s()})}var xf=0;function De(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Us(){return++xf}var Pe=qt.prototype;De.prototype={constructor:De,select:Ku,selectAll:Zu,selectChild:Pe.selectChild,selectChildren:Pe.selectChildren,filter:Ou,merge:Xu,selection:Ju,transition:mf,call:Pe.call,nodes:Pe.nodes,node:Pe.node,size:Pe.size,empty:Pe.empty,each:Pe.each,on:Gu,attr:Eu,attrTween:Iu,style:of,styleTween:cf,text:uf,textTween:gf,remove:qu,tween:wu,delay:Tu,duration:Ru,ease:Hu,easeVarying:Bu,end:pf,[Symbol.iterator]:Pe[Symbol.iterator]};function yf(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var bf={time:null,delay:0,duration:250,ease:yf};function wf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function vf(e){var t,n;e instanceof De?(t=e._id,e=e._name):(t=Us(),(n=bf).time=Dr(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&Hn(c,e,t,l,i,n||wf(c,t));return new De(r,this._parents,e,t)}qt.prototype.interrupt=xu;qt.prototype.transition=vf;const un=e=>()=>e;function Nf(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ae(e,t,n){this.k=e,this.x=t,this.y=n}Ae.prototype={constructor:Ae,scale:function(e){return e===1?this:new Ae(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ae(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Fn=new Ae(1,0,0);qs.prototype=Ae.prototype;function qs(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Fn;return e.__zoom}function rr(e){e.stopImmediatePropagation()}function zt(e){e.preventDefault(),e.stopImmediatePropagation()}function Sf(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Cf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function So(){return this.__zoom||Fn}function jf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function kf(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ef(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function Ks(){var e=Sf,t=Cf,n=Ef,r=jf,o=kf,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=vn,l=Vn("start","zoom","end"),u,h,f,g=500,y=150,p=0,x=10;function b(v){v.property("__zoom",So).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",H).filter(o).on("touchstart.zoom",R).on("touchmove.zoom",$).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(v,P,j,E){var _=v.selection?v.selection():v;_.property("__zoom",So),v!==_?C(v,P,j,E):_.interrupt().each(function(){N(this,arguments).event(E).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},b.scaleBy=function(v,P,j,E){b.scaleTo(v,function(){var _=this.__zoom.k,z=typeof P=="function"?P.apply(this,arguments):P;return _*z},j,E)},b.scaleTo=function(v,P,j,E){b.transform(v,function(){var _=t.apply(this,arguments),z=this.__zoom,T=j==null?w(_):typeof j=="function"?j.apply(this,arguments):j,V=z.invert(T),L=typeof P=="function"?P.apply(this,arguments):P;return n(m(S(z,L),T,V),_,i)},j,E)},b.translateBy=function(v,P,j,E){b.transform(v,function(){return n(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof j=="function"?j.apply(this,arguments):j),t.apply(this,arguments),i)},null,E)},b.translateTo=function(v,P,j,E,_){b.transform(v,function(){var z=t.apply(this,arguments),T=this.__zoom,V=E==null?w(z):typeof E=="function"?E.apply(this,arguments):E;return n(Fn.translate(V[0],V[1]).scale(T.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof j=="function"?-j.apply(this,arguments):-j),z,i)},E,_)};function S(v,P){return P=Math.max(s[0],Math.min(s[1],P)),P===v.k?v:new Ae(P,v.x,v.y)}function m(v,P,j){var E=P[0]-j[0]*v.k,_=P[1]-j[1]*v.k;return E===v.x&&_===v.y?v:new Ae(v.k,E,_)}function w(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function C(v,P,j,E){v.on("start.zoom",function(){N(this,arguments).event(E).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(E).end()}).tween("zoom",function(){var _=this,z=arguments,T=N(_,z).event(E),V=t.apply(_,z),L=j==null?w(V):typeof j=="function"?j.apply(_,z):j,O=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),B=_.__zoom,q=typeof P=="function"?P.apply(_,z):P,Z=c(B.invert(L).concat(O/B.k),q.invert(L).concat(O/q.k));return function(X){if(X===1)X=q;else{var F=Z(X),U=O/F[2];X=new Ae(U,L[0]-F[0]*U,L[1]-F[1]*U)}T.zoom(null,X)}})}function N(v,P,j){return!j&&v.__zooming||new M(v,P)}function M(v,P){this.that=v,this.args=P,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,P),this.taps=0}M.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,P){return this.mouse&&v!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var P=pe(this.that).datum();l.call(v,this.that,new Nf(v,{sourceEvent:this.sourceEvent,target:b,type:v,transform:this.that.__zoom,dispatch:l}),P)}};function k(v,...P){if(!e.apply(this,arguments))return;var j=N(this,P).event(v),E=this.__zoom,_=Math.max(s[0],Math.min(s[1],E.k*Math.pow(2,r.apply(this,arguments)))),z=we(v);if(j.wheel)(j.mouse[0][0]!==z[0]||j.mouse[0][1]!==z[1])&&(j.mouse[1]=E.invert(j.mouse[0]=z)),clearTimeout(j.wheel);else{if(E.k===_)return;j.mouse=[z,E.invert(z)],Cn(this),j.start()}zt(v),j.wheel=setTimeout(T,y),j.zoom("mouse",n(m(S(E,_),j.mouse[0],j.mouse[1]),j.extent,i));function T(){j.wheel=null,j.end()}}function A(v,...P){if(f||!e.apply(this,arguments))return;var j=v.currentTarget,E=N(this,P,!0).event(v),_=pe(v.view).on("mousemove.zoom",L,!0).on("mouseup.zoom",O,!0),z=we(v,j),T=v.clientX,V=v.clientY;As(v.view),rr(v),E.mouse=[z,this.__zoom.invert(z)],Cn(this),E.start();function L(B){if(zt(B),!E.moved){var q=B.clientX-T,Z=B.clientY-V;E.moved=q*q+Z*Z>p}E.event(B).zoom("mouse",n(m(E.that.__zoom,E.mouse[0]=we(B,j),E.mouse[1]),E.extent,i))}function O(B){_.on("mousemove.zoom mouseup.zoom",null),$s(B.view,E.moved),zt(B),E.event(B).end()}}function H(v,...P){if(e.apply(this,arguments)){var j=this.__zoom,E=we(v.changedTouches?v.changedTouches[0]:v,this),_=j.invert(E),z=j.k*(v.shiftKey?.5:2),T=n(m(S(j,z),E,_),t.apply(this,P),i);zt(v),a>0?pe(this).transition().duration(a).call(C,T,E,v):pe(this).call(b.transform,T,E,v)}}function R(v,...P){if(e.apply(this,arguments)){var j=v.touches,E=j.length,_=N(this,P,v.changedTouches.length===E).event(v),z,T,V,L;for(rr(v),T=0;T<E;++T)V=j[T],L=we(V,this),L=[L,this.__zoom.invert(L),V.identifier],_.touch0?!_.touch1&&_.touch0[2]!==L[2]&&(_.touch1=L,_.taps=0):(_.touch0=L,z=!0,_.taps=1+!!u);u&&(u=clearTimeout(u)),z&&(_.taps<2&&(h=L[0],u=setTimeout(function(){u=null},g)),Cn(this),_.start())}}function $(v,...P){if(this.__zooming){var j=N(this,P).event(v),E=v.changedTouches,_=E.length,z,T,V,L;for(zt(v),z=0;z<_;++z)T=E[z],V=we(T,this),j.touch0&&j.touch0[2]===T.identifier?j.touch0[0]=V:j.touch1&&j.touch1[2]===T.identifier&&(j.touch1[0]=V);if(T=j.that.__zoom,j.touch1){var O=j.touch0[0],B=j.touch0[1],q=j.touch1[0],Z=j.touch1[1],X=(X=q[0]-O[0])*X+(X=q[1]-O[1])*X,F=(F=Z[0]-B[0])*F+(F=Z[1]-B[1])*F;T=S(T,Math.sqrt(X/F)),V=[(O[0]+q[0])/2,(O[1]+q[1])/2],L=[(B[0]+Z[0])/2,(B[1]+Z[1])/2]}else if(j.touch0)V=j.touch0[0],L=j.touch0[1];else return;j.zoom("touch",n(m(T,V,L),j.extent,i))}}function D(v,...P){if(this.__zooming){var j=N(this,P).event(v),E=v.changedTouches,_=E.length,z,T;for(rr(v),f&&clearTimeout(f),f=setTimeout(function(){f=null},g),z=0;z<_;++z)T=E[z],j.touch0&&j.touch0[2]===T.identifier?delete j.touch0:j.touch1&&j.touch1[2]===T.identifier&&delete j.touch1;if(j.touch1&&!j.touch0&&(j.touch0=j.touch1,delete j.touch1),j.touch0)j.touch0[1]=this.__zoom.invert(j.touch0[0]);else if(j.end(),j.taps===2&&(T=we(T,this),Math.hypot(h[0]-T[0],h[1]-T[1])<x)){var V=pe(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return b.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:un(+v),b):r},b.filter=function(v){return arguments.length?(e=typeof v=="function"?v:un(!!v),b):e},b.touchable=function(v){return arguments.length?(o=typeof v=="function"?v:un(!!v),b):o},b.extent=function(v){return arguments.length?(t=typeof v=="function"?v:un([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),b):t},b.scaleExtent=function(v){return arguments.length?(s[0]=+v[0],s[1]=+v[1],b):[s[0],s[1]]},b.translateExtent=function(v){return arguments.length?(i[0][0]=+v[0][0],i[1][0]=+v[1][0],i[0][1]=+v[0][1],i[1][1]=+v[1][1],b):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},b.constrain=function(v){return arguments.length?(n=v,b):n},b.duration=function(v){return arguments.length?(a=+v,b):a},b.interpolate=function(v){return arguments.length?(c=v,b):c},b.on=function(){var v=l.on.apply(l,arguments);return v===l?b:v},b.clickDistance=function(v){return arguments.length?(p=(v=+v)*v,b):Math.sqrt(p)},b.tapDistance=function(v){return arguments.length?(x=+v,b):x},b}const Me={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Ft=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Zs=["Enter"," ","Escape"],Qs={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var xt;(function(e){e.Strict="strict",e.Loose="loose"})(xt||(xt={}));var Ke;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ke||(Ke={}));var Bt;(function(e){e.Partial="partial",e.Full="full"})(Bt||(Bt={}));const Js={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ke;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ke||(ke={}));var yt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(yt||(yt={}));var G;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(G||(G={}));const Co={[G.Left]:G.Right,[G.Right]:G.Left,[G.Top]:G.Bottom,[G.Bottom]:G.Top};function ei(e){return e===null?null:e?"valid":"invalid"}const ti=e=>"id"in e&&"source"in e&&"target"in e,_f=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Lr=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Zt=(e,t=[0,0])=>{const{width:n,height:r}=Ve(e),o=e.origin??t,s=n*o[0],i=r*o[1];return{x:e.position.x-s,y:e.position.y-i}},Mf=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const s=typeof o=="string";let i=!t.nodeLookup&&!s?o:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(o):Lr(o)?o:t.nodeLookup.get(o.id));const a=i?An(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Bn(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return On(n)},Qt=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=An(r);n=Bn(n,o)}}),On(n)},Hr=(e,t,[n,r,o]=[0,0,1],s=!1,i=!1)=>{const a={...en(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:u,selectable:h=!0,hidden:f=!1}=l;if(i&&!h||f)continue;const g=u.width??l.width??l.initialWidth??null,y=u.height??l.height??l.initialHeight??null,p=Ot(a,wt(l)),x=(g??0)*(y??0),b=s&&p>0;(!l.internals.handleBounds||b||p>=x||l.dragging)&&c.push(l)}return c},zf=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Pf(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function If({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=Pf(e,i),c=Qt(a),l=Fr(c,t,n,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await r.setViewport(l,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function ni({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},u=i.origin??r;let h=i.extent||o;if(i.extent==="parent"&&!i.expandParent)if(!a)s==null||s("005",Me.error005());else{const g=a.measured.width,y=a.measured.height;g&&y&&(h=[[c,l],[c+g,l+y]])}else a&&vt(i.extent)&&(h=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const f=vt(h)?tt(t,h,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",Me.error015())),{position:{x:f.x-c+(i.measured.width??0)*u[0],y:f.y-l+(i.measured.height??0)*u[1]},positionAbsolute:f}}async function Af({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const s=new Set(e.map(f=>f.id)),i=[];for(const f of n){if(f.deletable===!1)continue;const g=s.has(f.id),y=!g&&f.parentId&&i.find(p=>p.id===f.parentId);(g||y)&&i.push(f)}const a=new Set(t.map(f=>f.id)),c=r.filter(f=>f.deletable!==!1),u=zf(i,c);for(const f of c)a.has(f.id)&&!u.find(y=>y.id===f.id)&&u.push(f);if(!o)return{edges:u,nodes:i};const h=await o({nodes:i,edges:u});return typeof h=="boolean"?h?{edges:u,nodes:i}:{edges:[],nodes:[]}:h}const bt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),tt=(e={x:0,y:0},t,n)=>({x:bt(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:bt(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function ri(e,t,n){const{width:r,height:o}=Ve(n),{x:s,y:i}=n.internals.positionAbsolute;return tt(e,[[s,i],[s+r,i+o]],t)}const jo=(e,t,n)=>e<t?bt(Math.abs(e-t),1,t)/t:e>n?-bt(Math.abs(e-n),1,t)/t:0,oi=(e,t,n=15,r=40)=>{const o=jo(e.x,r,t.width-r)*n,s=jo(e.y,r,t.height-r)*n;return[o,s]},Bn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),br=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),On=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),wt=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Lr(e)?e.internals.positionAbsolute:Zt(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},An=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Lr(e)?e.internals.positionAbsolute:Zt(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},si=(e,t)=>On(Bn(br(e),br(t))),Ot=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},ko=e=>Ne(e.width)&&Ne(e.height)&&Ne(e.x)&&Ne(e.y),Ne=e=>!isNaN(e)&&isFinite(e),$f=(e,t)=>{},Jt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),en=({x:e,y:t},[n,r,o],s=!1,i=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return s?Jt(a,i):a},$n=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function ot(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Tf(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=ot(e,n),o=ot(e,t);return{top:r,right:o,bottom:r,left:o,x:o*2,y:r*2}}if(typeof e=="object"){const r=ot(e.top??e.y??0,n),o=ot(e.bottom??e.y??0,n),s=ot(e.left??e.x??0,t),i=ot(e.right??e.x??0,t);return{top:r,right:i,bottom:o,left:s,x:s+i,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Df(e,t,n,r,o,s){const{x:i,y:a}=$n(e,[t,n,r]),{x:c,y:l}=$n({x:e.x+e.width,y:e.y+e.height},[t,n,r]),u=o-c,h=s-l;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(h)}}const Fr=(e,t,n,r,o,s)=>{const i=Tf(s,t,n),a=(t-i.x)/e.width,c=(n-i.y)/e.height,l=Math.min(a,c),u=bt(l,r,o),h=e.x+e.width/2,f=e.y+e.height/2,g=t/2-h*u,y=n/2-f*u,p=Df(e,g,y,u,t,n),x={left:Math.min(p.left-i.left,0),top:Math.min(p.top-i.top,0),right:Math.min(p.right-i.right,0),bottom:Math.min(p.bottom-i.bottom,0)};return{x:g-x.left+x.right,y:y-x.top+x.bottom,zoom:u}},Xt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function vt(e){return e!=null&&e!=="parent"}function Ve(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function ii(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function ai(e,t={width:0,height:0},n,r,o){const s={...e},i=r.get(n);if(i){const a=i.origin||o;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function Eo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Vf(){let e,t;return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}}function Rf(e){return{...Qs,...e||{}}}function Dt(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:s,y:i}=Ee(e),a=en({x:s-((o==null?void 0:o.left)??0),y:i-((o==null?void 0:o.top)??0)},r),{x:c,y:l}=n?Jt(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const Br=e=>({width:e.offsetWidth,height:e.offsetHeight}),ci=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Lf=["INPUT","SELECT","TEXTAREA"];function li(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Lf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const di=e=>"clientX"in e,Ee=(e,t)=>{var s,i;const n=di(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,o=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},_o=(e,t,n,r,o)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:o,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...Br(i)}})};function ui({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:a}){const c=e*.125+o*.375+i*.375+n*.125,l=t*.125+s*.375+a*.375+r*.125,u=Math.abs(c-e),h=Math.abs(l-t);return[c,l,u,h]}function fn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Mo({pos:e,x1:t,y1:n,x2:r,y2:o,c:s}){switch(e){case G.Left:return[t-fn(t-r,s),n];case G.Right:return[t+fn(r-t,s),n];case G.Top:return[t,n-fn(n-o,s)];case G.Bottom:return[t,n+fn(o-n,s)]}}function fi({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top,curvature:i=.25}){const[a,c]=Mo({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[l,u]=Mo({pos:s,x1:r,y1:o,x2:e,y2:t,c:i}),[h,f,g,y]=ui({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${r},${o}`,h,f,g,y]}function hi({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,s=n<e?n+o:n-o,i=Math.abs(r-t)/2,a=r<t?r+i:r-i;return[s,a,o,i]}function Hf({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r,elevateOnSelect:o=!1}){if(r!==void 0)return r;const s=o&&n?1e3:0,i=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return s+i}function Ff({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const s=Bn(An(e),An(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return Ot(i,On(s))>0}const Bf=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Of=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),gi=(e,t)=>{if(!e.source||!e.target)return t;let n;return ti(e)?n={...e}:n={...e,id:Bf(e)},Of(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function mi({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,s,i,a]=hi({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,s,i,a]}const zo={[G.Left]:{x:-1,y:0},[G.Right]:{x:1,y:0},[G.Top]:{x:0,y:-1},[G.Bottom]:{x:0,y:1}},Xf=({source:e,sourcePosition:t=G.Bottom,target:n})=>t===G.Left||t===G.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Po=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Yf({source:e,sourcePosition:t=G.Bottom,target:n,targetPosition:r=G.Top,center:o,offset:s,stepPosition:i}){const a=zo[t],c=zo[r],l={x:e.x+a.x*s,y:e.y+a.y*s},u={x:n.x+c.x*s,y:n.y+c.y*s},h=Xf({source:l,sourcePosition:t,target:u}),f=h.x!==0?"x":"y",g=h[f];let y=[],p,x;const b={x:0,y:0},S={x:0,y:0},[,,m,w]=hi({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[f]*c[f]===-1){f==="x"?(p=o.x??l.x+(u.x-l.x)*i,x=o.y??(l.y+u.y)/2):(p=o.x??(l.x+u.x)/2,x=o.y??l.y+(u.y-l.y)*i);const N=[{x:p,y:l.y},{x:p,y:u.y}],M=[{x:l.x,y:x},{x:u.x,y:x}];a[f]===g?y=f==="x"?N:M:y=f==="x"?M:N}else{const N=[{x:l.x,y:u.y}],M=[{x:u.x,y:l.y}];if(f==="x"?y=a.x===g?M:N:y=a.y===g?N:M,t===r){const $=Math.abs(e[f]-n[f]);if($<=s){const D=Math.min(s-1,s-$);a[f]===g?b[f]=(l[f]>e[f]?-1:1)*D:S[f]=(u[f]>n[f]?-1:1)*D}}if(t!==r){const $=f==="x"?"y":"x",D=a[f]===c[$],v=l[$]>u[$],P=l[$]<u[$];(a[f]===1&&(!D&&v||D&&P)||a[f]!==1&&(!D&&P||D&&v))&&(y=f==="x"?N:M)}const k={x:l.x+b.x,y:l.y+b.y},A={x:u.x+S.x,y:u.y+S.y},H=Math.max(Math.abs(k.x-y[0].x),Math.abs(A.x-y[0].x)),R=Math.max(Math.abs(k.y-y[0].y),Math.abs(A.y-y[0].y));H>=R?(p=(k.x+A.x)/2,x=y[0].y):(p=y[0].x,x=(k.y+A.y)/2)}return[[e,{x:l.x+b.x,y:l.y+b.y},...y,{x:u.x+S.x,y:u.y+S.y},n],p,x,m,w]}function Wf(e,t,n,r){const o=Math.min(Po(e,t)/2,Po(t,n)/2,r),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${s+o*l},${i}Q ${s},${i} ${s},${i+o*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${i+o*c}Q ${s},${i} ${s+o*a},${i}`}function wr({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top,borderRadius:i=5,centerX:a,centerY:c,offset:l=20,stepPosition:u=.5}){const[h,f,g,y,p]=Yf({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:s,center:{x:a,y:c},offset:l,stepPosition:u});return[h.reduce((b,S,m)=>{let w="";return m>0&&m<h.length-1?w=Wf(h[m-1],S,h[m+1],i):w=`${m===0?"M":"L"}${S.x} ${S.y}`,b+=w,b},""),f,g,y,p]}function Io(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Gf(e){var h;const{sourceNode:t,targetNode:n}=e;if(!Io(t)||!Io(n))return null;const r=t.internals.handleBounds||Ao(t.handles),o=n.internals.handleBounds||Ao(n.handles),s=$o((r==null?void 0:r.source)??[],e.sourceHandle),i=$o(e.connectionMode===xt.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!s||!i)return(h=e.onError)==null||h.call(e,"008",Me.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||G.Bottom,c=(i==null?void 0:i.position)||G.Top,l=Yt(t,s,a),u=Yt(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:c}}function Ao(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Yt(e,t,n=G.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??Ve(e);if(r)return{x:o+i/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case G.Top:return{x:o+i/2,y:s};case G.Right:return{x:o+i,y:s+a/2};case G.Bottom:return{x:o+i/2,y:s+a};case G.Left:return{x:o,y:s+a/2}}}function $o(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function vr(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function Uf(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||r,a.markerEnd||o].forEach(c=>{if(c&&typeof c=="object"){const l=vr(c,t);s.has(l)||(i.push({id:l,color:c.color||n,...c}),s.add(l))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const Or={nodeOrigin:[0,0],nodeExtent:Ft,elevateNodesOnSelect:!0,defaults:{}},qf={...Or,checkEquality:!0};function Xr(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Kf(e,t,n){const r=Xr(Or,n);for(const o of e.values())if(o.parentId)Yr(o,e,t,r);else{const s=Zt(o,r.nodeOrigin),i=vt(o.extent)?o.extent:r.nodeExtent,a=tt(s,i,Ve(o));o.internals.positionAbsolute=a}}function Nr(e,t,n,r){var c,l;const o=Xr(qf,r);let s=e.length>0;const i=new Map(t),a=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const u of e){let h=i.get(u.id);if(o.checkEquality&&u===(h==null?void 0:h.internals.userNode))t.set(u.id,h);else{const f=Zt(u,o.nodeOrigin),g=vt(u.extent)?u.extent:o.nodeExtent,y=tt(f,g,Ve(u));h={...o.defaults,...u,measured:{width:(c=u.measured)==null?void 0:c.width,height:(l=u.measured)==null?void 0:l.height},internals:{positionAbsolute:y,handleBounds:u.measured?h==null?void 0:h.internals.handleBounds:void 0,z:pi(u,a),userNode:u}},t.set(u.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(s=!1),u.parentId&&Yr(h,t,n,r)}return s}function Zf(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Yr(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:i}=Xr(Or,r),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Zf(e,n);const l=o?1e3:0,{x:u,y:h,z:f}=Qf(e,c,s,i,l),{positionAbsolute:g}=e.internals,y=u!==g.x||h!==g.y;(y||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:u,y:h}:g,z:f}})}function pi(e,t){return(Ne(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Qf(e,t,n,r,o){const{x:s,y:i}=t.internals.positionAbsolute,a=Ve(e),c=Zt(e,n),l=vt(e.extent)?tt(c,e.extent,a):c;let u=tt({x:s+l.x,y:i+l.y},r,a);e.extent==="parent"&&(u=ri(u,a,t));const h=pi(e,o),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>=h?f+1:h}}function Wr(e,t,n,r=[0,0]){var i;const o=[],s=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const l=((i=s.get(a.parentId))==null?void 0:i.expandedRect)??wt(c),u=si(l,a.rect);s.set(a.parentId,{expandedRect:u,parent:c})}return s.size>0&&s.forEach(({expandedRect:a,parent:c},l)=>{var m;const u=c.internals.positionAbsolute,h=Ve(c),f=c.origin??r,g=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,y=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,p=Math.max(h.width,Math.round(a.width)),x=Math.max(h.height,Math.round(a.height)),b=(p-h.width)*f[0],S=(x-h.height)*f[1];(g>0||y>0||b||S)&&(o.push({id:l,type:"position",position:{x:c.position.x-g+b,y:c.position.y-y+S}}),(m=n.get(l))==null||m.forEach(w=>{e.some(C=>C.id===w.id)||o.push({id:w.id,type:"position",position:{x:w.position.x+g,y:w.position.y+y}})})),(h.width<a.width||h.height<a.height||g||y)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(g?f[0]*g-b:0),height:x+(y?f[1]*y-S:0)}})}),o}function Jf(e,t,n,r,o,s){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const c=[],l=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(l.transform),h=[];for(const f of e.values()){const g=t.get(f.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),a=!0;continue}const y=Br(f.nodeElement),p=g.measured.width!==y.width||g.measured.height!==y.height;if(!!(y.width&&y.height&&(p||!g.internals.handleBounds||f.force))){const b=f.nodeElement.getBoundingClientRect(),S=vt(g.extent)?g.extent:s;let{positionAbsolute:m}=g.internals;g.parentId&&g.extent==="parent"?m=ri(m,y,t.get(g.parentId)):S&&(m=tt(m,S,y));const w={...g,measured:y,internals:{...g.internals,positionAbsolute:m,handleBounds:{source:_o("source",f.nodeElement,b,u,g.id),target:_o("target",f.nodeElement,b,u,g.id)}}};t.set(g.id,w),g.parentId&&Yr(w,t,n,{nodeOrigin:o}),a=!0,p&&(c.push({id:g.id,type:"dimensions",dimensions:y}),g.expandParent&&g.parentId&&h.push({id:g.id,parentId:g.parentId,rect:wt(w,o)}))}}if(h.length>0){const f=Wr(h,t,n,o);c.push(...f)}return{changes:c,updatedInternals:a}}async function eh({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,s]],r),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function To(e,t,n,r,o,s){let i=o;const a=r.get(i)||new Map;r.set(i,a.set(n,t)),i=`${o}-${e}`;const c=r.get(i)||new Map;if(r.set(i,c.set(n,t)),s){i=`${o}-${e}-${s}`;const l=r.get(i)||new Map;r.set(i,l.set(n,t))}}function xi(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:s,sourceHandle:i=null,targetHandle:a=null}=r,c={edgeId:r.id,source:o,target:s,sourceHandle:i,targetHandle:a},l=`${o}-${i}--${s}-${a}`,u=`${s}-${a}--${o}-${i}`;To("source",c,u,e,o,i),To("target",c,l,e,s,a),t.set(r.id,r)}}function yi(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:yi(n,t):!1}function Do(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function th(e,t,n,r){const o=new Map;for(const[s,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!yi(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&o.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function or({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,a,c;const o=[];for(const[l,u]of t){const h=(i=n.get(l))==null?void 0:i.internals.userNode;h&&o.push({...h,position:u.position,dragging:r})}if(!e)return[o[0],o];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((c=t.get(e))==null?void 0:c.position)||s.position,dragging:r}:o[0],o]}function nh({dragItems:e,snapGrid:t,x:n,y:r}){const o=e.values().next().value;if(!o)return null;const s={x:n-o.distance.x,y:r-o.distance.y},i=Jt(s,t);return{x:i.x-s.x,y:i.y-s.y}}function rh({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let s={x:null,y:null},i=0,a=new Map,c=!1,l={x:0,y:0},u=null,h=!1,f=null,g=!1,y=!1,p=null;function x({noDragClassName:S,handleSelector:m,domNode:w,isSelectable:C,nodeId:N,nodeClickDistance:M=0}){f=pe(w);function k({x:$,y:D}){const{nodeLookup:v,nodeExtent:P,snapGrid:j,snapToGrid:E,nodeOrigin:_,onNodeDrag:z,onSelectionDrag:T,onError:V,updateNodePositions:L}=t();s={x:$,y:D};let O=!1;const B=a.size>1,q=B&&P?br(Qt(a)):null,Z=B&&E?nh({dragItems:a,snapGrid:j,x:$,y:D}):null;for(const[X,F]of a){if(!v.has(X))continue;let U={x:$-F.distance.x,y:D-F.distance.y};E&&(U=Z?{x:Math.round(U.x+Z.x),y:Math.round(U.y+Z.y)}:Jt(U,j));let ee=null;if(B&&P&&!F.extent&&q){const{positionAbsolute:Q}=F.internals,J=Q.x-q.x+P[0][0],se=Q.x+F.measured.width-q.x2+P[1][0],ae=Q.y-q.y+P[0][1],be=Q.y+F.measured.height-q.y2+P[1][1];ee=[[J,ae],[se,be]]}const{position:te,positionAbsolute:K}=ni({nodeId:X,nextPosition:U,nodeLookup:v,nodeExtent:ee||P,nodeOrigin:_,onError:V});O=O||F.position.x!==te.x||F.position.y!==te.y,F.position=te,F.internals.positionAbsolute=K}if(y=y||O,!!O&&(L(a,!0),p&&(r||z||!N&&T))){const[X,F]=or({nodeId:N,dragItems:a,nodeLookup:v});r==null||r(p,a,X,F),z==null||z(p,X,F),N||T==null||T(p,F)}}async function A(){if(!u)return;const{transform:$,panBy:D,autoPanSpeed:v,autoPanOnNodeDrag:P}=t();if(!P){c=!1,cancelAnimationFrame(i);return}const[j,E]=oi(l,u,v);(j!==0||E!==0)&&(s.x=(s.x??0)-j/$[2],s.y=(s.y??0)-E/$[2],await D({x:j,y:E})&&k(s)),i=requestAnimationFrame(A)}function H($){var B;const{nodeLookup:D,multiSelectionActive:v,nodesDraggable:P,transform:j,snapGrid:E,snapToGrid:_,selectNodesOnDrag:z,onNodeDragStart:T,onSelectionDragStart:V,unselectNodesAndEdges:L}=t();h=!0,(!z||!C)&&!v&&N&&((B=D.get(N))!=null&&B.selected||L()),C&&z&&N&&(e==null||e(N));const O=Dt($.sourceEvent,{transform:j,snapGrid:E,snapToGrid:_,containerBounds:u});if(s=O,a=th(D,P,O,N),a.size>0&&(n||T||!N&&V)){const[q,Z]=or({nodeId:N,dragItems:a,nodeLookup:D});n==null||n($.sourceEvent,a,q,Z),T==null||T($.sourceEvent,q,Z),N||V==null||V($.sourceEvent,Z)}}const R=Ts().clickDistance(M).on("start",$=>{const{domNode:D,nodeDragThreshold:v,transform:P,snapGrid:j,snapToGrid:E}=t();u=(D==null?void 0:D.getBoundingClientRect())||null,g=!1,y=!1,p=$.sourceEvent,v===0&&H($),s=Dt($.sourceEvent,{transform:P,snapGrid:j,snapToGrid:E,containerBounds:u}),l=Ee($.sourceEvent,u)}).on("drag",$=>{const{autoPanOnNodeDrag:D,transform:v,snapGrid:P,snapToGrid:j,nodeDragThreshold:E,nodeLookup:_}=t(),z=Dt($.sourceEvent,{transform:v,snapGrid:P,snapToGrid:j,containerBounds:u});if(p=$.sourceEvent,($.sourceEvent.type==="touchmove"&&$.sourceEvent.touches.length>1||N&&!_.has(N))&&(g=!0),!g){if(!c&&D&&h&&(c=!0,A()),!h){const T=z.xSnapped-(s.x??0),V=z.ySnapped-(s.y??0);Math.sqrt(T*T+V*V)>E&&H($)}(s.x!==z.xSnapped||s.y!==z.ySnapped)&&a&&h&&(l=Ee($.sourceEvent,u),k(z))}}).on("end",$=>{if(!(!h||g)&&(c=!1,h=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:D,updateNodePositions:v,onNodeDragStop:P,onSelectionDragStop:j}=t();if(y&&(v(a,!1),y=!1),o||P||!N&&j){const[E,_]=or({nodeId:N,dragItems:a,nodeLookup:D,dragging:!1});o==null||o($.sourceEvent,a,E,_),P==null||P($.sourceEvent,E,_),N||j==null||j($.sourceEvent,_)}}}).filter($=>{const D=$.target;return!$.button&&(!S||!Do(D,`.${S}`,w))&&(!m||Do(D,m,w))});f.call(R)}function b(){f==null||f.on(".drag",null)}return{update:x,destroy:b}}function oh(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())Ot(o,wt(s))>0&&r.push(s);return r}const sh=250;function ih(e,t,n,r){var a,c;let o=[],s=1/0;const i=oh(e,n,t+sh);for(const l of i){const u=[...((a=l.internals.handleBounds)==null?void 0:a.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const h of u){if(r.nodeId===h.nodeId&&r.type===h.type&&r.id===h.id)continue;const{x:f,y:g}=Yt(l,h,h.position,!0),y=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(g-e.y,2));y>t||(y<s?(o=[{...h,x:f,y:g}],s=y):y===s&&o.push({...h,x:f,y:g}))}}if(!o.length)return null;if(o.length>1){const l=r.type==="source"?"target":"source";return o.find(u=>u.type===l)??o[0]}return o[0]}function bi(e,t,n,r,o,s=!1){var l,u,h;const i=r.get(e);if(!i)return null;const a=o==="strict"?(l=i.internals.handleBounds)==null?void 0:l[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((h=i.internals.handleBounds)==null?void 0:h.target)??[]],c=(n?a==null?void 0:a.find(f=>f.id===n):a==null?void 0:a[0])??null;return c&&s?{...c,...Yt(i,c,c.position,!0)}:c}function wi(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function ah(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const vi=()=>!0;function ch(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:h,panBy:f,cancelConnection:g,onConnectStart:y,onConnect:p,onConnectEnd:x,isValidConnection:b=vi,onReconnectEnd:S,updateConnection:m,getTransform:w,getFromHandle:C,autoPanSpeed:N,dragThreshold:M=1,handleDomNode:k}){const A=ci(e.target);let H=0,R;const{x:$,y:D}=Ee(e),v=wi(s,k),P=a==null?void 0:a.getBoundingClientRect();let j=!1;if(!P||!v)return;const E=bi(o,v,r,c,t);if(!E)return;let _=Ee(e,P),z=!1,T=null,V=!1,L=null;function O(){if(!u||!P)return;const[te,K]=oi(_,P,N);f({x:te,y:K}),H=requestAnimationFrame(O)}const B={...E,nodeId:o,type:v,position:E.position},q=c.get(o);let X={inProgress:!0,isValid:null,from:Yt(q,B,G.Left,!0),fromHandle:B,fromPosition:B.position,fromNode:q,to:_,toHandle:null,toPosition:Co[B.position],toNode:null};function F(){j=!0,m(X),y==null||y(e,{nodeId:o,handleId:r,handleType:v})}M===0&&F();function U(te){if(!j){const{x:se,y:ae}=Ee(te),be=se-$,nt=ae-D;if(!(be*be+nt*nt>M*M))return;F()}if(!C()||!B){ee(te);return}const K=w();_=Ee(te,P),R=ih(en(_,K,!1,[1,1]),n,c,B),z||(O(),z=!0);const Q=Ni(te,{handle:R,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:i?"target":"source",isValidConnection:b,doc:A,lib:l,flowId:h,nodeLookup:c});L=Q.handleDomNode,T=Q.connection,V=ah(!!R,Q.isValid);const J={...X,isValid:V,to:Q.toHandle&&V?$n({x:Q.toHandle.x,y:Q.toHandle.y},K):_,toHandle:Q.toHandle,toPosition:V&&Q.toHandle?Q.toHandle.position:Co[B.position],toNode:Q.toHandle?c.get(Q.toHandle.nodeId):null};V&&R&&X.toHandle&&J.toHandle&&X.toHandle.type===J.toHandle.type&&X.toHandle.nodeId===J.toHandle.nodeId&&X.toHandle.id===J.toHandle.id&&X.to.x===J.to.x&&X.to.y===J.to.y||(m(J),X=J)}function ee(te){if(j){(R||L)&&T&&V&&(p==null||p(T));const{inProgress:K,...Q}=X,J={...Q,toPosition:X.toHandle?X.toPosition:null};x==null||x(te,J),s&&(S==null||S(te,J))}g(),cancelAnimationFrame(H),z=!1,V=!1,T=null,L=null,A.removeEventListener("mousemove",U),A.removeEventListener("mouseup",ee),A.removeEventListener("touchmove",U),A.removeEventListener("touchend",ee)}A.addEventListener("mousemove",U),A.addEventListener("mouseup",ee),A.addEventListener("touchmove",U),A.addEventListener("touchend",ee)}function Ni(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:s,doc:i,lib:a,flowId:c,isValidConnection:l=vi,nodeLookup:u}){const h=s==="target",f=t?i.querySelector(`.${a}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:g,y}=Ee(e),p=i.elementFromPoint(g,y),x=p!=null&&p.classList.contains(`${a}-flow__handle`)?p:f,b={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const S=wi(void 0,x),m=x.getAttribute("data-nodeid"),w=x.getAttribute("data-handleid"),C=x.classList.contains("connectable"),N=x.classList.contains("connectableend");if(!m||!S)return b;const M={source:h?m:r,sourceHandle:h?w:o,target:h?r:m,targetHandle:h?o:w};b.connection=M;const A=C&&N&&(n===xt.Strict?h&&S==="source"||!h&&S==="target":m!==r||w!==o);b.isValid=A&&l(M),b.toHandle=bi(m,S,w,u,n,!0)}return b}const Sr={onPointerDown:ch,isValid:Ni};function lh({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=pe(e);function s({translateExtent:a,width:c,height:l,zoomStep:u=1,pannable:h=!0,zoomable:f=!0,inversePan:g=!1}){const y=m=>{if(m.sourceEvent.type!=="wheel"||!t)return;const w=n(),C=m.sourceEvent.ctrlKey&&Xt()?10:1,N=-m.sourceEvent.deltaY*(m.sourceEvent.deltaMode===1?.05:m.sourceEvent.deltaMode?1:.002)*u,M=w[2]*Math.pow(2,N*C);t.scaleTo(M)};let p=[0,0];const x=m=>{(m.sourceEvent.type==="mousedown"||m.sourceEvent.type==="touchstart")&&(p=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY])},b=m=>{const w=n();if(m.sourceEvent.type!=="mousemove"&&m.sourceEvent.type!=="touchmove"||!t)return;const C=[m.sourceEvent.clientX??m.sourceEvent.touches[0].clientX,m.sourceEvent.clientY??m.sourceEvent.touches[0].clientY],N=[C[0]-p[0],C[1]-p[1]];p=C;const M=r()*Math.max(w[2],Math.log(w[2]))*(g?-1:1),k={x:w[0]-N[0]*M,y:w[1]-N[1]*M},A=[[0,0],[c,l]];t.setViewportConstrained({x:k.x,y:k.y,zoom:w[2]},A,a)},S=Ks().on("start",x).on("zoom",h?b:null).on("zoom.wheel",f?y:null);o.call(S,{})}function i(){o.on("zoom",null)}return{update:s,destroy:i,pointer:we}}const dh=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Xn=e=>({x:e.x,y:e.y,zoom:e.k}),sr=({x:e,y:t,zoom:n})=>Fn.translate(e,t).scale(n),ct=(e,t)=>e.target.closest(`.${t}`),Si=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),uh=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,ir=(e,t=0,n=uh,r=()=>{})=>{const o=typeof t=="number"&&t>0;return o||r(),o?e.transition().duration(t).ease(n).on("end",r):e},Ci=e=>{const t=e.ctrlKey&&Xt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function fh({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(ct(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const h=n.property("__zoom").k||1;if(u.ctrlKey&&i){const x=we(u),b=Ci(u),S=h*Math.pow(2,b);r.scaleTo(n,S,x,u);return}const f=u.deltaMode===1?20:1;let g=o===Ke.Vertical?0:u.deltaX*f,y=o===Ke.Horizontal?0:u.deltaY*f;!Xt()&&u.shiftKey&&o!==Ke.Vertical&&(g=u.deltaY*f,y=0),r.translateBy(n,-(g/h)*s,-(y/h)*s,{internal:!0});const p=Xn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,p)),e.isPanScrolling&&(c==null||c(u,p),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,p),e.isPanScrolling=!1},150))}}function hh({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){const s=r.type==="wheel",i=!t&&s&&!r.ctrlKey,a=ct(r,e);if(r.ctrlKey&&s&&a&&r.preventDefault(),i||a)return null;r.preventDefault(),n.call(this,r,o)}}function gh({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,i,a;if((s=r.sourceEvent)!=null&&s.internal)return;const o=Xn(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function mh({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return s=>{var i,a;e.usedRightMouseButton=!!(n&&Si(t,e.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||r([s.transform.x,s.transform.y,s.transform.k]),o&&!((a=s.sourceEvent)!=null&&a.internal)&&(o==null||o(s.sourceEvent,Xn(s.transform)))}}function ph({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:s}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&Si(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&dh(e.prevViewport,i.transform))){const c=Xn(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,c)},n?150:0)}}}function xh({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:c,lib:l}){return u=>{var y;const h=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(ct(u,`${l}-flow__node`)||ct(u,`${l}-flow__edge`)))return!0;if(!r&&!h&&!o&&!s&&!n||i||ct(u,a)&&u.type==="wheel"||ct(u,c)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((y=u.touches)==null?void 0:y.length)>1)return u.preventDefault(),!1;if(!h&&!o&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const g=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&g}}function yh({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:s,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),f=Ks().clickDistance(!Ne(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),g=pe(e).call(f);m({x:s.x,y:s.y,zoom:bt(s.zoom,t,n)},[[0,0],[h.width,h.height]],o);const y=g.on("wheel.zoom"),p=g.on("dblclick.zoom");f.wheelDelta(Ci);function x($,D){return g?new Promise(v=>{f==null||f.interpolate((D==null?void 0:D.interpolate)==="linear"?Tt:vn).transform(ir(g,D==null?void 0:D.duration,D==null?void 0:D.ease,()=>v(!0)),$)}):Promise.resolve(!1)}function b({noWheelClassName:$,noPanClassName:D,onPaneContextMenu:v,userSelectionActive:P,panOnScroll:j,panOnDrag:E,panOnScrollMode:_,panOnScrollSpeed:z,preventScrolling:T,zoomOnPinch:V,zoomOnScroll:L,zoomOnDoubleClick:O,zoomActivationKeyPressed:B,lib:q,onTransformChange:Z}){P&&!u.isZoomingOrPanning&&S();const F=j&&!B&&!P?fh({zoomPanValues:u,noWheelClassName:$,d3Selection:g,d3Zoom:f,panOnScrollMode:_,panOnScrollSpeed:z,zoomOnPinch:V,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:c}):hh({noWheelClassName:$,preventScrolling:T,d3ZoomHandler:y});if(g.on("wheel.zoom",F,{passive:!1}),!P){const ee=gh({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:a});f.on("start",ee);const te=mh({zoomPanValues:u,panOnDrag:E,onPaneContextMenu:!!v,onPanZoom:i,onTransformChange:Z});f.on("zoom",te);const K=ph({zoomPanValues:u,panOnDrag:E,panOnScroll:j,onPaneContextMenu:v,onPanZoomEnd:c,onDraggingChange:l});f.on("end",K)}const U=xh({zoomActivationKeyPressed:B,panOnDrag:E,zoomOnScroll:L,panOnScroll:j,zoomOnDoubleClick:O,zoomOnPinch:V,userSelectionActive:P,noPanClassName:D,noWheelClassName:$,lib:q});f.filter(U),O?g.on("dblclick.zoom",p):g.on("dblclick.zoom",null)}function S(){f.on("zoom",null)}async function m($,D,v){const P=sr($),j=f==null?void 0:f.constrain()(P,D,v);return j&&await x(j),new Promise(E=>E(j))}async function w($,D){const v=sr($);return await x(v,D),new Promise(P=>P(v))}function C($){if(g){const D=sr($),v=g.property("__zoom");(v.k!==$.zoom||v.x!==$.x||v.y!==$.y)&&(f==null||f.transform(g,D,null,{sync:!0}))}}function N(){const $=g?qs(g.node()):{x:0,y:0,k:1};return{x:$.x,y:$.y,zoom:$.k}}function M($,D){return g?new Promise(v=>{f==null||f.interpolate((D==null?void 0:D.interpolate)==="linear"?Tt:vn).scaleTo(ir(g,D==null?void 0:D.duration,D==null?void 0:D.ease,()=>v(!0)),$)}):Promise.resolve(!1)}function k($,D){return g?new Promise(v=>{f==null||f.interpolate((D==null?void 0:D.interpolate)==="linear"?Tt:vn).scaleBy(ir(g,D==null?void 0:D.duration,D==null?void 0:D.ease,()=>v(!0)),$)}):Promise.resolve(!1)}function A($){f==null||f.scaleExtent($)}function H($){f==null||f.translateExtent($)}function R($){const D=!Ne($)||$<0?0:$;f==null||f.clickDistance(D)}return{update:b,destroy:S,setViewport:w,setViewportConstrained:m,getViewport:N,scaleTo:M,scaleBy:k,setScaleExtent:A,setTranslateExtent:H,syncViewport:C,setClickDistance:R}}var Nt;(function(e){e.Line="line",e.Handle="handle"})(Nt||(Nt={}));function bh({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:s}){const i=e-t,a=n-r,c=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&o&&(c[0]=c[0]*-1),a&&s&&(c[1]=c[1]*-1),c}function wh(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function Re(e,t){return Math.max(0,t-e)}function Le(e,t){return Math.max(0,e-t)}function hn(e,t,n){return Math.max(0,t-e,e-n)}function Vo(e,t){return e?!t:t}function vh(e,t,n,r,o,s,i,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:h}=t,f=u&&h,{xSnapped:g,ySnapped:y}=n,{minWidth:p,maxWidth:x,minHeight:b,maxHeight:S}=r,{x:m,y:w,width:C,height:N,aspectRatio:M}=e;let k=Math.floor(u?g-e.pointerX:0),A=Math.floor(h?y-e.pointerY:0);const H=C+(c?-k:k),R=N+(l?-A:A),$=-s[0]*C,D=-s[1]*N;let v=hn(H,p,x),P=hn(R,b,S);if(i){let _=0,z=0;c&&k<0?_=Re(m+k+$,i[0][0]):!c&&k>0&&(_=Le(m+H+$,i[1][0])),l&&A<0?z=Re(w+A+D,i[0][1]):!l&&A>0&&(z=Le(w+R+D,i[1][1])),v=Math.max(v,_),P=Math.max(P,z)}if(a){let _=0,z=0;c&&k>0?_=Le(m+k,a[0][0]):!c&&k<0&&(_=Re(m+H,a[1][0])),l&&A>0?z=Le(w+A,a[0][1]):!l&&A<0&&(z=Re(w+R,a[1][1])),v=Math.max(v,_),P=Math.max(P,z)}if(o){if(u){const _=hn(H/M,b,S)*M;if(v=Math.max(v,_),i){let z=0;!c&&!l||c&&!l&&f?z=Le(w+D+H/M,i[1][1])*M:z=Re(w+D+(c?k:-k)/M,i[0][1])*M,v=Math.max(v,z)}if(a){let z=0;!c&&!l||c&&!l&&f?z=Re(w+H/M,a[1][1])*M:z=Le(w+(c?k:-k)/M,a[0][1])*M,v=Math.max(v,z)}}if(h){const _=hn(R*M,p,x)/M;if(P=Math.max(P,_),i){let z=0;!c&&!l||l&&!c&&f?z=Le(m+R*M+$,i[1][0])/M:z=Re(m+(l?A:-A)*M+$,i[0][0])/M,P=Math.max(P,z)}if(a){let z=0;!c&&!l||l&&!c&&f?z=Re(m+R*M,a[1][0])/M:z=Le(m+(l?A:-A)*M,a[0][0])/M,P=Math.max(P,z)}}}A=A+(A<0?P:-P),k=k+(k<0?v:-v),o&&(f?H>R*M?A=(Vo(c,l)?-k:k)/M:k=(Vo(c,l)?-A:A)*M:u?(A=k/M,l=c):(k=A*M,c=l));const j=c?m+k:m,E=l?w+A:w;return{width:C+(c?-k:k),height:N+(l?-A:A),x:s[0]*k*(c?-1:1)+j,y:s[1]*A*(l?-1:1)+E}}const ji={width:0,height:0,x:0,y:0},Nh={...ji,pointerX:0,pointerY:0,aspectRatio:1};function Sh(e){return[[0,0],[e.measured.width,e.measured.height]]}function Ch(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,c=n[1]*i;return[[r-a,o-c],[r+s-a,o+i-c]]}function jh({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const s=pe(e);function i({controlPosition:c,boundaries:l,keepAspectRatio:u,resizeDirection:h,onResizeStart:f,onResize:g,onResizeEnd:y,shouldResize:p}){let x={...ji},b={...Nh};const S=wh(c);let m,w=null,C=[],N,M,k;const A=Ts().on("start",H=>{const{nodeLookup:R,transform:$,snapGrid:D,snapToGrid:v,nodeOrigin:P,paneDomNode:j}=n();if(m=R.get(t),!m)return;w=(j==null?void 0:j.getBoundingClientRect())??null;const{xSnapped:E,ySnapped:_}=Dt(H.sourceEvent,{transform:$,snapGrid:D,snapToGrid:v,containerBounds:w});x={width:m.measured.width??0,height:m.measured.height??0,x:m.position.x??0,y:m.position.y??0},b={...x,pointerX:E,pointerY:_,aspectRatio:x.width/x.height},N=void 0,m.parentId&&(m.extent==="parent"||m.expandParent)&&(N=R.get(m.parentId),M=N&&m.extent==="parent"?Sh(N):void 0),C=[],k=void 0;for(const[z,T]of R)if(T.parentId===t&&(C.push({id:z,position:{...T.position},extent:T.extent}),T.extent==="parent"||T.expandParent)){const V=Ch(T,m,T.origin??P);k?k=[[Math.min(V[0][0],k[0][0]),Math.min(V[0][1],k[0][1])],[Math.max(V[1][0],k[1][0]),Math.max(V[1][1],k[1][1])]]:k=V}f==null||f(H,{...x})}).on("drag",H=>{const{transform:R,snapGrid:$,snapToGrid:D,nodeOrigin:v}=n(),P=Dt(H.sourceEvent,{transform:R,snapGrid:$,snapToGrid:D,containerBounds:w}),j=[];if(!m)return;const{x:E,y:_,width:z,height:T}=x,V={},L=m.origin??v,{width:O,height:B,x:q,y:Z}=vh(b,S,P,l,u,L,M,k),X=O!==z,F=B!==T,U=q!==E&&X,ee=Z!==_&&F;if(!U&&!ee&&!X&&!F)return;if((U||ee||L[0]===1||L[1]===1)&&(V.x=U?q:x.x,V.y=ee?Z:x.y,x.x=V.x,x.y=V.y,C.length>0)){const J=q-E,se=Z-_;for(const ae of C)ae.position={x:ae.position.x-J+L[0]*(O-z),y:ae.position.y-se+L[1]*(B-T)},j.push(ae)}if((X||F)&&(V.width=X&&(!h||h==="horizontal")?O:x.width,V.height=F&&(!h||h==="vertical")?B:x.height,x.width=V.width,x.height=V.height),N&&m.expandParent){const J=L[0]*(V.width??0);V.x&&V.x<J&&(x.x=J,b.x=b.x-(V.x-J));const se=L[1]*(V.height??0);V.y&&V.y<se&&(x.y=se,b.y=b.y-(V.y-se))}const te=bh({width:x.width,prevWidth:z,height:x.height,prevHeight:T,affectsX:S.affectsX,affectsY:S.affectsY}),K={...x,direction:te};(p==null?void 0:p(H,K))!==!1&&(g==null||g(H,K),r(V,j))}).on("end",H=>{y==null||y(H,{...x}),o==null||o({...x})});s.call(A)}function a(){s.on(".drag",null)}return{update:i,destroy:a}}const Yn=I.createContext(null),kh=Yn.Provider,ki=Me.error001();function re(e,t){const n=I.useContext(Yn);if(n===null)throw new Error(ki);return Dc(n,e,t)}function ie(){const e=I.useContext(Yn);if(e===null)throw new Error(ki);return I.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Ro={display:"none"},Eh={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ei="react-flow__node-desc",_i="react-flow__edge-desc",_h="react-flow__aria-live",Mh=e=>e.ariaLiveMessage,zh=e=>e.ariaLabelConfig;function Ph({rfId:e}){const t=re(Mh);return d.jsx("div",{id:`${_h}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Eh,children:t})}function Ih({rfId:e,disableKeyboardA11y:t}){const n=re(zh);return d.jsxs(d.Fragment,{children:[d.jsx("div",{id:`${Ei}-${e}`,style:Ro,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),d.jsx("div",{id:`${_i}-${e}`,style:Ro,children:n["edge.a11yDescription.default"]}),!t&&d.jsx(Ph,{rfId:e})]})}const Wn=I.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},s)=>{const i=`${e}`.split("-");return d.jsx("div",{className:de(["react-flow__panel",n,...i]),style:r,ref:s,...o,children:t})});Wn.displayName="Panel";function Ah({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:d.jsx(Wn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:d.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const $h=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},gn=e=>e.id;function Th(e,t){return ce(e.selectedNodes.map(gn),t.selectedNodes.map(gn))&&ce(e.selectedEdges.map(gn),t.selectedEdges.map(gn))}function Dh({onSelectionChange:e}){const t=ie(),{selectedNodes:n,selectedEdges:r}=re($h,Th);return I.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(s=>s(o))},[n,r,e]),null}const Vh=e=>!!e.onSelectionChangeHandlers;function Rh({onSelectionChange:e}){const t=re(Vh);return e||t?d.jsx(Dh,{onSelectionChange:e}):null}const Mi=[0,0],Lh={x:0,y:0,zoom:1},Hh=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],Lo=[...Hh,"rfId"],Fh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Ho={translateExtent:Ft,nodeOrigin:Mi,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Bh(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=re(Fh,ce),u=ie();I.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{h.current=Ho,a()}),[]);const h=I.useRef(Ho);return I.useEffect(()=>{for(const f of Lo){const g=e[f],y=h.current[f];g!==y&&(typeof e[f]>"u"||(f==="nodes"?t(g):f==="edges"?n(g):f==="minZoom"?r(g):f==="maxZoom"?o(g):f==="translateExtent"?s(g):f==="nodeExtent"?i(g):f==="paneClickDistance"?l(g):f==="ariaLabelConfig"?u.setState({ariaLabelConfig:Rf(g)}):f==="fitView"?u.setState({fitViewQueued:g}):f==="fitViewOptions"?u.setState({fitViewOptions:g}):u.setState({[f]:g})))}h.current=e},Lo.map(f=>e[f])),null}function Fo(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Oh(e){var r;const[t,n]=I.useState(e==="system"?null:e);return I.useEffect(()=>{if(e!=="system"){n(e);return}const o=Fo(),s=()=>n(o!=null&&o.matches?"dark":"light");return s(),o==null||o.addEventListener("change",s),()=>{o==null||o.removeEventListener("change",s)}},[e]),t!==null?t:(r=Fo())!=null&&r.matches?"dark":"light"}const Bo=typeof document<"u"?document:null;function Wt(e=null,t={target:Bo,actInsideInputWithModifier:!0}){const[n,r]=I.useState(!1),o=I.useRef(!1),s=I.useRef(new Set([])),[i,a]=I.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(h=>typeof h=="string").map(h=>h.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=l.reduce((h,f)=>h.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return I.useEffect(()=>{const c=(t==null?void 0:t.target)??Bo,l=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const u=g=>{var x,b;if(o.current=g.ctrlKey||g.metaKey||g.shiftKey||g.altKey,(!o.current||o.current&&!l)&&li(g))return!1;const p=Xo(g.code,a);if(s.current.add(g[p]),Oo(i,s.current,!1)){const S=((b=(x=g.composedPath)==null?void 0:x.call(g))==null?void 0:b[0])||g.target,m=(S==null?void 0:S.nodeName)==="BUTTON"||(S==null?void 0:S.nodeName)==="A";t.preventDefault!==!1&&(o.current||!m)&&g.preventDefault(),r(!0)}},h=g=>{const y=Xo(g.code,a);Oo(i,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(g[y]),g.key==="Meta"&&s.current.clear(),o.current=!1},f=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",u),c==null||c.addEventListener("keyup",h),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{c==null||c.removeEventListener("keydown",u),c==null||c.removeEventListener("keyup",h),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function Oo(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Xo(e,t){return t.includes(e)?"code":"key"}const Xh=()=>{const e=ie();return I.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??s},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),c=Fr(t,r,o,s,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(c,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:c}=i.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},u=n.snapGrid??o,h=n.snapToGrid??s;return en(l,r,h,u)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:s}=r.getBoundingClientRect(),i=$n(t,n);return{x:i.x+o,y:i.y+s}}}),[])};function zi(e,t){const n=[],r=new Map,o=[];for(const s of e)if(s.type==="add"){o.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const i=r.get(s.id);i?i.push(s):r.set(s.id,[s])}for(const s of t){const i=r.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const c of i)Yh(c,a);n.push(a)}return o.length&&o.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function Yh(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Pi(e,t){return zi(e,t)}function Ii(e,t){return zi(e,t)}function Ge(e,t){return{id:e,type:"select",selected:t}}function lt(e,t=new Set,n=!1){const r=[];for(const[o,s]of e){const i=t.has(o);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),r.push(Ge(s.id,i)))}return r}function Yo({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,i]of e.entries()){const a=t.get(i.id),c=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;c!==void 0&&c!==i&&n.push({id:i.id,item:i,type:"replace"}),c===void 0&&n.push({item:i,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function Wo(e){return{id:e.id,type:"remove"}}const Go=e=>_f(e),Wh=e=>ti(e);function Ai(e){return I.forwardRef(e)}const Gh=typeof window<"u"?I.useLayoutEffect:I.useEffect;function Uo(e){const[t,n]=I.useState(BigInt(0)),[r]=I.useState(()=>Uh(()=>n(o=>o+BigInt(1))));return Gh(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function Uh(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const $i=I.createContext(null);function qh({children:e}){const t=ie(),n=I.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:h,nodeLookup:f,fitViewQueued:g}=t.getState();let y=c;for(const x of a)y=typeof x=="function"?x(y):x;const p=Yo({items:y,lookup:f});u&&l(y),p.length>0?h==null||h(p):g&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:b,setNodes:S}=t.getState();x&&S(b)})},[]),r=Uo(n),o=I.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:h,edgeLookup:f}=t.getState();let g=c;for(const y of a)g=typeof y=="function"?y(g):y;u?l(g):h&&h(Yo({items:g,lookup:f}))},[]),s=Uo(o),i=I.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return d.jsx($i.Provider,{value:i,children:e})}function Kh(){const e=I.useContext($i);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Zh=e=>!!e.panZoom;function Gn(){const e=Xh(),t=ie(),n=Kh(),r=re(Zh),o=I.useMemo(()=>{const s=h=>t.getState().nodeLookup.get(h),i=h=>{n.nodeQueue.push(h)},a=h=>{n.edgeQueue.push(h)},c=h=>{var b,S;const{nodeLookup:f,nodeOrigin:g}=t.getState(),y=Go(h)?h:f.get(h.id),p=y.parentId?ai(y.position,y.measured,y.parentId,f,g):y.position,x={...y,position:p,width:((b=y.measured)==null?void 0:b.width)??y.width,height:((S=y.measured)==null?void 0:S.height)??y.height};return wt(x)},l=(h,f,g={replace:!1})=>{i(y=>y.map(p=>{if(p.id===h){const x=typeof f=="function"?f(p):f;return g.replace&&Go(x)?x:{...p,...x}}return p}))},u=(h,f,g={replace:!1})=>{a(y=>y.map(p=>{if(p.id===h){const x=typeof f=="function"?f(p):f;return g.replace&&Wh(x)?x:{...p,...x}}return p}))};return{getNodes:()=>t.getState().nodes.map(h=>({...h})),getNode:h=>{var f;return(f=s(h))==null?void 0:f.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:h=[]}=t.getState();return h.map(f=>({...f}))},getEdge:h=>t.getState().edgeLookup.get(h),setNodes:i,setEdges:a,addNodes:h=>{const f=Array.isArray(h)?h:[h];n.nodeQueue.push(g=>[...g,...f])},addEdges:h=>{const f=Array.isArray(h)?h:[h];n.edgeQueue.push(g=>[...g,...f])},toObject:()=>{const{nodes:h=[],edges:f=[],transform:g}=t.getState(),[y,p,x]=g;return{nodes:h.map(b=>({...b})),edges:f.map(b=>({...b})),viewport:{x:y,y:p,zoom:x}}},deleteElements:async({nodes:h=[],edges:f=[]})=>{const{nodes:g,edges:y,onNodesDelete:p,onEdgesDelete:x,triggerNodeChanges:b,triggerEdgeChanges:S,onDelete:m,onBeforeDelete:w}=t.getState(),{nodes:C,edges:N}=await Af({nodesToRemove:h,edgesToRemove:f,nodes:g,edges:y,onBeforeDelete:w}),M=N.length>0,k=C.length>0;if(M){const A=N.map(Wo);x==null||x(N),S(A)}if(k){const A=C.map(Wo);p==null||p(C),b(A)}return(k||M)&&(m==null||m({nodes:C,edges:N})),{deletedNodes:C,deletedEdges:N}},getIntersectingNodes:(h,f=!0,g)=>{const y=ko(h),p=y?h:c(h),x=g!==void 0;return p?(g||t.getState().nodes).filter(b=>{const S=t.getState().nodeLookup.get(b.id);if(S&&!y&&(b.id===h.id||!S.internals.positionAbsolute))return!1;const m=wt(x?b:S),w=Ot(m,p);return f&&w>0||w>=m.width*m.height||w>=p.width*p.height}):[]},isNodeIntersecting:(h,f,g=!0)=>{const p=ko(h)?h:c(h);if(!p)return!1;const x=Ot(p,f);return g&&x>0||x>=p.width*p.height},updateNode:l,updateNodeData:(h,f,g={replace:!1})=>{l(h,y=>{const p=typeof f=="function"?f(y):f;return g.replace?{...y,data:p}:{...y,data:{...y.data,...p}}},g)},updateEdge:u,updateEdgeData:(h,f,g={replace:!1})=>{u(h,y=>{const p=typeof f=="function"?f(y):f;return g.replace?{...y,data:p}:{...y,data:{...y.data,...p}}},g)},getNodesBounds:h=>{const{nodeLookup:f,nodeOrigin:g}=t.getState();return Mf(h,{nodeLookup:f,nodeOrigin:g})},getHandleConnections:({type:h,id:f,nodeId:g})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${g}-${h}${f?`-${f}`:""}`))==null?void 0:y.values())??[])},getNodeConnections:({type:h,handleId:f,nodeId:g})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${g}${h?f?`-${h}-${f}`:`-${h}`:""}`))==null?void 0:y.values())??[])},fitView:async h=>{const f=t.getState().fitViewResolver??Vf();return t.setState({fitViewQueued:!0,fitViewOptions:h,fitViewResolver:f}),n.nodeQueue.push(g=>[...g]),f.promise}}},[]);return I.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const qo=e=>e.selected,Qh=typeof window<"u"?window:void 0;function Jh({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ie(),{deleteElements:r}=Gn(),o=Wt(e,{actInsideInputWithModifier:!1}),s=Wt(t,{target:Qh});I.useEffect(()=>{if(o){const{edges:i,nodes:a}=n.getState();r({nodes:a.filter(qo),edges:i.filter(qo)}),n.setState({nodesSelectionActive:!1})}},[o]),I.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function eg(e){const t=ie();I.useEffect(()=>{const n=()=>{var o,s;if(!e.current)return!1;const r=Br(e.current);(r.height===0||r.width===0)&&((s=(o=t.getState()).onError)==null||s.call(o,"004",Me.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Un={position:"absolute",width:"100%",height:"100%",top:0,left:0},tg=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function ng({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:s=Ke.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:h,zoomActivationKeyCode:f,preventScrolling:g=!0,children:y,noWheelClassName:p,noPanClassName:x,onViewportChange:b,isControlledViewport:S,paneClickDistance:m}){const w=ie(),C=I.useRef(null),{userSelectionActive:N,lib:M}=re(tg,ce),k=Wt(f),A=I.useRef();eg(C);const H=I.useCallback(R=>{b==null||b({x:R[0],y:R[1],zoom:R[2]}),S||w.setState({transform:R})},[b,S]);return I.useEffect(()=>{if(C.current){A.current=yh({domNode:C.current,minZoom:u,maxZoom:h,translateExtent:l,viewport:c,paneClickDistance:m,onDraggingChange:v=>w.setState({paneDragging:v}),onPanZoomStart:(v,P)=>{const{onViewportChangeStart:j,onMoveStart:E}=w.getState();E==null||E(v,P),j==null||j(P)},onPanZoom:(v,P)=>{const{onViewportChange:j,onMove:E}=w.getState();E==null||E(v,P),j==null||j(P)},onPanZoomEnd:(v,P)=>{const{onViewportChangeEnd:j,onMoveEnd:E}=w.getState();E==null||E(v,P),j==null||j(P)}});const{x:R,y:$,zoom:D}=A.current.getViewport();return w.setState({panZoom:A.current,transform:[R,$,D],domNode:C.current.closest(".react-flow")}),()=>{var v;(v=A.current)==null||v.destroy()}}},[]),I.useEffect(()=>{var R;(R=A.current)==null||R.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:k,preventScrolling:g,noPanClassName:x,userSelectionActive:N,noWheelClassName:p,lib:M,onTransformChange:H})},[e,t,n,r,o,s,i,a,k,g,x,N,p,M,H]),d.jsx("div",{className:"react-flow__renderer",ref:C,style:Un,children:y})}const rg=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function og(){const{userSelectionActive:e,userSelectionRect:t}=re(rg,ce);return e&&t?d.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const ar=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},sg=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function ig({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Bt.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:s,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:h,onPaneMouseLeave:f,children:g}){const y=ie(),{userSelectionActive:p,elementsSelectable:x,dragging:b,connectionInProgress:S}=re(sg,ce),m=x&&(e||p),w=I.useRef(null),C=I.useRef(),N=I.useRef(new Set),M=I.useRef(new Set),k=I.useRef(!1),A=I.useRef(!1),H=E=>{if(k.current||S){k.current=!1;return}a==null||a(E),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},R=E=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){E.preventDefault();return}c==null||c(E)},$=l?E=>l(E):void 0,D=E=>{var L,O;const{resetSelectedElements:_,domNode:z}=y.getState();if(C.current=z==null?void 0:z.getBoundingClientRect(),!x||!e||E.button!==0||E.target!==w.current||!C.current)return;(O=(L=E.target)==null?void 0:L.setPointerCapture)==null||O.call(L,E.pointerId),A.current=!0,k.current=!1;const{x:T,y:V}=Ee(E.nativeEvent,C.current);_(),y.setState({userSelectionRect:{width:0,height:0,startX:T,startY:V,x:T,y:V}}),s==null||s(E)},v=E=>{const{userSelectionRect:_,transform:z,nodeLookup:T,edgeLookup:V,connectionLookup:L,triggerNodeChanges:O,triggerEdgeChanges:B,defaultEdgeOptions:q}=y.getState();if(!C.current||!_)return;k.current=!0;const{x:Z,y:X}=Ee(E.nativeEvent,C.current),{startX:F,startY:U}=_,ee={startX:F,startY:U,x:Z<F?Z:F,y:X<U?X:U,width:Math.abs(Z-F),height:Math.abs(X-U)},te=N.current,K=M.current;N.current=new Set(Hr(T,ee,z,n===Bt.Partial,!0).map(J=>J.id)),M.current=new Set;const Q=(q==null?void 0:q.selectable)??!0;for(const J of N.current){const se=L.get(J);if(se)for(const{edgeId:ae}of se.values()){const be=V.get(ae);be&&(be.selectable??Q)&&M.current.add(ae)}}if(!Eo(te,N.current)){const J=lt(T,N.current,!0);O(J)}if(!Eo(K,M.current)){const J=lt(V,M.current);B(J)}y.setState({userSelectionRect:ee,userSelectionActive:!0,nodesSelectionActive:!1})},P=E=>{var z,T;if(E.button!==0||!A.current)return;(T=(z=E.target)==null?void 0:z.releasePointerCapture)==null||T.call(z,E.pointerId);const{userSelectionRect:_}=y.getState();!p&&_&&E.target===w.current&&(H==null||H(E)),y.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:N.current.size>0}),i==null||i(E),(t||o)&&(k.current=!1),A.current=!1},j=r===!0||Array.isArray(r)&&r.includes(0);return d.jsxs("div",{className:de(["react-flow__pane",{draggable:j,dragging:b,selection:e}]),onClick:m?void 0:ar(H,w),onContextMenu:ar(R,w),onWheel:ar($,w),onPointerEnter:m?void 0:u,onPointerDown:m?D:h,onPointerMove:m?v:h,onPointerUp:m?P:void 0,onPointerLeave:f,ref:w,style:Un,children:[g,d.jsx(og,{})]})}function Cr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",Me.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(s({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):o([e])}function Ti({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:s,nodeClickDistance:i}){const a=ie(),[c,l]=I.useState(!1),u=I.useRef();return I.useEffect(()=>{u.current=rh({getStoreItems:()=>a.getState(),onNodeMouseDown:h=>{Cr({id:h,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),I.useEffect(()=>{var h,f;if(t)(h=u.current)==null||h.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:o,nodeClickDistance:i}),()=>{var g;(g=u.current)==null||g.destroy()}},[n,r,t,s,e,o]),c}const ag=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Di(){const e=ie();return I.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:u}=e.getState(),h=new Map,f=ag(i),g=o?s[0]:5,y=o?s[1]:5,p=n.direction.x*g*n.factor,x=n.direction.y*y*n.factor;for(const[,b]of l){if(!f(b))continue;let S={x:b.internals.positionAbsolute.x+p,y:b.internals.positionAbsolute.y+x};o&&(S=Jt(S,s));const{position:m,positionAbsolute:w}=ni({nodeId:b.id,nextPosition:S,nodeLookup:l,nodeExtent:r,nodeOrigin:u,onError:a});b.position=m,b.internals.positionAbsolute=w,h.set(b.id,b)}c(h)},[])}const Gr=I.createContext(null),cg=Gr.Provider;Gr.Consumer;const Vi=()=>I.useContext(Gr),lg=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),dg=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:s,connection:i}=r,{fromHandle:a,toHandle:c,isValid:l}=i,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:s===xt.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:u&&l}};function ug({type:e="source",position:t=G.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:h,...f},g){var P,j;const y=i||null,p=e==="target",x=ie(),b=Vi(),{connectOnClick:S,noPanClassName:m,rfId:w}=re(lg,ce),{connectingFrom:C,connectingTo:N,clickConnecting:M,isPossibleEndHandle:k,connectionInProcess:A,clickConnectionInProcess:H,valid:R}=re(dg(b,y,e),ce);b||(j=(P=x.getState()).onError)==null||j.call(P,"010",Me.error010());const $=E=>{const{defaultEdgeOptions:_,onConnect:z,hasDefaultEdges:T}=x.getState(),V={..._,...E};if(T){const{edges:L,setEdges:O}=x.getState();O(gi(V,L))}z==null||z(V),a==null||a(V)},D=E=>{if(!b)return;const _=di(E.nativeEvent);if(o&&(_&&E.button===0||!_)){const z=x.getState();Sr.onPointerDown(E.nativeEvent,{handleDomNode:E.currentTarget,autoPanOnConnect:z.autoPanOnConnect,connectionMode:z.connectionMode,connectionRadius:z.connectionRadius,domNode:z.domNode,nodeLookup:z.nodeLookup,lib:z.lib,isTarget:p,handleId:y,nodeId:b,flowId:z.rfId,panBy:z.panBy,cancelConnection:z.cancelConnection,onConnectStart:z.onConnectStart,onConnectEnd:z.onConnectEnd,updateConnection:z.updateConnection,onConnect:$,isValidConnection:n||z.isValidConnection,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,autoPanSpeed:z.autoPanSpeed,dragThreshold:z.connectionDragThreshold})}_?u==null||u(E):h==null||h(E)},v=E=>{const{onClickConnectStart:_,onClickConnectEnd:z,connectionClickStartHandle:T,connectionMode:V,isValidConnection:L,lib:O,rfId:B,nodeLookup:q,connection:Z}=x.getState();if(!b||!T&&!o)return;if(!T){_==null||_(E.nativeEvent,{nodeId:b,handleId:y,handleType:e}),x.setState({connectionClickStartHandle:{nodeId:b,type:e,id:y}});return}const X=ci(E.target),F=n||L,{connection:U,isValid:ee}=Sr.isValid(E.nativeEvent,{handle:{nodeId:b,id:y,type:e},connectionMode:V,fromNodeId:T.nodeId,fromHandleId:T.id||null,fromType:T.type,isValidConnection:F,flowId:B,doc:X,lib:O,nodeLookup:q});ee&&U&&$(U);const te=structuredClone(Z);delete te.inProgress,te.toPosition=te.toHandle?te.toHandle.position:null,z==null||z(E,te),x.setState({connectionClickStartHandle:null})};return d.jsx("div",{"data-handleid":y,"data-nodeid":b,"data-handlepos":t,"data-id":`${w}-${b}-${y}-${e}`,className:de(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",m,l,{source:!p,target:p,connectable:r,connectablestart:o,connectableend:s,clickconnecting:M,connectingfrom:C,connectingto:N,valid:R,connectionindicator:r&&(!A||k)&&(A||H?s:o)}]),onMouseDown:D,onTouchStart:D,onClick:S?v:void 0,ref:g,...f,children:c})}const Oe=I.memo(Ai(ug));function fg({data:e,isConnectable:t,sourcePosition:n=G.Bottom}){return d.jsxs(d.Fragment,{children:[e==null?void 0:e.label,d.jsx(Oe,{type:"source",position:n,isConnectable:t})]})}function hg({data:e,isConnectable:t,targetPosition:n=G.Top,sourcePosition:r=G.Bottom}){return d.jsxs(d.Fragment,{children:[d.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,d.jsx(Oe,{type:"source",position:r,isConnectable:t})]})}function gg(){return null}function mg({data:e,isConnectable:t,targetPosition:n=G.Top}){return d.jsxs(d.Fragment,{children:[d.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Tn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Ko={input:fg,default:hg,output:mg,group:gg};function pg(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const xg=e=>{const{width:t,height:n,x:r,y:o}=Qt(e.nodeLookup,{filter:s=>!!s.selected});return{width:Ne(t)?t:null,height:Ne(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function yg({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ie(),{width:o,height:s,transformString:i,userSelectionActive:a}=re(xg,ce),c=Di(),l=I.useRef(null);if(I.useEffect(()=>{var f;n||(f=l.current)==null||f.focus({preventScroll:!0})},[n]),Ti({nodeRef:l}),a||!o||!s)return null;const u=e?f=>{const g=r.getState().nodes.filter(y=>y.selected);e(f,g)}:void 0,h=f=>{Object.prototype.hasOwnProperty.call(Tn,f.key)&&(f.preventDefault(),c({direction:Tn[f.key],factor:f.shiftKey?4:1}))};return d.jsx("div",{className:de(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:d.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:o,height:s}})})}const Zo=typeof window<"u"?window:void 0,bg=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ri({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:h,onSelectionStart:f,onSelectionEnd:g,multiSelectionKeyCode:y,panActivationKeyCode:p,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:S,zoomOnPinch:m,panOnScroll:w,panOnScrollSpeed:C,panOnScrollMode:N,zoomOnDoubleClick:M,panOnDrag:k,defaultViewport:A,translateExtent:H,minZoom:R,maxZoom:$,preventScrolling:D,onSelectionContextMenu:v,noWheelClassName:P,noPanClassName:j,disableKeyboardA11y:E,onViewportChange:_,isControlledViewport:z}){const{nodesSelectionActive:T,userSelectionActive:V}=re(bg),L=Wt(l,{target:Zo}),O=Wt(p,{target:Zo}),B=O||k,q=O||w,Z=u&&B!==!0,X=L||V||Z;return Jh({deleteKeyCode:c,multiSelectionKeyCode:y}),d.jsx(ng,{onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:S,zoomOnPinch:m,panOnScroll:q,panOnScrollSpeed:C,panOnScrollMode:N,zoomOnDoubleClick:M,panOnDrag:!L&&B,defaultViewport:A,translateExtent:H,minZoom:R,maxZoom:$,zoomActivationKeyCode:x,preventScrolling:D,noWheelClassName:P,noPanClassName:j,onViewportChange:_,isControlledViewport:z,paneClickDistance:a,children:d.jsxs(ig,{onSelectionStart:f,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:B,isSelecting:!!X,selectionMode:h,selectionKeyPressed:L,selectionOnDrag:Z,children:[e,T&&d.jsx(yg,{onSelectionContextMenu:v,noPanClassName:j,disableKeyboardA11y:E})]})})}Ri.displayName="FlowRenderer";const wg=I.memo(Ri),vg=e=>t=>e?Hr(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Ng(e){return re(I.useCallback(vg(e),[e]),ce)}const Sg=e=>e.updateNodeInternals;function Cg(){const e=re(Sg),[t]=I.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const s=o.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:o.target,force:!0})}),e(r)}));return I.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function jg({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=ie(),s=I.useRef(null),i=I.useRef(null),a=I.useRef(e.sourcePosition),c=I.useRef(e.targetPosition),l=I.useRef(t),u=n&&!!e.internals.handleBounds;return I.useEffect(()=>{s.current&&!e.hidden&&(!u||i.current!==s.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(s.current),i.current=s.current)},[u,e.hidden]),I.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),I.useEffect(()=>{if(s.current){const h=l.current!==t,f=a.current!==e.sourcePosition,g=c.current!==e.targetPosition;(h||f||g)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function kg({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:h,noDragClassName:f,noPanClassName:g,disableKeyboardA11y:y,rfId:p,nodeTypes:x,nodeClickDistance:b,onError:S}){const{node:m,internals:w,isParent:C}=re(F=>{const U=F.nodeLookup.get(e),ee=F.parentLookup.has(e);return{node:U,internals:U.internals,isParent:ee}},ce);let N=m.type||"default",M=(x==null?void 0:x[N])||Ko[N];M===void 0&&(S==null||S("003",Me.error003(N)),N="default",M=(x==null?void 0:x.default)||Ko.default);const k=!!(m.draggable||a&&typeof m.draggable>"u"),A=!!(m.selectable||c&&typeof m.selectable>"u"),H=!!(m.connectable||l&&typeof m.connectable>"u"),R=!!(m.focusable||u&&typeof m.focusable>"u"),$=ie(),D=ii(m),v=jg({node:m,nodeType:N,hasDimensions:D,resizeObserver:h}),P=Ti({nodeRef:v,disabled:m.hidden||!k,noDragClassName:f,handleSelector:m.dragHandle,nodeId:e,isSelectable:A,nodeClickDistance:b}),j=Di();if(m.hidden)return null;const E=Ve(m),_=pg(m),z=A||k||t||n||r||o,T=n?F=>n(F,{...w.userNode}):void 0,V=r?F=>r(F,{...w.userNode}):void 0,L=o?F=>o(F,{...w.userNode}):void 0,O=s?F=>s(F,{...w.userNode}):void 0,B=i?F=>i(F,{...w.userNode}):void 0,q=F=>{const{selectNodesOnDrag:U,nodeDragThreshold:ee}=$.getState();A&&(!U||!k||ee>0)&&Cr({id:e,store:$,nodeRef:v}),t&&t(F,{...w.userNode})},Z=F=>{if(!(li(F.nativeEvent)||y)){if(Zs.includes(F.key)&&A){const U=F.key==="Escape";Cr({id:e,store:$,unselect:U,nodeRef:v})}else if(k&&m.selected&&Object.prototype.hasOwnProperty.call(Tn,F.key)){F.preventDefault();const{ariaLabelConfig:U}=$.getState();$.setState({ariaLiveMessage:U["node.a11yDescription.ariaLiveMessage"]({direction:F.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),j({direction:Tn[F.key],factor:F.shiftKey?4:1})}}},X=()=>{var J;if(y||!((J=v.current)!=null&&J.matches(":focus-visible")))return;const{transform:F,width:U,height:ee,autoPanOnNodeFocus:te,setCenter:K}=$.getState();if(!te)return;Hr(new Map([[e,m]]),{x:0,y:0,width:U,height:ee},F,!0).length>0||K(m.position.x+E.width/2,m.position.y+E.height/2,{zoom:F[2]})};return d.jsx("div",{className:de(["react-flow__node",`react-flow__node-${N}`,{[g]:k},m.className,{selected:m.selected,selectable:A,parent:C,draggable:k,dragging:P}]),ref:v,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:z?"all":"none",visibility:D?"visible":"hidden",...m.style,..._},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:T,onMouseMove:V,onMouseLeave:L,onContextMenu:O,onClick:q,onDoubleClick:B,onKeyDown:R?Z:void 0,tabIndex:R?0:void 0,onFocus:R?X:void 0,role:m.ariaRole??(R?"group":void 0),"aria-roledescription":"node","aria-describedby":y?void 0:`${Ei}-${p}`,"aria-label":m.ariaLabel,...m.domAttributes,children:d.jsx(cg,{value:e,children:d.jsx(M,{id:e,data:m.data,type:N,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:m.selected??!1,selectable:A,draggable:k,deletable:m.deletable??!0,isConnectable:H,sourcePosition:m.sourcePosition,targetPosition:m.targetPosition,dragging:P,dragHandle:m.dragHandle,zIndex:w.z,parentId:m.parentId,...E})})})}const Eg=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Li(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:s}=re(Eg,ce),i=Ng(e.onlyRenderVisibleElements),a=Cg();return d.jsx("div",{className:"react-flow__nodes",style:Un,children:i.map(c=>d.jsx(kg,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:s},c))})}Li.displayName="NodeRenderer";const _g=I.memo(Li);function Mg(e){return re(I.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const s=n.nodeLookup.get(o.source),i=n.nodeLookup.get(o.target);s&&i&&Ff({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),ce)}const zg=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return d.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},Pg=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return d.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Qo={[yt.Arrow]:zg,[yt.ArrowClosed]:Pg};function Ig(e){const t=ie();return I.useMemo(()=>{var o,s;return Object.prototype.hasOwnProperty.call(Qo,e)?Qo[e]:((s=(o=t.getState()).onError)==null||s.call(o,"009",Me.error009(e)),null)},[e])}const Ag=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=Ig(t);return c?d.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:d.jsx(c,{color:n,strokeWidth:i})}):null},Hi=({defaultColor:e,rfId:t})=>{const n=re(s=>s.edges),r=re(s=>s.defaultEdgeOptions),o=I.useMemo(()=>Uf(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?d.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:d.jsx("defs",{children:o.map(s=>d.jsx(Ag,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Hi.displayName="MarkerDefinitions";var $g=I.memo(Hi);function Fi({x:e,y:t,label:n,labelStyle:r,labelShowBg:o=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u}){const[h,f]=I.useState({x:1,y:0,width:0,height:0}),g=de(["react-flow__edge-textwrapper",l]),y=I.useRef(null);return I.useEffect(()=>{if(y.current){const p=y.current.getBBox();f({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),n?d.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:g,visibility:h.width?"visible":"hidden",...u,children:[o&&d.jsx("rect",{width:h.width+2*i[0],x:-i[0],y:-i[1],height:h.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),d.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:y,style:r,children:n}),c]}):null}Fi.displayName="EdgeText";const Tg=I.memo(Fi);function qn({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...u}){return d.jsxs(d.Fragment,{children:[d.jsx("path",{...u,d:e,fill:"none",className:de(["react-flow__edge-path",u.className])}),l?d.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}):null,r&&Ne(t)&&Ne(n)?d.jsx(Tg,{x:t,y:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function Jo({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===G.Left||e===G.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Bi({sourceX:e,sourceY:t,sourcePosition:n=G.Bottom,targetX:r,targetY:o,targetPosition:s=G.Top}){const[i,a]=Jo({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,l]=Jo({pos:s,x1:r,y1:o,x2:e,y2:t}),[u,h,f,g]=ui({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${a} ${c},${l} ${r},${o}`,u,h,f,g]}function Oi(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i,targetPosition:a,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:y,markerEnd:p,markerStart:x,interactionWidth:b})=>{const[S,m,w]=Bi({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a}),C=e.isInternal?void 0:t;return d.jsx(qn,{id:C,path:S,labelX:m,labelY:w,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:y,markerEnd:p,markerStart:x,interactionWidth:b})})}const Dg=Oi({isInternal:!1}),Xi=Oi({isInternal:!0});Dg.displayName="SimpleBezierEdge";Xi.displayName="SimpleBezierEdgeInternal";function Yi(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:f,sourcePosition:g=G.Bottom,targetPosition:y=G.Top,markerEnd:p,markerStart:x,pathOptions:b,interactionWidth:S})=>{const[m,w,C]=wr({sourceX:n,sourceY:r,sourcePosition:g,targetX:o,targetY:s,targetPosition:y,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset,stepPosition:b==null?void 0:b.stepPosition}),N=e.isInternal?void 0:t;return d.jsx(qn,{id:N,path:m,labelX:w,labelY:C,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:p,markerStart:x,interactionWidth:S})})}const Wi=Yi({isInternal:!1}),Gi=Yi({isInternal:!0});Wi.displayName="SmoothStepEdge";Gi.displayName="SmoothStepEdgeInternal";function Ui(e){return I.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return d.jsx(Wi,{...n,id:r,pathOptions:I.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const Vg=Ui({isInternal:!1}),qi=Ui({isInternal:!0});Vg.displayName="StepEdge";qi.displayName="StepEdgeInternal";function Ki(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:y,interactionWidth:p})=>{const[x,b,S]=mi({sourceX:n,sourceY:r,targetX:o,targetY:s}),m=e.isInternal?void 0:t;return d.jsx(qn,{id:m,path:x,labelX:b,labelY:S,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:y,interactionWidth:p})})}const Rg=Ki({isInternal:!1}),Zi=Ki({isInternal:!0});Rg.displayName="StraightEdge";Zi.displayName="StraightEdgeInternal";function Qi(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i=G.Bottom,targetPosition:a=G.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:y,markerEnd:p,markerStart:x,pathOptions:b,interactionWidth:S})=>{const[m,w,C]=fi({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a,curvature:b==null?void 0:b.curvature}),N=e.isInternal?void 0:t;return d.jsx(qn,{id:N,path:m,labelX:w,labelY:C,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:y,markerEnd:p,markerStart:x,interactionWidth:S})})}const Lg=Qi({isInternal:!1}),Ji=Qi({isInternal:!0});Lg.displayName="BezierEdge";Ji.displayName="BezierEdgeInternal";const es={default:Ji,straight:Zi,step:qi,smoothstep:Gi,simplebezier:Xi},ts={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Hg=(e,t,n)=>n===G.Left?e-t:n===G.Right?e+t:e,Fg=(e,t,n)=>n===G.Top?e-t:n===G.Bottom?e+t:e,ns="react-flow__edgeupdater";function rs({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:s,onMouseOut:i,type:a}){return d.jsx("circle",{onMouseDown:o,onMouseEnter:s,onMouseOut:i,className:de([ns,`${ns}-${a}`]),cx:Hg(t,r,e),cy:Fg(n,r,e),r,stroke:"transparent",fill:"transparent"})}function Bg({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:s,targetY:i,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:h,setReconnecting:f,setUpdateHover:g}){const y=ie(),p=(w,C)=>{if(w.button!==0)return;const{autoPanOnConnect:N,domNode:M,isValidConnection:k,connectionMode:A,connectionRadius:H,lib:R,onConnectStart:$,onConnectEnd:D,cancelConnection:v,nodeLookup:P,rfId:j,panBy:E,updateConnection:_}=y.getState(),z=C.type==="target",T=(O,B)=>{f(!1),h==null||h(O,n,C.type,B)},V=O=>l==null?void 0:l(n,O),L=(O,B)=>{f(!0),u==null||u(w,n,C.type),$==null||$(O,B)};Sr.onPointerDown(w.nativeEvent,{autoPanOnConnect:N,connectionMode:A,connectionRadius:H,domNode:M,handleId:C.id,nodeId:C.nodeId,nodeLookup:P,isTarget:z,edgeUpdaterType:C.type,lib:R,flowId:j,cancelConnection:v,panBy:E,isValidConnection:k,onConnect:V,onConnectStart:L,onConnectEnd:D,onReconnectEnd:T,updateConnection:_,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,dragThreshold:y.getState().connectionDragThreshold,handleDomNode:w.currentTarget})},x=w=>p(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=w=>p(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),S=()=>g(!0),m=()=>g(!1);return d.jsxs(d.Fragment,{children:[(e===!0||e==="source")&&d.jsx(rs,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:x,onMouseEnter:S,onMouseOut:m,type:"source"}),(e===!0||e==="target")&&d.jsx(rs,{position:c,centerX:s,centerY:i,radius:t,onMouseDown:b,onMouseEnter:S,onMouseOut:m,type:"target"})]})}function Og({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:h,onReconnectStart:f,onReconnectEnd:g,rfId:y,edgeTypes:p,noPanClassName:x,onError:b,disableKeyboardA11y:S}){let m=re(K=>K.edgeLookup.get(e));const w=re(K=>K.defaultEdgeOptions);m=w?{...w,...m}:m;let C=m.type||"default",N=(p==null?void 0:p[C])||es[C];N===void 0&&(b==null||b("011",Me.error011(C)),C="default",N=(p==null?void 0:p.default)||es.default);const M=!!(m.focusable||t&&typeof m.focusable>"u"),k=typeof h<"u"&&(m.reconnectable||n&&typeof m.reconnectable>"u"),A=!!(m.selectable||r&&typeof m.selectable>"u"),H=I.useRef(null),[R,$]=I.useState(!1),[D,v]=I.useState(!1),P=ie(),{zIndex:j,sourceX:E,sourceY:_,targetX:z,targetY:T,sourcePosition:V,targetPosition:L}=re(I.useCallback(K=>{const Q=K.nodeLookup.get(m.source),J=K.nodeLookup.get(m.target);if(!Q||!J)return{zIndex:m.zIndex,...ts};const se=Gf({id:e,sourceNode:Q,targetNode:J,sourceHandle:m.sourceHandle||null,targetHandle:m.targetHandle||null,connectionMode:K.connectionMode,onError:b});return{zIndex:Hf({selected:m.selected,zIndex:m.zIndex,sourceNode:Q,targetNode:J,elevateOnSelect:K.elevateEdgesOnSelect}),...se||ts}},[m.source,m.target,m.sourceHandle,m.targetHandle,m.selected,m.zIndex]),ce),O=I.useMemo(()=>m.markerStart?`url('#${vr(m.markerStart,y)}')`:void 0,[m.markerStart,y]),B=I.useMemo(()=>m.markerEnd?`url('#${vr(m.markerEnd,y)}')`:void 0,[m.markerEnd,y]);if(m.hidden||E===null||_===null||z===null||T===null)return null;const q=K=>{var ae;const{addSelectedEdges:Q,unselectNodesAndEdges:J,multiSelectionActive:se}=P.getState();A&&(P.setState({nodesSelectionActive:!1}),m.selected&&se?(J({nodes:[],edges:[m]}),(ae=H.current)==null||ae.blur()):Q([e])),o&&o(K,m)},Z=s?K=>{s(K,{...m})}:void 0,X=i?K=>{i(K,{...m})}:void 0,F=a?K=>{a(K,{...m})}:void 0,U=c?K=>{c(K,{...m})}:void 0,ee=l?K=>{l(K,{...m})}:void 0,te=K=>{var Q;if(!S&&Zs.includes(K.key)&&A){const{unselectNodesAndEdges:J,addSelectedEdges:se}=P.getState();K.key==="Escape"?((Q=H.current)==null||Q.blur(),J({edges:[m]})):se([e])}};return d.jsx("svg",{style:{zIndex:j},children:d.jsxs("g",{className:de(["react-flow__edge",`react-flow__edge-${C}`,m.className,x,{selected:m.selected,animated:m.animated,inactive:!A&&!o,updating:R,selectable:A}]),onClick:q,onDoubleClick:Z,onContextMenu:X,onMouseEnter:F,onMouseMove:U,onMouseLeave:ee,onKeyDown:M?te:void 0,tabIndex:M?0:void 0,role:m.ariaRole??(M?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":m.ariaLabel===null?void 0:m.ariaLabel||`Edge from ${m.source} to ${m.target}`,"aria-describedby":M?`${_i}-${y}`:void 0,ref:H,...m.domAttributes,children:[!D&&d.jsx(N,{id:e,source:m.source,target:m.target,type:m.type,selected:m.selected,animated:m.animated,selectable:A,deletable:m.deletable??!0,label:m.label,labelStyle:m.labelStyle,labelShowBg:m.labelShowBg,labelBgStyle:m.labelBgStyle,labelBgPadding:m.labelBgPadding,labelBgBorderRadius:m.labelBgBorderRadius,sourceX:E,sourceY:_,targetX:z,targetY:T,sourcePosition:V,targetPosition:L,data:m.data,style:m.style,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle,markerStart:O,markerEnd:B,pathOptions:"pathOptions"in m?m.pathOptions:void 0,interactionWidth:m.interactionWidth}),k&&d.jsx(Bg,{edge:m,isReconnectable:k,reconnectRadius:u,onReconnect:h,onReconnectStart:f,onReconnectEnd:g,sourceX:E,sourceY:_,targetX:z,targetY:T,sourcePosition:V,targetPosition:L,setUpdateHover:$,setReconnecting:v})]})})}const Xg=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function ea({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:h,onEdgeDoubleClick:f,onReconnectStart:g,onReconnectEnd:y,disableKeyboardA11y:p}){const{edgesFocusable:x,edgesReconnectable:b,elementsSelectable:S,onError:m}=re(Xg,ce),w=Mg(t);return d.jsxs("div",{className:"react-flow__edges",children:[d.jsx($g,{defaultColor:e,rfId:n}),w.map(C=>d.jsx(Og,{id:C,edgesFocusable:x,edgesReconnectable:b,elementsSelectable:S,noPanClassName:o,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:h,onDoubleClick:f,onReconnectStart:g,onReconnectEnd:y,rfId:n,onError:m,edgeTypes:r,disableKeyboardA11y:p},C))]})}ea.displayName="EdgeRenderer";const Yg=I.memo(ea),Wg=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Gg({children:e}){const t=re(Wg);return d.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Ug(e){const t=Gn(),n=I.useRef(!1);I.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const qg=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function Kg(e){const t=re(qg),n=ie();return I.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function os(e){return e.connection.inProgress?{...e.connection,to:en(e.connection.to,e.transform)}:{...e.connection}}function Zg(e){return e?n=>{const r=os(n);return e(r)}:os}function Qg(e){const t=Zg(e);return re(t,ce)}const Jg=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function em({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:s,height:i,isValid:a,inProgress:c}=re(Jg,ce);return!(s&&o&&c)?null:d.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:d.jsx("g",{className:de(["react-flow__connection",ei(a)]),children:d.jsx(ta,{style:t,type:n,CustomComponent:r,isValid:a})})})}const ta=({style:e,type:t=ke.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:s,fromNode:i,fromHandle:a,fromPosition:c,to:l,toNode:u,toHandle:h,toPosition:f}=Qg();if(!o)return;if(n)return d.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:ei(r),toNode:u,toHandle:h});let g="";const y={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case ke.Bezier:[g]=fi(y);break;case ke.SimpleBezier:[g]=Bi(y);break;case ke.Step:[g]=wr({...y,borderRadius:0});break;case ke.SmoothStep:[g]=wr(y);break;default:[g]=mi(y)}return d.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};ta.displayName="ConnectionLine";const tm={};function ss(e=tm){I.useRef(e),ie(),I.useEffect(()=>{},[e])}function nm(){ie(),I.useRef(!1),I.useEffect(()=>{},[])}function na({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:h,onSelectionStart:f,onSelectionEnd:g,connectionLineType:y,connectionLineStyle:p,connectionLineComponent:x,connectionLineContainerStyle:b,selectionKeyCode:S,selectionOnDrag:m,selectionMode:w,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:M,deleteKeyCode:k,onlyRenderVisibleElements:A,elementsSelectable:H,defaultViewport:R,translateExtent:$,minZoom:D,maxZoom:v,preventScrolling:P,defaultMarkerColor:j,zoomOnScroll:E,zoomOnPinch:_,panOnScroll:z,panOnScrollSpeed:T,panOnScrollMode:V,zoomOnDoubleClick:L,panOnDrag:O,onPaneClick:B,onPaneMouseEnter:q,onPaneMouseMove:Z,onPaneMouseLeave:X,onPaneScroll:F,onPaneContextMenu:U,paneClickDistance:ee,nodeClickDistance:te,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:se,reconnectRadius:ae,onReconnect:be,onReconnectStart:nt,onReconnectEnd:tn,noDragClassName:nn,noWheelClassName:rn,noPanClassName:kt,disableKeyboardA11y:Et,nodeExtent:Zn,rfId:on,viewport:rt,onViewportChange:_t}){return ss(e),ss(t),nm(),Ug(n),Kg(rt),d.jsx(wg,{onPaneClick:B,onPaneMouseEnter:q,onPaneMouseMove:Z,onPaneMouseLeave:X,onPaneContextMenu:U,onPaneScroll:F,paneClickDistance:ee,deleteKeyCode:k,selectionKeyCode:S,selectionOnDrag:m,selectionMode:w,onSelectionStart:f,onSelectionEnd:g,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:M,elementsSelectable:H,zoomOnScroll:E,zoomOnPinch:_,zoomOnDoubleClick:L,panOnScroll:z,panOnScrollSpeed:T,panOnScrollMode:V,panOnDrag:O,defaultViewport:R,translateExtent:$,minZoom:D,maxZoom:v,onSelectionContextMenu:h,preventScrolling:P,noDragClassName:nn,noWheelClassName:rn,noPanClassName:kt,disableKeyboardA11y:Et,onViewportChange:_t,isControlledViewport:!!rt,children:d.jsxs(Gg,{children:[d.jsx(Yg,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:i,onReconnect:be,onReconnectStart:nt,onReconnectEnd:tn,onlyRenderVisibleElements:A,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:se,reconnectRadius:ae,defaultMarkerColor:j,noPanClassName:kt,disableKeyboardA11y:Et,rfId:on}),d.jsx(em,{style:p,type:y,component:x,containerStyle:b}),d.jsx("div",{className:"react-flow__edgelabel-renderer"}),d.jsx(_g,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:te,onlyRenderVisibleElements:A,noPanClassName:kt,noDragClassName:nn,disableKeyboardA11y:Et,nodeExtent:Zn,rfId:on}),d.jsx("div",{className:"react-flow__viewport-portal"})]})})}na.displayName="GraphView";const rm=I.memo(na),is=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c=.5,maxZoom:l=2,nodeOrigin:u,nodeExtent:h}={})=>{const f=new Map,g=new Map,y=new Map,p=new Map,x=r??t??[],b=n??e??[],S=u??[0,0],m=h??Ft;xi(y,p,x);const w=Nr(b,f,g,{nodeOrigin:S,nodeExtent:m,elevateNodesOnSelect:!1});let C=[0,0,1];if(i&&o&&s){const N=Qt(f,{filter:H=>!!((H.width||H.initialWidth)&&(H.height||H.initialHeight))}),{x:M,y:k,zoom:A}=Fr(N,o,s,c,l,(a==null?void 0:a.padding)??.1);C=[M,k,A]}return{rfId:"1",width:0,height:0,transform:C,nodes:b,nodesInitialized:w,nodeLookup:f,parentLookup:g,edges:x,edgeLookup:p,connectionLookup:y,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:c,maxZoom:l,translateExtent:Ft,nodeExtent:m,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:xt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:S,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Js},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:$f,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Qs}},om=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:h})=>Tc((f,g)=>{async function y(){const{nodeLookup:p,panZoom:x,fitViewOptions:b,fitViewResolver:S,width:m,height:w,minZoom:C,maxZoom:N}=g();x&&(await If({nodes:p,width:m,height:w,panZoom:x,minZoom:C,maxZoom:N},b),S==null||S.resolve(!0),f({fitViewResolver:null}))}return{...is({nodes:e,edges:t,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:h,defaultNodes:n,defaultEdges:r}),setNodes:p=>{const{nodeLookup:x,parentLookup:b,nodeOrigin:S,elevateNodesOnSelect:m,fitViewQueued:w}=g(),C=Nr(p,x,b,{nodeOrigin:S,nodeExtent:h,elevateNodesOnSelect:m,checkEquality:!0});w&&C?(y(),f({nodes:p,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):f({nodes:p,nodesInitialized:C})},setEdges:p=>{const{connectionLookup:x,edgeLookup:b}=g();xi(x,b,p),f({edges:p})},setDefaultNodesAndEdges:(p,x)=>{if(p){const{setNodes:b}=g();b(p),f({hasDefaultNodes:!0})}if(x){const{setEdges:b}=g();b(x),f({hasDefaultEdges:!0})}},updateNodeInternals:p=>{const{triggerNodeChanges:x,nodeLookup:b,parentLookup:S,domNode:m,nodeOrigin:w,nodeExtent:C,debug:N,fitViewQueued:M}=g(),{changes:k,updatedInternals:A}=Jf(p,b,S,m,w,C);A&&(Kf(b,S,{nodeOrigin:w,nodeExtent:C}),M?(y(),f({fitViewQueued:!1,fitViewOptions:void 0})):f({}),(k==null?void 0:k.length)>0&&(N&&console.log("React Flow: trigger node changes",k),x==null||x(k)))},updateNodePositions:(p,x=!1)=>{const b=[],S=[],{nodeLookup:m,triggerNodeChanges:w}=g();for(const[C,N]of p){const M=m.get(C),k=!!(M!=null&&M.expandParent&&(M!=null&&M.parentId)&&(N!=null&&N.position)),A={id:C,type:"position",position:k?{x:Math.max(0,N.position.x),y:Math.max(0,N.position.y)}:N.position,dragging:x};k&&M.parentId&&b.push({id:C,parentId:M.parentId,rect:{...N.internals.positionAbsolute,width:N.measured.width??0,height:N.measured.height??0}}),S.push(A)}if(b.length>0){const{parentLookup:C,nodeOrigin:N}=g(),M=Wr(b,m,C,N);S.push(...M)}w(S)},triggerNodeChanges:p=>{const{onNodesChange:x,setNodes:b,nodes:S,hasDefaultNodes:m,debug:w}=g();if(p!=null&&p.length){if(m){const C=Pi(p,S);b(C)}w&&console.log("React Flow: trigger node changes",p),x==null||x(p)}},triggerEdgeChanges:p=>{const{onEdgesChange:x,setEdges:b,edges:S,hasDefaultEdges:m,debug:w}=g();if(p!=null&&p.length){if(m){const C=Ii(p,S);b(C)}w&&console.log("React Flow: trigger edge changes",p),x==null||x(p)}},addSelectedNodes:p=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:S,triggerNodeChanges:m,triggerEdgeChanges:w}=g();if(x){const C=p.map(N=>Ge(N,!0));m(C);return}m(lt(S,new Set([...p]),!0)),w(lt(b))},addSelectedEdges:p=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:S,triggerNodeChanges:m,triggerEdgeChanges:w}=g();if(x){const C=p.map(N=>Ge(N,!0));w(C);return}w(lt(b,new Set([...p]))),m(lt(S,new Set,!0))},unselectNodesAndEdges:({nodes:p,edges:x}={})=>{const{edges:b,nodes:S,nodeLookup:m,triggerNodeChanges:w,triggerEdgeChanges:C}=g(),N=p||S,M=x||b,k=N.map(H=>{const R=m.get(H.id);return R&&(R.selected=!1),Ge(H.id,!1)}),A=M.map(H=>Ge(H.id,!1));w(k),C(A)},setMinZoom:p=>{const{panZoom:x,maxZoom:b}=g();x==null||x.setScaleExtent([p,b]),f({minZoom:p})},setMaxZoom:p=>{const{panZoom:x,minZoom:b}=g();x==null||x.setScaleExtent([b,p]),f({maxZoom:p})},setTranslateExtent:p=>{var x;(x=g().panZoom)==null||x.setTranslateExtent(p),f({translateExtent:p})},setPaneClickDistance:p=>{var x;(x=g().panZoom)==null||x.setClickDistance(p)},resetSelectedElements:()=>{const{edges:p,nodes:x,triggerNodeChanges:b,triggerEdgeChanges:S,elementsSelectable:m}=g();if(!m)return;const w=x.reduce((N,M)=>M.selected?[...N,Ge(M.id,!1)]:N,[]),C=p.reduce((N,M)=>M.selected?[...N,Ge(M.id,!1)]:N,[]);b(w),S(C)},setNodeExtent:p=>{const{nodes:x,nodeLookup:b,parentLookup:S,nodeOrigin:m,elevateNodesOnSelect:w,nodeExtent:C}=g();p[0][0]===C[0][0]&&p[0][1]===C[0][1]&&p[1][0]===C[1][0]&&p[1][1]===C[1][1]||(Nr(x,b,S,{nodeOrigin:m,nodeExtent:p,elevateNodesOnSelect:w,checkEquality:!1}),f({nodeExtent:p}))},panBy:p=>{const{transform:x,width:b,height:S,panZoom:m,translateExtent:w}=g();return eh({delta:p,panZoom:m,transform:x,translateExtent:w,width:b,height:S})},setCenter:async(p,x,b)=>{const{width:S,height:m,maxZoom:w,panZoom:C}=g();if(!C)return Promise.resolve(!1);const N=typeof(b==null?void 0:b.zoom)<"u"?b.zoom:w;return await C.setViewport({x:S/2-p*N,y:m/2-x*N,zoom:N},{duration:b==null?void 0:b.duration,ease:b==null?void 0:b.ease,interpolate:b==null?void 0:b.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{f({connection:{...Js}})},updateConnection:p=>{f({connection:p})},reset:()=>f({...is()})}},Object.is);function Ur({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:s,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:c,fitView:l,nodeOrigin:u,nodeExtent:h,children:f}){const[g]=I.useState(()=>om({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:l,minZoom:i,maxZoom:a,fitViewOptions:c,nodeOrigin:u,nodeExtent:h}));return d.jsx(kh,{value:g,children:d.jsx(qh,{children:f})})}function sm({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:s,height:i,fitView:a,fitViewOptions:c,minZoom:l,maxZoom:u,nodeOrigin:h,nodeExtent:f}){return I.useContext(Yn)?d.jsx(d.Fragment,{children:e}):d.jsx(Ur,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:s,initialHeight:i,fitView:a,initialFitViewOptions:c,initialMinZoom:l,initialMaxZoom:u,nodeOrigin:h,nodeExtent:f,children:e})}const im={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function am({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:h,onMoveEnd:f,onConnect:g,onConnectStart:y,onConnectEnd:p,onClickConnectStart:x,onClickConnectEnd:b,onNodeMouseEnter:S,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:N,onNodeDragStart:M,onNodeDrag:k,onNodeDragStop:A,onNodesDelete:H,onEdgesDelete:R,onDelete:$,onSelectionChange:D,onSelectionDragStart:v,onSelectionDrag:P,onSelectionDragStop:j,onSelectionContextMenu:E,onSelectionStart:_,onSelectionEnd:z,onBeforeDelete:T,connectionMode:V,connectionLineType:L=ke.Bezier,connectionLineStyle:O,connectionLineComponent:B,connectionLineContainerStyle:q,deleteKeyCode:Z="Backspace",selectionKeyCode:X="Shift",selectionOnDrag:F=!1,selectionMode:U=Bt.Full,panActivationKeyCode:ee="Space",multiSelectionKeyCode:te=Xt()?"Meta":"Control",zoomActivationKeyCode:K=Xt()?"Meta":"Control",snapToGrid:Q,snapGrid:J,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:ae,nodesDraggable:be,autoPanOnNodeFocus:nt,nodesConnectable:tn,nodesFocusable:nn,nodeOrigin:rn=Mi,edgesFocusable:kt,edgesReconnectable:Et,elementsSelectable:Zn=!0,defaultViewport:on=Lh,minZoom:rt=.5,maxZoom:_t=2,translateExtent:Kr=Ft,preventScrolling:_a=!0,nodeExtent:Qn,defaultMarkerColor:Ma="#b1b1b7",zoomOnScroll:za=!0,zoomOnPinch:Pa=!0,panOnScroll:Ia=!1,panOnScrollSpeed:Aa=.5,panOnScrollMode:$a=Ke.Free,zoomOnDoubleClick:Ta=!0,panOnDrag:Da=!0,onPaneClick:Va,onPaneMouseEnter:Ra,onPaneMouseMove:La,onPaneMouseLeave:Ha,onPaneScroll:Fa,onPaneContextMenu:Ba,paneClickDistance:Zr=0,nodeClickDistance:Oa=0,children:Xa,onReconnect:Ya,onReconnectStart:Wa,onReconnectEnd:Ga,onEdgeContextMenu:Ua,onEdgeDoubleClick:qa,onEdgeMouseEnter:Ka,onEdgeMouseMove:Za,onEdgeMouseLeave:Qa,reconnectRadius:Ja=10,onNodesChange:ec,onEdgesChange:tc,noDragClassName:nc="nodrag",noWheelClassName:rc="nowheel",noPanClassName:Qr="nopan",fitView:Jr,fitViewOptions:eo,connectOnClick:oc,attributionPosition:sc,proOptions:ic,defaultEdgeOptions:ac,elevateNodesOnSelect:cc,elevateEdgesOnSelect:lc,disableKeyboardA11y:to=!1,autoPanOnConnect:dc,autoPanOnNodeDrag:uc,autoPanSpeed:fc,connectionRadius:hc,isValidConnection:gc,onError:mc,style:pc,id:no,nodeDragThreshold:xc,connectionDragThreshold:yc,viewport:bc,onViewportChange:wc,width:vc,height:Nc,colorMode:Sc="light",debug:Cc,onScroll:sn,ariaLabelConfig:jc,...kc},Ec){const Jn=no||"1",_c=Oh(Sc),Mc=I.useCallback(ro=>{ro.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),sn==null||sn(ro)},[sn]);return d.jsx("div",{"data-testid":"rf__wrapper",...kc,onScroll:Mc,style:{...pc,...im},ref:Ec,className:de(["react-flow",o,_c]),id:no,role:"application",children:d.jsxs(sm,{nodes:e,edges:t,width:vc,height:Nc,fitView:Jr,fitViewOptions:eo,minZoom:rt,maxZoom:_t,nodeOrigin:rn,nodeExtent:Qn,children:[d.jsx(rm,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:S,onNodeMouseMove:m,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:N,nodeTypes:s,edgeTypes:i,connectionLineType:L,connectionLineStyle:O,connectionLineComponent:B,connectionLineContainerStyle:q,selectionKeyCode:X,selectionOnDrag:F,selectionMode:U,deleteKeyCode:Z,multiSelectionKeyCode:te,panActivationKeyCode:ee,zoomActivationKeyCode:K,onlyRenderVisibleElements:se,defaultViewport:on,translateExtent:Kr,minZoom:rt,maxZoom:_t,preventScrolling:_a,zoomOnScroll:za,zoomOnPinch:Pa,zoomOnDoubleClick:Ta,panOnScroll:Ia,panOnScrollSpeed:Aa,panOnScrollMode:$a,panOnDrag:Da,onPaneClick:Va,onPaneMouseEnter:Ra,onPaneMouseMove:La,onPaneMouseLeave:Ha,onPaneScroll:Fa,onPaneContextMenu:Ba,paneClickDistance:Zr,nodeClickDistance:Oa,onSelectionContextMenu:E,onSelectionStart:_,onSelectionEnd:z,onReconnect:Ya,onReconnectStart:Wa,onReconnectEnd:Ga,onEdgeContextMenu:Ua,onEdgeDoubleClick:qa,onEdgeMouseEnter:Ka,onEdgeMouseMove:Za,onEdgeMouseLeave:Qa,reconnectRadius:Ja,defaultMarkerColor:Ma,noDragClassName:nc,noWheelClassName:rc,noPanClassName:Qr,rfId:Jn,disableKeyboardA11y:to,nodeExtent:Qn,viewport:bc,onViewportChange:wc}),d.jsx(Bh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:g,onConnectStart:y,onConnectEnd:p,onClickConnectStart:x,onClickConnectEnd:b,nodesDraggable:be,autoPanOnNodeFocus:nt,nodesConnectable:tn,nodesFocusable:nn,edgesFocusable:kt,edgesReconnectable:Et,elementsSelectable:Zn,elevateNodesOnSelect:cc,elevateEdgesOnSelect:lc,minZoom:rt,maxZoom:_t,nodeExtent:Qn,onNodesChange:ec,onEdgesChange:tc,snapToGrid:Q,snapGrid:J,connectionMode:V,translateExtent:Kr,connectOnClick:oc,defaultEdgeOptions:ac,fitView:Jr,fitViewOptions:eo,onNodesDelete:H,onEdgesDelete:R,onDelete:$,onNodeDragStart:M,onNodeDrag:k,onNodeDragStop:A,onSelectionDrag:P,onSelectionDragStart:v,onSelectionDragStop:j,onMove:u,onMoveStart:h,onMoveEnd:f,noPanClassName:Qr,nodeOrigin:rn,rfId:Jn,autoPanOnConnect:dc,autoPanOnNodeDrag:uc,autoPanSpeed:fc,onError:mc,connectionRadius:hc,isValidConnection:gc,selectNodesOnDrag:ae,nodeDragThreshold:xc,connectionDragThreshold:yc,onBeforeDelete:T,paneClickDistance:Zr,debug:Cc,ariaLabelConfig:jc}),d.jsx(Rh,{onSelectionChange:D}),Xa,d.jsx(Ah,{proOptions:ic,position:sc}),d.jsx(Ih,{rfId:Jn,disableKeyboardA11y:to})]})})}var ra=Ai(am);function cm({onChange:e}){const t=ie();I.useEffect(()=>{const n=[...t.getState().onSelectionChangeHandlers,e];return t.setState({onSelectionChangeHandlers:n}),()=>{const r=t.getState().onSelectionChangeHandlers.filter(o=>o!==e);t.setState({onSelectionChangeHandlers:r})}},[e])}function lm({dimensions:e,lineWidth:t,variant:n,className:r}){return d.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:de(["react-flow__background-pattern",n,r])})}function dm({radius:e,className:t}){return d.jsx("circle",{cx:e,cy:e,r:e,className:de(["react-flow__background-pattern","dots",t])})}var Fe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Fe||(Fe={}));const um={[Fe.Dots]:1,[Fe.Lines]:1,[Fe.Cross]:6},fm=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function oa({id:e,variant:t=Fe.Dots,gap:n=20,size:r,lineWidth:o=1,offset:s=0,color:i,bgColor:a,style:c,className:l,patternClassName:u}){const h=I.useRef(null),{transform:f,patternId:g}=re(fm,ce),y=r||um[t],p=t===Fe.Dots,x=t===Fe.Cross,b=Array.isArray(n)?n:[n,n],S=[b[0]*f[2]||1,b[1]*f[2]||1],m=y*f[2],w=Array.isArray(s)?s:[s,s],C=x?[m,m]:S,N=[w[0]*f[2]||1+C[0]/2,w[1]*f[2]||1+C[1]/2],M=`${g}${e||""}`;return d.jsxs("svg",{className:de(["react-flow__background",l]),style:{...c,...Un,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:h,"data-testid":"rf__background",children:[d.jsx("pattern",{id:M,x:f[0]%S[0],y:f[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${N[0]},-${N[1]})`,children:p?d.jsx(dm,{radius:m/2,className:u}):d.jsx(lm,{dimensions:C,lineWidth:o,variant:t,className:u})}),d.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${M})`})]})}oa.displayName="Background";const sa=I.memo(oa);function hm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:d.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function gm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:d.jsx("path",{d:"M0 0h32v4.2H0z"})})}function mm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:d.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function pm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:d.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function xm(){return d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:d.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function mn({children:e,className:t,...n}){return d.jsx("button",{type:"button",className:de(["react-flow__controls-button",t]),...n,children:e})}const ym=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ia({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:c,className:l,children:u,position:h="bottom-left",orientation:f="vertical","aria-label":g}){const y=ie(),{isInteractive:p,minZoomReached:x,maxZoomReached:b,ariaLabelConfig:S}=re(ym,ce),{zoomIn:m,zoomOut:w,fitView:C}=Gn(),N=()=>{m(),s==null||s()},M=()=>{w(),i==null||i()},k=()=>{C(o),a==null||a()},A=()=>{y.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),c==null||c(!p)},H=f==="horizontal"?"horizontal":"vertical";return d.jsxs(Wn,{className:de(["react-flow__controls",H,l]),position:h,style:e,"data-testid":"rf__controls","aria-label":g??S["controls.ariaLabel"],children:[t&&d.jsxs(d.Fragment,{children:[d.jsx(mn,{onClick:N,className:"react-flow__controls-zoomin",title:S["controls.zoomIn.ariaLabel"],"aria-label":S["controls.zoomIn.ariaLabel"],disabled:b,children:d.jsx(hm,{})}),d.jsx(mn,{onClick:M,className:"react-flow__controls-zoomout",title:S["controls.zoomOut.ariaLabel"],"aria-label":S["controls.zoomOut.ariaLabel"],disabled:x,children:d.jsx(gm,{})})]}),n&&d.jsx(mn,{className:"react-flow__controls-fitview",onClick:k,title:S["controls.fitView.ariaLabel"],"aria-label":S["controls.fitView.ariaLabel"],children:d.jsx(mm,{})}),r&&d.jsx(mn,{className:"react-flow__controls-interactive",onClick:A,title:S["controls.interactive.ariaLabel"],"aria-label":S["controls.interactive.ariaLabel"],children:p?d.jsx(xm,{}):d.jsx(pm,{})}),u]})}ia.displayName="Controls";const aa=I.memo(ia);function bm({id:e,x:t,y:n,width:r,height:o,style:s,color:i,strokeColor:a,strokeWidth:c,className:l,borderRadius:u,shapeRendering:h,selected:f,onClick:g}){const{background:y,backgroundColor:p}=s||{},x=i||y||p;return d.jsx("rect",{className:de(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:o,style:{fill:x,stroke:a,strokeWidth:c},shapeRendering:h,onClick:g?b=>g(b,e):void 0})}const wm=I.memo(bm),vm=e=>e.nodes.map(t=>t.id),cr=e=>e instanceof Function?e:()=>e;function Nm({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:s=wm,onClick:i}){const a=re(vm,ce),c=cr(t),l=cr(e),u=cr(n),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return d.jsx(d.Fragment,{children:a.map(f=>d.jsx(Cm,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:s,onClick:i,shapeRendering:h},f))})}function Sm({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:c}){const{node:l,x:u,y:h,width:f,height:g}=re(y=>{const{internals:p}=y.nodeLookup.get(e),x=p.userNode,{x:b,y:S}=p.positionAbsolute,{width:m,height:w}=Ve(x);return{node:x,x:b,y:S,width:m,height:w}},ce);return!l||l.hidden||!ii(l)?null:d.jsx(a,{x:u,y:h,width:f,height:g,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:o,strokeColor:n(l),strokeWidth:s,shapeRendering:i,onClick:c,id:l.id})}const Cm=I.memo(Sm);var jm=I.memo(Nm);const km=200,Em=150,_m=e=>!e.hidden,Mm=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?si(Qt(e.nodeLookup,{filter:_m}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},zm="react-flow__minimap-desc";function ca({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:h,position:f="bottom-right",onClick:g,onNodeClick:y,pannable:p=!1,zoomable:x=!1,ariaLabel:b,inversePan:S,zoomStep:m=1,offsetScale:w=5}){const C=ie(),N=I.useRef(null),{boundingRect:M,viewBB:k,rfId:A,panZoom:H,translateExtent:R,flowWidth:$,flowHeight:D,ariaLabelConfig:v}=re(Mm,ce),P=(e==null?void 0:e.width)??km,j=(e==null?void 0:e.height)??Em,E=M.width/P,_=M.height/j,z=Math.max(E,_),T=z*P,V=z*j,L=w*z,O=M.x-(T-M.width)/2-L,B=M.y-(V-M.height)/2-L,q=T+L*2,Z=V+L*2,X=`${zm}-${A}`,F=I.useRef(0),U=I.useRef();F.current=z,I.useEffect(()=>{if(N.current&&H)return U.current=lh({domNode:N.current,panZoom:H,getTransform:()=>C.getState().transform,getViewScale:()=>F.current}),()=>{var Q;(Q=U.current)==null||Q.destroy()}},[H]),I.useEffect(()=>{var Q;(Q=U.current)==null||Q.update({translateExtent:R,width:$,height:D,inversePan:S,pannable:p,zoomStep:m,zoomable:x})},[p,x,S,m,R,$,D]);const ee=g?Q=>{var ae;const[J,se]=((ae=U.current)==null?void 0:ae.pointer(Q))||[0,0];g(Q,{x:J,y:se})}:void 0,te=y?I.useCallback((Q,J)=>{const se=C.getState().nodeLookup.get(J).internals.userNode;y(Q,se)},[]):void 0,K=b??v["minimap.ariaLabel"];return d.jsx(Wn,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof h=="number"?h*z:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:de(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:d.jsxs("svg",{width:P,height:j,viewBox:`${O} ${B} ${q} ${Z}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":X,ref:N,onClick:ee,children:[K&&d.jsx("title",{id:X,children:K}),d.jsx(jm,{onClick:te,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:a}),d.jsx("path",{className:"react-flow__minimap-mask",d:`M${O-L},${B-L}h${q+L*2}v${Z+L*2}h${-q-L*2}z
        M${k.x},${k.y}h${k.width}v${k.height}h${-k.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}ca.displayName="MiniMap";const la=I.memo(ca),Pm=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Im={[Nt.Line]:"right",[Nt.Handle]:"bottom-right"};function Am({nodeId:e,position:t,variant:n=Nt.Handle,className:r,style:o=void 0,children:s,color:i,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:h=!1,resizeDirection:f,autoScale:g=!0,shouldResize:y,onResizeStart:p,onResize:x,onResizeEnd:b}){const S=Vi(),m=typeof e=="string"?e:S,w=ie(),C=I.useRef(null),N=n===Nt.Handle,M=re(I.useCallback(Pm(N&&g),[N,g]),ce),k=I.useRef(null),A=t??Im[n];I.useEffect(()=>{if(!(!C.current||!m))return k.current||(k.current=jh({domNode:C.current,nodeId:m,getStoreItems:()=>{const{nodeLookup:R,transform:$,snapGrid:D,snapToGrid:v,nodeOrigin:P,domNode:j}=w.getState();return{nodeLookup:R,transform:$,snapGrid:D,snapToGrid:v,nodeOrigin:P,paneDomNode:j}},onChange:(R,$)=>{const{triggerNodeChanges:D,nodeLookup:v,parentLookup:P,nodeOrigin:j}=w.getState(),E=[],_={x:R.x,y:R.y},z=v.get(m);if(z&&z.expandParent&&z.parentId){const T=z.origin??j,V=R.width??z.measured.width??0,L=R.height??z.measured.height??0,O={id:z.id,parentId:z.parentId,rect:{width:V,height:L,...ai({x:R.x??z.position.x,y:R.y??z.position.y},{width:V,height:L},z.parentId,v,T)}},B=Wr([O],v,P,j);E.push(...B),_.x=R.x?Math.max(T[0]*V,R.x):void 0,_.y=R.y?Math.max(T[1]*L,R.y):void 0}if(_.x!==void 0&&_.y!==void 0){const T={id:m,type:"position",position:{..._}};E.push(T)}if(R.width!==void 0&&R.height!==void 0){const V={id:m,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:R.width,height:R.height}};E.push(V)}for(const T of $){const V={...T,type:"position"};E.push(V)}D(E)},onEnd:({width:R,height:$})=>{const D={id:m,type:"dimensions",resizing:!1,dimensions:{width:R,height:$}};w.getState().triggerNodeChanges([D])}})),k.current.update({controlPosition:A,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:h,resizeDirection:f,onResizeStart:p,onResize:x,onResizeEnd:b,shouldResize:y}),()=>{var R;(R=k.current)==null||R.destroy()}},[A,a,c,l,u,h,p,x,b,y]);const H=A.split("-");return d.jsx("div",{className:de(["react-flow__resize-control","nodrag",...H,n,r]),ref:C,style:{...o,scale:M,...i&&{[N?"backgroundColor":"borderColor"]:i}},children:s})}I.memo(Am);const Se=e=>e.type==="scene",Ze=e=>e.type==="choice",Dn=24,as=(e,t=Dn)=>Math.round(e/t)*t,jr=e=>({x:as(e.x),y:as(e.y)}),Gt="scene_start",cs=e=>`${e}_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,9)}`,ls=()=>[{id:Gt,type:"scene",position:jr({x:250,y:250}),data:{label:"Start",durationSec:5},deletable:!1}],oe=Ut()(ps((e,t)=>({nodes:ls(),edges:[],selectedNodeId:null,onNodesChange:n=>e(r=>({nodes:Pi(n,r.nodes)})),onEdgesChange:n=>e(r=>({edges:Ii(n,r.edges)})),addConnection:n=>e(r=>({edges:gi(n,r.edges)})),addChoiceNode:()=>e(n=>{const o={id:cs("choice"),type:"choice",position:jr({x:0,y:0}),data:{label:`Choice ${n.nodes.filter(s=>s.type==="choice").length+1}`,effects:{}}};return{nodes:[...n.nodes,o],edges:n.edges,selectedNodeId:o.id}}),selectNode:n=>e(r=>r.selectedNodeId===n?r:{selectedNodeId:n}),updateNode:(n,r)=>e(o=>({nodes:o.nodes.map(s=>s.id===n?{...s,data:{...s.data,...r}}:s)})),deleteNode:n=>{n!==Gt&&e(r=>{const o=r.nodes.find(a=>a.id===n);if(!o)return r;const s=[n],i=new Set;return r.edges.forEach(a=>{(a.source===n||a.target===n)&&i.add(a.id)}),Se(o)&&r.nodes.forEach(a=>{Ze(a)&&(r.edges.filter(l=>(l.source===a.id||l.target===a.id)&&!i.has(l.id)).length>=2||(s.push(a.id),r.edges.forEach(l=>{(l.source===a.id||l.target===a.id)&&i.add(l.id)})))}),{nodes:r.nodes.filter(a=>!s.includes(a.id)),edges:r.edges.filter(a=>!i.has(a.id)),selectedNodeId:s.includes(r.selectedNodeId||"")?null:r.selectedNodeId}})},addSceneNode:()=>e(n=>{const r=n.nodes.reduce((s,i)=>Math.max(s,i.position.y),250),o={id:cs("scene"),type:"scene",position:jr({x:400,y:r+100}),data:{label:`Scene ${n.nodes.filter(s=>s.type==="scene").length}`,durationSec:5}};return{nodes:[...n.nodes,o],selectedNodeId:o.id}}),getNode:n=>t().nodes.find(r=>r.id===n),getChoicesForScene:n=>{const r=t();return r.edges.filter(s=>s.source===n).map(s=>r.nodes.find(i=>i.id===s.target)).filter(s=>!!s&&Ze(s))},loadNodes:n=>e({nodes:n,selectedNodeId:null}),loadEdges:n=>e({edges:n}),reset:()=>e({nodes:ls(),edges:[],selectedNodeId:null})}),{name:"flow-storage",partialize:e=>({nodes:e.nodes,edges:e.edges})})),$m=(e,t)=>{var n;return(n=e.find(r=>r.name===t))==null?void 0:n.value},da=(e,t)=>{let n=t;return typeof e.min=="number"&&(n=Math.max(n,e.min)),typeof e.max=="number"&&(n=Math.min(n,e.max)),n},Tm=(e,t)=>{const n=$m(t,e.varName);if(typeof n!="number")return!1;switch(e.op){case"lt":return n<e.value;case"lte":return n<=e.value;case"eq":return n===e.value;case"neq":return n!==e.value;case"gte":return n>=e.value;case"gt":return n>e.value;default:return!0}},$t=(e,t)=>!e||e.length===0?!0:e.every(n=>Tm(n,t)),Dm=e=>{const t={lt:"<",lte:"≤",eq:"=",neq:"≠",gte:"≥",gt:">"}[e.op];return`${e.varName} ${t} ${e.value}`},Vm=(e,t)=>t.map(n=>{const r=e[n.name]??0;if(r===0)return n;const o=da(n,n.value+r);return{...n,value:o}}),ds=[{name:"health",value:10,initialValue:10},{name:"energy",value:5,initialValue:5}],me=Ut()(ps(e=>({variables:ds,updateVariable:(t,n)=>e(r=>({variables:r.variables.map(o=>o.name===t?{...o,value:da(o,n)}:o)})),addVariable:t=>e(n=>({variables:[...n.variables,{name:t,value:0,initialValue:0}]})),removeVariable:t=>e(n=>({variables:n.variables.filter(r=>r.name!==t)})),reset:()=>e({variables:ds}),loadVariables:t=>e({variables:t})}),{name:"variables-storage"})),Be=Ut((e,t)=>({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,isPlaying:!1,currentTime:0,duration:0,volume:50,isLoading:!1,setCurrentVideo:(n,r)=>{const o=t();if(o.currentVideoUrl&&URL.revokeObjectURL(o.currentVideoUrl),!r){e({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,currentTime:0,duration:0,isPlaying:!1});return}const s=URL.createObjectURL(r);e({currentVideoId:n,currentVideoFile:r,currentVideoUrl:s,currentTime:0,isPlaying:!1})},setIsPlaying:n=>e({isPlaying:n}),setCurrentTime:n=>e({currentTime:n}),setDuration:n=>e({duration:n}),setVolume:n=>e({volume:n}),setIsLoading:n=>e({isLoading:n}),clearCurrentVideo:()=>{const n=t();n.currentVideoUrl&&URL.revokeObjectURL(n.currentVideoUrl),e({currentVideoId:null,currentVideoFile:null,currentVideoUrl:null,currentTime:0,duration:0,isPlaying:!1})}})),Te=Ut((e,t)=>({projectTitle:"Untitled Project",createdAt:new Date().toISOString(),lastSaved:null,isDirty:!1,setProjectTitle:n=>e({projectTitle:n,isDirty:!0}),markAsSaved:()=>e({lastSaved:new Date,isDirty:!1}),markAsDirty:()=>e({isDirty:!0}),exportProject:()=>{const n=oe.getState(),r=me.getState(),{projectTitle:o,createdAt:s}=t();return{title:o,nodes:n.nodes,edges:n.edges,variables:r.variables,version:"1.0.0",createdAt:s,updatedAt:new Date().toISOString()}},importProject:n=>{oe.getState().loadNodes(n.nodes),oe.getState().loadEdges(n.edges),me.getState().loadVariables(n.variables),e({projectTitle:n.title,createdAt:n.createdAt??new Date().toISOString(),lastSaved:null,isDirty:!1})},newProject:()=>{oe.getState().reset(),me.getState().reset(),Be.getState().clearCurrentVideo(),e({projectTitle:"Untitled Project",createdAt:new Date().toISOString(),lastSaved:null,isDirty:!1})}}));class it{static exportProject(){return Te.getState().exportProject()}static downloadProject(t){var a,c;const n=JSON.stringify(t,null,2),r=new Blob([n],{type:"application/json"}),o=URL.createObjectURL(r),s=(c=(a=t.title)==null?void 0:a.trim())!=null&&c.length?t.title.replace(/\s+/g,"_"):"project",i=document.createElement("a");i.href=o,i.download=`${s}_${Date.now()}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)}static async importProject(t){this.validateProjectData(t),Te.getState().importProject(t)}static async loadProjectFromFile(t){return new Promise((n,r)=>{const o=new FileReader;o.onload=s=>{var i;try{const a=(i=s.target)==null?void 0:i.result,c=JSON.parse(a);n(c)}catch{r(new Error("Nieprawidłowy format pliku projektu"))}},o.onerror=()=>r(new Error("Błąd odczytu pliku")),o.readAsText(t)})}static createNewProject(){Te.getState().newProject()}static async getProjectMetadata(t){const n=await this.loadProjectFromFile(t);return{title:n.title,version:n.version,createdAt:n.createdAt||"Nieznana",updatedAt:n.updatedAt||"Nieznana",nodeCount:n.nodes.length,edgeCount:n.edges.length}}static validateProjectData(t){if(!t.title||typeof t.title!="string")throw new Error("Nieprawidłowy projekt: brak tytułu");if(!Array.isArray(t.nodes))throw new Error("Nieprawidłowy projekt: nodes musi być tablicą");if(!Array.isArray(t.edges))throw new Error("Nieprawidłowy projekt: edges musi być tablicą");if(!Array.isArray(t.variables))throw new Error("Nieprawidłowy projekt: variables musi być tablicą");if(t.version&&!this.isVersionCompatible(t.version))throw new Error(`Niezgodna wersja projektu: ${t.version}`)}static isVersionCompatible(t){const[n]=t.split("."),[r]=this.CURRENT_VERSION.split(".");return n===r}}it.CURRENT_VERSION="1.0.0";const ua=(e={})=>{const[t,n]=I.useState(!1),[r,o]=I.useState(!1),s=I.useRef(null),i=Te(f=>f.projectTitle),a=I.useCallback(async()=>{var f;try{o(!0);const g=it.exportProject();it.downloadProject(g),(f=e.onExportSuccess)==null||f.call(e)}catch(g){console.error("Błąd eksportu:",g)}finally{o(!1)}},[e]),c=I.useCallback(async f=>{var g,y;try{n(!0);const p=await it.loadProjectFromFile(f);await it.importProject(p),(g=e.onImportSuccess)==null||g.call(e,p)}catch(p){console.error("Błąd importu:",p),(y=e.onImportError)==null||y.call(e,p)}finally{n(!1)}},[e]),l=I.useCallback(f=>{var y;const g=(y=f.target.files)==null?void 0:y[0];g&&c(g),s.current&&(s.current.value="")},[c]),u=I.useCallback(()=>{var f;(f=s.current)==null||f.click()},[]),h=I.useCallback(()=>e.confirmNewProject&&!confirm("Utworzyć nowy projekt? Niezapisane zmiany zostaną utracone.")?!1:(it.createNewProject(),!0),[e.confirmNewProject]);return{fileInputRef:s,isImporting:t,isExporting:r,projectTitle:i,handleExport:a,handleImport:c,handleFileSelect:l,triggerImport:u,createNewProject:h}},Rm=()=>d.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",className:"group-hover:scale-105 transition-transform",children:[d.jsx("rect",{x:"4",y:"8",width:"24",height:"16",fill:"#E84E36",rx:"1"}),d.jsx("rect",{x:"7",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"11",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"15",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"19",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"23",y:"10",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"7",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"11",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"15",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"19",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"23",y:"19",width:"2",height:"3",fill:"#1a1a1a"}),d.jsx("rect",{x:"8",y:"14.5",width:"4",height:"3",fill:"white",opacity:"0.9"}),d.jsx("rect",{x:"14",y:"14.5",width:"4",height:"3",fill:"white",opacity:"0.9"}),d.jsx("rect",{x:"20",y:"14.5",width:"4",height:"3",fill:"white",opacity:"0.9"})]}),Lm=({tabs:e})=>{const t=zr(),n=e.find(r=>r.path===t.pathname)||e[0];return d.jsx("div",{className:"flex h-full",children:e.map(r=>d.jsxs(zc,{to:r.path,className:`h-full px-8 flex items-center gap-3 transition-all border-r border-[#0a0a0a] ${n.id===r.id?"bg-[#1a1a1a] text-[#E84E36] border-b-2 border-b-[#E84E36]":"bg-transparent text-[#666] border-b-2 border-b-transparent"}`,children:[d.jsx(r.icon,{className:"w-5 h-5"}),d.jsx("span",{className:"font-medium text-sm",children:r.label})]},r.id))})},Hm=()=>{const e=zr(),t=Pr(),n=Te(p=>p.projectTitle),r=Te(p=>p.setProjectTitle),{fileInputRef:o,isImporting:s,isExporting:i,handleExport:a,handleFileSelect:c,triggerImport:l,createNewProject:u}=ua({confirmNewProject:!0,onImportSuccess:p=>{alert(`Projekt "${p.title}" został wczytany pomyślnie!`)},onImportError:p=>{alert(`Błąd wczytywania projektu: ${p.message}`)},onExportSuccess:()=>{console.log("Projekt wyeksportowany pomyślnie")}}),h=()=>{u()},f=()=>{a()},g=[{id:"storymap",path:"/storymap",label:"Story Map",icon:ys},{id:"story",path:"/story",label:"Screen Play",icon:oo},{id:"variables",path:"/variables",label:"Variables",icon:oo},{id:"video",path:"/video",label:"Video",icon:gt},{id:"play",path:"/play",label:"Play",icon:Vc}],y=g.find(p=>p.path===e.pathname)||g[0];return d.jsx(Ur,{children:d.jsxs("div",{className:"h-screen flex flex-col bg-zinc-900 select-none",children:[d.jsx("header",{className:"flex-shrink-0 h-10 bg-gradient-to-b from-zinc-950 to-zinc-900 border-b border-zinc-900",children:d.jsxs("div",{className:"h-full flex items-center",children:[d.jsx("button",{onClick:()=>t("/"),className:"px-3 h-full flex items-center border-r border-zinc-900 hover:bg-zinc-800 transition-colors group",title:"Go to Projects",children:d.jsx(Rm,{})}),d.jsx("div",{className:"flex items-center h-full",children:["File","Edit","Timeline","Workspace","Help"].map(p=>d.jsx("button",{className:"px-4 h-full hover:bg-zinc-800 text-sm text-zinc-400",children:p},p))}),d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsx("input",{type:"text",value:n,onChange:p=>r(p.target.value),className:"bg-transparent text-center font-medium text-zinc-200 text-[13px] outline-none border-none"})}),d.jsx("div",{className:"flex items-center gap-2 px-3",children:d.jsx("button",{onClick:h,className:"p-1.5 hover:bg-zinc-800 rounded",title:"New project",children:d.jsx(ht,{className:"w-4 h-4 text-zinc-400"})})})]})}),d.jsxs("div",{className:"h-12 bg-zinc-800 border-b border-zinc-900 flex items-center",children:[d.jsx(Lm,{tabs:g}),d.jsx("div",{className:"flex-1 flex items-center justify-end px-4 gap-2",children:y.id!=="projects"&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:l,disabled:s,className:"px-3 py-1.5 text-xs font-medium bg-zinc-800 text-zinc-400 border border-zinc-700 transition-colors hover:bg-zinc-700 hover:text-white disabled:opacity-50 flex items-center gap-2",children:[d.jsx(jn,{className:"w-3 h-3"}),s?"Importing...":"Import"]}),d.jsx("input",{ref:o,type:"file",accept:".json",onChange:c,className:"hidden"}),d.jsxs("button",{onClick:f,disabled:i,className:"px-3 py-1.5 text-xs font-medium bg-zinc-800 text-zinc-400 border border-zinc-700 transition-colors hover:bg-zinc-700 hover:text-white disabled:opacity-50 flex items-center gap-2",children:[d.jsx(xs,{className:"w-3 h-3"}),i?"Exporting...":"Export"]})]})})]}),d.jsx("div",{className:"flex-1 overflow-hidden",children:d.jsx(Pc,{})})]})})};class $e{constructor(){this.root=null,this.videosDir=null,this.metadataCache=new Map,this.subscribers=new Set}static getInstance(){return $e.instance||($e.instance=new $e),$e.instance}subscribe(t){return this.subscribers.add(t),()=>this.subscribers.delete(t)}notify(){this.subscribers.forEach(t=>{try{t()}catch{}})}async initialize(){try{return!("storage"in navigator)||!("getDirectory"in navigator.storage)?(console.warn("OPFS not supported"),!1):(this.root=await navigator.storage.getDirectory(),this.videosDir=await this.root.getDirectoryHandle("videos",{create:!0}),await this.loadMetadata(),!0)}catch(t){return console.error("Failed to initialize OPFS:",t),!1}}async storeVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");const n=`video-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=t.name.includes(".")?t.name.split(".").pop().toLowerCase():"bin",o=`${n}.${r}`;try{const i=await(await this.videosDir.getFileHandle(o,{create:!0})).createWritable();await i.write(t),await i.close();const a={id:n,fileName:t.name,fileSize:t.size,lastModified:t.lastModified,mimeType:t.type,storedFileName:o};return await this.saveMetadata(n,a),this.metadataCache.set(n,a),this.generateThumbnails(n,t).catch(console.error),this.notify(),n}catch(s){throw console.error("Failed to store video:",s),s}}async retrieveVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");try{const n=this.metadataCache.get(t);if(!n)return console.warn("No metadata found for video:",t),null;const o=await(await this.videosDir.getFileHandle(n.storedFileName)).getFile();return new File([o],n.fileName,{type:n.mimeType})}catch(n){return console.error("Failed to retrieve video:",n),null}}async deleteVideo(t){if(!this.videosDir)throw new Error("Storage not initialized");try{const n=this.metadataCache.get(t),r=(n==null?void 0:n.storedFileName)??`${t}.mp4`;await this.videosDir.removeEntry(r).catch(()=>{}),await this.videosDir.removeEntry(`${t}.json`).catch(()=>{});const o=await this.videosDir.getDirectoryHandle("thumbnails",{create:!1}).catch(()=>null);if(o)for await(const[s]of o.entries())typeof s=="string"&&s.startsWith(t)&&await o.removeEntry(s).catch(()=>{});this.metadataCache.delete(t),this.notify()}catch(n){console.error("Failed to delete video:",n)}}async listVideos(){return Array.from(this.metadataCache.values())}async getStorageEstimate(){if("estimate"in navigator.storage){const t=await navigator.storage.estimate();return{usage:t.usage||0,quota:t.quota||0}}return{usage:0,quota:0}}async generateThumbnails(t,n){const r=document.createElement("video"),o=document.createElement("canvas"),s=o.getContext("2d");if(!s)return;r.src=URL.createObjectURL(n),r.muted=!0,r.playsInline=!0,await new Promise(u=>{r.onloadedmetadata=()=>u()});const i=Math.max(0,r.duration||0),a=i>0?[0,i*.25,i*.5,i*.75]:[0],c=[];o.width=320,o.height=180;for(const u of a)await new Promise(h=>{r.currentTime=u,r.onseeked=()=>h()}),s.drawImage(r,0,0,o.width,o.height),c.push(o.toDataURL("image/jpeg",.7));URL.revokeObjectURL(r.src);const l=this.metadataCache.get(t);l&&(l.thumbnails=c,await this.saveMetadata(t,l),this.metadataCache.set(t,l),this.notify())}async saveMetadata(t,n){if(!this.videosDir)return;const o=await(await this.videosDir.getFileHandle(`${t}.json`,{create:!0})).createWritable();await o.write(JSON.stringify(n)),await o.close()}async loadMetadata(){if(this.videosDir)try{for await(const[t,n]of this.videosDir.entries()){const r=n;if(r.kind==="file"&&typeof t=="string"&&t.endsWith(".json")){const s=await(await r.getFile()).text(),i=JSON.parse(s),a=i.storedFileName??`${i.id}.mp4`,c={id:i.id,fileName:i.fileName,fileSize:i.fileSize,lastModified:i.lastModified,mimeType:i.mimeType,storedFileName:a,thumbnails:i.thumbnails??[]};this.metadataCache.set(c.id,c)}}}catch(t){console.error("Failed to load metadata:",t)}}}function fa(){const[e,t]=I.useState(!1),[n,r]=I.useState([]),o=$e.getInstance();return I.useEffect(()=>{let c=null;return o.initialize().then(async l=>{t(l),l&&(r(await o.listVideos()),c=o.subscribe(async()=>{r(await o.listVideos())}))}),()=>{c&&c()}},[]),{isInitialized:e,videos:n,storeVideo:async c=>{const l=await o.storeVideo(c);return r(await o.listVideos()),l},retrieveVideo:c=>o.retrieveVideo(c),deleteVideo:async c=>{await o.deleteVideo(c),r(await o.listVideos())},getStorageEstimate:()=>o.getStorageEstimate()}}const le=({variant:e="default",size:t="sm",icon:n,children:r,className:o="",...s})=>{const i={default:"bg-neutral-800 border border-neutral-700 text-neutral-300 hover:bg-neutral-700",primary:"bg-red-600 text-white hover:bg-red-500 border border-red-700",ghost:"bg-transparent text-neutral-400 hover:bg-neutral-800 hover:text-neutral-200",tool:"bg-neutral-900 text-neutral-400 hover:text-white hover:bg-neutral-800 border border-neutral-800"},a={xs:"px-2 py-0.5 text-xs",sm:"px-3 py-1 text-xs"};return d.jsx("button",{className:`
        transition-all duration-150 disabled:opacity-30
        ${i[e]}
        ${a[t]}
        ${o}
      `,...s,children:d.jsxs("span",{className:"flex items-center gap-1.5",children:[n&&d.jsx(n,{className:"w-3 h-3"}),r]})})},xe=({title:e,children:t,selected:n,compact:r=!1,className:o="",onClose:s})=>d.jsxs("div",{className:`
      bg-neutral-900 border rounded-sm
      ${n?"border-red-600 shadow-lg shadow-red-900/20":"border-neutral-800"}
      ${r?"p-1":"p-2"}
      ${o}
    `,children:[e&&d.jsxs("div",{className:"h-5 bg-gradient-to-r from-neutral-800 to-neutral-900 border border-neutral-700 px-1 mb-1 flex items-center justify-between",children:[d.jsx("span",{className:"text-xs text-neutral-400 font-medium tracking-wide",children:e}),s&&d.jsx("button",{onClick:s,className:"text-neutral-500 hover:text-neutral-200 text-xs leading-none transition-colors","aria-label":"Close",children:"×"})]}),d.jsx("div",{children:t})]}),Xe=({children:e,className:t=""})=>d.jsx("div",{className:`bg-zinc-950 flex flex-col ${t}`,children:e}),St=({title:e,actions:t})=>d.jsxs("div",{className:"h-8 bg-zinc-800 border-b border-zinc-700 px-3 flex items-center justify-between",children:[d.jsx("span",{className:"text-xs text-zinc-400 uppercase tracking-wider",children:e}),t&&d.jsx("div",{className:"flex items-center gap-1",children:t})]}),Ye=({children:e,className:t=""})=>d.jsx("div",{className:`flex-1 overflow-y-auto p-2 ${t}`,children:e}),Kn=({children:e})=>d.jsx("div",{className:"h-6 bg-zinc-900 border-t border-zinc-800 px-3 flex items-center text-zinc-600 text-xs",children:e}),kr=({label:e,className:t="",...n})=>d.jsxs("div",{className:"w-full",children:[e&&d.jsx("label",{className:"block text-neutral-500 mb-1 text-[10px] uppercase font-medium",children:e}),d.jsx("input",{className:`
        w-full bg-black border border-neutral-800 px-2 py-0.5
        text-neutral-200 text-xs focus:border-red-700 focus:outline-none
        placeholder-neutral-600
        ${t}
      `,...n})]}),us=({label:e,options:t,className:n="",...r})=>d.jsxs("div",{className:"w-full",children:[e&&d.jsx("label",{className:"block text-neutral-500 mb-1 text-[10px] uppercase font-medium",children:e}),d.jsx("select",{className:`
        w-full bg-black border border-neutral-800 px-2 py-0.5
        text-neutral-200 text-xs focus:border-red-700 focus:outline-none
        ${n}
      `,...r,children:t.map(o=>d.jsx("option",{value:o.value,children:o.label},o.value))})]}),pn=({label:e,value:t,onChange:n,min:r,max:o,placeholder:s,disabled:i=!1})=>{const a=typeof t=="number"?t:parseFloat(t)||0;return d.jsxs("div",{className:"w-full",children:[e&&d.jsx("label",{className:"block text-zinc-500 mb-1 text-[10px] uppercase",children:e}),d.jsxs("div",{className:"relative",children:[d.jsx("button",{type:"button",onClick:()=>n(a-1),disabled:i||r!==void 0&&a<=r,className:"absolute left-0 inset-y-0 px-1.5 text-zinc-500 hover:bg-zinc-800 disabled:opacity-50",children:"−"}),d.jsx("input",{type:"number",value:t,onChange:c=>n(parseFloat(c.target.value)||0),disabled:i,placeholder:s,min:r,max:o,className:"w-full bg-zinc-950 border border-zinc-800 px-6 py-0.5 text-xs text-center text-zinc-200 focus:border-zinc-600 focus:outline-none disabled:opacity-50"}),d.jsx("button",{type:"button",onClick:()=>n(a+1),disabled:i||o!==void 0&&a>=o,className:"absolute right-0 inset-y-0 px-1.5 text-zinc-500 hover:bg-zinc-800 disabled:opacity-50",children:"+"})]})]})},he=({children:e,className:t="",direction:n="row",flex:r=!1,fullHeight:o=!1})=>d.jsx("div",{className:["flex",n==="col"?"flex-col":"flex-row",r?"flex-1":"",o?"h-full":"",t].join(" "),children:e}),Qe=({children:e,className:t="",variant:n="default",size:r="sm"})=>{const o={default:"text-zinc-300",muted:"text-zinc-500",warning:"text-amber-400",error:"text-red-400"},s={xs:"text-xs",sm:"text-sm"};return d.jsx("span",{className:[o[n],s[r],t].join(" "),children:e})},Fm=({icon:e,title:t,description:n,action:r,className:o=""})=>d.jsxs("div",{className:`text-center py-8 ${o}`,children:[e&&d.jsx("div",{className:"mb-3 flex justify-center text-neutral-600",children:e}),d.jsx("h3",{className:"text-sm text-neutral-300 font-medium",children:t}),n&&d.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:n}),r&&d.jsx("div",{className:"mt-4",children:r})]}),Bm=({message:e})=>d.jsx(xe,{className:"mb-6 bg-red-900 bg-opacity-20 border-red-500 border-opacity-50",children:d.jsxs(he,{className:"gap-3",children:[d.jsx(Rc,{className:"w-5 h-5 flex-shrink-0 text-red-400"}),d.jsx(Qe,{variant:"error",size:"sm",children:e})]})}),Om=({title:e,lastSaved:t,isDirty:n,onContinue:r,onExport:o,isExporting:s})=>{const i=a=>{const c=Math.floor((Date.now()-a.getTime())/1e3);return c<3600?`${Math.floor(c/60)} min ago`:c<86400?`${Math.floor(c/3600)} hours ago`:`${Math.floor(c/86400)} days ago`};return d.jsx(xe,{className:"mb-8",children:d.jsxs(he,{className:"justify-between items-start",children:[d.jsxs(he,{direction:"col",children:[d.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:e}),d.jsxs(he,{className:"gap-4",children:[d.jsxs(he,{className:"gap-1",children:[d.jsx(bs,{className:"w-4 h-4 text-zinc-500"}),d.jsx(Qe,{variant:"muted",size:"sm",children:t?i(t):"Not saved"})]}),n&&d.jsx(Qe,{variant:"warning",size:"sm",children:"• Unsaved changes"})]})]}),d.jsxs(he,{className:"gap-2",children:[d.jsx(le,{variant:"primary",onClick:r,children:"Continue Project"}),d.jsx(le,{variant:"default",icon:xs,onClick:o,disabled:s,children:"Export"})]})]})})},Xm=({onNewProject:e,onImportClick:t,isImporting:n})=>d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsx(xe,{className:"p-8 border-2 border-dashed hover:border-orange-600 cursor-pointer transition-colors group",children:d.jsx("button",{onClick:e,className:"w-full",children:d.jsxs(he,{direction:"col",className:"items-center",children:[d.jsx(ht,{className:"w-12 h-12 mb-3 text-zinc-600 group-hover:text-orange-600"}),d.jsx("h3",{className:"text-lg font-medium text-white",children:"New Project"})]})})}),d.jsx(xe,{className:"p-8 border-2 border-dashed hover:border-orange-600 cursor-pointer transition-colors group",children:d.jsx("button",{onClick:t,disabled:n,className:"w-full",children:d.jsxs(he,{direction:"col",className:"items-center",children:[d.jsx(jn,{className:"w-12 h-12 mb-3 text-zinc-600 group-hover:text-orange-600"}),d.jsx("h3",{className:"text-lg font-medium text-white",children:n?"Importing...":"Open Project"})]})})})]}),Ym=()=>{const e=Pr(),t=I.useRef(null),[n,r]=I.useState(null),o=Te(g=>g.projectTitle),s=Te(g=>g.isDirty),i=Te(g=>g.lastSaved),{isImporting:a,isExporting:c,handleExport:l,handleFileSelect:u,createNewProject:h}=ua({onImportSuccess:()=>e("/storymap"),onImportError:g=>{r(g.message),setTimeout(()=>r(null),5e3)},confirmNewProject:!0}),f=async()=>{if(h()){try{const g=$e.getInstance();await g.initialize();const y=await g.listVideos();for(const p of y)await g.deleteVideo(p.id)}catch(g){console.error("Failed to clear video storage:",g)}e("/storymap")}};return d.jsx(Xe,{className:"h-full overflow-auto",children:d.jsx(Ye,{children:d.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-white mb-8",children:"Projects"}),n&&d.jsx(Bm,{message:n}),d.jsx(Om,{title:o,lastSaved:i,isDirty:s,onContinue:()=>e("/storymap"),onExport:l,isExporting:c}),d.jsx(Xm,{onNewProject:f,onImportClick:()=>{var g;return(g=t.current)==null?void 0:g.click()},isImporting:a}),d.jsx("input",{ref:t,type:"file",accept:".json",onChange:u,className:"hidden"})]})})})},Wm=()=>{const e=I.useRef(null),{isInitialized:t,videos:n,storeVideo:r,retrieveVideo:o,deleteVideo:s,getStorageEstimate:i}=fa(),{currentVideoId:a,setCurrentVideo:c,setIsLoading:l,clearCurrentVideo:u}=Be(),[h,f]=fe.useState({usage:0,quota:0}),[g,y]=fe.useState(0);fe.useEffect(()=>{t&&i().then(f)},[t,n,i]);const p=async m=>{const C=Array.from(m.target.files||[]).filter(N=>N.type.startsWith("video/"));y(C.length);for(const N of C)try{const M=await r(N);n.length===0&&!a&&x(M)}catch(M){console.error("Failed to store video:",M),alert(`Failed to store ${N.name}. Storage might be full.`)}y(0),e.current&&(e.current.value="")},x=async m=>{if(a!==m){l(!0);try{const w=await o(m);w&&c(m,w)}catch(w){console.error("Failed to load video:",w)}finally{l(!1)}}},b=async m=>{if(confirm("Delete this video from storage?")&&(await s(m),a===m)){u();const w=n.filter(C=>C.id!==m);w.length>0&&x(w[0].id)}},S=m=>{if(m===0)return"0 Bytes";const w=1024,C=["Bytes","KB","MB","GB"],N=Math.floor(Math.log(m)/Math.log(w));return parseFloat((m/Math.pow(w,N)).toFixed(2))+" "+C[N]};return d.jsxs(Xe,{className:"w-80 border-r border-zinc-800 flex flex-col",children:[d.jsx(St,{title:"Media Pool",actions:d.jsx(le,{variant:"ghost",size:"xs",icon:jn,onClick:()=>{var m;return(m=e.current)==null?void 0:m.click()},disabled:!t||g>0,children:g>0?`Uploading ${g}...`:"Import"})}),d.jsx("input",{ref:e,type:"file",accept:"video/*",multiple:!0,onChange:p,className:"hidden"}),t&&d.jsxs("div",{className:"px-3 py-2 bg-zinc-950 border-b border-zinc-800",children:[d.jsxs("div",{className:"flex items-center justify-between mb-1 text-[10px]",children:[d.jsxs("span",{className:"flex items-center gap-1 text-zinc-600",children:[d.jsx(so,{className:"w-3 h-3"}),"Browser Storage"]}),d.jsxs("span",{className:"text-zinc-600",children:[S(h.usage)," / ",S(h.quota)]})]}),d.jsx("div",{className:"h-1 bg-zinc-950 rounded overflow-hidden",children:d.jsx("div",{className:"h-full bg-orange-600 transition-all",style:{width:`${h.usage/h.quota*100}%`}})})]}),d.jsx(Ye,{className:"flex-1 overflow-y-auto",children:t?n.length===0?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(gt,{className:"w-12 h-12 mx-auto mb-4 text-zinc-600"}),d.jsx("p",{className:"text-zinc-600 text-xs mb-4",children:"No videos in storage"}),d.jsx(le,{variant:"default",icon:jn,onClick:()=>{var m;return(m=e.current)==null?void 0:m.click()},disabled:g>0,children:"Import Videos"})]}):d.jsx("div",{className:"p-2 space-y-1",children:n.map(m=>d.jsxs(xe,{selected:a===m.id,compact:!0,className:"relative cursor-pointer",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),b(m.id)},className:"absolute top-1 right-1 p-1 rounded hover:bg-red-500/20 text-zinc-500 hover:text-red-400",title:"Delete video",children:d.jsx(ws,{className:"w-4 h-4"})}),d.jsxs("div",{onClick:()=>x(m.id),children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx(gt,{className:"w-4 h-4 text-zinc-600 flex-shrink-0"}),d.jsx("p",{className:"text-xs text-zinc-300 truncate",children:m.fileName})]}),d.jsx("div",{className:"flex items-center gap-3 text-zinc-600 text-[10px]",children:d.jsx("span",{children:S(m.fileSize)})}),m.thumbnails&&m.thumbnails.length>0&&d.jsx("div",{className:"flex gap-1 mt-2",children:m.thumbnails.slice(0,4).map((w,C)=>d.jsx("div",{className:"w-1/4 aspect-video bg-zinc-900 overflow-hidden rounded",children:d.jsx("img",{src:w,alt:"",className:"w-full h-full object-cover opacity-70",draggable:!1})},C))})]})]},m.id))}):d.jsx("div",{className:"text-center py-12",children:d.jsxs("div",{className:"animate-pulse",children:[d.jsx(so,{className:"w-12 h-12 mx-auto mb-4 text-zinc-600"}),d.jsx("p",{className:"text-zinc-600 text-xs",children:"Initializing storage..."})]})})}),d.jsx(Kn,{children:d.jsxs("span",{className:"text-[10px]",children:[n.length," video",n.length!==1?"s":""," stored"]})})]})};let xn=null;const at=Ut((e,t)=>{const n=()=>{xn&&(window.clearTimeout(xn),xn=null)},r=async c=>{var p;const{nodes:l}=oe.getState(),u=l.find(x=>x.id===c&&x.type==="scene"),h=(p=u==null?void 0:u.data)==null?void 0:p.videoId,f=Be.getState();if(!h){f.clearCurrentVideo();return}const g=$e.getInstance();await g.initialize();const y=await g.retrieveVideo(h);y?f.setCurrentVideo(h,y):f.clearCurrentVideo()},o=c=>{const{nodes:l,edges:u}=oe.getState(),{variables:h}=me.getState(),g=u.filter(S=>S.source===c).map(S=>l.find(m=>m.id===S.target)).filter(S=>S!==void 0),y=g.filter(S=>Ze(S)),p=g.filter(S=>Se(S));if(y.length>0&&y.some(m=>u.filter(N=>N.source===m.id).map(N=>l.find(M=>M.id===N.target)).filter(N=>N!==void 0&&Se(N)).some(N=>$t(N.data.conditions,h))))return null;const x=p.filter(S=>$t(S.data.conditions,h));if(x.length===0)return null;const b=x.find(S=>S.data.isPriority);return b?b.id:x[0].id},s=c=>{const{nodes:l,edges:u}=oe.getState(),{variables:h}=me.getState(),y=u.filter(x=>x.source===c).map(x=>l.find(b=>b.id===x.target)).filter(x=>x!==void 0&&Se(x)).filter(x=>$t(x.data.conditions,h));if(y.length===0)return null;const p=y.find(x=>x.data.isPriority);return p?p.id:y[0].id},i=c=>{n();const u=oe.getState().nodes.find(g=>g.id===c&&g.type==="scene"),h=(u==null?void 0:u.data)||{};if(h.videoId)return;const f=h.durationSec??0;!f||f<=0||(xn=window.setTimeout(()=>{const g=o(c);g&&t().goTo(g)},Math.max(0,f*1e3)))};return{currentSceneId:null,start:()=>{const c=Gt;e({currentSceneId:c}),r(c),i(c)},goTo:c=>{e({currentSceneId:c}),r(c),i(c)},reset:()=>{n();const c=Gt;e({currentSceneId:c}),r(c),i(c)},onVideoEnded:()=>{const c=t().currentSceneId;if(!c)return;const l=o(c);l&&t().goTo(l)},executeChoice:c=>{const{nodes:l}=oe.getState(),{variables:u,loadVariables:h}=me.getState(),f=l.find(p=>p.id===c);if(!f||!Ze(f))return!1;const g=s(c);if(!g)return!1;const y=Vm(f.data.effects||{},u);return h(y),t().goTo(g),!0},getAvailableChoices:()=>{const c=t().currentSceneId;if(!c)return[];const{nodes:l,edges:u}=oe.getState(),{variables:h}=me.getState();return u.filter(y=>y.source===c).map(y=>l.find(p=>p.id===y.target)).filter(y=>y!==void 0&&Ze(y)).filter(y=>u.filter(b=>b.source===y.id).map(b=>l.find(S=>S.id===b.target)).filter(b=>b!==void 0&&Se(b)).some(b=>$t(b.data.conditions,h)))}}}),ha=()=>{const e=I.useRef(null),{currentVideoUrl:t,isPlaying:n,currentTime:r,duration:o,volume:s,setIsPlaying:i,setCurrentTime:a,setDuration:c,setVolume:l}=Be(),u=at(p=>p.onVideoEnded);I.useEffect(()=>{const p=e.current;if(!p)return;const x=()=>c(p.duration||0),b=()=>a(p.currentTime||0),S=()=>i(!0),m=()=>i(!1),w=()=>{i(!1),u()};return p.addEventListener("loadedmetadata",x),p.addEventListener("timeupdate",b),p.addEventListener("play",S),p.addEventListener("pause",m),p.addEventListener("ended",w),p.volume=s/100,()=>{p.removeEventListener("loadedmetadata",x),p.removeEventListener("timeupdate",b),p.removeEventListener("play",S),p.removeEventListener("pause",m),p.removeEventListener("ended",w)}},[t,s,c,a,i,u]);const h=()=>{const p=e.current;p&&(p.paused?p.play():p.pause())},f=p=>{const x=e.current;if(!x)return;const b=Number.isFinite(o)?o:x.duration||0;x.currentTime=Math.max(0,Math.min(p,b))},g=p=>{if(!Number.isFinite(p))return"0:00";const x=Math.max(0,Math.floor(p)),b=Math.floor(x/60),S=x%60;return`${b}:${S.toString().padStart(2,"0")}`};if(!t)return d.jsx("div",{className:"flex-1 flex items-center justify-center bg-black",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 text-[#444]",children:d.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:d.jsx("path",{d:"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"})})}),d.jsx("p",{className:"text-[#666] text-sm",children:"Select a video to preview"})]})});const y="object-contain";return d.jsxs("div",{className:"flex-1 flex flex-col bg-black min-h-0",children:[d.jsx("div",{className:"flex-1 min-h-0 flex items-center justify-center overflow-hidden",children:d.jsx("video",{ref:e,src:t,className:`w-full h-full max-w-full max-h-full ${y}`,playsInline:!0,autoPlay:!0,controls:!1,preload:"metadata"})}),d.jsxs("div",{className:"h-24 shrink-0 bg-[#252525] border-t border-[#0a0a0a] p-3",children:[d.jsx("div",{className:"mb-3",children:d.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-[#666] mb-1",children:[d.jsx("span",{children:g(r)}),d.jsxs("div",{className:"flex-1 h-1 bg-[#1a1a1a] relative",children:[d.jsx("div",{className:"absolute h-full bg-[#E84E36]",style:{width:`${o>0?Math.min(100,r/o*100):0}%`}}),d.jsx("input",{type:"range",min:0,max:Math.max(0,o||0),value:Math.min(r,o||0),onChange:p=>f(parseFloat(p.target.value)),className:"absolute inset-0 w-full opacity-0 cursor-pointer","aria-label":"Seek"})]}),d.jsx("span",{children:g(o)})]})}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>f(0),className:"p-2 bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] hover:bg-[#333] hover:text-white transition-colors","aria-label":"Restart",children:d.jsx(Lc,{className:"w-4 h-4"})}),d.jsx("button",{onClick:h,className:"p-2 bg-[#E84E36] text-white hover:bg-[#d63d2a] transition-colors","aria-label":n?"Pause":"Play",children:n?d.jsx(Hc,{className:"w-4 h-4"}):d.jsx(Fc,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>f(o||0),className:"p-2 bg-[#2a2a2a] border border-[#3a3a3a] text-[#999] hover:bg-[#333] hover:text-white transition-colors","aria-label":"End",children:d.jsx(Bc,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-[10px] text-[#666]",children:"Vol"}),d.jsx("input",{type:"range",min:0,max:100,value:s,onChange:p=>{const x=parseInt(p.target.value,10);l(x),e.current&&(e.current.volume=x/100)},className:"w-24",style:{height:"4px",backgroundColor:"#1a1a1a",outline:"none"},"aria-label":"Volume"}),d.jsxs("span",{className:"text-[10px] text-[#666] w-8 text-right",children:[s,"%"]})]})]})]})]})},Gm=()=>{const e=oe(x=>x.nodes),t=oe(x=>x.updateNode),{videos:n,retrieveVideo:r}=fa(),{setCurrentVideo:o,currentVideoId:s}=Be(),i=zr(),[a,c]=I.useState(""),[l,u]=I.useState(null);I.useEffect(()=>{const x=i.state;x!=null&&x.sceneId&&(u(x.sceneId),x.videoId&&r(x.videoId).then(b=>{b&&o(x.videoId,b)}))},[i.state]);const h=I.useMemo(()=>e.filter(Se).filter(x=>!a||x.data.label.toLowerCase().includes(a.toLowerCase())||x.id.toLowerCase().includes(a.toLowerCase())),[e,a]),f=async(x,b)=>{if(u(x),b){const S=await r(b);S&&o(b,S)}},g=x=>{if(!s){alert("Select a video first");return}t(x,{videoId:s})},y=n.find(x=>x.id===s),p=x=>n.find(b=>b.id===x);return d.jsxs(Xe,{className:"w-96 border-l border-zinc-800 flex flex-col",children:[d.jsx(St,{title:"Scene Linker"}),y&&d.jsx("div",{className:"px-3 py-2 bg-zinc-800 border-b border-zinc-700",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(gt,{className:"w-3 h-3 text-green-500"}),d.jsxs("span",{className:"text-zinc-400 truncate",style:{fontSize:"10px"},children:["Selected: ",y.fileName]})]})}),d.jsx("div",{className:"p-3 border-b border-zinc-800",children:d.jsx(kr,{value:a,onChange:x=>c(x.target.value),placeholder:"Search scenes..."})}),d.jsx(Ye,{className:"flex-1 overflow-y-auto",children:d.jsxs("div",{className:"space-y-2",children:[h.map(x=>{const b=p(x.data.videoId),S=l===x.id;return d.jsx(xe,{selected:S,compact:!0,className:"cursor-pointer",children:d.jsx("div",{onClick:()=>f(x.id,x.data.videoId),children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-xs font-medium text-zinc-200",children:x.data.label}),b?d.jsxs("p",{className:"text-zinc-500 mt-1",style:{fontSize:"10px"},children:[d.jsx(gt,{className:"w-3 h-3 inline mr-1"}),b.fileName]}):d.jsxs("p",{className:"text-zinc-600 mt-1",style:{fontSize:"10px"},children:["No video • ",x.data.durationSec,"s"]})]}),d.jsx("div",{className:"flex gap-2",children:b?s&&s!==x.data.videoId?d.jsx(le,{variant:"ghost",size:"xs",onClick:m=>{m.stopPropagation(),g(x.id)},children:"change"}):d.jsx(le,{variant:"ghost",size:"xs",onClick:m=>{m.stopPropagation(),t(x.id,{videoId:void 0})},children:"remove"}):s&&d.jsx(le,{variant:"ghost",size:"xs",onClick:m=>{m.stopPropagation(),g(x.id)},children:"link"})})]})})},x.id)}),h.length===0&&d.jsx("div",{className:"text-center py-8 text-xs text-zinc-500",children:a?"No scenes found":"No scenes in project"})]})})]})},Um=()=>d.jsxs("div",{className:"flex h-full bg-zinc-900",children:[d.jsx(Wm,{}),d.jsx("div",{className:"flex-1 flex flex-col",children:d.jsx(ha,{})}),d.jsx(Gm,{})]});function ga(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=ga(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function qm(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=ga(e))&&(r&&(r+=" "),r+=t);return r}const qr="-",Km=e=>{const t=Qm(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:i=>{const a=i.split(qr);return a[0]===""&&a.length!==1&&a.shift(),ma(a,t)||Zm(i)},getConflictingClassGroupIds:(i,a)=>{const c=n[i]||[];return a&&r[i]?[...c,...r[i]]:c}}},ma=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?ma(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const s=e.join(qr);return(i=t.validators.find(({validator:a})=>a(s)))==null?void 0:i.classGroupId},fs=/^\[(.+)\]$/,Zm=e=>{if(fs.test(e)){const t=fs.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Qm=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const o in n)Er(n[o],r,o,t);return r},Er=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const s=o===""?t:hs(t,o);s.classGroupId=n;return}if(typeof o=="function"){if(Jm(o)){Er(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([s,i])=>{Er(i,hs(t,s),n,r)})})},hs=(e,t)=>{let n=e;return t.split(qr).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Jm=e=>e.isThemeGetter,ep=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(s,i)=>{n.set(s,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(s){let i=n.get(s);if(i!==void 0)return i;if((i=r.get(s))!==void 0)return o(s,i),i},set(s,i){n.has(s)?n.set(s,i):o(s,i)}}},_r="!",Mr=":",tp=Mr.length,np=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=o=>{const s=[];let i=0,a=0,c=0,l;for(let y=0;y<o.length;y++){let p=o[y];if(i===0&&a===0){if(p===Mr){s.push(o.slice(c,y)),c=y+tp;continue}if(p==="/"){l=y;continue}}p==="["?i++:p==="]"?i--:p==="("?a++:p===")"&&a--}const u=s.length===0?o:o.substring(c),h=rp(u),f=h!==u,g=l&&l>c?l-c:void 0;return{modifiers:s,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:g}};if(t){const o=t+Mr,s=r;r=i=>i.startsWith(o)?s(i.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:i,maybePostfixModifierPosition:void 0}}if(n){const o=r;r=s=>n({className:s,parseClassName:o})}return r},rp=e=>e.endsWith(_r)?e.substring(0,e.length-1):e.startsWith(_r)?e.substring(1):e,op=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const o=[];let s=[];return r.forEach(i=>{i[0]==="["||t[i]?(o.push(...s.sort(),i),s=[]):s.push(i)}),o.push(...s.sort()),o}},sp=e=>({cache:ep(e.cacheSize),parseClassName:np(e),sortModifiers:op(e),...Km(e)}),ip=/\s+/,ap=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o,sortModifiers:s}=t,i=[],a=e.trim().split(ip);let c="";for(let l=a.length-1;l>=0;l-=1){const u=a[l],{isExternal:h,modifiers:f,hasImportantModifier:g,baseClassName:y,maybePostfixModifierPosition:p}=n(u);if(h){c=u+(c.length>0?" "+c:c);continue}let x=!!p,b=r(x?y.substring(0,p):y);if(!b){if(!x){c=u+(c.length>0?" "+c:c);continue}if(b=r(y),!b){c=u+(c.length>0?" "+c:c);continue}x=!1}const S=s(f).join(":"),m=g?S+_r:S,w=m+b;if(i.includes(w))continue;i.push(w);const C=o(b,x);for(let N=0;N<C.length;++N){const M=C[N];i.push(m+M)}c=u+(c.length>0?" "+c:c)}return c};function cp(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=pa(t))&&(r&&(r+=" "),r+=n);return r}const pa=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=pa(e[r]))&&(n&&(n+=" "),n+=t);return n};function lp(e,...t){let n,r,o,s=i;function i(c){const l=t.reduce((u,h)=>h(u),e());return n=sp(l),r=n.cache.get,o=n.cache.set,s=a,a(c)}function a(c){const l=r(c);if(l)return l;const u=ap(c,n);return o(c,u),u}return function(){return s(cp.apply(null,arguments))}}const ue=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},xa=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ya=/^\((?:(\w[\w-]*):)?(.+)\)$/i,dp=/^\d+\/\d+$/,up=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,fp=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,hp=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,gp=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,mp=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,st=e=>dp.test(e),ne=e=>!!e&&!Number.isNaN(Number(e)),He=e=>!!e&&Number.isInteger(Number(e)),lr=e=>e.endsWith("%")&&ne(e.slice(0,-1)),Ie=e=>up.test(e),pp=()=>!0,xp=e=>fp.test(e)&&!hp.test(e),ba=()=>!1,yp=e=>gp.test(e),bp=e=>mp.test(e),wp=e=>!Y(e)&&!W(e),vp=e=>Ct(e,Na,ba),Y=e=>xa.test(e),We=e=>Ct(e,Sa,xp),dr=e=>Ct(e,kp,ne),gs=e=>Ct(e,wa,ba),Np=e=>Ct(e,va,bp),yn=e=>Ct(e,Ca,yp),W=e=>ya.test(e),Pt=e=>jt(e,Sa),Sp=e=>jt(e,Ep),ms=e=>jt(e,wa),Cp=e=>jt(e,Na),jp=e=>jt(e,va),bn=e=>jt(e,Ca,!0),Ct=(e,t,n)=>{const r=xa.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},jt=(e,t,n=!1)=>{const r=ya.exec(e);return r?r[1]?t(r[1]):n:!1},wa=e=>e==="position"||e==="percentage",va=e=>e==="image"||e==="url",Na=e=>e==="length"||e==="size"||e==="bg-size",Sa=e=>e==="length",kp=e=>e==="number",Ep=e=>e==="family-name",Ca=e=>e==="shadow",_p=()=>{const e=ue("color"),t=ue("font"),n=ue("text"),r=ue("font-weight"),o=ue("tracking"),s=ue("leading"),i=ue("breakpoint"),a=ue("container"),c=ue("spacing"),l=ue("radius"),u=ue("shadow"),h=ue("inset-shadow"),f=ue("text-shadow"),g=ue("drop-shadow"),y=ue("blur"),p=ue("perspective"),x=ue("aspect"),b=ue("ease"),S=ue("animate"),m=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...w(),W,Y],N=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto","contain","none"],k=()=>[W,Y,c],A=()=>[st,"full","auto",...k()],H=()=>[He,"none","subgrid",W,Y],R=()=>["auto",{span:["full",He,W,Y]},He,W,Y],$=()=>[He,"auto",W,Y],D=()=>["auto","min","max","fr",W,Y],v=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],P=()=>["start","end","center","stretch","center-safe","end-safe"],j=()=>["auto",...k()],E=()=>[st,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],_=()=>[e,W,Y],z=()=>[...w(),ms,gs,{position:[W,Y]}],T=()=>["no-repeat",{repeat:["","x","y","space","round"]}],V=()=>["auto","cover","contain",Cp,vp,{size:[W,Y]}],L=()=>[lr,Pt,We],O=()=>["","none","full",l,W,Y],B=()=>["",ne,Pt,We],q=()=>["solid","dashed","dotted","double"],Z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],X=()=>[ne,lr,ms,gs],F=()=>["","none",y,W,Y],U=()=>["none",ne,W,Y],ee=()=>["none",ne,W,Y],te=()=>[ne,W,Y],K=()=>[st,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ie],breakpoint:[Ie],color:[pp],container:[Ie],"drop-shadow":[Ie],ease:["in","out","in-out"],font:[wp],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ie],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ie],shadow:[Ie],spacing:["px",ne],text:[Ie],"text-shadow":[Ie],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",st,Y,W,x]}],container:["container"],columns:[{columns:[ne,Y,W,a]}],"break-after":[{"break-after":m()}],"break-before":[{"break-before":m()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:A()}],"inset-x":[{"inset-x":A()}],"inset-y":[{"inset-y":A()}],start:[{start:A()}],end:[{end:A()}],top:[{top:A()}],right:[{right:A()}],bottom:[{bottom:A()}],left:[{left:A()}],visibility:["visible","invisible","collapse"],z:[{z:[He,"auto",W,Y]}],basis:[{basis:[st,"full","auto",a,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ne,st,"auto","initial","none",Y]}],grow:[{grow:["",ne,W,Y]}],shrink:[{shrink:["",ne,W,Y]}],order:[{order:[He,"first","last","none",W,Y]}],"grid-cols":[{"grid-cols":H()}],"col-start-end":[{col:R()}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":H()}],"row-start-end":[{row:R()}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":D()}],"auto-rows":[{"auto-rows":D()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...v(),"normal"]}],"justify-items":[{"justify-items":[...P(),"normal"]}],"justify-self":[{"justify-self":["auto",...P()]}],"align-content":[{content:["normal",...v()]}],"align-items":[{items:[...P(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...P(),{baseline:["","last"]}]}],"place-content":[{"place-content":v()}],"place-items":[{"place-items":[...P(),"baseline"]}],"place-self":[{"place-self":["auto",...P()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:j()}],mx:[{mx:j()}],my:[{my:j()}],ms:[{ms:j()}],me:[{me:j()}],mt:[{mt:j()}],mr:[{mr:j()}],mb:[{mb:j()}],ml:[{ml:j()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:E()}],w:[{w:[a,"screen",...E()]}],"min-w":[{"min-w":[a,"screen","none",...E()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[i]},...E()]}],h:[{h:["screen","lh",...E()]}],"min-h":[{"min-h":["screen","lh","none",...E()]}],"max-h":[{"max-h":["screen","lh",...E()]}],"font-size":[{text:["base",n,Pt,We]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,W,dr]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",lr,Y]}],"font-family":[{font:[Sp,Y,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,W,Y]}],"line-clamp":[{"line-clamp":[ne,"none",W,dr]}],leading:[{leading:[s,...k()]}],"list-image":[{"list-image":["none",W,Y]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",W,Y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:_()}],"text-color":[{text:_()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:[ne,"from-font","auto",W,We]}],"text-decoration-color":[{decoration:_()}],"underline-offset":[{"underline-offset":[ne,"auto",W,Y]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",W,Y]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",W,Y]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:z()}],"bg-repeat":[{bg:T()}],"bg-size":[{bg:V()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},He,W,Y],radial:["",W,Y],conic:[He,W,Y]},jp,Np]}],"bg-color":[{bg:_()}],"gradient-from-pos":[{from:L()}],"gradient-via-pos":[{via:L()}],"gradient-to-pos":[{to:L()}],"gradient-from":[{from:_()}],"gradient-via":[{via:_()}],"gradient-to":[{to:_()}],rounded:[{rounded:O()}],"rounded-s":[{"rounded-s":O()}],"rounded-e":[{"rounded-e":O()}],"rounded-t":[{"rounded-t":O()}],"rounded-r":[{"rounded-r":O()}],"rounded-b":[{"rounded-b":O()}],"rounded-l":[{"rounded-l":O()}],"rounded-ss":[{"rounded-ss":O()}],"rounded-se":[{"rounded-se":O()}],"rounded-ee":[{"rounded-ee":O()}],"rounded-es":[{"rounded-es":O()}],"rounded-tl":[{"rounded-tl":O()}],"rounded-tr":[{"rounded-tr":O()}],"rounded-br":[{"rounded-br":O()}],"rounded-bl":[{"rounded-bl":O()}],"border-w":[{border:B()}],"border-w-x":[{"border-x":B()}],"border-w-y":[{"border-y":B()}],"border-w-s":[{"border-s":B()}],"border-w-e":[{"border-e":B()}],"border-w-t":[{"border-t":B()}],"border-w-r":[{"border-r":B()}],"border-w-b":[{"border-b":B()}],"border-w-l":[{"border-l":B()}],"divide-x":[{"divide-x":B()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":B()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...q(),"hidden","none"]}],"divide-style":[{divide:[...q(),"hidden","none"]}],"border-color":[{border:_()}],"border-color-x":[{"border-x":_()}],"border-color-y":[{"border-y":_()}],"border-color-s":[{"border-s":_()}],"border-color-e":[{"border-e":_()}],"border-color-t":[{"border-t":_()}],"border-color-r":[{"border-r":_()}],"border-color-b":[{"border-b":_()}],"border-color-l":[{"border-l":_()}],"divide-color":[{divide:_()}],"outline-style":[{outline:[...q(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ne,W,Y]}],"outline-w":[{outline:["",ne,Pt,We]}],"outline-color":[{outline:_()}],shadow:[{shadow:["","none",u,bn,yn]}],"shadow-color":[{shadow:_()}],"inset-shadow":[{"inset-shadow":["none",h,bn,yn]}],"inset-shadow-color":[{"inset-shadow":_()}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:_()}],"ring-offset-w":[{"ring-offset":[ne,We]}],"ring-offset-color":[{"ring-offset":_()}],"inset-ring-w":[{"inset-ring":B()}],"inset-ring-color":[{"inset-ring":_()}],"text-shadow":[{"text-shadow":["none",f,bn,yn]}],"text-shadow-color":[{"text-shadow":_()}],opacity:[{opacity:[ne,W,Y]}],"mix-blend":[{"mix-blend":[...Z(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Z()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ne]}],"mask-image-linear-from-pos":[{"mask-linear-from":X()}],"mask-image-linear-to-pos":[{"mask-linear-to":X()}],"mask-image-linear-from-color":[{"mask-linear-from":_()}],"mask-image-linear-to-color":[{"mask-linear-to":_()}],"mask-image-t-from-pos":[{"mask-t-from":X()}],"mask-image-t-to-pos":[{"mask-t-to":X()}],"mask-image-t-from-color":[{"mask-t-from":_()}],"mask-image-t-to-color":[{"mask-t-to":_()}],"mask-image-r-from-pos":[{"mask-r-from":X()}],"mask-image-r-to-pos":[{"mask-r-to":X()}],"mask-image-r-from-color":[{"mask-r-from":_()}],"mask-image-r-to-color":[{"mask-r-to":_()}],"mask-image-b-from-pos":[{"mask-b-from":X()}],"mask-image-b-to-pos":[{"mask-b-to":X()}],"mask-image-b-from-color":[{"mask-b-from":_()}],"mask-image-b-to-color":[{"mask-b-to":_()}],"mask-image-l-from-pos":[{"mask-l-from":X()}],"mask-image-l-to-pos":[{"mask-l-to":X()}],"mask-image-l-from-color":[{"mask-l-from":_()}],"mask-image-l-to-color":[{"mask-l-to":_()}],"mask-image-x-from-pos":[{"mask-x-from":X()}],"mask-image-x-to-pos":[{"mask-x-to":X()}],"mask-image-x-from-color":[{"mask-x-from":_()}],"mask-image-x-to-color":[{"mask-x-to":_()}],"mask-image-y-from-pos":[{"mask-y-from":X()}],"mask-image-y-to-pos":[{"mask-y-to":X()}],"mask-image-y-from-color":[{"mask-y-from":_()}],"mask-image-y-to-color":[{"mask-y-to":_()}],"mask-image-radial":[{"mask-radial":[W,Y]}],"mask-image-radial-from-pos":[{"mask-radial-from":X()}],"mask-image-radial-to-pos":[{"mask-radial-to":X()}],"mask-image-radial-from-color":[{"mask-radial-from":_()}],"mask-image-radial-to-color":[{"mask-radial-to":_()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[ne]}],"mask-image-conic-from-pos":[{"mask-conic-from":X()}],"mask-image-conic-to-pos":[{"mask-conic-to":X()}],"mask-image-conic-from-color":[{"mask-conic-from":_()}],"mask-image-conic-to-color":[{"mask-conic-to":_()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:z()}],"mask-repeat":[{mask:T()}],"mask-size":[{mask:V()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",W,Y]}],filter:[{filter:["","none",W,Y]}],blur:[{blur:F()}],brightness:[{brightness:[ne,W,Y]}],contrast:[{contrast:[ne,W,Y]}],"drop-shadow":[{"drop-shadow":["","none",g,bn,yn]}],"drop-shadow-color":[{"drop-shadow":_()}],grayscale:[{grayscale:["",ne,W,Y]}],"hue-rotate":[{"hue-rotate":[ne,W,Y]}],invert:[{invert:["",ne,W,Y]}],saturate:[{saturate:[ne,W,Y]}],sepia:[{sepia:["",ne,W,Y]}],"backdrop-filter":[{"backdrop-filter":["","none",W,Y]}],"backdrop-blur":[{"backdrop-blur":F()}],"backdrop-brightness":[{"backdrop-brightness":[ne,W,Y]}],"backdrop-contrast":[{"backdrop-contrast":[ne,W,Y]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ne,W,Y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ne,W,Y]}],"backdrop-invert":[{"backdrop-invert":["",ne,W,Y]}],"backdrop-opacity":[{"backdrop-opacity":[ne,W,Y]}],"backdrop-saturate":[{"backdrop-saturate":[ne,W,Y]}],"backdrop-sepia":[{"backdrop-sepia":["",ne,W,Y]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",W,Y]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ne,"initial",W,Y]}],ease:[{ease:["linear","initial",b,W,Y]}],delay:[{delay:[ne,W,Y]}],animate:[{animate:["none",S,W,Y]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,W,Y]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:U()}],"rotate-x":[{"rotate-x":U()}],"rotate-y":[{"rotate-y":U()}],"rotate-z":[{"rotate-z":U()}],scale:[{scale:ee()}],"scale-x":[{"scale-x":ee()}],"scale-y":[{"scale-y":ee()}],"scale-z":[{"scale-z":ee()}],"scale-3d":["scale-3d"],skew:[{skew:te()}],"skew-x":[{"skew-x":te()}],"skew-y":[{"skew-y":te()}],transform:[{transform:[W,Y,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:K()}],"translate-x":[{"translate-x":K()}],"translate-y":[{"translate-y":K()}],"translate-z":[{"translate-z":K()}],"translate-none":["translate-none"],accent:[{accent:_()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:_()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",W,Y]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",W,Y]}],fill:[{fill:["none",..._()]}],"stroke-w":[{stroke:[ne,Pt,We,dr]}],stroke:[{stroke:["none",..._()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Mp=lp(_p);function dt(...e){return Mp(qm(e))}const ja=({id:e,data:t,selected:n})=>{const{label:r,description:o,durationSec:s,conditions:i,videoId:a}=t,c=me(b=>b.variables),l=oe(b=>b.updateNode),u=Pr(),[h,f]=I.useState(!1),g=I.useRef(null),y=I.useMemo(()=>$t(i,c),[i,c]),p=async b=>{f(!0);try{const S=$e.getInstance();await S.initialize();const m=await S.storeVideo(b);l(e,{videoId:m})}finally{f(!1)}},x=()=>{u("/video",{state:{sceneId:e,videoId:a}})};return d.jsxs("div",{className:dt("relative w-60 h-60 transition-all duration-150 ease-in-out","border-2 bg-zinc-800",n?"border-red-500":"border-zinc-700",!y&&"opacity-60"),children:[!y&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60",children:d.jsxs("div",{className:"flex flex-col items-center gap-1 text-xs text-zinc-300",children:[d.jsx(Oc,{className:"w-5 h-5 text-zinc-400"}),i==null?void 0:i.map((b,S)=>d.jsx("span",{className:"font-mono",children:Dm(b)},S))]})}),d.jsxs("div",{className:"p-4 h-full flex flex-col",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsx("h3",{className:"text-sm font-semibold text-zinc-200",children:r}),d.jsx("div",{className:"flex items-center gap-1",children:a?d.jsxs("span",{onClick:x,className:"inline-flex items-center gap-1 text-[10px] px-1.5 py-0.5 rounded bg-zinc-700 text-zinc-200 cursor-pointer hover:bg-zinc-600",children:[d.jsx(gt,{className:"w-3 h-3"}),d.jsx("span",{children:h?"...":"attached"}),d.jsx("button",{type:"button",title:"Unlink video",className:"ml-1 opacity-70 hover:opacity-100",onClick:b=>{b.stopPropagation(),l(e,{videoId:void 0})},children:d.jsx(ws,{className:"w-3 h-3"})})]}):d.jsxs(d.Fragment,{children:[d.jsx("input",{ref:g,type:"file",accept:"video/*",className:"hidden",onChange:b=>{var m;const S=(m=b.target.files)==null?void 0:m[0];S&&p(S),g.current&&(g.current.value="")}}),d.jsx("button",{type:"button",title:"Attach video or go to video view",className:dt("p-1 rounded border border-zinc-700 hover:bg-zinc-700/50","text-zinc-300"),onClick:x,disabled:h,children:d.jsx(Xc,{className:"w-4 h-4"})})]})})]}),d.jsx("div",{className:"flex-1 mb-3",children:o&&d.jsx("p",{className:"text-xs leading-relaxed text-zinc-500 overflow-hidden text-ellipsis line-clamp-6",children:o})}),d.jsxs("div",{className:"mt-auto",children:[d.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[d.jsx("span",{className:"text-xs text-zinc-500",children:a?"Video":"Duration"}),d.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:a?"auto":`${s}s`})]}),d.jsx("div",{className:"h-1 bg-zinc-900 relative overflow-hidden rounded-sm"})]})]}),d.jsx(Oe,{type:"target",position:G.Left,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !left-[-5px]"}),d.jsx(Oe,{type:"source",position:G.Right,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !right-[-5px]"})]})},ka=({data:e,selected:t})=>{const{label:n,effects:r}=e,o=me(c=>c.variables),s=I.useMemo(()=>Object.entries(r).filter(([c,l])=>l!==0),[r]),i=s.length>0,a=I.useMemo(()=>{const c=new Map;for(const l of o)c.set(l.name,l);return c},[o]);return d.jsxs("div",{className:"relative group",children:[d.jsxs("div",{className:dt("relative px-5 py-2.5 border-2 text-xs font-medium","inline-flex items-center gap-2 h-12","bg-zinc-700 border-zinc-600 text-zinc-200",t&&"border-red-500"),children:[d.jsx("span",{children:n}),i&&d.jsx("div",{className:"flex items-center gap-1 ml-1",children:s.map(([c,l])=>d.jsx("div",{className:dt("w-4 h-4 bg-zinc-800 border border-zinc-700","flex items-center justify-center text-[9px] font-bold",l>0?"text-green-400":"text-red-400"),children:l>0?"↑":"↓"},c))}),d.jsx(Oe,{type:"target",position:G.Left,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !left-[-5px]"}),d.jsx(Oe,{type:"source",position:G.Right,className:"!w-2 !h-4 !bg-zinc-700 !border !border-zinc-600 !rounded-none !right-[-5px]"})]}),i&&d.jsx("div",{className:dt("absolute left-1/2 -translate-x-1/2 -bottom-[60px] z-10","opacity-0 pointer-events-none transition-opacity duration-200","group-hover:opacity-100"),children:d.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 px-2.5 py-1.5 text-[10px] whitespace-nowrap relative",children:[d.jsx("div",{className:"flex flex-col gap-0.5",children:s.map(([c,l])=>a.get(c)?d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("span",{className:"text-zinc-500",children:[c,":"]}),d.jsxs("span",{className:dt("font-mono font-medium",l>0?"text-green-400":"text-red-400"),children:[l>0?"+":"",l]})]},c):null)}),d.jsx("div",{className:"absolute -top-[3px] left-1/2 -translate-x-1/2 w-0 h-0 border-l-[4px] border-r-[4px] border-b-[4px] border-l-transparent border-r-transparent border-b-zinc-700"})]})})]})},zp={scene:ja,choice:ka},Pp={type:"step",markerEnd:{type:yt.Arrow},style:{strokeWidth:2,stroke:"#52525b"}},Ip=[Dn,Dn],Ap=["Backspace","Delete"],$p=()=>{const e=oe(n=>n.selectNode),t=I.useCallback(({nodes:n})=>{const r=n.length>0?n[0].id:null;e(r)},[e]);return cm({onChange:t}),null},Ea=fe.memo(()=>{const e=oe(l=>l.nodes),t=oe(l=>l.edges),n=oe(l=>l.selectedNodeId),r=oe(l=>l.onNodesChange),o=oe(l=>l.onEdgesChange),s=oe(l=>l.addConnection),i=I.useMemo(()=>new Map(e.map(l=>[l.id,l])),[e]),a=I.useMemo(()=>{if(!n)return t;const l=i.get(n);if(!l||!Ze(l))return t;let u=!1;const h=t.map(f=>f.source===n||f.target===n?(u=!0,{...f,style:{...f.style??{},strokeWidth:3,stroke:"#dc2626"},markerEnd:{type:yt.Arrow,color:"#dc2626"}}):f);return u?h:t},[t,i,n]),c=I.useCallback(l=>{s(l)},[s]);return d.jsxs(Ur,{children:[d.jsxs(ra,{nodes:e,edges:a,nodeTypes:zp,onNodesChange:r,onEdgesChange:o,onConnect:c,defaultEdgeOptions:Pp,connectionLineType:ke.Step,deleteKeyCode:Ap,snapToGrid:!0,snapGrid:Ip,fitView:!0,children:[d.jsx(aa,{}),d.jsx(la,{}),d.jsx(sa,{gap:Dn,size:1})]}),d.jsx($p,{})]})}),Tp=()=>d.jsxs(he,{direction:"col",className:"space-y-2 mt-4",children:[d.jsxs(he,{className:"items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-zinc-800 border border-zinc-700"}),d.jsx(Qe,{variant:"muted",size:"xs",children:"Scene nodes"})]}),d.jsxs(he,{className:"items-center gap-2",children:[d.jsx("div",{className:"w-3 h-3 bg-zinc-700 border border-zinc-600"}),d.jsx(Qe,{variant:"muted",size:"xs",children:"Choice nodes"})]}),d.jsxs(he,{className:"items-center gap-2",children:[d.jsx("div",{className:"w-8 h-0.5 bg-orange-500"}),d.jsx(Qe,{variant:"muted",size:"xs",children:"Conditional paths"})]})]}),Dp=()=>d.jsxs(he,{direction:"row",fullHeight:!0,children:[d.jsx(he,{flex:!0,direction:"col",className:"bg-zinc-950",children:d.jsx(Xe,{className:"flex-1",children:d.jsx(Ea,{})})}),d.jsxs(Xe,{className:"w-[350px] border-l border-zinc-800",children:[d.jsx(St,{title:"Story Overview"}),d.jsx(Ye,{children:d.jsx(Fm,{icon:d.jsx(ys,{className:"w-12 h-12 text-zinc-600"}),title:"Story flow visualization",action:d.jsxs(xe,{compact:!0,children:[d.jsxs(he,{className:"items-start gap-2 mb-3",children:[d.jsx(Yc,{className:"w-4 h-4 text-zinc-500 mt-0.5"}),d.jsx(Qe,{variant:"muted",size:"xs",className:"leading-relaxed",children:"This view shows your complete story structure. Add scenes and choices to build branching narratives."})]}),d.jsx(Tp,{})]})})})]})]}),Vp=()=>{const e=oe(l=>l.nodes),t=oe(l=>l.edges),n=oe(l=>l.selectedNodeId),r=oe(l=>l.updateNode),o=oe(l=>l.deleteNode),s=oe(l=>l.addSceneNode),i=oe(l=>l.addChoiceNode),a=me(l=>l.variables),c=I.useMemo(()=>e.find(l=>l.id===n),[e,n]);return c?d.jsxs(d.Fragment,{children:[d.jsxs(Ye,{children:[d.jsx(xe,{title:Se(c)?"Scene":"Choice",children:d.jsxs("div",{className:"space-y-3",children:[d.jsx(kr,{label:"Name",value:c.data.label,onChange:l=>r(c.id,{label:l.target.value})}),Se(c)&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-zinc-500 mb-1 text-[10px] uppercase",children:"Description"}),d.jsx("textarea",{value:c.data.description||"",onChange:l=>r(c.id,{description:l.target.value}),className:"w-full bg-zinc-950 border border-zinc-800 px-2 py-1 text-xs text-zinc-200 focus:border-zinc-600 focus:outline-none resize-none rounded",rows:3})]}),d.jsx(kr,{label:"Duration (sec)",type:"number",value:c.data.durationSec,min:0,onChange:l=>{const u=parseInt(l.target.value);!isNaN(u)&&u>=0&&r(c.id,{durationSec:u})}}),d.jsxs("div",{className:"flex items-center justify-between py-2 px-2 bg-zinc-950 border border-zinc-800 rounded",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Wc,{className:`w-4 h-4 ${c.data.isPriority?"text-yellow-400 fill-yellow-400":"text-zinc-600"}`}),d.jsx("span",{className:"text-xs text-zinc-400",children:"Priority Scene"})]}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:c.data.isPriority||!1,onChange:l=>r(c.id,{isPriority:l.target.checked}),className:"sr-only peer"}),d.jsx("div",{className:"w-9 h-5 bg-zinc-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-yellow-600"})]})]}),c.data.isPriority&&d.jsx("div",{className:"p-2 bg-yellow-900/20 border border-yellow-800/30 rounded",children:d.jsx("p",{className:"text-[10px] text-yellow-200/80 leading-relaxed",children:"This scene will be chosen automatically when multiple scenes are available after playback ends."})})]}),d.jsxs("div",{className:"flex justify-between",children:[Se(c)&&d.jsx(le,{size:"xs",onClick:()=>i({connectFromId:c.id}),children:"+ Choice"}),c.id!==Gt&&d.jsx(le,{size:"xs",variant:"ghost",onClick:()=>o(c.id),children:"Delete"})]})]})}),Se(c)&&d.jsx(xe,{title:"Conditions",className:"mt-3",children:d.jsxs("div",{className:"space-y-2",children:[(c.data.conditions??[]).map((l,u)=>d.jsxs("div",{className:"flex gap-1",children:[d.jsx(us,{value:l.varName,options:[{value:"",label:"(none)"},...a.map(h=>({value:h.name,label:h.name}))],onChange:h=>{const f=[...c.data.conditions??[]];f[u]={...l,varName:h.target.value},r(c.id,{conditions:f})},className:"flex-1"}),d.jsx(us,{value:l.op,options:[{value:"lt",label:"<"},{value:"lte",label:"≤"},{value:"eq",label:"="},{value:"neq",label:"≠"},{value:"gte",label:"≥"},{value:"gt",label:">"}],onChange:h=>{const f=[...c.data.conditions??[]];f[u]={...l,op:h.target.value},r(c.id,{conditions:f})},className:"w-16"}),d.jsx("input",{type:"number",value:l.value,onChange:h=>{const f=parseFloat(h.target.value),g=[...c.data.conditions??[]];g[u]={...l,value:isNaN(f)?0:f},r(c.id,{conditions:g})},className:"w-16 bg-zinc-950 border border-zinc-800 px-1 py-0.5 text-xs text-zinc-200 text-center focus:border-zinc-600 focus:outline-none rounded"}),d.jsx(le,{size:"xs",variant:"ghost",onClick:()=>{const h=(c.data.conditions??[]).filter((f,g)=>g!==u);r(c.id,{conditions:h})},children:"×"})]},u)),d.jsx(le,{size:"xs",onClick:()=>{var u;const l=[...c.data.conditions??[],{varName:((u=a[0])==null?void 0:u.name)??"",op:"gte",value:0}];r(c.id,{conditions:l})},children:"+ Add Condition"})]})}),Ze(c)&&d.jsx(xe,{title:"Variable Effects",className:"mt-3",children:d.jsx("div",{className:"space-y-2",children:a.map(l=>{const u=c.data.effects[l.name]??0;return d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"w-20 text-xs text-zinc-400 font-mono",children:l.name}),d.jsx(le,{size:"xs",onClick:()=>r(c.id,{effects:{...c.data.effects,[l.name]:u-1}}),children:"−"}),d.jsxs("span",{className:`w-10 text-center text-xs font-mono ${u>0?"text-green-400":u<0?"text-red-400":"text-zinc-600"}`,children:[u>0?"+":"",u]}),d.jsx(le,{size:"xs",onClick:()=>r(c.id,{effects:{...c.data.effects,[l.name]:u+1}}),children:"+"})]},l.name)})})})]}),d.jsxs(Kn,{children:[e.length," nodes • ",t.length," edges",d.jsx("span",{className:"ml-auto",children:n?`ID: ${n}`:"Ready"})]})]}):d.jsx(Ye,{children:d.jsxs("div",{className:"text-center py-8",children:[d.jsx("p",{className:"text-zinc-600 text-xs mb-4",children:"No node selected"}),d.jsxs("div",{className:"flex gap-2 justify-center",children:[d.jsx(le,{icon:ht,onClick:s,children:"Add Scene"}),d.jsx(le,{icon:ht,onClick:()=>i(),children:"Add Choice"})]})]})})},Rp=()=>d.jsxs("div",{className:"flex h-full",children:[d.jsx("div",{className:"flex-1 bg-zinc-900",children:d.jsx(Ea,{})}),d.jsxs(Xe,{className:"w-96 border-l border-zinc-800",children:[d.jsx(St,{title:"Inspector"}),d.jsx(Vp,{})]})]}),Lp={scene:ja,choice:ka},Hp={type:"smoothstep",markerEnd:{type:"arrow"},style:{strokeWidth:2,stroke:"#52525b"}},Fp=()=>{const e=oe(N=>N.nodes),t=oe(N=>N.edges),n=at(N=>N.currentSceneId),r=at(N=>N.start),o=at(N=>N.reset),s=at(N=>N.executeChoice),i=at(N=>N.getAvailableChoices),{setCenter:a,fitView:c,getZoom:l}=Gn(),u=fe.useRef(null),h=fe.useRef(!0),f=Be(N=>N.currentVideoUrl),g=Be(N=>N.duration),y=Be(N=>N.currentTime),p=fe.useMemo(()=>f&&Number.isFinite(g)&&Number.isFinite(y)?Math.ceil(Math.max(0,(g||0)-(y||0))):null,[f,g,y]);fe.useEffect(()=>{n||r()},[n,r]);const x=fe.useMemo(()=>e.find(N=>N.id===n&&Se(N)),[e,n]);fe.useEffect(()=>{h.current&&e.length>0&&(h.current=!1,requestAnimationFrame(()=>{c({padding:.2,duration:800,maxZoom:1,minZoom:.5})}))},[e.length,c]),fe.useEffect(()=>{if(!x||u.current===x.id)return;const N=x.position.x+120,M=x.position.y+120,k=l(),A=k<.5?.8:k;a(N,M,{zoom:A,duration:600}).then(()=>{u.current=x.id})},[x,a,l]);const b=fe.useMemo(()=>i(),[i,n]),S=N=>{s(N)&&(u.current=null)},m=()=>{u.current=null,h.current=!0,o()},w=fe.useMemo(()=>e.map(N=>({...N,selected:N.id===n,draggable:!1,data:{...N.data,isCurrent:N.id===n}})),[e,n]),C=fe.useMemo(()=>t.map(N=>({...N,selected:!1})),[t]);return d.jsxs("div",{className:"flex h-full min-h-0",children:[d.jsx("div",{className:"flex-1 bg-zinc-950 min-h-0",children:d.jsxs(ra,{nodes:w,edges:C,nodeTypes:Lp,defaultEdgeOptions:Hp,connectionLineType:ke.SmoothStep,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,selectNodesOnDrag:!1,selectionOnDrag:!1,selectionKeyCode:null,panOnDrag:!0,zoomOnScroll:!0,zoomOnPinch:!0,children:[d.jsx(aa,{}),d.jsx(la,{}),d.jsx(sa,{gap:24,size:1})]})}),d.jsxs(Xe,{className:"w-[420px] border-l border-zinc-800 flex flex-col min-h-0",children:[d.jsx(St,{title:"Play",actions:d.jsxs("div",{className:"flex items-center gap-2",children:[p!==null&&d.jsxs("div",{className:"flex items-center gap-1 text-zinc-300 text-xs",children:[d.jsx(bs,{className:"w-3 h-3"}),d.jsxs("span",{children:[p,"s"]})]}),d.jsx(le,{size:"xs",onClick:m,children:"Restart"})]})}),d.jsxs(Ye,{className:"space-y-3",children:[d.jsx(xe,{title:"Video",className:"p-0 overflow-hidden",children:d.jsx("div",{className:"h-[360px] md:h-[420px] lg:h-[480px] flex flex-col min-h-0",children:d.jsx(ha,{})})}),d.jsx(xe,{title:"Title",children:d.jsx("span",{className:`text-xs ${x?"text-zinc-300":"text-zinc-600"}`,children:x?x.data.label:"—"})}),d.jsx(xe,{title:"Choices",children:b.length>0?d.jsx("div",{className:"space-y-2",children:b.map(N=>d.jsx(le,{variant:"primary",onClick:()=>S(N.id),className:"w-full justify-start",children:N.data.label},N.id))}):d.jsx("p",{className:"text-xs text-zinc-600 text-center py-4",children:"No choices available"})})]}),d.jsxs(Kn,{children:[d.jsxs("span",{children:[e.length," nodes • ",t.length," edges"]}),d.jsx("span",{className:"ml-auto",children:x?`Scene: ${x.id}`:"Ready"})]})]})]})},Bp=()=>{const e=me(a=>a.variables),t=me(a=>a.removeVariable),n=me(a=>a.reset),r=me(a=>a.loadVariables),o=I.useMemo(()=>new Map(e.map(a=>[a.name,a])),[e]),s=(a,c)=>{r(e.map(l=>l.name===a?{...l,...c}:l))},i=()=>{const a=prompt("Variable name:");if(!a)return;if(o.has(a)){alert("Variable with this name already exists.");return}const c={name:a,value:10,initialValue:10,min:void 0,max:void 0};r([...e,c])};return d.jsxs(Xe,{className:"h-full bg-zinc-900",children:[d.jsx(St,{title:"Variables",actions:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("span",{className:"text-xs text-zinc-500",children:[e.length," items"]}),d.jsx(le,{variant:"default",size:"xs",icon:ht,onClick:i,children:"Add"}),d.jsx(le,{variant:"default",size:"xs",icon:Gc,onClick:n,children:"Reset"})]})}),d.jsx(Ye,{className:"p-2",children:e.length>0?d.jsx(d.Fragment,{children:e.map(a=>d.jsxs("div",{className:"mb-2",children:[d.jsxs("div",{className:"bg-zinc-800 border border-zinc-700 px-2 py-1 flex items-center justify-between",children:[d.jsx("span",{className:"text-xs font-mono text-zinc-300",children:a.name}),d.jsx("button",{onClick:()=>t(a.name),className:"text-zinc-600 hover:text-zinc-400 transition-colors text-lg leading-none",children:"×"})]}),d.jsx("div",{className:"bg-zinc-950 border-x border-b border-zinc-700 p-2",children:d.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[d.jsx(pn,{label:"Current",value:a.value,onChange:()=>{},disabled:!0}),d.jsx(pn,{label:"Initial",value:a.initialValue,onChange:c=>s(a.name,{initialValue:c,value:c})}),d.jsx(pn,{label:"Min",value:typeof a.min=="number"?a.min:"",placeholder:"—",onChange:c=>s(a.name,{min:c})}),d.jsx(pn,{label:"Max",value:typeof a.max=="number"?a.max:"",placeholder:"—",onChange:c=>s(a.name,{max:c})})]})})]},a.name))}):d.jsxs("div",{className:"text-center py-8",children:[d.jsx("div",{className:"text-zinc-600 italic text-xs mb-4",children:"No variables defined"}),d.jsx(le,{variant:"default",icon:ht,onClick:i,children:"Add Variable"})]})}),d.jsx(Kn,{children:"Variable System"})]})},Op=Ic([{element:d.jsx(Hm,{}),children:[{path:"/",element:d.jsx(Ym,{})},{path:"/video",element:d.jsx(Um,{})},{path:"/story",element:d.jsx(Dp,{})},{path:"/storymap",element:d.jsx(Rp,{})},{path:"/variables",element:d.jsx(Bp,{})},{path:"/play",element:d.jsx(Fp,{})}]}]);Ac.createRoot(document.getElementById("root")).render(d.jsx(fe.StrictMode,{children:d.jsx($c,{router:Op})}));
